// modules are defined as an array
// [ module function, map of requires ]
//
// map of requires is short require name -> numeric require
//
// anything defined in a previous bundle is accessed via the
// orig method which is the require for previous bundles
parcelRequire = (function (modules, cache, entry, globalName) {
  // Save the require from previous bundle to this closure if any
  var previousRequire = typeof parcelRequire === 'function' && parcelRequire;
  var nodeRequire = typeof require === 'function' && require;

  function newRequire(name, jumped) {
    if (!cache[name]) {
      if (!modules[name]) {
        // if we cannot find the module within our internal map or
        // cache jump to the current global require ie. the last bundle
        // that was added to the page.
        var currentRequire = typeof parcelRequire === 'function' && parcelRequire;
        if (!jumped && currentRequire) {
          return currentRequire(name, true);
        }

        // If there are other bundles on this page the require from the
        // previous one is saved to 'previousRequire'. Repeat this as
        // many times as there are bundles until the module is found or
        // we exhaust the require chain.
        if (previousRequire) {
          return previousRequire(name, true);
        }

        // Try the node require function if it exists.
        if (nodeRequire && typeof name === 'string') {
          return nodeRequire(name);
        }

        var err = new Error('Cannot find module \'' + name + '\'');
        err.code = 'MODULE_NOT_FOUND';
        throw err;
      }

      localRequire.resolve = resolve;
      localRequire.cache = {};

      var module = cache[name] = new newRequire.Module(name);

      modules[name][0].call(module.exports, localRequire, module, module.exports, this);
    }

    return cache[name].exports;

    function localRequire(x){
      return newRequire(localRequire.resolve(x));
    }

    function resolve(x){
      return modules[name][1][x] || x;
    }
  }

  function Module(moduleName) {
    this.id = moduleName;
    this.bundle = newRequire;
    this.exports = {};
  }

  newRequire.isParcelRequire = true;
  newRequire.Module = Module;
  newRequire.modules = modules;
  newRequire.cache = cache;
  newRequire.parent = previousRequire;
  newRequire.register = function (id, exports) {
    modules[id] = [function (require, module) {
      module.exports = exports;
    }, {}];
  };

  var error;
  for (var i = 0; i < entry.length; i++) {
    try {
      newRequire(entry[i]);
    } catch (e) {
      // Save first error but execute all entries
      if (!error) {
        error = e;
      }
    }
  }

  if (entry.length) {
    // Expose entry point to Node, AMD or browser globals
    // Based on https://github.com/ForbesLindesay/umd/blob/master/template.js
    var mainExports = newRequire(entry[entry.length - 1]);

    // CommonJS
    if (typeof exports === "object" && typeof module !== "undefined") {
      module.exports = mainExports;

    // RequireJS
    } else if (typeof define === "function" && define.amd) {
     define(function () {
       return mainExports;
     });

    // <script>
    } else if (globalName) {
      this[globalName] = mainExports;
    }
  }

  // Override the current require with this new one
  parcelRequire = newRequire;

  if (error) {
    // throw error from earlier, _after updating parcelRequire_
    throw error;
  }

  return newRequire;
})({"three.js-master/build/three.min.js":[function(require,module,exports) {
var define;
function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

function _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e307) { throw _e307; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e308) { didErr = true; err = _e308; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function _get(target, property, receiver) { if (typeof Reflect !== "undefined" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }

function _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _isNativeReflectConstruct() { if (typeof Reflect === "undefined" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === "function") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

/**
 * @license
 * Copyright 2010-2021 Three.js Authors
 * SPDX-License-Identifier: MIT
 */
!function (t, e) {
  "object" == (typeof exports === "undefined" ? "undefined" : _typeof(exports)) && "undefined" != typeof module ? e(exports) : "function" == typeof define && define.amd ? define(["exports"], e) : e((t = "undefined" != typeof globalThis ? globalThis : t || self).THREE = {});
}(this, function (t) {
  "use strict";

  var _Ti;

  var e = "131",
      n = 100,
      i = 300,
      r = 301,
      s = 302,
      a = 303,
      o = 304,
      l = 306,
      c = 307,
      h = 1e3,
      u = 1001,
      d = 1002,
      p = 1003,
      m = 1004,
      f = 1005,
      g = 1006,
      v = 1007,
      y = 1008,
      x = 1009,
      _ = 1012,
      M = 1014,
      b = 1015,
      w = 1016,
      S = 1020,
      T = 1022,
      E = 1023,
      A = 1026,
      L = 1027,
      R = 33776,
      C = 33777,
      P = 33778,
      I = 33779,
      D = 35840,
      N = 35841,
      B = 35842,
      z = 35843,
      F = 37492,
      O = 37496,
      U = 2300,
      H = 2301,
      G = 2302,
      k = 2400,
      V = 2401,
      W = 2402,
      j = 2500,
      q = 2501,
      X = 3e3,
      Y = 3001,
      J = 3007,
      Z = 3002,
      Q = 3004,
      K = 3005,
      $ = 3006,
      tt = 7680,
      et = 35044,
      nt = 35048,
      it = "300 es";

  var rt = /*#__PURE__*/function () {
    function rt() {
      _classCallCheck(this, rt);
    }

    _createClass(rt, [{
      key: "addEventListener",
      value: function addEventListener(t, e) {
        void 0 === this._listeners && (this._listeners = {});
        var n = this._listeners;
        void 0 === n[t] && (n[t] = []), -1 === n[t].indexOf(e) && n[t].push(e);
      }
    }, {
      key: "hasEventListener",
      value: function hasEventListener(t, e) {
        if (void 0 === this._listeners) return !1;
        var n = this._listeners;
        return void 0 !== n[t] && -1 !== n[t].indexOf(e);
      }
    }, {
      key: "removeEventListener",
      value: function removeEventListener(t, e) {
        if (void 0 === this._listeners) return;
        var n = this._listeners[t];

        if (void 0 !== n) {
          var _t2 = n.indexOf(e);

          -1 !== _t2 && n.splice(_t2, 1);
        }
      }
    }, {
      key: "dispatchEvent",
      value: function dispatchEvent(t) {
        if (void 0 === this._listeners) return;
        var e = this._listeners[t.type];

        if (void 0 !== e) {
          t.target = this;

          var _n2 = e.slice(0);

          for (var _e2 = 0, _i2 = _n2.length; _e2 < _i2; _e2++) {
            _n2[_e2].call(this, t);
          }

          t.target = null;
        }
      }
    }]);

    return rt;
  }();

  var st = [];

  for (var _t3 = 0; _t3 < 256; _t3++) {
    st[_t3] = (_t3 < 16 ? "0" : "") + _t3.toString(16);
  }

  var at = 1234567;
  var ot = Math.PI / 180,
      lt = 180 / Math.PI;

  function ct() {
    var t = 4294967295 * Math.random() | 0,
        e = 4294967295 * Math.random() | 0,
        n = 4294967295 * Math.random() | 0,
        i = 4294967295 * Math.random() | 0;
    return (st[255 & t] + st[t >> 8 & 255] + st[t >> 16 & 255] + st[t >> 24 & 255] + "-" + st[255 & e] + st[e >> 8 & 255] + "-" + st[e >> 16 & 15 | 64] + st[e >> 24 & 255] + "-" + st[63 & n | 128] + st[n >> 8 & 255] + "-" + st[n >> 16 & 255] + st[n >> 24 & 255] + st[255 & i] + st[i >> 8 & 255] + st[i >> 16 & 255] + st[i >> 24 & 255]).toUpperCase();
  }

  function ht(t, e, n) {
    return Math.max(e, Math.min(n, t));
  }

  function ut(t, e) {
    return (t % e + e) % e;
  }

  function dt(t, e, n) {
    return (1 - n) * t + n * e;
  }

  function pt(t) {
    return 0 == (t & t - 1) && 0 !== t;
  }

  function mt(t) {
    return Math.pow(2, Math.ceil(Math.log(t) / Math.LN2));
  }

  function ft(t) {
    return Math.pow(2, Math.floor(Math.log(t) / Math.LN2));
  }

  var gt = Object.freeze({
    __proto__: null,
    DEG2RAD: ot,
    RAD2DEG: lt,
    generateUUID: ct,
    clamp: ht,
    euclideanModulo: ut,
    mapLinear: function mapLinear(t, e, n, i, r) {
      return i + (t - e) * (r - i) / (n - e);
    },
    inverseLerp: function inverseLerp(t, e, n) {
      return t !== e ? (n - t) / (e - t) : 0;
    },
    lerp: dt,
    damp: function damp(t, e, n, i) {
      return dt(t, e, 1 - Math.exp(-n * i));
    },
    pingpong: function pingpong(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      return e - Math.abs(ut(t, 2 * e) - e);
    },
    smoothstep: function smoothstep(t, e, n) {
      return t <= e ? 0 : t >= n ? 1 : (t = (t - e) / (n - e)) * t * (3 - 2 * t);
    },
    smootherstep: function smootherstep(t, e, n) {
      return t <= e ? 0 : t >= n ? 1 : (t = (t - e) / (n - e)) * t * t * (t * (6 * t - 15) + 10);
    },
    randInt: function randInt(t, e) {
      return t + Math.floor(Math.random() * (e - t + 1));
    },
    randFloat: function randFloat(t, e) {
      return t + Math.random() * (e - t);
    },
    randFloatSpread: function randFloatSpread(t) {
      return t * (.5 - Math.random());
    },
    seededRandom: function seededRandom(t) {
      return void 0 !== t && (at = t % 2147483647), at = 16807 * at % 2147483647, (at - 1) / 2147483646;
    },
    degToRad: function degToRad(t) {
      return t * ot;
    },
    radToDeg: function radToDeg(t) {
      return t * lt;
    },
    isPowerOfTwo: pt,
    ceilPowerOfTwo: mt,
    floorPowerOfTwo: ft,
    setQuaternionFromProperEuler: function setQuaternionFromProperEuler(t, e, n, i, r) {
      var s = Math.cos,
          a = Math.sin,
          o = s(n / 2),
          l = a(n / 2),
          c = s((e + i) / 2),
          h = a((e + i) / 2),
          u = s((e - i) / 2),
          d = a((e - i) / 2),
          p = s((i - e) / 2),
          m = a((i - e) / 2);

      switch (r) {
        case "XYX":
          t.set(o * h, l * u, l * d, o * c);
          break;

        case "YZY":
          t.set(l * d, o * h, l * u, o * c);
          break;

        case "ZXZ":
          t.set(l * u, l * d, o * h, o * c);
          break;

        case "XZX":
          t.set(o * h, l * m, l * p, o * c);
          break;

        case "YXY":
          t.set(l * p, o * h, l * m, o * c);
          break;

        case "ZYZ":
          t.set(l * m, l * p, o * h, o * c);
          break;

        default:
          console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: " + r);
      }
    }
  });

  var vt = /*#__PURE__*/function () {
    function vt() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;

      _classCallCheck(this, vt);

      this.x = t, this.y = e;
    }

    _createClass(vt, [{
      key: "width",
      get: function get() {
        return this.x;
      },
      set: function set(t) {
        this.x = t;
      }
    }, {
      key: "height",
      get: function get() {
        return this.y;
      },
      set: function set(t) {
        this.y = t;
      }
    }, {
      key: "set",
      value: function set(t, e) {
        return this.x = t, this.y = e, this;
      }
    }, {
      key: "setScalar",
      value: function setScalar(t) {
        return this.x = t, this.y = t, this;
      }
    }, {
      key: "setX",
      value: function setX(t) {
        return this.x = t, this;
      }
    }, {
      key: "setY",
      value: function setY(t) {
        return this.y = t, this;
      }
    }, {
      key: "setComponent",
      value: function setComponent(t, e) {
        switch (t) {
          case 0:
            this.x = e;
            break;

          case 1:
            this.y = e;
            break;

          default:
            throw new Error("index is out of range: " + t);
        }

        return this;
      }
    }, {
      key: "getComponent",
      value: function getComponent(t) {
        switch (t) {
          case 0:
            return this.x;

          case 1:
            return this.y;

          default:
            throw new Error("index is out of range: " + t);
        }
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor(this.x, this.y);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.x = t.x, this.y = t.y, this;
      }
    }, {
      key: "add",
      value: function add(t, e) {
        return void 0 !== e ? (console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(t, e)) : (this.x += t.x, this.y += t.y, this);
      }
    }, {
      key: "addScalar",
      value: function addScalar(t) {
        return this.x += t, this.y += t, this;
      }
    }, {
      key: "addVectors",
      value: function addVectors(t, e) {
        return this.x = t.x + e.x, this.y = t.y + e.y, this;
      }
    }, {
      key: "addScaledVector",
      value: function addScaledVector(t, e) {
        return this.x += t.x * e, this.y += t.y * e, this;
      }
    }, {
      key: "sub",
      value: function sub(t, e) {
        return void 0 !== e ? (console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(t, e)) : (this.x -= t.x, this.y -= t.y, this);
      }
    }, {
      key: "subScalar",
      value: function subScalar(t) {
        return this.x -= t, this.y -= t, this;
      }
    }, {
      key: "subVectors",
      value: function subVectors(t, e) {
        return this.x = t.x - e.x, this.y = t.y - e.y, this;
      }
    }, {
      key: "multiply",
      value: function multiply(t) {
        return this.x *= t.x, this.y *= t.y, this;
      }
    }, {
      key: "multiplyScalar",
      value: function multiplyScalar(t) {
        return this.x *= t, this.y *= t, this;
      }
    }, {
      key: "divide",
      value: function divide(t) {
        return this.x /= t.x, this.y /= t.y, this;
      }
    }, {
      key: "divideScalar",
      value: function divideScalar(t) {
        return this.multiplyScalar(1 / t);
      }
    }, {
      key: "applyMatrix3",
      value: function applyMatrix3(t) {
        var e = this.x,
            n = this.y,
            i = t.elements;
        return this.x = i[0] * e + i[3] * n + i[6], this.y = i[1] * e + i[4] * n + i[7], this;
      }
    }, {
      key: "min",
      value: function min(t) {
        return this.x = Math.min(this.x, t.x), this.y = Math.min(this.y, t.y), this;
      }
    }, {
      key: "max",
      value: function max(t) {
        return this.x = Math.max(this.x, t.x), this.y = Math.max(this.y, t.y), this;
      }
    }, {
      key: "clamp",
      value: function clamp(t, e) {
        return this.x = Math.max(t.x, Math.min(e.x, this.x)), this.y = Math.max(t.y, Math.min(e.y, this.y)), this;
      }
    }, {
      key: "clampScalar",
      value: function clampScalar(t, e) {
        return this.x = Math.max(t, Math.min(e, this.x)), this.y = Math.max(t, Math.min(e, this.y)), this;
      }
    }, {
      key: "clampLength",
      value: function clampLength(t, e) {
        var n = this.length();
        return this.divideScalar(n || 1).multiplyScalar(Math.max(t, Math.min(e, n)));
      }
    }, {
      key: "floor",
      value: function floor() {
        return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this;
      }
    }, {
      key: "ceil",
      value: function ceil() {
        return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this;
      }
    }, {
      key: "round",
      value: function round() {
        return this.x = Math.round(this.x), this.y = Math.round(this.y), this;
      }
    }, {
      key: "roundToZero",
      value: function roundToZero() {
        return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this;
      }
    }, {
      key: "negate",
      value: function negate() {
        return this.x = -this.x, this.y = -this.y, this;
      }
    }, {
      key: "dot",
      value: function dot(t) {
        return this.x * t.x + this.y * t.y;
      }
    }, {
      key: "cross",
      value: function cross(t) {
        return this.x * t.y - this.y * t.x;
      }
    }, {
      key: "lengthSq",
      value: function lengthSq() {
        return this.x * this.x + this.y * this.y;
      }
    }, {
      key: "length",
      value: function length() {
        return Math.sqrt(this.x * this.x + this.y * this.y);
      }
    }, {
      key: "manhattanLength",
      value: function manhattanLength() {
        return Math.abs(this.x) + Math.abs(this.y);
      }
    }, {
      key: "normalize",
      value: function normalize() {
        return this.divideScalar(this.length() || 1);
      }
    }, {
      key: "angle",
      value: function angle() {
        return Math.atan2(-this.y, -this.x) + Math.PI;
      }
    }, {
      key: "distanceTo",
      value: function distanceTo(t) {
        return Math.sqrt(this.distanceToSquared(t));
      }
    }, {
      key: "distanceToSquared",
      value: function distanceToSquared(t) {
        var e = this.x - t.x,
            n = this.y - t.y;
        return e * e + n * n;
      }
    }, {
      key: "manhattanDistanceTo",
      value: function manhattanDistanceTo(t) {
        return Math.abs(this.x - t.x) + Math.abs(this.y - t.y);
      }
    }, {
      key: "setLength",
      value: function setLength(t) {
        return this.normalize().multiplyScalar(t);
      }
    }, {
      key: "lerp",
      value: function lerp(t, e) {
        return this.x += (t.x - this.x) * e, this.y += (t.y - this.y) * e, this;
      }
    }, {
      key: "lerpVectors",
      value: function lerpVectors(t, e, n) {
        return this.x = t.x + (e.x - t.x) * n, this.y = t.y + (e.y - t.y) * n, this;
      }
    }, {
      key: "equals",
      value: function equals(t) {
        return t.x === this.x && t.y === this.y;
      }
    }, {
      key: "fromArray",
      value: function fromArray(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        return this.x = t[e], this.y = t[e + 1], this;
      }
    }, {
      key: "toArray",
      value: function toArray() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        return t[e] = this.x, t[e + 1] = this.y, t;
      }
    }, {
      key: "fromBufferAttribute",
      value: function fromBufferAttribute(t, e, n) {
        return void 0 !== n && console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."), this.x = t.getX(e), this.y = t.getY(e), this;
      }
    }, {
      key: "rotateAround",
      value: function rotateAround(t, e) {
        var n = Math.cos(e),
            i = Math.sin(e),
            r = this.x - t.x,
            s = this.y - t.y;
        return this.x = r * n - s * i + t.x, this.y = r * i + s * n + t.y, this;
      }
    }, {
      key: "random",
      value: function random() {
        return this.x = Math.random(), this.y = Math.random(), this;
      }
    }]);

    return vt;
  }();

  vt.prototype.isVector2 = !0;

  var yt = /*#__PURE__*/function () {
    function yt() {
      _classCallCheck(this, yt);

      this.elements = [1, 0, 0, 0, 1, 0, 0, 0, 1], arguments.length > 0 && console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.");
    }

    _createClass(yt, [{
      key: "set",
      value: function set(t, e, n, i, r, s, a, o, l) {
        var c = this.elements;
        return c[0] = t, c[1] = i, c[2] = a, c[3] = e, c[4] = r, c[5] = o, c[6] = n, c[7] = s, c[8] = l, this;
      }
    }, {
      key: "identity",
      value: function identity() {
        return this.set(1, 0, 0, 0, 1, 0, 0, 0, 1), this;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        var e = this.elements,
            n = t.elements;
        return e[0] = n[0], e[1] = n[1], e[2] = n[2], e[3] = n[3], e[4] = n[4], e[5] = n[5], e[6] = n[6], e[7] = n[7], e[8] = n[8], this;
      }
    }, {
      key: "extractBasis",
      value: function extractBasis(t, e, n) {
        return t.setFromMatrix3Column(this, 0), e.setFromMatrix3Column(this, 1), n.setFromMatrix3Column(this, 2), this;
      }
    }, {
      key: "setFromMatrix4",
      value: function setFromMatrix4(t) {
        var e = t.elements;
        return this.set(e[0], e[4], e[8], e[1], e[5], e[9], e[2], e[6], e[10]), this;
      }
    }, {
      key: "multiply",
      value: function multiply(t) {
        return this.multiplyMatrices(this, t);
      }
    }, {
      key: "premultiply",
      value: function premultiply(t) {
        return this.multiplyMatrices(t, this);
      }
    }, {
      key: "multiplyMatrices",
      value: function multiplyMatrices(t, e) {
        var n = t.elements,
            i = e.elements,
            r = this.elements,
            s = n[0],
            a = n[3],
            o = n[6],
            l = n[1],
            c = n[4],
            h = n[7],
            u = n[2],
            d = n[5],
            p = n[8],
            m = i[0],
            f = i[3],
            g = i[6],
            v = i[1],
            y = i[4],
            x = i[7],
            _ = i[2],
            M = i[5],
            b = i[8];
        return r[0] = s * m + a * v + o * _, r[3] = s * f + a * y + o * M, r[6] = s * g + a * x + o * b, r[1] = l * m + c * v + h * _, r[4] = l * f + c * y + h * M, r[7] = l * g + c * x + h * b, r[2] = u * m + d * v + p * _, r[5] = u * f + d * y + p * M, r[8] = u * g + d * x + p * b, this;
      }
    }, {
      key: "multiplyScalar",
      value: function multiplyScalar(t) {
        var e = this.elements;
        return e[0] *= t, e[3] *= t, e[6] *= t, e[1] *= t, e[4] *= t, e[7] *= t, e[2] *= t, e[5] *= t, e[8] *= t, this;
      }
    }, {
      key: "determinant",
      value: function determinant() {
        var t = this.elements,
            e = t[0],
            n = t[1],
            i = t[2],
            r = t[3],
            s = t[4],
            a = t[5],
            o = t[6],
            l = t[7],
            c = t[8];
        return e * s * c - e * a * l - n * r * c + n * a * o + i * r * l - i * s * o;
      }
    }, {
      key: "invert",
      value: function invert() {
        var t = this.elements,
            e = t[0],
            n = t[1],
            i = t[2],
            r = t[3],
            s = t[4],
            a = t[5],
            o = t[6],
            l = t[7],
            c = t[8],
            h = c * s - a * l,
            u = a * o - c * r,
            d = l * r - s * o,
            p = e * h + n * u + i * d;
        if (0 === p) return this.set(0, 0, 0, 0, 0, 0, 0, 0, 0);
        var m = 1 / p;
        return t[0] = h * m, t[1] = (i * l - c * n) * m, t[2] = (a * n - i * s) * m, t[3] = u * m, t[4] = (c * e - i * o) * m, t[5] = (i * r - a * e) * m, t[6] = d * m, t[7] = (n * o - l * e) * m, t[8] = (s * e - n * r) * m, this;
      }
    }, {
      key: "transpose",
      value: function transpose() {
        var t;
        var e = this.elements;
        return t = e[1], e[1] = e[3], e[3] = t, t = e[2], e[2] = e[6], e[6] = t, t = e[5], e[5] = e[7], e[7] = t, this;
      }
    }, {
      key: "getNormalMatrix",
      value: function getNormalMatrix(t) {
        return this.setFromMatrix4(t).invert().transpose();
      }
    }, {
      key: "transposeIntoArray",
      value: function transposeIntoArray(t) {
        var e = this.elements;
        return t[0] = e[0], t[1] = e[3], t[2] = e[6], t[3] = e[1], t[4] = e[4], t[5] = e[7], t[6] = e[2], t[7] = e[5], t[8] = e[8], this;
      }
    }, {
      key: "setUvTransform",
      value: function setUvTransform(t, e, n, i, r, s, a) {
        var o = Math.cos(r),
            l = Math.sin(r);
        return this.set(n * o, n * l, -n * (o * s + l * a) + s + t, -i * l, i * o, -i * (-l * s + o * a) + a + e, 0, 0, 1), this;
      }
    }, {
      key: "scale",
      value: function scale(t, e) {
        var n = this.elements;
        return n[0] *= t, n[3] *= t, n[6] *= t, n[1] *= e, n[4] *= e, n[7] *= e, this;
      }
    }, {
      key: "rotate",
      value: function rotate(t) {
        var e = Math.cos(t),
            n = Math.sin(t),
            i = this.elements,
            r = i[0],
            s = i[3],
            a = i[6],
            o = i[1],
            l = i[4],
            c = i[7];
        return i[0] = e * r + n * o, i[3] = e * s + n * l, i[6] = e * a + n * c, i[1] = -n * r + e * o, i[4] = -n * s + e * l, i[7] = -n * a + e * c, this;
      }
    }, {
      key: "translate",
      value: function translate(t, e) {
        var n = this.elements;
        return n[0] += t * n[2], n[3] += t * n[5], n[6] += t * n[8], n[1] += e * n[2], n[4] += e * n[5], n[7] += e * n[8], this;
      }
    }, {
      key: "equals",
      value: function equals(t) {
        var e = this.elements,
            n = t.elements;

        for (var _t4 = 0; _t4 < 9; _t4++) {
          if (e[_t4] !== n[_t4]) return !1;
        }

        return !0;
      }
    }, {
      key: "fromArray",
      value: function fromArray(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;

        for (var _n3 = 0; _n3 < 9; _n3++) {
          this.elements[_n3] = t[_n3 + e];
        }

        return this;
      }
    }, {
      key: "toArray",
      value: function toArray() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        var n = this.elements;
        return t[e] = n[0], t[e + 1] = n[1], t[e + 2] = n[2], t[e + 3] = n[3], t[e + 4] = n[4], t[e + 5] = n[5], t[e + 6] = n[6], t[e + 7] = n[7], t[e + 8] = n[8], t;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().fromArray(this.elements);
      }
    }]);

    return yt;
  }();

  var xt;
  yt.prototype.isMatrix3 = !0;

  var _t = /*#__PURE__*/function () {
    function _t() {
      _classCallCheck(this, _t);
    }

    _createClass(_t, null, [{
      key: "getDataURL",
      value: function getDataURL(t) {
        if (/^data:/i.test(t.src)) return t.src;
        if ("undefined" == typeof HTMLCanvasElement) return t.src;
        var e;
        if (t instanceof HTMLCanvasElement) e = t;else {
          void 0 === xt && (xt = document.createElementNS("http://www.w3.org/1999/xhtml", "canvas")), xt.width = t.width, xt.height = t.height;

          var _n4 = xt.getContext("2d");

          t instanceof ImageData ? _n4.putImageData(t, 0, 0) : _n4.drawImage(t, 0, 0, t.width, t.height), e = xt;
        }
        return e.width > 2048 || e.height > 2048 ? (console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons", t), e.toDataURL("image/jpeg", .6)) : e.toDataURL("image/png");
      }
    }]);

    return _t;
  }();

  var Mt = 0;

  var bt = /*#__PURE__*/function (_rt) {
    _inherits(bt, _rt);

    var _super = _createSuper(bt);

    function bt() {
      var _this;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : bt.DEFAULT_IMAGE;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : bt.DEFAULT_MAPPING;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1001;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1001;
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1006;
      var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 1008;
      var a = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 1023;
      var o = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : 1009;
      var l = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : 1;
      var c = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : 3e3;

      _classCallCheck(this, bt);

      _this = _super.call(this), Object.defineProperty(_assertThisInitialized(_this), "id", {
        value: Mt++
      }), _this.uuid = ct(), _this.name = "", _this.image = t, _this.mipmaps = [], _this.mapping = e, _this.wrapS = n, _this.wrapT = i, _this.magFilter = r, _this.minFilter = s, _this.anisotropy = l, _this.format = a, _this.internalFormat = null, _this.type = o, _this.offset = new vt(0, 0), _this.repeat = new vt(1, 1), _this.center = new vt(0, 0), _this.rotation = 0, _this.matrixAutoUpdate = !0, _this.matrix = new yt(), _this.generateMipmaps = !0, _this.premultiplyAlpha = !1, _this.flipY = !0, _this.unpackAlignment = 4, _this.encoding = c, _this.version = 0, _this.onUpdate = null, _this.isRenderTargetTexture = !1;
      return _this;
    }

    _createClass(bt, [{
      key: "updateMatrix",
      value: function updateMatrix() {
        this.matrix.setUvTransform(this.offset.x, this.offset.y, this.repeat.x, this.repeat.y, this.rotation, this.center.x, this.center.y);
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.name = t.name, this.image = t.image, this.mipmaps = t.mipmaps.slice(0), this.mapping = t.mapping, this.wrapS = t.wrapS, this.wrapT = t.wrapT, this.magFilter = t.magFilter, this.minFilter = t.minFilter, this.anisotropy = t.anisotropy, this.format = t.format, this.internalFormat = t.internalFormat, this.type = t.type, this.offset.copy(t.offset), this.repeat.copy(t.repeat), this.center.copy(t.center), this.rotation = t.rotation, this.matrixAutoUpdate = t.matrixAutoUpdate, this.matrix.copy(t.matrix), this.generateMipmaps = t.generateMipmaps, this.premultiplyAlpha = t.premultiplyAlpha, this.flipY = t.flipY, this.unpackAlignment = t.unpackAlignment, this.encoding = t.encoding, this;
      }
    }, {
      key: "toJSON",
      value: function toJSON(t) {
        var e = void 0 === t || "string" == typeof t;
        if (!e && void 0 !== t.textures[this.uuid]) return t.textures[this.uuid];
        var n = {
          metadata: {
            version: 4.5,
            type: "Texture",
            generator: "Texture.toJSON"
          },
          uuid: this.uuid,
          name: this.name,
          mapping: this.mapping,
          repeat: [this.repeat.x, this.repeat.y],
          offset: [this.offset.x, this.offset.y],
          center: [this.center.x, this.center.y],
          rotation: this.rotation,
          wrap: [this.wrapS, this.wrapT],
          format: this.format,
          type: this.type,
          encoding: this.encoding,
          minFilter: this.minFilter,
          magFilter: this.magFilter,
          anisotropy: this.anisotropy,
          flipY: this.flipY,
          premultiplyAlpha: this.premultiplyAlpha,
          unpackAlignment: this.unpackAlignment
        };

        if (void 0 !== this.image) {
          var _i3 = this.image;

          if (void 0 === _i3.uuid && (_i3.uuid = ct()), !e && void 0 === t.images[_i3.uuid]) {
            var _e3;

            if (Array.isArray(_i3)) {
              _e3 = [];

              for (var _t5 = 0, _n5 = _i3.length; _t5 < _n5; _t5++) {
                _i3[_t5].isDataTexture ? _e3.push(wt(_i3[_t5].image)) : _e3.push(wt(_i3[_t5]));
              }
            } else _e3 = wt(_i3);

            t.images[_i3.uuid] = {
              uuid: _i3.uuid,
              url: _e3
            };
          }

          n.image = _i3.uuid;
        }

        return e || (t.textures[this.uuid] = n), n;
      }
    }, {
      key: "dispose",
      value: function dispose() {
        this.dispatchEvent({
          type: "dispose"
        });
      }
    }, {
      key: "transformUv",
      value: function transformUv(t) {
        if (this.mapping !== i) return t;
        if (t.applyMatrix3(this.matrix), t.x < 0 || t.x > 1) switch (this.wrapS) {
          case h:
            t.x = t.x - Math.floor(t.x);
            break;

          case u:
            t.x = t.x < 0 ? 0 : 1;
            break;

          case d:
            1 === Math.abs(Math.floor(t.x) % 2) ? t.x = Math.ceil(t.x) - t.x : t.x = t.x - Math.floor(t.x);
        }
        if (t.y < 0 || t.y > 1) switch (this.wrapT) {
          case h:
            t.y = t.y - Math.floor(t.y);
            break;

          case u:
            t.y = t.y < 0 ? 0 : 1;
            break;

          case d:
            1 === Math.abs(Math.floor(t.y) % 2) ? t.y = Math.ceil(t.y) - t.y : t.y = t.y - Math.floor(t.y);
        }
        return this.flipY && (t.y = 1 - t.y), t;
      }
    }, {
      key: "needsUpdate",
      set: function set(t) {
        !0 === t && this.version++;
      }
    }]);

    return bt;
  }(rt);

  function wt(t) {
    return "undefined" != typeof HTMLImageElement && t instanceof HTMLImageElement || "undefined" != typeof HTMLCanvasElement && t instanceof HTMLCanvasElement || "undefined" != typeof ImageBitmap && t instanceof ImageBitmap ? _t.getDataURL(t) : t.data ? {
      data: Array.prototype.slice.call(t.data),
      width: t.width,
      height: t.height,
      type: t.data.constructor.name
    } : (console.warn("THREE.Texture: Unable to serialize Texture."), {});
  }

  bt.DEFAULT_IMAGE = void 0, bt.DEFAULT_MAPPING = i, bt.prototype.isTexture = !0;

  var St = /*#__PURE__*/function () {
    function St() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;

      _classCallCheck(this, St);

      this.x = t, this.y = e, this.z = n, this.w = i;
    }

    _createClass(St, [{
      key: "width",
      get: function get() {
        return this.z;
      },
      set: function set(t) {
        this.z = t;
      }
    }, {
      key: "height",
      get: function get() {
        return this.w;
      },
      set: function set(t) {
        this.w = t;
      }
    }, {
      key: "set",
      value: function set(t, e, n, i) {
        return this.x = t, this.y = e, this.z = n, this.w = i, this;
      }
    }, {
      key: "setScalar",
      value: function setScalar(t) {
        return this.x = t, this.y = t, this.z = t, this.w = t, this;
      }
    }, {
      key: "setX",
      value: function setX(t) {
        return this.x = t, this;
      }
    }, {
      key: "setY",
      value: function setY(t) {
        return this.y = t, this;
      }
    }, {
      key: "setZ",
      value: function setZ(t) {
        return this.z = t, this;
      }
    }, {
      key: "setW",
      value: function setW(t) {
        return this.w = t, this;
      }
    }, {
      key: "setComponent",
      value: function setComponent(t, e) {
        switch (t) {
          case 0:
            this.x = e;
            break;

          case 1:
            this.y = e;
            break;

          case 2:
            this.z = e;
            break;

          case 3:
            this.w = e;
            break;

          default:
            throw new Error("index is out of range: " + t);
        }

        return this;
      }
    }, {
      key: "getComponent",
      value: function getComponent(t) {
        switch (t) {
          case 0:
            return this.x;

          case 1:
            return this.y;

          case 2:
            return this.z;

          case 3:
            return this.w;

          default:
            throw new Error("index is out of range: " + t);
        }
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor(this.x, this.y, this.z, this.w);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.x = t.x, this.y = t.y, this.z = t.z, this.w = void 0 !== t.w ? t.w : 1, this;
      }
    }, {
      key: "add",
      value: function add(t, e) {
        return void 0 !== e ? (console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(t, e)) : (this.x += t.x, this.y += t.y, this.z += t.z, this.w += t.w, this);
      }
    }, {
      key: "addScalar",
      value: function addScalar(t) {
        return this.x += t, this.y += t, this.z += t, this.w += t, this;
      }
    }, {
      key: "addVectors",
      value: function addVectors(t, e) {
        return this.x = t.x + e.x, this.y = t.y + e.y, this.z = t.z + e.z, this.w = t.w + e.w, this;
      }
    }, {
      key: "addScaledVector",
      value: function addScaledVector(t, e) {
        return this.x += t.x * e, this.y += t.y * e, this.z += t.z * e, this.w += t.w * e, this;
      }
    }, {
      key: "sub",
      value: function sub(t, e) {
        return void 0 !== e ? (console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(t, e)) : (this.x -= t.x, this.y -= t.y, this.z -= t.z, this.w -= t.w, this);
      }
    }, {
      key: "subScalar",
      value: function subScalar(t) {
        return this.x -= t, this.y -= t, this.z -= t, this.w -= t, this;
      }
    }, {
      key: "subVectors",
      value: function subVectors(t, e) {
        return this.x = t.x - e.x, this.y = t.y - e.y, this.z = t.z - e.z, this.w = t.w - e.w, this;
      }
    }, {
      key: "multiply",
      value: function multiply(t) {
        return this.x *= t.x, this.y *= t.y, this.z *= t.z, this.w *= t.w, this;
      }
    }, {
      key: "multiplyScalar",
      value: function multiplyScalar(t) {
        return this.x *= t, this.y *= t, this.z *= t, this.w *= t, this;
      }
    }, {
      key: "applyMatrix4",
      value: function applyMatrix4(t) {
        var e = this.x,
            n = this.y,
            i = this.z,
            r = this.w,
            s = t.elements;
        return this.x = s[0] * e + s[4] * n + s[8] * i + s[12] * r, this.y = s[1] * e + s[5] * n + s[9] * i + s[13] * r, this.z = s[2] * e + s[6] * n + s[10] * i + s[14] * r, this.w = s[3] * e + s[7] * n + s[11] * i + s[15] * r, this;
      }
    }, {
      key: "divideScalar",
      value: function divideScalar(t) {
        return this.multiplyScalar(1 / t);
      }
    }, {
      key: "setAxisAngleFromQuaternion",
      value: function setAxisAngleFromQuaternion(t) {
        this.w = 2 * Math.acos(t.w);
        var e = Math.sqrt(1 - t.w * t.w);
        return e < 1e-4 ? (this.x = 1, this.y = 0, this.z = 0) : (this.x = t.x / e, this.y = t.y / e, this.z = t.z / e), this;
      }
    }, {
      key: "setAxisAngleFromRotationMatrix",
      value: function setAxisAngleFromRotationMatrix(t) {
        var e, n, i, r;
        var s = .01,
            a = .1,
            o = t.elements,
            l = o[0],
            c = o[4],
            h = o[8],
            u = o[1],
            d = o[5],
            p = o[9],
            m = o[2],
            f = o[6],
            g = o[10];

        if (Math.abs(c - u) < s && Math.abs(h - m) < s && Math.abs(p - f) < s) {
          if (Math.abs(c + u) < a && Math.abs(h + m) < a && Math.abs(p + f) < a && Math.abs(l + d + g - 3) < a) return this.set(1, 0, 0, 0), this;
          e = Math.PI;

          var _t6 = (l + 1) / 2,
              _o2 = (d + 1) / 2,
              _v = (g + 1) / 2,
              _y = (c + u) / 4,
              _x = (h + m) / 4,
              _2 = (p + f) / 4;

          return _t6 > _o2 && _t6 > _v ? _t6 < s ? (n = 0, i = .707106781, r = .707106781) : (n = Math.sqrt(_t6), i = _y / n, r = _x / n) : _o2 > _v ? _o2 < s ? (n = .707106781, i = 0, r = .707106781) : (i = Math.sqrt(_o2), n = _y / i, r = _2 / i) : _v < s ? (n = .707106781, i = .707106781, r = 0) : (r = Math.sqrt(_v), n = _x / r, i = _2 / r), this.set(n, i, r, e), this;
        }

        var v = Math.sqrt((f - p) * (f - p) + (h - m) * (h - m) + (u - c) * (u - c));
        return Math.abs(v) < .001 && (v = 1), this.x = (f - p) / v, this.y = (h - m) / v, this.z = (u - c) / v, this.w = Math.acos((l + d + g - 1) / 2), this;
      }
    }, {
      key: "min",
      value: function min(t) {
        return this.x = Math.min(this.x, t.x), this.y = Math.min(this.y, t.y), this.z = Math.min(this.z, t.z), this.w = Math.min(this.w, t.w), this;
      }
    }, {
      key: "max",
      value: function max(t) {
        return this.x = Math.max(this.x, t.x), this.y = Math.max(this.y, t.y), this.z = Math.max(this.z, t.z), this.w = Math.max(this.w, t.w), this;
      }
    }, {
      key: "clamp",
      value: function clamp(t, e) {
        return this.x = Math.max(t.x, Math.min(e.x, this.x)), this.y = Math.max(t.y, Math.min(e.y, this.y)), this.z = Math.max(t.z, Math.min(e.z, this.z)), this.w = Math.max(t.w, Math.min(e.w, this.w)), this;
      }
    }, {
      key: "clampScalar",
      value: function clampScalar(t, e) {
        return this.x = Math.max(t, Math.min(e, this.x)), this.y = Math.max(t, Math.min(e, this.y)), this.z = Math.max(t, Math.min(e, this.z)), this.w = Math.max(t, Math.min(e, this.w)), this;
      }
    }, {
      key: "clampLength",
      value: function clampLength(t, e) {
        var n = this.length();
        return this.divideScalar(n || 1).multiplyScalar(Math.max(t, Math.min(e, n)));
      }
    }, {
      key: "floor",
      value: function floor() {
        return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.z = Math.floor(this.z), this.w = Math.floor(this.w), this;
      }
    }, {
      key: "ceil",
      value: function ceil() {
        return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.z = Math.ceil(this.z), this.w = Math.ceil(this.w), this;
      }
    }, {
      key: "round",
      value: function round() {
        return this.x = Math.round(this.x), this.y = Math.round(this.y), this.z = Math.round(this.z), this.w = Math.round(this.w), this;
      }
    }, {
      key: "roundToZero",
      value: function roundToZero() {
        return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z), this.w = this.w < 0 ? Math.ceil(this.w) : Math.floor(this.w), this;
      }
    }, {
      key: "negate",
      value: function negate() {
        return this.x = -this.x, this.y = -this.y, this.z = -this.z, this.w = -this.w, this;
      }
    }, {
      key: "dot",
      value: function dot(t) {
        return this.x * t.x + this.y * t.y + this.z * t.z + this.w * t.w;
      }
    }, {
      key: "lengthSq",
      value: function lengthSq() {
        return this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w;
      }
    }, {
      key: "length",
      value: function length() {
        return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z + this.w * this.w);
      }
    }, {
      key: "manhattanLength",
      value: function manhattanLength() {
        return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z) + Math.abs(this.w);
      }
    }, {
      key: "normalize",
      value: function normalize() {
        return this.divideScalar(this.length() || 1);
      }
    }, {
      key: "setLength",
      value: function setLength(t) {
        return this.normalize().multiplyScalar(t);
      }
    }, {
      key: "lerp",
      value: function lerp(t, e) {
        return this.x += (t.x - this.x) * e, this.y += (t.y - this.y) * e, this.z += (t.z - this.z) * e, this.w += (t.w - this.w) * e, this;
      }
    }, {
      key: "lerpVectors",
      value: function lerpVectors(t, e, n) {
        return this.x = t.x + (e.x - t.x) * n, this.y = t.y + (e.y - t.y) * n, this.z = t.z + (e.z - t.z) * n, this.w = t.w + (e.w - t.w) * n, this;
      }
    }, {
      key: "equals",
      value: function equals(t) {
        return t.x === this.x && t.y === this.y && t.z === this.z && t.w === this.w;
      }
    }, {
      key: "fromArray",
      value: function fromArray(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        return this.x = t[e], this.y = t[e + 1], this.z = t[e + 2], this.w = t[e + 3], this;
      }
    }, {
      key: "toArray",
      value: function toArray() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        return t[e] = this.x, t[e + 1] = this.y, t[e + 2] = this.z, t[e + 3] = this.w, t;
      }
    }, {
      key: "fromBufferAttribute",
      value: function fromBufferAttribute(t, e, n) {
        return void 0 !== n && console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."), this.x = t.getX(e), this.y = t.getY(e), this.z = t.getZ(e), this.w = t.getW(e), this;
      }
    }, {
      key: "random",
      value: function random() {
        return this.x = Math.random(), this.y = Math.random(), this.z = Math.random(), this.w = Math.random(), this;
      }
    }]);

    return St;
  }();

  St.prototype.isVector4 = !0;

  var Tt = /*#__PURE__*/function (_rt2) {
    _inherits(Tt, _rt2);

    var _super2 = _createSuper(Tt);

    function Tt(t, e) {
      var _this2;

      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

      _classCallCheck(this, Tt);

      _this2 = _super2.call(this), _this2.width = t, _this2.height = e, _this2.depth = 1, _this2.scissor = new St(0, 0, t, e), _this2.scissorTest = !1, _this2.viewport = new St(0, 0, t, e), _this2.texture = new bt(void 0, n.mapping, n.wrapS, n.wrapT, n.magFilter, n.minFilter, n.format, n.type, n.anisotropy, n.encoding), _this2.texture.isRenderTargetTexture = !0, _this2.texture.image = {
        width: t,
        height: e,
        depth: 1
      }, _this2.texture.generateMipmaps = void 0 !== n.generateMipmaps && n.generateMipmaps, _this2.texture.minFilter = void 0 !== n.minFilter ? n.minFilter : g, _this2.depthBuffer = void 0 === n.depthBuffer || n.depthBuffer, _this2.stencilBuffer = void 0 !== n.stencilBuffer && n.stencilBuffer, _this2.depthTexture = void 0 !== n.depthTexture ? n.depthTexture : null;
      return _this2;
    }

    _createClass(Tt, [{
      key: "setTexture",
      value: function setTexture(t) {
        t.image = {
          width: this.width,
          height: this.height,
          depth: this.depth
        }, this.texture = t;
      }
    }, {
      key: "setSize",
      value: function setSize(t, e) {
        var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
        this.width === t && this.height === e && this.depth === n || (this.width = t, this.height = e, this.depth = n, this.texture.image.width = t, this.texture.image.height = e, this.texture.image.depth = n, this.dispose()), this.viewport.set(0, 0, t, e), this.scissor.set(0, 0, t, e);
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.width = t.width, this.height = t.height, this.depth = t.depth, this.viewport.copy(t.viewport), this.texture = t.texture.clone(), this.texture.image = _objectSpread({}, this.texture.image), this.depthBuffer = t.depthBuffer, this.stencilBuffer = t.stencilBuffer, this.depthTexture = t.depthTexture, this;
      }
    }, {
      key: "dispose",
      value: function dispose() {
        this.dispatchEvent({
          type: "dispose"
        });
      }
    }]);

    return Tt;
  }(rt);

  Tt.prototype.isWebGLRenderTarget = !0;

  var Et = /*#__PURE__*/function (_Tt) {
    _inherits(Et, _Tt);

    var _super3 = _createSuper(Et);

    function Et(t, e, n) {
      var _this3;

      _classCallCheck(this, Et);

      _this3 = _super3.call(this, t, e);
      var i = _this3.texture;
      _this3.texture = [];

      for (var _t7 = 0; _t7 < n; _t7++) {
        _this3.texture[_t7] = i.clone();
      }

      return _this3;
    }

    _createClass(Et, [{
      key: "setSize",
      value: function setSize(t, e) {
        var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;

        if (this.width !== t || this.height !== e || this.depth !== n) {
          this.width = t, this.height = e, this.depth = n;

          for (var _i4 = 0, _r2 = this.texture.length; _i4 < _r2; _i4++) {
            this.texture[_i4].image.width = t, this.texture[_i4].image.height = e, this.texture[_i4].image.depth = n;
          }

          this.dispose();
        }

        return this.viewport.set(0, 0, t, e), this.scissor.set(0, 0, t, e), this;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        this.dispose(), this.width = t.width, this.height = t.height, this.depth = t.depth, this.viewport.set(0, 0, this.width, this.height), this.scissor.set(0, 0, this.width, this.height), this.depthBuffer = t.depthBuffer, this.stencilBuffer = t.stencilBuffer, this.depthTexture = t.depthTexture, this.texture.length = 0;

        for (var _e4 = 0, _n6 = t.texture.length; _e4 < _n6; _e4++) {
          this.texture[_e4] = t.texture[_e4].clone();
        }

        return this;
      }
    }]);

    return Et;
  }(Tt);

  Et.prototype.isWebGLMultipleRenderTargets = !0;

  var At = /*#__PURE__*/function (_Tt2) {
    _inherits(At, _Tt2);

    var _super4 = _createSuper(At);

    function At(t, e, n) {
      var _this4;

      _classCallCheck(this, At);

      _this4 = _super4.call(this, t, e, n), _this4.samples = 4;
      return _this4;
    }

    _createClass(At, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(At.prototype), "copy", this).call(this, t), this.samples = t.samples, this;
      }
    }]);

    return At;
  }(Tt);

  At.prototype.isWebGLMultisampleRenderTarget = !0;

  var Lt = /*#__PURE__*/function () {
    function Lt() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;

      _classCallCheck(this, Lt);

      this._x = t, this._y = e, this._z = n, this._w = i;
    }

    _createClass(Lt, [{
      key: "x",
      get: function get() {
        return this._x;
      },
      set: function set(t) {
        this._x = t, this._onChangeCallback();
      }
    }, {
      key: "y",
      get: function get() {
        return this._y;
      },
      set: function set(t) {
        this._y = t, this._onChangeCallback();
      }
    }, {
      key: "z",
      get: function get() {
        return this._z;
      },
      set: function set(t) {
        this._z = t, this._onChangeCallback();
      }
    }, {
      key: "w",
      get: function get() {
        return this._w;
      },
      set: function set(t) {
        this._w = t, this._onChangeCallback();
      }
    }, {
      key: "set",
      value: function set(t, e, n, i) {
        return this._x = t, this._y = e, this._z = n, this._w = i, this._onChangeCallback(), this;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor(this._x, this._y, this._z, this._w);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this._x = t.x, this._y = t.y, this._z = t.z, this._w = t.w, this._onChangeCallback(), this;
      }
    }, {
      key: "setFromEuler",
      value: function setFromEuler(t, e) {
        if (!t || !t.isEuler) throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");
        var n = t._x,
            i = t._y,
            r = t._z,
            s = t._order,
            a = Math.cos,
            o = Math.sin,
            l = a(n / 2),
            c = a(i / 2),
            h = a(r / 2),
            u = o(n / 2),
            d = o(i / 2),
            p = o(r / 2);

        switch (s) {
          case "XYZ":
            this._x = u * c * h + l * d * p, this._y = l * d * h - u * c * p, this._z = l * c * p + u * d * h, this._w = l * c * h - u * d * p;
            break;

          case "YXZ":
            this._x = u * c * h + l * d * p, this._y = l * d * h - u * c * p, this._z = l * c * p - u * d * h, this._w = l * c * h + u * d * p;
            break;

          case "ZXY":
            this._x = u * c * h - l * d * p, this._y = l * d * h + u * c * p, this._z = l * c * p + u * d * h, this._w = l * c * h - u * d * p;
            break;

          case "ZYX":
            this._x = u * c * h - l * d * p, this._y = l * d * h + u * c * p, this._z = l * c * p - u * d * h, this._w = l * c * h + u * d * p;
            break;

          case "YZX":
            this._x = u * c * h + l * d * p, this._y = l * d * h + u * c * p, this._z = l * c * p - u * d * h, this._w = l * c * h - u * d * p;
            break;

          case "XZY":
            this._x = u * c * h - l * d * p, this._y = l * d * h - u * c * p, this._z = l * c * p + u * d * h, this._w = l * c * h + u * d * p;
            break;

          default:
            console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: " + s);
        }

        return !1 !== e && this._onChangeCallback(), this;
      }
    }, {
      key: "setFromAxisAngle",
      value: function setFromAxisAngle(t, e) {
        var n = e / 2,
            i = Math.sin(n);
        return this._x = t.x * i, this._y = t.y * i, this._z = t.z * i, this._w = Math.cos(n), this._onChangeCallback(), this;
      }
    }, {
      key: "setFromRotationMatrix",
      value: function setFromRotationMatrix(t) {
        var e = t.elements,
            n = e[0],
            i = e[4],
            r = e[8],
            s = e[1],
            a = e[5],
            o = e[9],
            l = e[2],
            c = e[6],
            h = e[10],
            u = n + a + h;

        if (u > 0) {
          var _t8 = .5 / Math.sqrt(u + 1);

          this._w = .25 / _t8, this._x = (c - o) * _t8, this._y = (r - l) * _t8, this._z = (s - i) * _t8;
        } else if (n > a && n > h) {
          var _t9 = 2 * Math.sqrt(1 + n - a - h);

          this._w = (c - o) / _t9, this._x = .25 * _t9, this._y = (i + s) / _t9, this._z = (r + l) / _t9;
        } else if (a > h) {
          var _t10 = 2 * Math.sqrt(1 + a - n - h);

          this._w = (r - l) / _t10, this._x = (i + s) / _t10, this._y = .25 * _t10, this._z = (o + c) / _t10;
        } else {
          var _t11 = 2 * Math.sqrt(1 + h - n - a);

          this._w = (s - i) / _t11, this._x = (r + l) / _t11, this._y = (o + c) / _t11, this._z = .25 * _t11;
        }

        return this._onChangeCallback(), this;
      }
    }, {
      key: "setFromUnitVectors",
      value: function setFromUnitVectors(t, e) {
        var n = t.dot(e) + 1;
        return n < Number.EPSILON ? (n = 0, Math.abs(t.x) > Math.abs(t.z) ? (this._x = -t.y, this._y = t.x, this._z = 0, this._w = n) : (this._x = 0, this._y = -t.z, this._z = t.y, this._w = n)) : (this._x = t.y * e.z - t.z * e.y, this._y = t.z * e.x - t.x * e.z, this._z = t.x * e.y - t.y * e.x, this._w = n), this.normalize();
      }
    }, {
      key: "angleTo",
      value: function angleTo(t) {
        return 2 * Math.acos(Math.abs(ht(this.dot(t), -1, 1)));
      }
    }, {
      key: "rotateTowards",
      value: function rotateTowards(t, e) {
        var n = this.angleTo(t);
        if (0 === n) return this;
        var i = Math.min(1, e / n);
        return this.slerp(t, i), this;
      }
    }, {
      key: "identity",
      value: function identity() {
        return this.set(0, 0, 0, 1);
      }
    }, {
      key: "invert",
      value: function invert() {
        return this.conjugate();
      }
    }, {
      key: "conjugate",
      value: function conjugate() {
        return this._x *= -1, this._y *= -1, this._z *= -1, this._onChangeCallback(), this;
      }
    }, {
      key: "dot",
      value: function dot(t) {
        return this._x * t._x + this._y * t._y + this._z * t._z + this._w * t._w;
      }
    }, {
      key: "lengthSq",
      value: function lengthSq() {
        return this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w;
      }
    }, {
      key: "length",
      value: function length() {
        return Math.sqrt(this._x * this._x + this._y * this._y + this._z * this._z + this._w * this._w);
      }
    }, {
      key: "normalize",
      value: function normalize() {
        var t = this.length();
        return 0 === t ? (this._x = 0, this._y = 0, this._z = 0, this._w = 1) : (t = 1 / t, this._x = this._x * t, this._y = this._y * t, this._z = this._z * t, this._w = this._w * t), this._onChangeCallback(), this;
      }
    }, {
      key: "multiply",
      value: function multiply(t, e) {
        return void 0 !== e ? (console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."), this.multiplyQuaternions(t, e)) : this.multiplyQuaternions(this, t);
      }
    }, {
      key: "premultiply",
      value: function premultiply(t) {
        return this.multiplyQuaternions(t, this);
      }
    }, {
      key: "multiplyQuaternions",
      value: function multiplyQuaternions(t, e) {
        var n = t._x,
            i = t._y,
            r = t._z,
            s = t._w,
            a = e._x,
            o = e._y,
            l = e._z,
            c = e._w;
        return this._x = n * c + s * a + i * l - r * o, this._y = i * c + s * o + r * a - n * l, this._z = r * c + s * l + n * o - i * a, this._w = s * c - n * a - i * o - r * l, this._onChangeCallback(), this;
      }
    }, {
      key: "slerp",
      value: function slerp(t, e) {
        if (0 === e) return this;
        if (1 === e) return this.copy(t);
        var n = this._x,
            i = this._y,
            r = this._z,
            s = this._w;
        var a = s * t._w + n * t._x + i * t._y + r * t._z;
        if (a < 0 ? (this._w = -t._w, this._x = -t._x, this._y = -t._y, this._z = -t._z, a = -a) : this.copy(t), a >= 1) return this._w = s, this._x = n, this._y = i, this._z = r, this;
        var o = 1 - a * a;

        if (o <= Number.EPSILON) {
          var _t12 = 1 - e;

          return this._w = _t12 * s + e * this._w, this._x = _t12 * n + e * this._x, this._y = _t12 * i + e * this._y, this._z = _t12 * r + e * this._z, this.normalize(), this._onChangeCallback(), this;
        }

        var l = Math.sqrt(o),
            c = Math.atan2(l, a),
            h = Math.sin((1 - e) * c) / l,
            u = Math.sin(e * c) / l;
        return this._w = s * h + this._w * u, this._x = n * h + this._x * u, this._y = i * h + this._y * u, this._z = r * h + this._z * u, this._onChangeCallback(), this;
      }
    }, {
      key: "slerpQuaternions",
      value: function slerpQuaternions(t, e, n) {
        this.copy(t).slerp(e, n);
      }
    }, {
      key: "equals",
      value: function equals(t) {
        return t._x === this._x && t._y === this._y && t._z === this._z && t._w === this._w;
      }
    }, {
      key: "fromArray",
      value: function fromArray(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        return this._x = t[e], this._y = t[e + 1], this._z = t[e + 2], this._w = t[e + 3], this._onChangeCallback(), this;
      }
    }, {
      key: "toArray",
      value: function toArray() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        return t[e] = this._x, t[e + 1] = this._y, t[e + 2] = this._z, t[e + 3] = this._w, t;
      }
    }, {
      key: "fromBufferAttribute",
      value: function fromBufferAttribute(t, e) {
        return this._x = t.getX(e), this._y = t.getY(e), this._z = t.getZ(e), this._w = t.getW(e), this;
      }
    }, {
      key: "_onChange",
      value: function _onChange(t) {
        return this._onChangeCallback = t, this;
      }
    }, {
      key: "_onChangeCallback",
      value: function _onChangeCallback() {}
    }], [{
      key: "slerp",
      value: function slerp(t, e, n, i) {
        return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."), n.slerpQuaternions(t, e, i);
      }
    }, {
      key: "slerpFlat",
      value: function slerpFlat(t, e, n, i, r, s, a) {
        var o = n[i + 0],
            l = n[i + 1],
            c = n[i + 2],
            h = n[i + 3];
        var u = r[s + 0],
            d = r[s + 1],
            p = r[s + 2],
            m = r[s + 3];
        if (0 === a) return t[e + 0] = o, t[e + 1] = l, t[e + 2] = c, void (t[e + 3] = h);
        if (1 === a) return t[e + 0] = u, t[e + 1] = d, t[e + 2] = p, void (t[e + 3] = m);

        if (h !== m || o !== u || l !== d || c !== p) {
          var _t13 = 1 - a;

          var _e5 = o * u + l * d + c * p + h * m,
              _n7 = _e5 >= 0 ? 1 : -1,
              _i5 = 1 - _e5 * _e5;

          if (_i5 > Number.EPSILON) {
            var _r4 = Math.sqrt(_i5),
                _s2 = Math.atan2(_r4, _e5 * _n7);

            _t13 = Math.sin(_t13 * _s2) / _r4, a = Math.sin(a * _s2) / _r4;
          }

          var _r3 = a * _n7;

          if (o = o * _t13 + u * _r3, l = l * _t13 + d * _r3, c = c * _t13 + p * _r3, h = h * _t13 + m * _r3, _t13 === 1 - a) {
            var _t14 = 1 / Math.sqrt(o * o + l * l + c * c + h * h);

            o *= _t14, l *= _t14, c *= _t14, h *= _t14;
          }
        }

        t[e] = o, t[e + 1] = l, t[e + 2] = c, t[e + 3] = h;
      }
    }, {
      key: "multiplyQuaternionsFlat",
      value: function multiplyQuaternionsFlat(t, e, n, i, r, s) {
        var a = n[i],
            o = n[i + 1],
            l = n[i + 2],
            c = n[i + 3],
            h = r[s],
            u = r[s + 1],
            d = r[s + 2],
            p = r[s + 3];
        return t[e] = a * p + c * h + o * d - l * u, t[e + 1] = o * p + c * u + l * h - a * d, t[e + 2] = l * p + c * d + a * u - o * h, t[e + 3] = c * p - a * h - o * u - l * d, t;
      }
    }]);

    return Lt;
  }();

  Lt.prototype.isQuaternion = !0;

  var Rt = /*#__PURE__*/function () {
    function Rt() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;

      _classCallCheck(this, Rt);

      this.x = t, this.y = e, this.z = n;
    }

    _createClass(Rt, [{
      key: "set",
      value: function set(t, e, n) {
        return void 0 === n && (n = this.z), this.x = t, this.y = e, this.z = n, this;
      }
    }, {
      key: "setScalar",
      value: function setScalar(t) {
        return this.x = t, this.y = t, this.z = t, this;
      }
    }, {
      key: "setX",
      value: function setX(t) {
        return this.x = t, this;
      }
    }, {
      key: "setY",
      value: function setY(t) {
        return this.y = t, this;
      }
    }, {
      key: "setZ",
      value: function setZ(t) {
        return this.z = t, this;
      }
    }, {
      key: "setComponent",
      value: function setComponent(t, e) {
        switch (t) {
          case 0:
            this.x = e;
            break;

          case 1:
            this.y = e;
            break;

          case 2:
            this.z = e;
            break;

          default:
            throw new Error("index is out of range: " + t);
        }

        return this;
      }
    }, {
      key: "getComponent",
      value: function getComponent(t) {
        switch (t) {
          case 0:
            return this.x;

          case 1:
            return this.y;

          case 2:
            return this.z;

          default:
            throw new Error("index is out of range: " + t);
        }
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor(this.x, this.y, this.z);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.x = t.x, this.y = t.y, this.z = t.z, this;
      }
    }, {
      key: "add",
      value: function add(t, e) {
        return void 0 !== e ? (console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."), this.addVectors(t, e)) : (this.x += t.x, this.y += t.y, this.z += t.z, this);
      }
    }, {
      key: "addScalar",
      value: function addScalar(t) {
        return this.x += t, this.y += t, this.z += t, this;
      }
    }, {
      key: "addVectors",
      value: function addVectors(t, e) {
        return this.x = t.x + e.x, this.y = t.y + e.y, this.z = t.z + e.z, this;
      }
    }, {
      key: "addScaledVector",
      value: function addScaledVector(t, e) {
        return this.x += t.x * e, this.y += t.y * e, this.z += t.z * e, this;
      }
    }, {
      key: "sub",
      value: function sub(t, e) {
        return void 0 !== e ? (console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."), this.subVectors(t, e)) : (this.x -= t.x, this.y -= t.y, this.z -= t.z, this);
      }
    }, {
      key: "subScalar",
      value: function subScalar(t) {
        return this.x -= t, this.y -= t, this.z -= t, this;
      }
    }, {
      key: "subVectors",
      value: function subVectors(t, e) {
        return this.x = t.x - e.x, this.y = t.y - e.y, this.z = t.z - e.z, this;
      }
    }, {
      key: "multiply",
      value: function multiply(t, e) {
        return void 0 !== e ? (console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."), this.multiplyVectors(t, e)) : (this.x *= t.x, this.y *= t.y, this.z *= t.z, this);
      }
    }, {
      key: "multiplyScalar",
      value: function multiplyScalar(t) {
        return this.x *= t, this.y *= t, this.z *= t, this;
      }
    }, {
      key: "multiplyVectors",
      value: function multiplyVectors(t, e) {
        return this.x = t.x * e.x, this.y = t.y * e.y, this.z = t.z * e.z, this;
      }
    }, {
      key: "applyEuler",
      value: function applyEuler(t) {
        return t && t.isEuler || console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."), this.applyQuaternion(Pt.setFromEuler(t));
      }
    }, {
      key: "applyAxisAngle",
      value: function applyAxisAngle(t, e) {
        return this.applyQuaternion(Pt.setFromAxisAngle(t, e));
      }
    }, {
      key: "applyMatrix3",
      value: function applyMatrix3(t) {
        var e = this.x,
            n = this.y,
            i = this.z,
            r = t.elements;
        return this.x = r[0] * e + r[3] * n + r[6] * i, this.y = r[1] * e + r[4] * n + r[7] * i, this.z = r[2] * e + r[5] * n + r[8] * i, this;
      }
    }, {
      key: "applyNormalMatrix",
      value: function applyNormalMatrix(t) {
        return this.applyMatrix3(t).normalize();
      }
    }, {
      key: "applyMatrix4",
      value: function applyMatrix4(t) {
        var e = this.x,
            n = this.y,
            i = this.z,
            r = t.elements,
            s = 1 / (r[3] * e + r[7] * n + r[11] * i + r[15]);
        return this.x = (r[0] * e + r[4] * n + r[8] * i + r[12]) * s, this.y = (r[1] * e + r[5] * n + r[9] * i + r[13]) * s, this.z = (r[2] * e + r[6] * n + r[10] * i + r[14]) * s, this;
      }
    }, {
      key: "applyQuaternion",
      value: function applyQuaternion(t) {
        var e = this.x,
            n = this.y,
            i = this.z,
            r = t.x,
            s = t.y,
            a = t.z,
            o = t.w,
            l = o * e + s * i - a * n,
            c = o * n + a * e - r * i,
            h = o * i + r * n - s * e,
            u = -r * e - s * n - a * i;
        return this.x = l * o + u * -r + c * -a - h * -s, this.y = c * o + u * -s + h * -r - l * -a, this.z = h * o + u * -a + l * -s - c * -r, this;
      }
    }, {
      key: "project",
      value: function project(t) {
        return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix);
      }
    }, {
      key: "unproject",
      value: function unproject(t) {
        return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld);
      }
    }, {
      key: "transformDirection",
      value: function transformDirection(t) {
        var e = this.x,
            n = this.y,
            i = this.z,
            r = t.elements;
        return this.x = r[0] * e + r[4] * n + r[8] * i, this.y = r[1] * e + r[5] * n + r[9] * i, this.z = r[2] * e + r[6] * n + r[10] * i, this.normalize();
      }
    }, {
      key: "divide",
      value: function divide(t) {
        return this.x /= t.x, this.y /= t.y, this.z /= t.z, this;
      }
    }, {
      key: "divideScalar",
      value: function divideScalar(t) {
        return this.multiplyScalar(1 / t);
      }
    }, {
      key: "min",
      value: function min(t) {
        return this.x = Math.min(this.x, t.x), this.y = Math.min(this.y, t.y), this.z = Math.min(this.z, t.z), this;
      }
    }, {
      key: "max",
      value: function max(t) {
        return this.x = Math.max(this.x, t.x), this.y = Math.max(this.y, t.y), this.z = Math.max(this.z, t.z), this;
      }
    }, {
      key: "clamp",
      value: function clamp(t, e) {
        return this.x = Math.max(t.x, Math.min(e.x, this.x)), this.y = Math.max(t.y, Math.min(e.y, this.y)), this.z = Math.max(t.z, Math.min(e.z, this.z)), this;
      }
    }, {
      key: "clampScalar",
      value: function clampScalar(t, e) {
        return this.x = Math.max(t, Math.min(e, this.x)), this.y = Math.max(t, Math.min(e, this.y)), this.z = Math.max(t, Math.min(e, this.z)), this;
      }
    }, {
      key: "clampLength",
      value: function clampLength(t, e) {
        var n = this.length();
        return this.divideScalar(n || 1).multiplyScalar(Math.max(t, Math.min(e, n)));
      }
    }, {
      key: "floor",
      value: function floor() {
        return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.z = Math.floor(this.z), this;
      }
    }, {
      key: "ceil",
      value: function ceil() {
        return this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.z = Math.ceil(this.z), this;
      }
    }, {
      key: "round",
      value: function round() {
        return this.x = Math.round(this.x), this.y = Math.round(this.y), this.z = Math.round(this.z), this;
      }
    }, {
      key: "roundToZero",
      value: function roundToZero() {
        return this.x = this.x < 0 ? Math.ceil(this.x) : Math.floor(this.x), this.y = this.y < 0 ? Math.ceil(this.y) : Math.floor(this.y), this.z = this.z < 0 ? Math.ceil(this.z) : Math.floor(this.z), this;
      }
    }, {
      key: "negate",
      value: function negate() {
        return this.x = -this.x, this.y = -this.y, this.z = -this.z, this;
      }
    }, {
      key: "dot",
      value: function dot(t) {
        return this.x * t.x + this.y * t.y + this.z * t.z;
      }
    }, {
      key: "lengthSq",
      value: function lengthSq() {
        return this.x * this.x + this.y * this.y + this.z * this.z;
      }
    }, {
      key: "length",
      value: function length() {
        return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);
      }
    }, {
      key: "manhattanLength",
      value: function manhattanLength() {
        return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z);
      }
    }, {
      key: "normalize",
      value: function normalize() {
        return this.divideScalar(this.length() || 1);
      }
    }, {
      key: "setLength",
      value: function setLength(t) {
        return this.normalize().multiplyScalar(t);
      }
    }, {
      key: "lerp",
      value: function lerp(t, e) {
        return this.x += (t.x - this.x) * e, this.y += (t.y - this.y) * e, this.z += (t.z - this.z) * e, this;
      }
    }, {
      key: "lerpVectors",
      value: function lerpVectors(t, e, n) {
        return this.x = t.x + (e.x - t.x) * n, this.y = t.y + (e.y - t.y) * n, this.z = t.z + (e.z - t.z) * n, this;
      }
    }, {
      key: "cross",
      value: function cross(t, e) {
        return void 0 !== e ? (console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."), this.crossVectors(t, e)) : this.crossVectors(this, t);
      }
    }, {
      key: "crossVectors",
      value: function crossVectors(t, e) {
        var n = t.x,
            i = t.y,
            r = t.z,
            s = e.x,
            a = e.y,
            o = e.z;
        return this.x = i * o - r * a, this.y = r * s - n * o, this.z = n * a - i * s, this;
      }
    }, {
      key: "projectOnVector",
      value: function projectOnVector(t) {
        var e = t.lengthSq();
        if (0 === e) return this.set(0, 0, 0);
        var n = t.dot(this) / e;
        return this.copy(t).multiplyScalar(n);
      }
    }, {
      key: "projectOnPlane",
      value: function projectOnPlane(t) {
        return Ct.copy(this).projectOnVector(t), this.sub(Ct);
      }
    }, {
      key: "reflect",
      value: function reflect(t) {
        return this.sub(Ct.copy(t).multiplyScalar(2 * this.dot(t)));
      }
    }, {
      key: "angleTo",
      value: function angleTo(t) {
        var e = Math.sqrt(this.lengthSq() * t.lengthSq());
        if (0 === e) return Math.PI / 2;
        var n = this.dot(t) / e;
        return Math.acos(ht(n, -1, 1));
      }
    }, {
      key: "distanceTo",
      value: function distanceTo(t) {
        return Math.sqrt(this.distanceToSquared(t));
      }
    }, {
      key: "distanceToSquared",
      value: function distanceToSquared(t) {
        var e = this.x - t.x,
            n = this.y - t.y,
            i = this.z - t.z;
        return e * e + n * n + i * i;
      }
    }, {
      key: "manhattanDistanceTo",
      value: function manhattanDistanceTo(t) {
        return Math.abs(this.x - t.x) + Math.abs(this.y - t.y) + Math.abs(this.z - t.z);
      }
    }, {
      key: "setFromSpherical",
      value: function setFromSpherical(t) {
        return this.setFromSphericalCoords(t.radius, t.phi, t.theta);
      }
    }, {
      key: "setFromSphericalCoords",
      value: function setFromSphericalCoords(t, e, n) {
        var i = Math.sin(e) * t;
        return this.x = i * Math.sin(n), this.y = Math.cos(e) * t, this.z = i * Math.cos(n), this;
      }
    }, {
      key: "setFromCylindrical",
      value: function setFromCylindrical(t) {
        return this.setFromCylindricalCoords(t.radius, t.theta, t.y);
      }
    }, {
      key: "setFromCylindricalCoords",
      value: function setFromCylindricalCoords(t, e, n) {
        return this.x = t * Math.sin(e), this.y = n, this.z = t * Math.cos(e), this;
      }
    }, {
      key: "setFromMatrixPosition",
      value: function setFromMatrixPosition(t) {
        var e = t.elements;
        return this.x = e[12], this.y = e[13], this.z = e[14], this;
      }
    }, {
      key: "setFromMatrixScale",
      value: function setFromMatrixScale(t) {
        var e = this.setFromMatrixColumn(t, 0).length(),
            n = this.setFromMatrixColumn(t, 1).length(),
            i = this.setFromMatrixColumn(t, 2).length();
        return this.x = e, this.y = n, this.z = i, this;
      }
    }, {
      key: "setFromMatrixColumn",
      value: function setFromMatrixColumn(t, e) {
        return this.fromArray(t.elements, 4 * e);
      }
    }, {
      key: "setFromMatrix3Column",
      value: function setFromMatrix3Column(t, e) {
        return this.fromArray(t.elements, 3 * e);
      }
    }, {
      key: "equals",
      value: function equals(t) {
        return t.x === this.x && t.y === this.y && t.z === this.z;
      }
    }, {
      key: "fromArray",
      value: function fromArray(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        return this.x = t[e], this.y = t[e + 1], this.z = t[e + 2], this;
      }
    }, {
      key: "toArray",
      value: function toArray() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        return t[e] = this.x, t[e + 1] = this.y, t[e + 2] = this.z, t;
      }
    }, {
      key: "fromBufferAttribute",
      value: function fromBufferAttribute(t, e, n) {
        return void 0 !== n && console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."), this.x = t.getX(e), this.y = t.getY(e), this.z = t.getZ(e), this;
      }
    }, {
      key: "random",
      value: function random() {
        return this.x = Math.random(), this.y = Math.random(), this.z = Math.random(), this;
      }
    }]);

    return Rt;
  }();

  Rt.prototype.isVector3 = !0;
  var Ct = new Rt(),
      Pt = new Lt();

  var It = /*#__PURE__*/function () {
    function It() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Rt(1 / 0, 1 / 0, 1 / 0);
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Rt(-1 / 0, -1 / 0, -1 / 0);

      _classCallCheck(this, It);

      this.min = t, this.max = e;
    }

    _createClass(It, [{
      key: "set",
      value: function set(t, e) {
        return this.min.copy(t), this.max.copy(e), this;
      }
    }, {
      key: "setFromArray",
      value: function setFromArray(t) {
        var e = 1 / 0,
            n = 1 / 0,
            i = 1 / 0,
            r = -1 / 0,
            s = -1 / 0,
            a = -1 / 0;

        for (var _o3 = 0, _l2 = t.length; _o3 < _l2; _o3 += 3) {
          var _l3 = t[_o3],
              _c2 = t[_o3 + 1],
              _h2 = t[_o3 + 2];
          _l3 < e && (e = _l3), _c2 < n && (n = _c2), _h2 < i && (i = _h2), _l3 > r && (r = _l3), _c2 > s && (s = _c2), _h2 > a && (a = _h2);
        }

        return this.min.set(e, n, i), this.max.set(r, s, a), this;
      }
    }, {
      key: "setFromBufferAttribute",
      value: function setFromBufferAttribute(t) {
        var e = 1 / 0,
            n = 1 / 0,
            i = 1 / 0,
            r = -1 / 0,
            s = -1 / 0,
            a = -1 / 0;

        for (var _o4 = 0, _l4 = t.count; _o4 < _l4; _o4++) {
          var _l5 = t.getX(_o4),
              _c3 = t.getY(_o4),
              _h3 = t.getZ(_o4);

          _l5 < e && (e = _l5), _c3 < n && (n = _c3), _h3 < i && (i = _h3), _l5 > r && (r = _l5), _c3 > s && (s = _c3), _h3 > a && (a = _h3);
        }

        return this.min.set(e, n, i), this.max.set(r, s, a), this;
      }
    }, {
      key: "setFromPoints",
      value: function setFromPoints(t) {
        this.makeEmpty();

        for (var _e6 = 0, _n8 = t.length; _e6 < _n8; _e6++) {
          this.expandByPoint(t[_e6]);
        }

        return this;
      }
    }, {
      key: "setFromCenterAndSize",
      value: function setFromCenterAndSize(t, e) {
        var n = Nt.copy(e).multiplyScalar(.5);
        return this.min.copy(t).sub(n), this.max.copy(t).add(n), this;
      }
    }, {
      key: "setFromObject",
      value: function setFromObject(t) {
        return this.makeEmpty(), this.expandByObject(t);
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.min.copy(t.min), this.max.copy(t.max), this;
      }
    }, {
      key: "makeEmpty",
      value: function makeEmpty() {
        return this.min.x = this.min.y = this.min.z = 1 / 0, this.max.x = this.max.y = this.max.z = -1 / 0, this;
      }
    }, {
      key: "isEmpty",
      value: function isEmpty() {
        return this.max.x < this.min.x || this.max.y < this.min.y || this.max.z < this.min.z;
      }
    }, {
      key: "getCenter",
      value: function getCenter(t) {
        return this.isEmpty() ? t.set(0, 0, 0) : t.addVectors(this.min, this.max).multiplyScalar(.5);
      }
    }, {
      key: "getSize",
      value: function getSize(t) {
        return this.isEmpty() ? t.set(0, 0, 0) : t.subVectors(this.max, this.min);
      }
    }, {
      key: "expandByPoint",
      value: function expandByPoint(t) {
        return this.min.min(t), this.max.max(t), this;
      }
    }, {
      key: "expandByVector",
      value: function expandByVector(t) {
        return this.min.sub(t), this.max.add(t), this;
      }
    }, {
      key: "expandByScalar",
      value: function expandByScalar(t) {
        return this.min.addScalar(-t), this.max.addScalar(t), this;
      }
    }, {
      key: "expandByObject",
      value: function expandByObject(t) {
        t.updateWorldMatrix(!1, !1);
        var e = t.geometry;
        void 0 !== e && (null === e.boundingBox && e.computeBoundingBox(), Bt.copy(e.boundingBox), Bt.applyMatrix4(t.matrixWorld), this.union(Bt));
        var n = t.children;

        for (var _t15 = 0, _e7 = n.length; _t15 < _e7; _t15++) {
          this.expandByObject(n[_t15]);
        }

        return this;
      }
    }, {
      key: "containsPoint",
      value: function containsPoint(t) {
        return !(t.x < this.min.x || t.x > this.max.x || t.y < this.min.y || t.y > this.max.y || t.z < this.min.z || t.z > this.max.z);
      }
    }, {
      key: "containsBox",
      value: function containsBox(t) {
        return this.min.x <= t.min.x && t.max.x <= this.max.x && this.min.y <= t.min.y && t.max.y <= this.max.y && this.min.z <= t.min.z && t.max.z <= this.max.z;
      }
    }, {
      key: "getParameter",
      value: function getParameter(t, e) {
        return e.set((t.x - this.min.x) / (this.max.x - this.min.x), (t.y - this.min.y) / (this.max.y - this.min.y), (t.z - this.min.z) / (this.max.z - this.min.z));
      }
    }, {
      key: "intersectsBox",
      value: function intersectsBox(t) {
        return !(t.max.x < this.min.x || t.min.x > this.max.x || t.max.y < this.min.y || t.min.y > this.max.y || t.max.z < this.min.z || t.min.z > this.max.z);
      }
    }, {
      key: "intersectsSphere",
      value: function intersectsSphere(t) {
        return this.clampPoint(t.center, Nt), Nt.distanceToSquared(t.center) <= t.radius * t.radius;
      }
    }, {
      key: "intersectsPlane",
      value: function intersectsPlane(t) {
        var e, n;
        return t.normal.x > 0 ? (e = t.normal.x * this.min.x, n = t.normal.x * this.max.x) : (e = t.normal.x * this.max.x, n = t.normal.x * this.min.x), t.normal.y > 0 ? (e += t.normal.y * this.min.y, n += t.normal.y * this.max.y) : (e += t.normal.y * this.max.y, n += t.normal.y * this.min.y), t.normal.z > 0 ? (e += t.normal.z * this.min.z, n += t.normal.z * this.max.z) : (e += t.normal.z * this.max.z, n += t.normal.z * this.min.z), e <= -t.constant && n >= -t.constant;
      }
    }, {
      key: "intersectsTriangle",
      value: function intersectsTriangle(t) {
        if (this.isEmpty()) return !1;
        this.getCenter(kt), Vt.subVectors(this.max, kt), zt.subVectors(t.a, kt), Ft.subVectors(t.b, kt), Ot.subVectors(t.c, kt), Ut.subVectors(Ft, zt), Ht.subVectors(Ot, Ft), Gt.subVectors(zt, Ot);
        var e = [0, -Ut.z, Ut.y, 0, -Ht.z, Ht.y, 0, -Gt.z, Gt.y, Ut.z, 0, -Ut.x, Ht.z, 0, -Ht.x, Gt.z, 0, -Gt.x, -Ut.y, Ut.x, 0, -Ht.y, Ht.x, 0, -Gt.y, Gt.x, 0];
        return !!qt(e, zt, Ft, Ot, Vt) && (e = [1, 0, 0, 0, 1, 0, 0, 0, 1], !!qt(e, zt, Ft, Ot, Vt) && (Wt.crossVectors(Ut, Ht), e = [Wt.x, Wt.y, Wt.z], qt(e, zt, Ft, Ot, Vt)));
      }
    }, {
      key: "clampPoint",
      value: function clampPoint(t, e) {
        return e.copy(t).clamp(this.min, this.max);
      }
    }, {
      key: "distanceToPoint",
      value: function distanceToPoint(t) {
        return Nt.copy(t).clamp(this.min, this.max).sub(t).length();
      }
    }, {
      key: "getBoundingSphere",
      value: function getBoundingSphere(t) {
        return this.getCenter(t.center), t.radius = .5 * this.getSize(Nt).length(), t;
      }
    }, {
      key: "intersect",
      value: function intersect(t) {
        return this.min.max(t.min), this.max.min(t.max), this.isEmpty() && this.makeEmpty(), this;
      }
    }, {
      key: "union",
      value: function union(t) {
        return this.min.min(t.min), this.max.max(t.max), this;
      }
    }, {
      key: "applyMatrix4",
      value: function applyMatrix4(t) {
        return this.isEmpty() || (Dt[0].set(this.min.x, this.min.y, this.min.z).applyMatrix4(t), Dt[1].set(this.min.x, this.min.y, this.max.z).applyMatrix4(t), Dt[2].set(this.min.x, this.max.y, this.min.z).applyMatrix4(t), Dt[3].set(this.min.x, this.max.y, this.max.z).applyMatrix4(t), Dt[4].set(this.max.x, this.min.y, this.min.z).applyMatrix4(t), Dt[5].set(this.max.x, this.min.y, this.max.z).applyMatrix4(t), Dt[6].set(this.max.x, this.max.y, this.min.z).applyMatrix4(t), Dt[7].set(this.max.x, this.max.y, this.max.z).applyMatrix4(t), this.setFromPoints(Dt)), this;
      }
    }, {
      key: "translate",
      value: function translate(t) {
        return this.min.add(t), this.max.add(t), this;
      }
    }, {
      key: "equals",
      value: function equals(t) {
        return t.min.equals(this.min) && t.max.equals(this.max);
      }
    }]);

    return It;
  }();

  It.prototype.isBox3 = !0;
  var Dt = [new Rt(), new Rt(), new Rt(), new Rt(), new Rt(), new Rt(), new Rt(), new Rt()],
      Nt = new Rt(),
      Bt = new It(),
      zt = new Rt(),
      Ft = new Rt(),
      Ot = new Rt(),
      Ut = new Rt(),
      Ht = new Rt(),
      Gt = new Rt(),
      kt = new Rt(),
      Vt = new Rt(),
      Wt = new Rt(),
      jt = new Rt();

  function qt(t, e, n, i, r) {
    for (var _s3 = 0, _a2 = t.length - 3; _s3 <= _a2; _s3 += 3) {
      jt.fromArray(t, _s3);

      var _a3 = r.x * Math.abs(jt.x) + r.y * Math.abs(jt.y) + r.z * Math.abs(jt.z),
          _o5 = e.dot(jt),
          _l6 = n.dot(jt),
          _c4 = i.dot(jt);

      if (Math.max(-Math.max(_o5, _l6, _c4), Math.min(_o5, _l6, _c4)) > _a3) return !1;
    }

    return !0;
  }

  var Xt = new It(),
      Yt = new Rt(),
      Jt = new Rt(),
      Zt = new Rt();

  var Qt = /*#__PURE__*/function () {
    function Qt() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Rt();
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : -1;

      _classCallCheck(this, Qt);

      this.center = t, this.radius = e;
    }

    _createClass(Qt, [{
      key: "set",
      value: function set(t, e) {
        return this.center.copy(t), this.radius = e, this;
      }
    }, {
      key: "setFromPoints",
      value: function setFromPoints(t, e) {
        var n = this.center;
        void 0 !== e ? n.copy(e) : Xt.setFromPoints(t).getCenter(n);
        var i = 0;

        for (var _e8 = 0, _r5 = t.length; _e8 < _r5; _e8++) {
          i = Math.max(i, n.distanceToSquared(t[_e8]));
        }

        return this.radius = Math.sqrt(i), this;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.center.copy(t.center), this.radius = t.radius, this;
      }
    }, {
      key: "isEmpty",
      value: function isEmpty() {
        return this.radius < 0;
      }
    }, {
      key: "makeEmpty",
      value: function makeEmpty() {
        return this.center.set(0, 0, 0), this.radius = -1, this;
      }
    }, {
      key: "containsPoint",
      value: function containsPoint(t) {
        return t.distanceToSquared(this.center) <= this.radius * this.radius;
      }
    }, {
      key: "distanceToPoint",
      value: function distanceToPoint(t) {
        return t.distanceTo(this.center) - this.radius;
      }
    }, {
      key: "intersectsSphere",
      value: function intersectsSphere(t) {
        var e = this.radius + t.radius;
        return t.center.distanceToSquared(this.center) <= e * e;
      }
    }, {
      key: "intersectsBox",
      value: function intersectsBox(t) {
        return t.intersectsSphere(this);
      }
    }, {
      key: "intersectsPlane",
      value: function intersectsPlane(t) {
        return Math.abs(t.distanceToPoint(this.center)) <= this.radius;
      }
    }, {
      key: "clampPoint",
      value: function clampPoint(t, e) {
        var n = this.center.distanceToSquared(t);
        return e.copy(t), n > this.radius * this.radius && (e.sub(this.center).normalize(), e.multiplyScalar(this.radius).add(this.center)), e;
      }
    }, {
      key: "getBoundingBox",
      value: function getBoundingBox(t) {
        return this.isEmpty() ? (t.makeEmpty(), t) : (t.set(this.center, this.center), t.expandByScalar(this.radius), t);
      }
    }, {
      key: "applyMatrix4",
      value: function applyMatrix4(t) {
        return this.center.applyMatrix4(t), this.radius = this.radius * t.getMaxScaleOnAxis(), this;
      }
    }, {
      key: "translate",
      value: function translate(t) {
        return this.center.add(t), this;
      }
    }, {
      key: "expandByPoint",
      value: function expandByPoint(t) {
        Zt.subVectors(t, this.center);
        var e = Zt.lengthSq();

        if (e > this.radius * this.radius) {
          var _t16 = Math.sqrt(e),
              _n9 = .5 * (_t16 - this.radius);

          this.center.add(Zt.multiplyScalar(_n9 / _t16)), this.radius += _n9;
        }

        return this;
      }
    }, {
      key: "union",
      value: function union(t) {
        return Jt.subVectors(t.center, this.center).normalize().multiplyScalar(t.radius), this.expandByPoint(Yt.copy(t.center).add(Jt)), this.expandByPoint(Yt.copy(t.center).sub(Jt)), this;
      }
    }, {
      key: "equals",
      value: function equals(t) {
        return t.center.equals(this.center) && t.radius === this.radius;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }]);

    return Qt;
  }();

  var Kt = new Rt(),
      $t = new Rt(),
      te = new Rt(),
      ee = new Rt(),
      ne = new Rt(),
      ie = new Rt(),
      re = new Rt();

  var se = /*#__PURE__*/function () {
    function se() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Rt();
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Rt(0, 0, -1);

      _classCallCheck(this, se);

      this.origin = t, this.direction = e;
    }

    _createClass(se, [{
      key: "set",
      value: function set(t, e) {
        return this.origin.copy(t), this.direction.copy(e), this;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.origin.copy(t.origin), this.direction.copy(t.direction), this;
      }
    }, {
      key: "at",
      value: function at(t, e) {
        return e.copy(this.direction).multiplyScalar(t).add(this.origin);
      }
    }, {
      key: "lookAt",
      value: function lookAt(t) {
        return this.direction.copy(t).sub(this.origin).normalize(), this;
      }
    }, {
      key: "recast",
      value: function recast(t) {
        return this.origin.copy(this.at(t, Kt)), this;
      }
    }, {
      key: "closestPointToPoint",
      value: function closestPointToPoint(t, e) {
        e.subVectors(t, this.origin);
        var n = e.dot(this.direction);
        return n < 0 ? e.copy(this.origin) : e.copy(this.direction).multiplyScalar(n).add(this.origin);
      }
    }, {
      key: "distanceToPoint",
      value: function distanceToPoint(t) {
        return Math.sqrt(this.distanceSqToPoint(t));
      }
    }, {
      key: "distanceSqToPoint",
      value: function distanceSqToPoint(t) {
        var e = Kt.subVectors(t, this.origin).dot(this.direction);
        return e < 0 ? this.origin.distanceToSquared(t) : (Kt.copy(this.direction).multiplyScalar(e).add(this.origin), Kt.distanceToSquared(t));
      }
    }, {
      key: "distanceSqToSegment",
      value: function distanceSqToSegment(t, e, n, i) {
        $t.copy(t).add(e).multiplyScalar(.5), te.copy(e).sub(t).normalize(), ee.copy(this.origin).sub($t);
        var r = .5 * t.distanceTo(e),
            s = -this.direction.dot(te),
            a = ee.dot(this.direction),
            o = -ee.dot(te),
            l = ee.lengthSq(),
            c = Math.abs(1 - s * s);
        var h, u, d, p;
        if (c > 0) {
          if (h = s * o - a, u = s * a - o, p = r * c, h >= 0) {
            if (u >= -p) {
              if (u <= p) {
                var _t17 = 1 / c;

                h *= _t17, u *= _t17, d = h * (h + s * u + 2 * a) + u * (s * h + u + 2 * o) + l;
              } else u = r, h = Math.max(0, -(s * u + a)), d = -h * h + u * (u + 2 * o) + l;
            } else u = -r, h = Math.max(0, -(s * u + a)), d = -h * h + u * (u + 2 * o) + l;
          } else u <= -p ? (h = Math.max(0, -(-s * r + a)), u = h > 0 ? -r : Math.min(Math.max(-r, -o), r), d = -h * h + u * (u + 2 * o) + l) : u <= p ? (h = 0, u = Math.min(Math.max(-r, -o), r), d = u * (u + 2 * o) + l) : (h = Math.max(0, -(s * r + a)), u = h > 0 ? r : Math.min(Math.max(-r, -o), r), d = -h * h + u * (u + 2 * o) + l);
        } else u = s > 0 ? -r : r, h = Math.max(0, -(s * u + a)), d = -h * h + u * (u + 2 * o) + l;
        return n && n.copy(this.direction).multiplyScalar(h).add(this.origin), i && i.copy(te).multiplyScalar(u).add($t), d;
      }
    }, {
      key: "intersectSphere",
      value: function intersectSphere(t, e) {
        Kt.subVectors(t.center, this.origin);
        var n = Kt.dot(this.direction),
            i = Kt.dot(Kt) - n * n,
            r = t.radius * t.radius;
        if (i > r) return null;
        var s = Math.sqrt(r - i),
            a = n - s,
            o = n + s;
        return a < 0 && o < 0 ? null : a < 0 ? this.at(o, e) : this.at(a, e);
      }
    }, {
      key: "intersectsSphere",
      value: function intersectsSphere(t) {
        return this.distanceSqToPoint(t.center) <= t.radius * t.radius;
      }
    }, {
      key: "distanceToPlane",
      value: function distanceToPlane(t) {
        var e = t.normal.dot(this.direction);
        if (0 === e) return 0 === t.distanceToPoint(this.origin) ? 0 : null;
        var n = -(this.origin.dot(t.normal) + t.constant) / e;
        return n >= 0 ? n : null;
      }
    }, {
      key: "intersectPlane",
      value: function intersectPlane(t, e) {
        var n = this.distanceToPlane(t);
        return null === n ? null : this.at(n, e);
      }
    }, {
      key: "intersectsPlane",
      value: function intersectsPlane(t) {
        var e = t.distanceToPoint(this.origin);
        if (0 === e) return !0;
        return t.normal.dot(this.direction) * e < 0;
      }
    }, {
      key: "intersectBox",
      value: function intersectBox(t, e) {
        var n, i, r, s, a, o;
        var l = 1 / this.direction.x,
            c = 1 / this.direction.y,
            h = 1 / this.direction.z,
            u = this.origin;
        return l >= 0 ? (n = (t.min.x - u.x) * l, i = (t.max.x - u.x) * l) : (n = (t.max.x - u.x) * l, i = (t.min.x - u.x) * l), c >= 0 ? (r = (t.min.y - u.y) * c, s = (t.max.y - u.y) * c) : (r = (t.max.y - u.y) * c, s = (t.min.y - u.y) * c), n > s || r > i ? null : ((r > n || n != n) && (n = r), (s < i || i != i) && (i = s), h >= 0 ? (a = (t.min.z - u.z) * h, o = (t.max.z - u.z) * h) : (a = (t.max.z - u.z) * h, o = (t.min.z - u.z) * h), n > o || a > i ? null : ((a > n || n != n) && (n = a), (o < i || i != i) && (i = o), i < 0 ? null : this.at(n >= 0 ? n : i, e)));
      }
    }, {
      key: "intersectsBox",
      value: function intersectsBox(t) {
        return null !== this.intersectBox(t, Kt);
      }
    }, {
      key: "intersectTriangle",
      value: function intersectTriangle(t, e, n, i, r) {
        ne.subVectors(e, t), ie.subVectors(n, t), re.crossVectors(ne, ie);
        var s,
            a = this.direction.dot(re);

        if (a > 0) {
          if (i) return null;
          s = 1;
        } else {
          if (!(a < 0)) return null;
          s = -1, a = -a;
        }

        ee.subVectors(this.origin, t);
        var o = s * this.direction.dot(ie.crossVectors(ee, ie));
        if (o < 0) return null;
        var l = s * this.direction.dot(ne.cross(ee));
        if (l < 0) return null;
        if (o + l > a) return null;
        var c = -s * ee.dot(re);
        return c < 0 ? null : this.at(c / a, r);
      }
    }, {
      key: "applyMatrix4",
      value: function applyMatrix4(t) {
        return this.origin.applyMatrix4(t), this.direction.transformDirection(t), this;
      }
    }, {
      key: "equals",
      value: function equals(t) {
        return t.origin.equals(this.origin) && t.direction.equals(this.direction);
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }]);

    return se;
  }();

  var ae = /*#__PURE__*/function () {
    function ae() {
      _classCallCheck(this, ae);

      this.elements = [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1], arguments.length > 0 && console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.");
    }

    _createClass(ae, [{
      key: "set",
      value: function set(t, e, n, i, r, s, a, o, l, c, h, u, d, p, m, f) {
        var g = this.elements;
        return g[0] = t, g[4] = e, g[8] = n, g[12] = i, g[1] = r, g[5] = s, g[9] = a, g[13] = o, g[2] = l, g[6] = c, g[10] = h, g[14] = u, g[3] = d, g[7] = p, g[11] = m, g[15] = f, this;
      }
    }, {
      key: "identity",
      value: function identity() {
        return this.set(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1), this;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new ae().fromArray(this.elements);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        var e = this.elements,
            n = t.elements;
        return e[0] = n[0], e[1] = n[1], e[2] = n[2], e[3] = n[3], e[4] = n[4], e[5] = n[5], e[6] = n[6], e[7] = n[7], e[8] = n[8], e[9] = n[9], e[10] = n[10], e[11] = n[11], e[12] = n[12], e[13] = n[13], e[14] = n[14], e[15] = n[15], this;
      }
    }, {
      key: "copyPosition",
      value: function copyPosition(t) {
        var e = this.elements,
            n = t.elements;
        return e[12] = n[12], e[13] = n[13], e[14] = n[14], this;
      }
    }, {
      key: "setFromMatrix3",
      value: function setFromMatrix3(t) {
        var e = t.elements;
        return this.set(e[0], e[3], e[6], 0, e[1], e[4], e[7], 0, e[2], e[5], e[8], 0, 0, 0, 0, 1), this;
      }
    }, {
      key: "extractBasis",
      value: function extractBasis(t, e, n) {
        return t.setFromMatrixColumn(this, 0), e.setFromMatrixColumn(this, 1), n.setFromMatrixColumn(this, 2), this;
      }
    }, {
      key: "makeBasis",
      value: function makeBasis(t, e, n) {
        return this.set(t.x, e.x, n.x, 0, t.y, e.y, n.y, 0, t.z, e.z, n.z, 0, 0, 0, 0, 1), this;
      }
    }, {
      key: "extractRotation",
      value: function extractRotation(t) {
        var e = this.elements,
            n = t.elements,
            i = 1 / oe.setFromMatrixColumn(t, 0).length(),
            r = 1 / oe.setFromMatrixColumn(t, 1).length(),
            s = 1 / oe.setFromMatrixColumn(t, 2).length();
        return e[0] = n[0] * i, e[1] = n[1] * i, e[2] = n[2] * i, e[3] = 0, e[4] = n[4] * r, e[5] = n[5] * r, e[6] = n[6] * r, e[7] = 0, e[8] = n[8] * s, e[9] = n[9] * s, e[10] = n[10] * s, e[11] = 0, e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1, this;
      }
    }, {
      key: "makeRotationFromEuler",
      value: function makeRotationFromEuler(t) {
        t && t.isEuler || console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");
        var e = this.elements,
            n = t.x,
            i = t.y,
            r = t.z,
            s = Math.cos(n),
            a = Math.sin(n),
            o = Math.cos(i),
            l = Math.sin(i),
            c = Math.cos(r),
            h = Math.sin(r);

        if ("XYZ" === t.order) {
          var _t18 = s * c,
              _n10 = s * h,
              _i6 = a * c,
              _r6 = a * h;

          e[0] = o * c, e[4] = -o * h, e[8] = l, e[1] = _n10 + _i6 * l, e[5] = _t18 - _r6 * l, e[9] = -a * o, e[2] = _r6 - _t18 * l, e[6] = _i6 + _n10 * l, e[10] = s * o;
        } else if ("YXZ" === t.order) {
          var _t19 = o * c,
              _n11 = o * h,
              _i7 = l * c,
              _r7 = l * h;

          e[0] = _t19 + _r7 * a, e[4] = _i7 * a - _n11, e[8] = s * l, e[1] = s * h, e[5] = s * c, e[9] = -a, e[2] = _n11 * a - _i7, e[6] = _r7 + _t19 * a, e[10] = s * o;
        } else if ("ZXY" === t.order) {
          var _t20 = o * c,
              _n12 = o * h,
              _i8 = l * c,
              _r8 = l * h;

          e[0] = _t20 - _r8 * a, e[4] = -s * h, e[8] = _i8 + _n12 * a, e[1] = _n12 + _i8 * a, e[5] = s * c, e[9] = _r8 - _t20 * a, e[2] = -s * l, e[6] = a, e[10] = s * o;
        } else if ("ZYX" === t.order) {
          var _t21 = s * c,
              _n13 = s * h,
              _i9 = a * c,
              _r9 = a * h;

          e[0] = o * c, e[4] = _i9 * l - _n13, e[8] = _t21 * l + _r9, e[1] = o * h, e[5] = _r9 * l + _t21, e[9] = _n13 * l - _i9, e[2] = -l, e[6] = a * o, e[10] = s * o;
        } else if ("YZX" === t.order) {
          var _t22 = s * o,
              _n14 = s * l,
              _i10 = a * o,
              _r10 = a * l;

          e[0] = o * c, e[4] = _r10 - _t22 * h, e[8] = _i10 * h + _n14, e[1] = h, e[5] = s * c, e[9] = -a * c, e[2] = -l * c, e[6] = _n14 * h + _i10, e[10] = _t22 - _r10 * h;
        } else if ("XZY" === t.order) {
          var _t23 = s * o,
              _n15 = s * l,
              _i11 = a * o,
              _r11 = a * l;

          e[0] = o * c, e[4] = -h, e[8] = l * c, e[1] = _t23 * h + _r11, e[5] = s * c, e[9] = _n15 * h - _i11, e[2] = _i11 * h - _n15, e[6] = a * c, e[10] = _r11 * h + _t23;
        }

        return e[3] = 0, e[7] = 0, e[11] = 0, e[12] = 0, e[13] = 0, e[14] = 0, e[15] = 1, this;
      }
    }, {
      key: "makeRotationFromQuaternion",
      value: function makeRotationFromQuaternion(t) {
        return this.compose(ce, t, he);
      }
    }, {
      key: "lookAt",
      value: function lookAt(t, e, n) {
        var i = this.elements;
        return pe.subVectors(t, e), 0 === pe.lengthSq() && (pe.z = 1), pe.normalize(), ue.crossVectors(n, pe), 0 === ue.lengthSq() && (1 === Math.abs(n.z) ? pe.x += 1e-4 : pe.z += 1e-4, pe.normalize(), ue.crossVectors(n, pe)), ue.normalize(), de.crossVectors(pe, ue), i[0] = ue.x, i[4] = de.x, i[8] = pe.x, i[1] = ue.y, i[5] = de.y, i[9] = pe.y, i[2] = ue.z, i[6] = de.z, i[10] = pe.z, this;
      }
    }, {
      key: "multiply",
      value: function multiply(t, e) {
        return void 0 !== e ? (console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."), this.multiplyMatrices(t, e)) : this.multiplyMatrices(this, t);
      }
    }, {
      key: "premultiply",
      value: function premultiply(t) {
        return this.multiplyMatrices(t, this);
      }
    }, {
      key: "multiplyMatrices",
      value: function multiplyMatrices(t, e) {
        var n = t.elements,
            i = e.elements,
            r = this.elements,
            s = n[0],
            a = n[4],
            o = n[8],
            l = n[12],
            c = n[1],
            h = n[5],
            u = n[9],
            d = n[13],
            p = n[2],
            m = n[6],
            f = n[10],
            g = n[14],
            v = n[3],
            y = n[7],
            x = n[11],
            _ = n[15],
            M = i[0],
            b = i[4],
            w = i[8],
            S = i[12],
            T = i[1],
            E = i[5],
            A = i[9],
            L = i[13],
            R = i[2],
            C = i[6],
            P = i[10],
            I = i[14],
            D = i[3],
            N = i[7],
            B = i[11],
            z = i[15];
        return r[0] = s * M + a * T + o * R + l * D, r[4] = s * b + a * E + o * C + l * N, r[8] = s * w + a * A + o * P + l * B, r[12] = s * S + a * L + o * I + l * z, r[1] = c * M + h * T + u * R + d * D, r[5] = c * b + h * E + u * C + d * N, r[9] = c * w + h * A + u * P + d * B, r[13] = c * S + h * L + u * I + d * z, r[2] = p * M + m * T + f * R + g * D, r[6] = p * b + m * E + f * C + g * N, r[10] = p * w + m * A + f * P + g * B, r[14] = p * S + m * L + f * I + g * z, r[3] = v * M + y * T + x * R + _ * D, r[7] = v * b + y * E + x * C + _ * N, r[11] = v * w + y * A + x * P + _ * B, r[15] = v * S + y * L + x * I + _ * z, this;
      }
    }, {
      key: "multiplyScalar",
      value: function multiplyScalar(t) {
        var e = this.elements;
        return e[0] *= t, e[4] *= t, e[8] *= t, e[12] *= t, e[1] *= t, e[5] *= t, e[9] *= t, e[13] *= t, e[2] *= t, e[6] *= t, e[10] *= t, e[14] *= t, e[3] *= t, e[7] *= t, e[11] *= t, e[15] *= t, this;
      }
    }, {
      key: "determinant",
      value: function determinant() {
        var t = this.elements,
            e = t[0],
            n = t[4],
            i = t[8],
            r = t[12],
            s = t[1],
            a = t[5],
            o = t[9],
            l = t[13],
            c = t[2],
            h = t[6],
            u = t[10],
            d = t[14];
        return t[3] * (+r * o * h - i * l * h - r * a * u + n * l * u + i * a * d - n * o * d) + t[7] * (+e * o * d - e * l * u + r * s * u - i * s * d + i * l * c - r * o * c) + t[11] * (+e * l * h - e * a * d - r * s * h + n * s * d + r * a * c - n * l * c) + t[15] * (-i * a * c - e * o * h + e * a * u + i * s * h - n * s * u + n * o * c);
      }
    }, {
      key: "transpose",
      value: function transpose() {
        var t = this.elements;
        var e;
        return e = t[1], t[1] = t[4], t[4] = e, e = t[2], t[2] = t[8], t[8] = e, e = t[6], t[6] = t[9], t[9] = e, e = t[3], t[3] = t[12], t[12] = e, e = t[7], t[7] = t[13], t[13] = e, e = t[11], t[11] = t[14], t[14] = e, this;
      }
    }, {
      key: "setPosition",
      value: function setPosition(t, e, n) {
        var i = this.elements;
        return t.isVector3 ? (i[12] = t.x, i[13] = t.y, i[14] = t.z) : (i[12] = t, i[13] = e, i[14] = n), this;
      }
    }, {
      key: "invert",
      value: function invert() {
        var t = this.elements,
            e = t[0],
            n = t[1],
            i = t[2],
            r = t[3],
            s = t[4],
            a = t[5],
            o = t[6],
            l = t[7],
            c = t[8],
            h = t[9],
            u = t[10],
            d = t[11],
            p = t[12],
            m = t[13],
            f = t[14],
            g = t[15],
            v = h * f * l - m * u * l + m * o * d - a * f * d - h * o * g + a * u * g,
            y = p * u * l - c * f * l - p * o * d + s * f * d + c * o * g - s * u * g,
            x = c * m * l - p * h * l + p * a * d - s * m * d - c * a * g + s * h * g,
            _ = p * h * o - c * m * o - p * a * u + s * m * u + c * a * f - s * h * f,
            M = e * v + n * y + i * x + r * _;

        if (0 === M) return this.set(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
        var b = 1 / M;
        return t[0] = v * b, t[1] = (m * u * r - h * f * r - m * i * d + n * f * d + h * i * g - n * u * g) * b, t[2] = (a * f * r - m * o * r + m * i * l - n * f * l - a * i * g + n * o * g) * b, t[3] = (h * o * r - a * u * r - h * i * l + n * u * l + a * i * d - n * o * d) * b, t[4] = y * b, t[5] = (c * f * r - p * u * r + p * i * d - e * f * d - c * i * g + e * u * g) * b, t[6] = (p * o * r - s * f * r - p * i * l + e * f * l + s * i * g - e * o * g) * b, t[7] = (s * u * r - c * o * r + c * i * l - e * u * l - s * i * d + e * o * d) * b, t[8] = x * b, t[9] = (p * h * r - c * m * r - p * n * d + e * m * d + c * n * g - e * h * g) * b, t[10] = (s * m * r - p * a * r + p * n * l - e * m * l - s * n * g + e * a * g) * b, t[11] = (c * a * r - s * h * r - c * n * l + e * h * l + s * n * d - e * a * d) * b, t[12] = _ * b, t[13] = (c * m * i - p * h * i + p * n * u - e * m * u - c * n * f + e * h * f) * b, t[14] = (p * a * i - s * m * i - p * n * o + e * m * o + s * n * f - e * a * f) * b, t[15] = (s * h * i - c * a * i + c * n * o - e * h * o - s * n * u + e * a * u) * b, this;
      }
    }, {
      key: "scale",
      value: function scale(t) {
        var e = this.elements,
            n = t.x,
            i = t.y,
            r = t.z;
        return e[0] *= n, e[4] *= i, e[8] *= r, e[1] *= n, e[5] *= i, e[9] *= r, e[2] *= n, e[6] *= i, e[10] *= r, e[3] *= n, e[7] *= i, e[11] *= r, this;
      }
    }, {
      key: "getMaxScaleOnAxis",
      value: function getMaxScaleOnAxis() {
        var t = this.elements,
            e = t[0] * t[0] + t[1] * t[1] + t[2] * t[2],
            n = t[4] * t[4] + t[5] * t[5] + t[6] * t[6],
            i = t[8] * t[8] + t[9] * t[9] + t[10] * t[10];
        return Math.sqrt(Math.max(e, n, i));
      }
    }, {
      key: "makeTranslation",
      value: function makeTranslation(t, e, n) {
        return this.set(1, 0, 0, t, 0, 1, 0, e, 0, 0, 1, n, 0, 0, 0, 1), this;
      }
    }, {
      key: "makeRotationX",
      value: function makeRotationX(t) {
        var e = Math.cos(t),
            n = Math.sin(t);
        return this.set(1, 0, 0, 0, 0, e, -n, 0, 0, n, e, 0, 0, 0, 0, 1), this;
      }
    }, {
      key: "makeRotationY",
      value: function makeRotationY(t) {
        var e = Math.cos(t),
            n = Math.sin(t);
        return this.set(e, 0, n, 0, 0, 1, 0, 0, -n, 0, e, 0, 0, 0, 0, 1), this;
      }
    }, {
      key: "makeRotationZ",
      value: function makeRotationZ(t) {
        var e = Math.cos(t),
            n = Math.sin(t);
        return this.set(e, -n, 0, 0, n, e, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1), this;
      }
    }, {
      key: "makeRotationAxis",
      value: function makeRotationAxis(t, e) {
        var n = Math.cos(e),
            i = Math.sin(e),
            r = 1 - n,
            s = t.x,
            a = t.y,
            o = t.z,
            l = r * s,
            c = r * a;
        return this.set(l * s + n, l * a - i * o, l * o + i * a, 0, l * a + i * o, c * a + n, c * o - i * s, 0, l * o - i * a, c * o + i * s, r * o * o + n, 0, 0, 0, 0, 1), this;
      }
    }, {
      key: "makeScale",
      value: function makeScale(t, e, n) {
        return this.set(t, 0, 0, 0, 0, e, 0, 0, 0, 0, n, 0, 0, 0, 0, 1), this;
      }
    }, {
      key: "makeShear",
      value: function makeShear(t, e, n, i, r, s) {
        return this.set(1, n, r, 0, t, 1, s, 0, e, i, 1, 0, 0, 0, 0, 1), this;
      }
    }, {
      key: "compose",
      value: function compose(t, e, n) {
        var i = this.elements,
            r = e._x,
            s = e._y,
            a = e._z,
            o = e._w,
            l = r + r,
            c = s + s,
            h = a + a,
            u = r * l,
            d = r * c,
            p = r * h,
            m = s * c,
            f = s * h,
            g = a * h,
            v = o * l,
            y = o * c,
            x = o * h,
            _ = n.x,
            M = n.y,
            b = n.z;
        return i[0] = (1 - (m + g)) * _, i[1] = (d + x) * _, i[2] = (p - y) * _, i[3] = 0, i[4] = (d - x) * M, i[5] = (1 - (u + g)) * M, i[6] = (f + v) * M, i[7] = 0, i[8] = (p + y) * b, i[9] = (f - v) * b, i[10] = (1 - (u + m)) * b, i[11] = 0, i[12] = t.x, i[13] = t.y, i[14] = t.z, i[15] = 1, this;
      }
    }, {
      key: "decompose",
      value: function decompose(t, e, n) {
        var i = this.elements;
        var r = oe.set(i[0], i[1], i[2]).length();
        var s = oe.set(i[4], i[5], i[6]).length(),
            a = oe.set(i[8], i[9], i[10]).length();
        this.determinant() < 0 && (r = -r), t.x = i[12], t.y = i[13], t.z = i[14], le.copy(this);
        var o = 1 / r,
            l = 1 / s,
            c = 1 / a;
        return le.elements[0] *= o, le.elements[1] *= o, le.elements[2] *= o, le.elements[4] *= l, le.elements[5] *= l, le.elements[6] *= l, le.elements[8] *= c, le.elements[9] *= c, le.elements[10] *= c, e.setFromRotationMatrix(le), n.x = r, n.y = s, n.z = a, this;
      }
    }, {
      key: "makePerspective",
      value: function makePerspective(t, e, n, i, r, s) {
        void 0 === s && console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");
        var a = this.elements,
            o = 2 * r / (e - t),
            l = 2 * r / (n - i),
            c = (e + t) / (e - t),
            h = (n + i) / (n - i),
            u = -(s + r) / (s - r),
            d = -2 * s * r / (s - r);
        return a[0] = o, a[4] = 0, a[8] = c, a[12] = 0, a[1] = 0, a[5] = l, a[9] = h, a[13] = 0, a[2] = 0, a[6] = 0, a[10] = u, a[14] = d, a[3] = 0, a[7] = 0, a[11] = -1, a[15] = 0, this;
      }
    }, {
      key: "makeOrthographic",
      value: function makeOrthographic(t, e, n, i, r, s) {
        var a = this.elements,
            o = 1 / (e - t),
            l = 1 / (n - i),
            c = 1 / (s - r),
            h = (e + t) * o,
            u = (n + i) * l,
            d = (s + r) * c;
        return a[0] = 2 * o, a[4] = 0, a[8] = 0, a[12] = -h, a[1] = 0, a[5] = 2 * l, a[9] = 0, a[13] = -u, a[2] = 0, a[6] = 0, a[10] = -2 * c, a[14] = -d, a[3] = 0, a[7] = 0, a[11] = 0, a[15] = 1, this;
      }
    }, {
      key: "equals",
      value: function equals(t) {
        var e = this.elements,
            n = t.elements;

        for (var _t24 = 0; _t24 < 16; _t24++) {
          if (e[_t24] !== n[_t24]) return !1;
        }

        return !0;
      }
    }, {
      key: "fromArray",
      value: function fromArray(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;

        for (var _n16 = 0; _n16 < 16; _n16++) {
          this.elements[_n16] = t[_n16 + e];
        }

        return this;
      }
    }, {
      key: "toArray",
      value: function toArray() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        var n = this.elements;
        return t[e] = n[0], t[e + 1] = n[1], t[e + 2] = n[2], t[e + 3] = n[3], t[e + 4] = n[4], t[e + 5] = n[5], t[e + 6] = n[6], t[e + 7] = n[7], t[e + 8] = n[8], t[e + 9] = n[9], t[e + 10] = n[10], t[e + 11] = n[11], t[e + 12] = n[12], t[e + 13] = n[13], t[e + 14] = n[14], t[e + 15] = n[15], t;
      }
    }]);

    return ae;
  }();

  ae.prototype.isMatrix4 = !0;
  var oe = new Rt(),
      le = new ae(),
      ce = new Rt(0, 0, 0),
      he = new Rt(1, 1, 1),
      ue = new Rt(),
      de = new Rt(),
      pe = new Rt(),
      me = new ae(),
      fe = new Lt();

  var ge = /*#__PURE__*/function () {
    function ge() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : ge.DefaultOrder;

      _classCallCheck(this, ge);

      this._x = t, this._y = e, this._z = n, this._order = i;
    }

    _createClass(ge, [{
      key: "x",
      get: function get() {
        return this._x;
      },
      set: function set(t) {
        this._x = t, this._onChangeCallback();
      }
    }, {
      key: "y",
      get: function get() {
        return this._y;
      },
      set: function set(t) {
        this._y = t, this._onChangeCallback();
      }
    }, {
      key: "z",
      get: function get() {
        return this._z;
      },
      set: function set(t) {
        this._z = t, this._onChangeCallback();
      }
    }, {
      key: "order",
      get: function get() {
        return this._order;
      },
      set: function set(t) {
        this._order = t, this._onChangeCallback();
      }
    }, {
      key: "set",
      value: function set(t, e, n) {
        var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : this._order;
        return this._x = t, this._y = e, this._z = n, this._order = i, this._onChangeCallback(), this;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor(this._x, this._y, this._z, this._order);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this._x = t._x, this._y = t._y, this._z = t._z, this._order = t._order, this._onChangeCallback(), this;
      }
    }, {
      key: "setFromRotationMatrix",
      value: function setFromRotationMatrix(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._order;
        var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : !0;
        var i = t.elements,
            r = i[0],
            s = i[4],
            a = i[8],
            o = i[1],
            l = i[5],
            c = i[9],
            h = i[2],
            u = i[6],
            d = i[10];

        switch (e) {
          case "XYZ":
            this._y = Math.asin(ht(a, -1, 1)), Math.abs(a) < .9999999 ? (this._x = Math.atan2(-c, d), this._z = Math.atan2(-s, r)) : (this._x = Math.atan2(u, l), this._z = 0);
            break;

          case "YXZ":
            this._x = Math.asin(-ht(c, -1, 1)), Math.abs(c) < .9999999 ? (this._y = Math.atan2(a, d), this._z = Math.atan2(o, l)) : (this._y = Math.atan2(-h, r), this._z = 0);
            break;

          case "ZXY":
            this._x = Math.asin(ht(u, -1, 1)), Math.abs(u) < .9999999 ? (this._y = Math.atan2(-h, d), this._z = Math.atan2(-s, l)) : (this._y = 0, this._z = Math.atan2(o, r));
            break;

          case "ZYX":
            this._y = Math.asin(-ht(h, -1, 1)), Math.abs(h) < .9999999 ? (this._x = Math.atan2(u, d), this._z = Math.atan2(o, r)) : (this._x = 0, this._z = Math.atan2(-s, l));
            break;

          case "YZX":
            this._z = Math.asin(ht(o, -1, 1)), Math.abs(o) < .9999999 ? (this._x = Math.atan2(-c, l), this._y = Math.atan2(-h, r)) : (this._x = 0, this._y = Math.atan2(a, d));
            break;

          case "XZY":
            this._z = Math.asin(-ht(s, -1, 1)), Math.abs(s) < .9999999 ? (this._x = Math.atan2(u, l), this._y = Math.atan2(a, r)) : (this._x = Math.atan2(-c, d), this._y = 0);
            break;

          default:
            console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: " + e);
        }

        return this._order = e, !0 === n && this._onChangeCallback(), this;
      }
    }, {
      key: "setFromQuaternion",
      value: function setFromQuaternion(t, e, n) {
        return me.makeRotationFromQuaternion(t), this.setFromRotationMatrix(me, e, n);
      }
    }, {
      key: "setFromVector3",
      value: function setFromVector3(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : this._order;
        return this.set(t.x, t.y, t.z, e);
      }
    }, {
      key: "reorder",
      value: function reorder(t) {
        return fe.setFromEuler(this), this.setFromQuaternion(fe, t);
      }
    }, {
      key: "equals",
      value: function equals(t) {
        return t._x === this._x && t._y === this._y && t._z === this._z && t._order === this._order;
      }
    }, {
      key: "fromArray",
      value: function fromArray(t) {
        return this._x = t[0], this._y = t[1], this._z = t[2], void 0 !== t[3] && (this._order = t[3]), this._onChangeCallback(), this;
      }
    }, {
      key: "toArray",
      value: function toArray() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        return t[e] = this._x, t[e + 1] = this._y, t[e + 2] = this._z, t[e + 3] = this._order, t;
      }
    }, {
      key: "toVector3",
      value: function toVector3(t) {
        return t ? t.set(this._x, this._y, this._z) : new Rt(this._x, this._y, this._z);
      }
    }, {
      key: "_onChange",
      value: function _onChange(t) {
        return this._onChangeCallback = t, this;
      }
    }, {
      key: "_onChangeCallback",
      value: function _onChangeCallback() {}
    }]);

    return ge;
  }();

  ge.prototype.isEuler = !0, ge.DefaultOrder = "XYZ", ge.RotationOrders = ["XYZ", "YZX", "ZXY", "XZY", "YXZ", "ZYX"];

  var ve = /*#__PURE__*/function () {
    function ve() {
      _classCallCheck(this, ve);

      this.mask = 1;
    }

    _createClass(ve, [{
      key: "set",
      value: function set(t) {
        this.mask = 1 << t | 0;
      }
    }, {
      key: "enable",
      value: function enable(t) {
        this.mask |= 1 << t | 0;
      }
    }, {
      key: "enableAll",
      value: function enableAll() {
        this.mask = -1;
      }
    }, {
      key: "toggle",
      value: function toggle(t) {
        this.mask ^= 1 << t | 0;
      }
    }, {
      key: "disable",
      value: function disable(t) {
        this.mask &= ~(1 << t | 0);
      }
    }, {
      key: "disableAll",
      value: function disableAll() {
        this.mask = 0;
      }
    }, {
      key: "test",
      value: function test(t) {
        return 0 != (this.mask & t.mask);
      }
    }]);

    return ve;
  }();

  var ye = 0;

  var xe = new Rt(),
      _e = new Lt(),
      Me = new ae(),
      be = new Rt(),
      we = new Rt(),
      Se = new Rt(),
      Te = new Lt(),
      Ee = new Rt(1, 0, 0),
      Ae = new Rt(0, 1, 0),
      Le = new Rt(0, 0, 1),
      Re = {
    type: "added"
  },
      Ce = {
    type: "removed"
  };

  var Pe = /*#__PURE__*/function (_rt3) {
    _inherits(Pe, _rt3);

    var _super5 = _createSuper(Pe);

    function Pe() {
      var _this5;

      _classCallCheck(this, Pe);

      _this5 = _super5.call(this), Object.defineProperty(_assertThisInitialized(_this5), "id", {
        value: ye++
      }), _this5.uuid = ct(), _this5.name = "", _this5.type = "Object3D", _this5.parent = null, _this5.children = [], _this5.up = Pe.DefaultUp.clone();
      var t = new Rt(),
          e = new ge(),
          n = new Lt(),
          i = new Rt(1, 1, 1);
      e._onChange(function () {
        n.setFromEuler(e, !1);
      }), n._onChange(function () {
        e.setFromQuaternion(n, void 0, !1);
      }), Object.defineProperties(_assertThisInitialized(_this5), {
        position: {
          configurable: !0,
          enumerable: !0,
          value: t
        },
        rotation: {
          configurable: !0,
          enumerable: !0,
          value: e
        },
        quaternion: {
          configurable: !0,
          enumerable: !0,
          value: n
        },
        scale: {
          configurable: !0,
          enumerable: !0,
          value: i
        },
        modelViewMatrix: {
          value: new ae()
        },
        normalMatrix: {
          value: new yt()
        }
      }), _this5.matrix = new ae(), _this5.matrixWorld = new ae(), _this5.matrixAutoUpdate = Pe.DefaultMatrixAutoUpdate, _this5.matrixWorldNeedsUpdate = !1, _this5.layers = new ve(), _this5.visible = !0, _this5.castShadow = !1, _this5.receiveShadow = !1, _this5.frustumCulled = !0, _this5.renderOrder = 0, _this5.animations = [], _this5.userData = {};
      return _this5;
    }

    _createClass(Pe, [{
      key: "onBeforeRender",
      value: function onBeforeRender() {}
    }, {
      key: "onAfterRender",
      value: function onAfterRender() {}
    }, {
      key: "applyMatrix4",
      value: function applyMatrix4(t) {
        this.matrixAutoUpdate && this.updateMatrix(), this.matrix.premultiply(t), this.matrix.decompose(this.position, this.quaternion, this.scale);
      }
    }, {
      key: "applyQuaternion",
      value: function applyQuaternion(t) {
        return this.quaternion.premultiply(t), this;
      }
    }, {
      key: "setRotationFromAxisAngle",
      value: function setRotationFromAxisAngle(t, e) {
        this.quaternion.setFromAxisAngle(t, e);
      }
    }, {
      key: "setRotationFromEuler",
      value: function setRotationFromEuler(t) {
        this.quaternion.setFromEuler(t, !0);
      }
    }, {
      key: "setRotationFromMatrix",
      value: function setRotationFromMatrix(t) {
        this.quaternion.setFromRotationMatrix(t);
      }
    }, {
      key: "setRotationFromQuaternion",
      value: function setRotationFromQuaternion(t) {
        this.quaternion.copy(t);
      }
    }, {
      key: "rotateOnAxis",
      value: function rotateOnAxis(t, e) {
        return _e.setFromAxisAngle(t, e), this.quaternion.multiply(_e), this;
      }
    }, {
      key: "rotateOnWorldAxis",
      value: function rotateOnWorldAxis(t, e) {
        return _e.setFromAxisAngle(t, e), this.quaternion.premultiply(_e), this;
      }
    }, {
      key: "rotateX",
      value: function rotateX(t) {
        return this.rotateOnAxis(Ee, t);
      }
    }, {
      key: "rotateY",
      value: function rotateY(t) {
        return this.rotateOnAxis(Ae, t);
      }
    }, {
      key: "rotateZ",
      value: function rotateZ(t) {
        return this.rotateOnAxis(Le, t);
      }
    }, {
      key: "translateOnAxis",
      value: function translateOnAxis(t, e) {
        return xe.copy(t).applyQuaternion(this.quaternion), this.position.add(xe.multiplyScalar(e)), this;
      }
    }, {
      key: "translateX",
      value: function translateX(t) {
        return this.translateOnAxis(Ee, t);
      }
    }, {
      key: "translateY",
      value: function translateY(t) {
        return this.translateOnAxis(Ae, t);
      }
    }, {
      key: "translateZ",
      value: function translateZ(t) {
        return this.translateOnAxis(Le, t);
      }
    }, {
      key: "localToWorld",
      value: function localToWorld(t) {
        return t.applyMatrix4(this.matrixWorld);
      }
    }, {
      key: "worldToLocal",
      value: function worldToLocal(t) {
        return t.applyMatrix4(Me.copy(this.matrixWorld).invert());
      }
    }, {
      key: "lookAt",
      value: function lookAt(t, e, n) {
        t.isVector3 ? be.copy(t) : be.set(t, e, n);
        var i = this.parent;
        this.updateWorldMatrix(!0, !1), we.setFromMatrixPosition(this.matrixWorld), this.isCamera || this.isLight ? Me.lookAt(we, be, this.up) : Me.lookAt(be, we, this.up), this.quaternion.setFromRotationMatrix(Me), i && (Me.extractRotation(i.matrixWorld), _e.setFromRotationMatrix(Me), this.quaternion.premultiply(_e.invert()));
      }
    }, {
      key: "add",
      value: function add(t) {
        if (arguments.length > 1) {
          for (var _t25 = 0; _t25 < arguments.length; _t25++) {
            this.add(arguments[_t25]);
          }

          return this;
        }

        return t === this ? (console.error("THREE.Object3D.add: object can't be added as a child of itself.", t), this) : (t && t.isObject3D ? (null !== t.parent && t.parent.remove(t), t.parent = this, this.children.push(t), t.dispatchEvent(Re)) : console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.", t), this);
      }
    }, {
      key: "remove",
      value: function remove(t) {
        if (arguments.length > 1) {
          for (var _t26 = 0; _t26 < arguments.length; _t26++) {
            this.remove(arguments[_t26]);
          }

          return this;
        }

        var e = this.children.indexOf(t);
        return -1 !== e && (t.parent = null, this.children.splice(e, 1), t.dispatchEvent(Ce)), this;
      }
    }, {
      key: "removeFromParent",
      value: function removeFromParent() {
        var t = this.parent;
        return null !== t && t.remove(this), this;
      }
    }, {
      key: "clear",
      value: function clear() {
        for (var _t27 = 0; _t27 < this.children.length; _t27++) {
          var _e9 = this.children[_t27];
          _e9.parent = null, _e9.dispatchEvent(Ce);
        }

        return this.children.length = 0, this;
      }
    }, {
      key: "attach",
      value: function attach(t) {
        return this.updateWorldMatrix(!0, !1), Me.copy(this.matrixWorld).invert(), null !== t.parent && (t.parent.updateWorldMatrix(!0, !1), Me.multiply(t.parent.matrixWorld)), t.applyMatrix4(Me), this.add(t), t.updateWorldMatrix(!1, !0), this;
      }
    }, {
      key: "getObjectById",
      value: function getObjectById(t) {
        return this.getObjectByProperty("id", t);
      }
    }, {
      key: "getObjectByName",
      value: function getObjectByName(t) {
        return this.getObjectByProperty("name", t);
      }
    }, {
      key: "getObjectByProperty",
      value: function getObjectByProperty(t, e) {
        if (this[t] === e) return this;

        for (var _n17 = 0, _i12 = this.children.length; _n17 < _i12; _n17++) {
          var _i13 = this.children[_n17].getObjectByProperty(t, e);

          if (void 0 !== _i13) return _i13;
        }
      }
    }, {
      key: "getWorldPosition",
      value: function getWorldPosition(t) {
        return this.updateWorldMatrix(!0, !1), t.setFromMatrixPosition(this.matrixWorld);
      }
    }, {
      key: "getWorldQuaternion",
      value: function getWorldQuaternion(t) {
        return this.updateWorldMatrix(!0, !1), this.matrixWorld.decompose(we, t, Se), t;
      }
    }, {
      key: "getWorldScale",
      value: function getWorldScale(t) {
        return this.updateWorldMatrix(!0, !1), this.matrixWorld.decompose(we, Te, t), t;
      }
    }, {
      key: "getWorldDirection",
      value: function getWorldDirection(t) {
        this.updateWorldMatrix(!0, !1);
        var e = this.matrixWorld.elements;
        return t.set(e[8], e[9], e[10]).normalize();
      }
    }, {
      key: "raycast",
      value: function raycast() {}
    }, {
      key: "traverse",
      value: function traverse(t) {
        t(this);
        var e = this.children;

        for (var _n18 = 0, _i14 = e.length; _n18 < _i14; _n18++) {
          e[_n18].traverse(t);
        }
      }
    }, {
      key: "traverseVisible",
      value: function traverseVisible(t) {
        if (!1 === this.visible) return;
        t(this);
        var e = this.children;

        for (var _n19 = 0, _i15 = e.length; _n19 < _i15; _n19++) {
          e[_n19].traverseVisible(t);
        }
      }
    }, {
      key: "traverseAncestors",
      value: function traverseAncestors(t) {
        var e = this.parent;
        null !== e && (t(e), e.traverseAncestors(t));
      }
    }, {
      key: "updateMatrix",
      value: function updateMatrix() {
        this.matrix.compose(this.position, this.quaternion, this.scale), this.matrixWorldNeedsUpdate = !0;
      }
    }, {
      key: "updateMatrixWorld",
      value: function updateMatrixWorld(t) {
        this.matrixAutoUpdate && this.updateMatrix(), (this.matrixWorldNeedsUpdate || t) && (null === this.parent ? this.matrixWorld.copy(this.matrix) : this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix), this.matrixWorldNeedsUpdate = !1, t = !0);
        var e = this.children;

        for (var _n20 = 0, _i16 = e.length; _n20 < _i16; _n20++) {
          e[_n20].updateMatrixWorld(t);
        }
      }
    }, {
      key: "updateWorldMatrix",
      value: function updateWorldMatrix(t, e) {
        var n = this.parent;

        if (!0 === t && null !== n && n.updateWorldMatrix(!0, !1), this.matrixAutoUpdate && this.updateMatrix(), null === this.parent ? this.matrixWorld.copy(this.matrix) : this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix), !0 === e) {
          var _t28 = this.children;

          for (var _e10 = 0, _n21 = _t28.length; _e10 < _n21; _e10++) {
            _t28[_e10].updateWorldMatrix(!1, !0);
          }
        }
      }
    }, {
      key: "toJSON",
      value: function toJSON(t) {
        var e = void 0 === t || "string" == typeof t,
            n = {};
        e && (t = {
          geometries: {},
          materials: {},
          textures: {},
          images: {},
          shapes: {},
          skeletons: {},
          animations: {}
        }, n.metadata = {
          version: 4.5,
          type: "Object",
          generator: "Object3D.toJSON"
        });
        var i = {};

        function r(e, n) {
          return void 0 === e[n.uuid] && (e[n.uuid] = n.toJSON(t)), n.uuid;
        }

        if (i.uuid = this.uuid, i.type = this.type, "" !== this.name && (i.name = this.name), !0 === this.castShadow && (i.castShadow = !0), !0 === this.receiveShadow && (i.receiveShadow = !0), !1 === this.visible && (i.visible = !1), !1 === this.frustumCulled && (i.frustumCulled = !1), 0 !== this.renderOrder && (i.renderOrder = this.renderOrder), "{}" !== JSON.stringify(this.userData) && (i.userData = this.userData), i.layers = this.layers.mask, i.matrix = this.matrix.toArray(), !1 === this.matrixAutoUpdate && (i.matrixAutoUpdate = !1), this.isInstancedMesh && (i.type = "InstancedMesh", i.count = this.count, i.instanceMatrix = this.instanceMatrix.toJSON(), null !== this.instanceColor && (i.instanceColor = this.instanceColor.toJSON())), this.isScene) this.background && (this.background.isColor ? i.background = this.background.toJSON() : this.background.isTexture && (i.background = this.background.toJSON(t).uuid)), this.environment && this.environment.isTexture && (i.environment = this.environment.toJSON(t).uuid);else if (this.isMesh || this.isLine || this.isPoints) {
          i.geometry = r(t.geometries, this.geometry);
          var _e11 = this.geometry.parameters;

          if (void 0 !== _e11 && void 0 !== _e11.shapes) {
            var _n22 = _e11.shapes;
            if (Array.isArray(_n22)) for (var _e12 = 0, _i17 = _n22.length; _e12 < _i17; _e12++) {
              var _i18 = _n22[_e12];
              r(t.shapes, _i18);
            } else r(t.shapes, _n22);
          }
        }
        if (this.isSkinnedMesh && (i.bindMode = this.bindMode, i.bindMatrix = this.bindMatrix.toArray(), void 0 !== this.skeleton && (r(t.skeletons, this.skeleton), i.skeleton = this.skeleton.uuid)), void 0 !== this.material) if (Array.isArray(this.material)) {
          var _e13 = [];

          for (var _n23 = 0, _i19 = this.material.length; _n23 < _i19; _n23++) {
            _e13.push(r(t.materials, this.material[_n23]));
          }

          i.material = _e13;
        } else i.material = r(t.materials, this.material);

        if (this.children.length > 0) {
          i.children = [];

          for (var _e14 = 0; _e14 < this.children.length; _e14++) {
            i.children.push(this.children[_e14].toJSON(t).object);
          }
        }

        if (this.animations.length > 0) {
          i.animations = [];

          for (var _e15 = 0; _e15 < this.animations.length; _e15++) {
            var _n24 = this.animations[_e15];
            i.animations.push(r(t.animations, _n24));
          }
        }

        if (e) {
          var _e16 = s(t.geometries),
              _i20 = s(t.materials),
              _r12 = s(t.textures),
              _a4 = s(t.images),
              _o6 = s(t.shapes),
              _l7 = s(t.skeletons),
              _c5 = s(t.animations);

          _e16.length > 0 && (n.geometries = _e16), _i20.length > 0 && (n.materials = _i20), _r12.length > 0 && (n.textures = _r12), _a4.length > 0 && (n.images = _a4), _o6.length > 0 && (n.shapes = _o6), _l7.length > 0 && (n.skeletons = _l7), _c5.length > 0 && (n.animations = _c5);
        }

        return n.object = i, n;

        function s(t) {
          var e = [];

          for (var _n25 in t) {
            var _i21 = t[_n25];
            delete _i21.metadata, e.push(_i21);
          }

          return e;
        }
      }
    }, {
      key: "clone",
      value: function clone(t) {
        return new this.constructor().copy(this, t);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !0;
        if (this.name = t.name, this.up.copy(t.up), this.position.copy(t.position), this.rotation.order = t.rotation.order, this.quaternion.copy(t.quaternion), this.scale.copy(t.scale), this.matrix.copy(t.matrix), this.matrixWorld.copy(t.matrixWorld), this.matrixAutoUpdate = t.matrixAutoUpdate, this.matrixWorldNeedsUpdate = t.matrixWorldNeedsUpdate, this.layers.mask = t.layers.mask, this.visible = t.visible, this.castShadow = t.castShadow, this.receiveShadow = t.receiveShadow, this.frustumCulled = t.frustumCulled, this.renderOrder = t.renderOrder, this.userData = JSON.parse(JSON.stringify(t.userData)), !0 === e) for (var _e17 = 0; _e17 < t.children.length; _e17++) {
          var _n26 = t.children[_e17];
          this.add(_n26.clone());
        }
        return this;
      }
    }]);

    return Pe;
  }(rt);

  Pe.DefaultUp = new Rt(0, 1, 0), Pe.DefaultMatrixAutoUpdate = !0, Pe.prototype.isObject3D = !0;
  var Ie = new Rt(),
      De = new Rt(),
      Ne = new Rt(),
      Be = new Rt(),
      ze = new Rt(),
      Fe = new Rt(),
      Oe = new Rt(),
      Ue = new Rt(),
      He = new Rt(),
      Ge = new Rt();

  var ke = /*#__PURE__*/function () {
    function ke() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Rt();
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Rt();
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new Rt();

      _classCallCheck(this, ke);

      this.a = t, this.b = e, this.c = n;
    }

    _createClass(ke, [{
      key: "set",
      value: function set(t, e, n) {
        return this.a.copy(t), this.b.copy(e), this.c.copy(n), this;
      }
    }, {
      key: "setFromPointsAndIndices",
      value: function setFromPointsAndIndices(t, e, n, i) {
        return this.a.copy(t[e]), this.b.copy(t[n]), this.c.copy(t[i]), this;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.a.copy(t.a), this.b.copy(t.b), this.c.copy(t.c), this;
      }
    }, {
      key: "getArea",
      value: function getArea() {
        return Ie.subVectors(this.c, this.b), De.subVectors(this.a, this.b), .5 * Ie.cross(De).length();
      }
    }, {
      key: "getMidpoint",
      value: function getMidpoint(t) {
        return t.addVectors(this.a, this.b).add(this.c).multiplyScalar(1 / 3);
      }
    }, {
      key: "getNormal",
      value: function getNormal(t) {
        return ke.getNormal(this.a, this.b, this.c, t);
      }
    }, {
      key: "getPlane",
      value: function getPlane(t) {
        return t.setFromCoplanarPoints(this.a, this.b, this.c);
      }
    }, {
      key: "getBarycoord",
      value: function getBarycoord(t, e) {
        return ke.getBarycoord(t, this.a, this.b, this.c, e);
      }
    }, {
      key: "getUV",
      value: function getUV(t, e, n, i, r) {
        return ke.getUV(t, this.a, this.b, this.c, e, n, i, r);
      }
    }, {
      key: "containsPoint",
      value: function containsPoint(t) {
        return ke.containsPoint(t, this.a, this.b, this.c);
      }
    }, {
      key: "isFrontFacing",
      value: function isFrontFacing(t) {
        return ke.isFrontFacing(this.a, this.b, this.c, t);
      }
    }, {
      key: "intersectsBox",
      value: function intersectsBox(t) {
        return t.intersectsTriangle(this);
      }
    }, {
      key: "closestPointToPoint",
      value: function closestPointToPoint(t, e) {
        var n = this.a,
            i = this.b,
            r = this.c;
        var s, a;
        ze.subVectors(i, n), Fe.subVectors(r, n), Ue.subVectors(t, n);
        var o = ze.dot(Ue),
            l = Fe.dot(Ue);
        if (o <= 0 && l <= 0) return e.copy(n);
        He.subVectors(t, i);
        var c = ze.dot(He),
            h = Fe.dot(He);
        if (c >= 0 && h <= c) return e.copy(i);
        var u = o * h - c * l;
        if (u <= 0 && o >= 0 && c <= 0) return s = o / (o - c), e.copy(n).addScaledVector(ze, s);
        Ge.subVectors(t, r);
        var d = ze.dot(Ge),
            p = Fe.dot(Ge);
        if (p >= 0 && d <= p) return e.copy(r);
        var m = d * l - o * p;
        if (m <= 0 && l >= 0 && p <= 0) return a = l / (l - p), e.copy(n).addScaledVector(Fe, a);
        var f = c * p - d * h;
        if (f <= 0 && h - c >= 0 && d - p >= 0) return Oe.subVectors(r, i), a = (h - c) / (h - c + (d - p)), e.copy(i).addScaledVector(Oe, a);
        var g = 1 / (f + m + u);
        return s = m * g, a = u * g, e.copy(n).addScaledVector(ze, s).addScaledVector(Fe, a);
      }
    }, {
      key: "equals",
      value: function equals(t) {
        return t.a.equals(this.a) && t.b.equals(this.b) && t.c.equals(this.c);
      }
    }], [{
      key: "getNormal",
      value: function getNormal(t, e, n, i) {
        i.subVectors(n, e), Ie.subVectors(t, e), i.cross(Ie);
        var r = i.lengthSq();
        return r > 0 ? i.multiplyScalar(1 / Math.sqrt(r)) : i.set(0, 0, 0);
      }
    }, {
      key: "getBarycoord",
      value: function getBarycoord(t, e, n, i, r) {
        Ie.subVectors(i, e), De.subVectors(n, e), Ne.subVectors(t, e);
        var s = Ie.dot(Ie),
            a = Ie.dot(De),
            o = Ie.dot(Ne),
            l = De.dot(De),
            c = De.dot(Ne),
            h = s * l - a * a;
        if (0 === h) return r.set(-2, -1, -1);
        var u = 1 / h,
            d = (l * o - a * c) * u,
            p = (s * c - a * o) * u;
        return r.set(1 - d - p, p, d);
      }
    }, {
      key: "containsPoint",
      value: function containsPoint(t, e, n, i) {
        return this.getBarycoord(t, e, n, i, Be), Be.x >= 0 && Be.y >= 0 && Be.x + Be.y <= 1;
      }
    }, {
      key: "getUV",
      value: function getUV(t, e, n, i, r, s, a, o) {
        return this.getBarycoord(t, e, n, i, Be), o.set(0, 0), o.addScaledVector(r, Be.x), o.addScaledVector(s, Be.y), o.addScaledVector(a, Be.z), o;
      }
    }, {
      key: "isFrontFacing",
      value: function isFrontFacing(t, e, n, i) {
        return Ie.subVectors(n, e), De.subVectors(t, e), Ie.cross(De).dot(i) < 0;
      }
    }]);

    return ke;
  }();

  var Ve = 0;

  var We = /*#__PURE__*/function (_rt4) {
    _inherits(We, _rt4);

    var _super6 = _createSuper(We);

    function We() {
      var _this6;

      _classCallCheck(this, We);

      _this6 = _super6.call(this), Object.defineProperty(_assertThisInitialized(_this6), "id", {
        value: Ve++
      }), _this6.uuid = ct(), _this6.name = "", _this6.type = "Material", _this6.fog = !0, _this6.blending = 1, _this6.side = 0, _this6.vertexColors = !1, _this6.opacity = 1, _this6.transparent = !1, _this6.blendSrc = 204, _this6.blendDst = 205, _this6.blendEquation = n, _this6.blendSrcAlpha = null, _this6.blendDstAlpha = null, _this6.blendEquationAlpha = null, _this6.depthFunc = 3, _this6.depthTest = !0, _this6.depthWrite = !0, _this6.stencilWriteMask = 255, _this6.stencilFunc = 519, _this6.stencilRef = 0, _this6.stencilFuncMask = 255, _this6.stencilFail = tt, _this6.stencilZFail = tt, _this6.stencilZPass = tt, _this6.stencilWrite = !1, _this6.clippingPlanes = null, _this6.clipIntersection = !1, _this6.clipShadows = !1, _this6.shadowSide = null, _this6.colorWrite = !0, _this6.precision = null, _this6.polygonOffset = !1, _this6.polygonOffsetFactor = 0, _this6.polygonOffsetUnits = 0, _this6.dithering = !1, _this6.alphaTest = 0, _this6.alphaToCoverage = !1, _this6.premultipliedAlpha = !1, _this6.visible = !0, _this6.toneMapped = !0, _this6.userData = {}, _this6.version = 0;
      return _this6;
    }

    _createClass(We, [{
      key: "onBuild",
      value: function onBuild() {}
    }, {
      key: "onBeforeCompile",
      value: function onBeforeCompile() {}
    }, {
      key: "customProgramCacheKey",
      value: function customProgramCacheKey() {
        return this.onBeforeCompile.toString();
      }
    }, {
      key: "setValues",
      value: function setValues(t) {
        if (void 0 !== t) for (var _e18 in t) {
          var _n27 = t[_e18];

          if (void 0 === _n27) {
            console.warn("THREE.Material: '" + _e18 + "' parameter is undefined.");
            continue;
          }

          if ("shading" === _e18) {
            console.warn("THREE." + this.type + ": .shading has been removed. Use the boolean .flatShading instead."), this.flatShading = 1 === _n27;
            continue;
          }

          var _i22 = this[_e18];
          void 0 !== _i22 ? _i22 && _i22.isColor ? _i22.set(_n27) : _i22 && _i22.isVector3 && _n27 && _n27.isVector3 ? _i22.copy(_n27) : this[_e18] = _n27 : console.warn("THREE." + this.type + ": '" + _e18 + "' is not a property of this material.");
        }
      }
    }, {
      key: "toJSON",
      value: function toJSON(t) {
        var e = void 0 === t || "string" == typeof t;
        e && (t = {
          textures: {},
          images: {}
        });
        var n = {
          metadata: {
            version: 4.5,
            type: "Material",
            generator: "Material.toJSON"
          }
        };

        function i(t) {
          var e = [];

          for (var _n28 in t) {
            var _i23 = t[_n28];
            delete _i23.metadata, e.push(_i23);
          }

          return e;
        }

        if (n.uuid = this.uuid, n.type = this.type, "" !== this.name && (n.name = this.name), this.color && this.color.isColor && (n.color = this.color.getHex()), void 0 !== this.roughness && (n.roughness = this.roughness), void 0 !== this.metalness && (n.metalness = this.metalness), this.sheen && this.sheen.isColor && (n.sheen = this.sheen.getHex()), this.emissive && this.emissive.isColor && (n.emissive = this.emissive.getHex()), this.emissiveIntensity && 1 !== this.emissiveIntensity && (n.emissiveIntensity = this.emissiveIntensity), this.specular && this.specular.isColor && (n.specular = this.specular.getHex()), void 0 !== this.specularIntensity && (n.specularIntensity = this.specularIntensity), this.specularTint && this.specularTint.isColor && (n.specularTint = this.specularTint.getHex()), void 0 !== this.shininess && (n.shininess = this.shininess), void 0 !== this.clearcoat && (n.clearcoat = this.clearcoat), void 0 !== this.clearcoatRoughness && (n.clearcoatRoughness = this.clearcoatRoughness), this.clearcoatMap && this.clearcoatMap.isTexture && (n.clearcoatMap = this.clearcoatMap.toJSON(t).uuid), this.clearcoatRoughnessMap && this.clearcoatRoughnessMap.isTexture && (n.clearcoatRoughnessMap = this.clearcoatRoughnessMap.toJSON(t).uuid), this.clearcoatNormalMap && this.clearcoatNormalMap.isTexture && (n.clearcoatNormalMap = this.clearcoatNormalMap.toJSON(t).uuid, n.clearcoatNormalScale = this.clearcoatNormalScale.toArray()), this.map && this.map.isTexture && (n.map = this.map.toJSON(t).uuid), this.matcap && this.matcap.isTexture && (n.matcap = this.matcap.toJSON(t).uuid), this.alphaMap && this.alphaMap.isTexture && (n.alphaMap = this.alphaMap.toJSON(t).uuid), this.lightMap && this.lightMap.isTexture && (n.lightMap = this.lightMap.toJSON(t).uuid, n.lightMapIntensity = this.lightMapIntensity), this.aoMap && this.aoMap.isTexture && (n.aoMap = this.aoMap.toJSON(t).uuid, n.aoMapIntensity = this.aoMapIntensity), this.bumpMap && this.bumpMap.isTexture && (n.bumpMap = this.bumpMap.toJSON(t).uuid, n.bumpScale = this.bumpScale), this.normalMap && this.normalMap.isTexture && (n.normalMap = this.normalMap.toJSON(t).uuid, n.normalMapType = this.normalMapType, n.normalScale = this.normalScale.toArray()), this.displacementMap && this.displacementMap.isTexture && (n.displacementMap = this.displacementMap.toJSON(t).uuid, n.displacementScale = this.displacementScale, n.displacementBias = this.displacementBias), this.roughnessMap && this.roughnessMap.isTexture && (n.roughnessMap = this.roughnessMap.toJSON(t).uuid), this.metalnessMap && this.metalnessMap.isTexture && (n.metalnessMap = this.metalnessMap.toJSON(t).uuid), this.emissiveMap && this.emissiveMap.isTexture && (n.emissiveMap = this.emissiveMap.toJSON(t).uuid), this.specularMap && this.specularMap.isTexture && (n.specularMap = this.specularMap.toJSON(t).uuid), this.specularIntensityMap && this.specularIntensityMap.isTexture && (n.specularIntensityMap = this.specularIntensityMap.toJSON(t).uuid), this.specularTintMap && this.specularTintMap.isTexture && (n.specularTintMap = this.specularTintMap.toJSON(t).uuid), this.envMap && this.envMap.isTexture && (n.envMap = this.envMap.toJSON(t).uuid, void 0 !== this.combine && (n.combine = this.combine)), void 0 !== this.envMapIntensity && (n.envMapIntensity = this.envMapIntensity), void 0 !== this.reflectivity && (n.reflectivity = this.reflectivity), void 0 !== this.refractionRatio && (n.refractionRatio = this.refractionRatio), this.gradientMap && this.gradientMap.isTexture && (n.gradientMap = this.gradientMap.toJSON(t).uuid), void 0 !== this.transmission && (n.transmission = this.transmission), this.transmissionMap && this.transmissionMap.isTexture && (n.transmissionMap = this.transmissionMap.toJSON(t).uuid), void 0 !== this.thickness && (n.thickness = this.thickness), this.thicknessMap && this.thicknessMap.isTexture && (n.thicknessMap = this.thicknessMap.toJSON(t).uuid), void 0 !== this.attenuationDistance && (n.attenuationDistance = this.attenuationDistance), void 0 !== this.attenuationTint && (n.attenuationTint = this.attenuationTint.getHex()), void 0 !== this.size && (n.size = this.size), null !== this.shadowSide && (n.shadowSide = this.shadowSide), void 0 !== this.sizeAttenuation && (n.sizeAttenuation = this.sizeAttenuation), 1 !== this.blending && (n.blending = this.blending), 0 !== this.side && (n.side = this.side), this.vertexColors && (n.vertexColors = !0), this.opacity < 1 && (n.opacity = this.opacity), !0 === this.transparent && (n.transparent = this.transparent), n.depthFunc = this.depthFunc, n.depthTest = this.depthTest, n.depthWrite = this.depthWrite, n.colorWrite = this.colorWrite, n.stencilWrite = this.stencilWrite, n.stencilWriteMask = this.stencilWriteMask, n.stencilFunc = this.stencilFunc, n.stencilRef = this.stencilRef, n.stencilFuncMask = this.stencilFuncMask, n.stencilFail = this.stencilFail, n.stencilZFail = this.stencilZFail, n.stencilZPass = this.stencilZPass, this.rotation && 0 !== this.rotation && (n.rotation = this.rotation), !0 === this.polygonOffset && (n.polygonOffset = !0), 0 !== this.polygonOffsetFactor && (n.polygonOffsetFactor = this.polygonOffsetFactor), 0 !== this.polygonOffsetUnits && (n.polygonOffsetUnits = this.polygonOffsetUnits), this.linewidth && 1 !== this.linewidth && (n.linewidth = this.linewidth), void 0 !== this.dashSize && (n.dashSize = this.dashSize), void 0 !== this.gapSize && (n.gapSize = this.gapSize), void 0 !== this.scale && (n.scale = this.scale), !0 === this.dithering && (n.dithering = !0), this.alphaTest > 0 && (n.alphaTest = this.alphaTest), !0 === this.alphaToCoverage && (n.alphaToCoverage = this.alphaToCoverage), !0 === this.premultipliedAlpha && (n.premultipliedAlpha = this.premultipliedAlpha), !0 === this.wireframe && (n.wireframe = this.wireframe), this.wireframeLinewidth > 1 && (n.wireframeLinewidth = this.wireframeLinewidth), "round" !== this.wireframeLinecap && (n.wireframeLinecap = this.wireframeLinecap), "round" !== this.wireframeLinejoin && (n.wireframeLinejoin = this.wireframeLinejoin), !0 === this.flatShading && (n.flatShading = this.flatShading), !1 === this.visible && (n.visible = !1), !1 === this.toneMapped && (n.toneMapped = !1), "{}" !== JSON.stringify(this.userData) && (n.userData = this.userData), e) {
          var _e19 = i(t.textures),
              _r13 = i(t.images);

          _e19.length > 0 && (n.textures = _e19), _r13.length > 0 && (n.images = _r13);
        }

        return n;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        this.name = t.name, this.fog = t.fog, this.blending = t.blending, this.side = t.side, this.vertexColors = t.vertexColors, this.opacity = t.opacity, this.transparent = t.transparent, this.blendSrc = t.blendSrc, this.blendDst = t.blendDst, this.blendEquation = t.blendEquation, this.blendSrcAlpha = t.blendSrcAlpha, this.blendDstAlpha = t.blendDstAlpha, this.blendEquationAlpha = t.blendEquationAlpha, this.depthFunc = t.depthFunc, this.depthTest = t.depthTest, this.depthWrite = t.depthWrite, this.stencilWriteMask = t.stencilWriteMask, this.stencilFunc = t.stencilFunc, this.stencilRef = t.stencilRef, this.stencilFuncMask = t.stencilFuncMask, this.stencilFail = t.stencilFail, this.stencilZFail = t.stencilZFail, this.stencilZPass = t.stencilZPass, this.stencilWrite = t.stencilWrite;
        var e = t.clippingPlanes;
        var n = null;

        if (null !== e) {
          var _t29 = e.length;
          n = new Array(_t29);

          for (var _i24 = 0; _i24 !== _t29; ++_i24) {
            n[_i24] = e[_i24].clone();
          }
        }

        return this.clippingPlanes = n, this.clipIntersection = t.clipIntersection, this.clipShadows = t.clipShadows, this.shadowSide = t.shadowSide, this.colorWrite = t.colorWrite, this.precision = t.precision, this.polygonOffset = t.polygonOffset, this.polygonOffsetFactor = t.polygonOffsetFactor, this.polygonOffsetUnits = t.polygonOffsetUnits, this.dithering = t.dithering, this.alphaTest = t.alphaTest, this.alphaToCoverage = t.alphaToCoverage, this.premultipliedAlpha = t.premultipliedAlpha, this.visible = t.visible, this.toneMapped = t.toneMapped, this.userData = JSON.parse(JSON.stringify(t.userData)), this;
      }
    }, {
      key: "dispose",
      value: function dispose() {
        this.dispatchEvent({
          type: "dispose"
        });
      }
    }, {
      key: "needsUpdate",
      set: function set(t) {
        !0 === t && this.version++;
      }
    }]);

    return We;
  }(rt);

  We.prototype.isMaterial = !0;
  var je = {
    aliceblue: 15792383,
    antiquewhite: 16444375,
    aqua: 65535,
    aquamarine: 8388564,
    azure: 15794175,
    beige: 16119260,
    bisque: 16770244,
    black: 0,
    blanchedalmond: 16772045,
    blue: 255,
    blueviolet: 9055202,
    brown: 10824234,
    burlywood: 14596231,
    cadetblue: 6266528,
    chartreuse: 8388352,
    chocolate: 13789470,
    coral: 16744272,
    cornflowerblue: 6591981,
    cornsilk: 16775388,
    crimson: 14423100,
    cyan: 65535,
    darkblue: 139,
    darkcyan: 35723,
    darkgoldenrod: 12092939,
    darkgray: 11119017,
    darkgreen: 25600,
    darkgrey: 11119017,
    darkkhaki: 12433259,
    darkmagenta: 9109643,
    darkolivegreen: 5597999,
    darkorange: 16747520,
    darkorchid: 10040012,
    darkred: 9109504,
    darksalmon: 15308410,
    darkseagreen: 9419919,
    darkslateblue: 4734347,
    darkslategray: 3100495,
    darkslategrey: 3100495,
    darkturquoise: 52945,
    darkviolet: 9699539,
    deeppink: 16716947,
    deepskyblue: 49151,
    dimgray: 6908265,
    dimgrey: 6908265,
    dodgerblue: 2003199,
    firebrick: 11674146,
    floralwhite: 16775920,
    forestgreen: 2263842,
    fuchsia: 16711935,
    gainsboro: 14474460,
    ghostwhite: 16316671,
    gold: 16766720,
    goldenrod: 14329120,
    gray: 8421504,
    green: 32768,
    greenyellow: 11403055,
    grey: 8421504,
    honeydew: 15794160,
    hotpink: 16738740,
    indianred: 13458524,
    indigo: 4915330,
    ivory: 16777200,
    khaki: 15787660,
    lavender: 15132410,
    lavenderblush: 16773365,
    lawngreen: 8190976,
    lemonchiffon: 16775885,
    lightblue: 11393254,
    lightcoral: 15761536,
    lightcyan: 14745599,
    lightgoldenrodyellow: 16448210,
    lightgray: 13882323,
    lightgreen: 9498256,
    lightgrey: 13882323,
    lightpink: 16758465,
    lightsalmon: 16752762,
    lightseagreen: 2142890,
    lightskyblue: 8900346,
    lightslategray: 7833753,
    lightslategrey: 7833753,
    lightsteelblue: 11584734,
    lightyellow: 16777184,
    lime: 65280,
    limegreen: 3329330,
    linen: 16445670,
    magenta: 16711935,
    maroon: 8388608,
    mediumaquamarine: 6737322,
    mediumblue: 205,
    mediumorchid: 12211667,
    mediumpurple: 9662683,
    mediumseagreen: 3978097,
    mediumslateblue: 8087790,
    mediumspringgreen: 64154,
    mediumturquoise: 4772300,
    mediumvioletred: 13047173,
    midnightblue: 1644912,
    mintcream: 16121850,
    mistyrose: 16770273,
    moccasin: 16770229,
    navajowhite: 16768685,
    navy: 128,
    oldlace: 16643558,
    olive: 8421376,
    olivedrab: 7048739,
    orange: 16753920,
    orangered: 16729344,
    orchid: 14315734,
    palegoldenrod: 15657130,
    palegreen: 10025880,
    paleturquoise: 11529966,
    palevioletred: 14381203,
    papayawhip: 16773077,
    peachpuff: 16767673,
    peru: 13468991,
    pink: 16761035,
    plum: 14524637,
    powderblue: 11591910,
    purple: 8388736,
    rebeccapurple: 6697881,
    red: 16711680,
    rosybrown: 12357519,
    royalblue: 4286945,
    saddlebrown: 9127187,
    salmon: 16416882,
    sandybrown: 16032864,
    seagreen: 3050327,
    seashell: 16774638,
    sienna: 10506797,
    silver: 12632256,
    skyblue: 8900331,
    slateblue: 6970061,
    slategray: 7372944,
    slategrey: 7372944,
    snow: 16775930,
    springgreen: 65407,
    steelblue: 4620980,
    tan: 13808780,
    teal: 32896,
    thistle: 14204888,
    tomato: 16737095,
    turquoise: 4251856,
    violet: 15631086,
    wheat: 16113331,
    white: 16777215,
    whitesmoke: 16119285,
    yellow: 16776960,
    yellowgreen: 10145074
  },
      qe = {
    h: 0,
    s: 0,
    l: 0
  },
      Xe = {
    h: 0,
    s: 0,
    l: 0
  };

  function Ye(t, e, n) {
    return n < 0 && (n += 1), n > 1 && (n -= 1), n < 1 / 6 ? t + 6 * (e - t) * n : n < .5 ? e : n < 2 / 3 ? t + 6 * (e - t) * (2 / 3 - n) : t;
  }

  function Je(t) {
    return t < .04045 ? .0773993808 * t : Math.pow(.9478672986 * t + .0521327014, 2.4);
  }

  function Ze(t) {
    return t < .0031308 ? 12.92 * t : 1.055 * Math.pow(t, .41666) - .055;
  }

  var Qe = /*#__PURE__*/function () {
    function Qe(t, e, n) {
      _classCallCheck(this, Qe);

      return void 0 === e && void 0 === n ? this.set(t) : this.setRGB(t, e, n);
    }

    _createClass(Qe, [{
      key: "set",
      value: function set(t) {
        return t && t.isColor ? this.copy(t) : "number" == typeof t ? this.setHex(t) : "string" == typeof t && this.setStyle(t), this;
      }
    }, {
      key: "setScalar",
      value: function setScalar(t) {
        return this.r = t, this.g = t, this.b = t, this;
      }
    }, {
      key: "setHex",
      value: function setHex(t) {
        return t = Math.floor(t), this.r = (t >> 16 & 255) / 255, this.g = (t >> 8 & 255) / 255, this.b = (255 & t) / 255, this;
      }
    }, {
      key: "setRGB",
      value: function setRGB(t, e, n) {
        return this.r = t, this.g = e, this.b = n, this;
      }
    }, {
      key: "setHSL",
      value: function setHSL(t, e, n) {
        if (t = ut(t, 1), e = ht(e, 0, 1), n = ht(n, 0, 1), 0 === e) this.r = this.g = this.b = n;else {
          var _i25 = n <= .5 ? n * (1 + e) : n + e - n * e,
              _r14 = 2 * n - _i25;

          this.r = Ye(_r14, _i25, t + 1 / 3), this.g = Ye(_r14, _i25, t), this.b = Ye(_r14, _i25, t - 1 / 3);
        }
        return this;
      }
    }, {
      key: "setStyle",
      value: function setStyle(t) {
        function e(e) {
          void 0 !== e && parseFloat(e) < 1 && console.warn("THREE.Color: Alpha component of " + t + " will be ignored.");
        }

        var n;

        if (n = /^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)) {
          var _t30;

          var _i26 = n[1],
              _r15 = n[2];

          switch (_i26) {
            case "rgb":
            case "rgba":
              if (_t30 = /^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(_r15)) return this.r = Math.min(255, parseInt(_t30[1], 10)) / 255, this.g = Math.min(255, parseInt(_t30[2], 10)) / 255, this.b = Math.min(255, parseInt(_t30[3], 10)) / 255, e(_t30[4]), this;
              if (_t30 = /^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(_r15)) return this.r = Math.min(100, parseInt(_t30[1], 10)) / 100, this.g = Math.min(100, parseInt(_t30[2], 10)) / 100, this.b = Math.min(100, parseInt(_t30[3], 10)) / 100, e(_t30[4]), this;
              break;

            case "hsl":
            case "hsla":
              if (_t30 = /^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(_r15)) {
                var _n29 = parseFloat(_t30[1]) / 360,
                    _i27 = parseInt(_t30[2], 10) / 100,
                    _r16 = parseInt(_t30[3], 10) / 100;

                return e(_t30[4]), this.setHSL(_n29, _i27, _r16);
              }

          }
        } else if (n = /^\#([A-Fa-f\d]+)$/.exec(t)) {
          var _t31 = n[1],
              _e20 = _t31.length;
          if (3 === _e20) return this.r = parseInt(_t31.charAt(0) + _t31.charAt(0), 16) / 255, this.g = parseInt(_t31.charAt(1) + _t31.charAt(1), 16) / 255, this.b = parseInt(_t31.charAt(2) + _t31.charAt(2), 16) / 255, this;
          if (6 === _e20) return this.r = parseInt(_t31.charAt(0) + _t31.charAt(1), 16) / 255, this.g = parseInt(_t31.charAt(2) + _t31.charAt(3), 16) / 255, this.b = parseInt(_t31.charAt(4) + _t31.charAt(5), 16) / 255, this;
        }

        return t && t.length > 0 ? this.setColorName(t) : this;
      }
    }, {
      key: "setColorName",
      value: function setColorName(t) {
        var e = je[t.toLowerCase()];
        return void 0 !== e ? this.setHex(e) : console.warn("THREE.Color: Unknown color " + t), this;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor(this.r, this.g, this.b);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.r = t.r, this.g = t.g, this.b = t.b, this;
      }
    }, {
      key: "copyGammaToLinear",
      value: function copyGammaToLinear(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 2;
        return this.r = Math.pow(t.r, e), this.g = Math.pow(t.g, e), this.b = Math.pow(t.b, e), this;
      }
    }, {
      key: "copyLinearToGamma",
      value: function copyLinearToGamma(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 2;
        var n = e > 0 ? 1 / e : 1;
        return this.r = Math.pow(t.r, n), this.g = Math.pow(t.g, n), this.b = Math.pow(t.b, n), this;
      }
    }, {
      key: "convertGammaToLinear",
      value: function convertGammaToLinear(t) {
        return this.copyGammaToLinear(this, t), this;
      }
    }, {
      key: "convertLinearToGamma",
      value: function convertLinearToGamma(t) {
        return this.copyLinearToGamma(this, t), this;
      }
    }, {
      key: "copySRGBToLinear",
      value: function copySRGBToLinear(t) {
        return this.r = Je(t.r), this.g = Je(t.g), this.b = Je(t.b), this;
      }
    }, {
      key: "copyLinearToSRGB",
      value: function copyLinearToSRGB(t) {
        return this.r = Ze(t.r), this.g = Ze(t.g), this.b = Ze(t.b), this;
      }
    }, {
      key: "convertSRGBToLinear",
      value: function convertSRGBToLinear() {
        return this.copySRGBToLinear(this), this;
      }
    }, {
      key: "convertLinearToSRGB",
      value: function convertLinearToSRGB() {
        return this.copyLinearToSRGB(this), this;
      }
    }, {
      key: "getHex",
      value: function getHex() {
        return 255 * this.r << 16 ^ 255 * this.g << 8 ^ 255 * this.b << 0;
      }
    }, {
      key: "getHexString",
      value: function getHexString() {
        return ("000000" + this.getHex().toString(16)).slice(-6);
      }
    }, {
      key: "getHSL",
      value: function getHSL(t) {
        var e = this.r,
            n = this.g,
            i = this.b,
            r = Math.max(e, n, i),
            s = Math.min(e, n, i);
        var a, o;
        var l = (s + r) / 2;
        if (s === r) a = 0, o = 0;else {
          var _t32 = r - s;

          switch (o = l <= .5 ? _t32 / (r + s) : _t32 / (2 - r - s), r) {
            case e:
              a = (n - i) / _t32 + (n < i ? 6 : 0);
              break;

            case n:
              a = (i - e) / _t32 + 2;
              break;

            case i:
              a = (e - n) / _t32 + 4;
          }

          a /= 6;
        }
        return t.h = a, t.s = o, t.l = l, t;
      }
    }, {
      key: "getStyle",
      value: function getStyle() {
        return "rgb(" + (255 * this.r | 0) + "," + (255 * this.g | 0) + "," + (255 * this.b | 0) + ")";
      }
    }, {
      key: "offsetHSL",
      value: function offsetHSL(t, e, n) {
        return this.getHSL(qe), qe.h += t, qe.s += e, qe.l += n, this.setHSL(qe.h, qe.s, qe.l), this;
      }
    }, {
      key: "add",
      value: function add(t) {
        return this.r += t.r, this.g += t.g, this.b += t.b, this;
      }
    }, {
      key: "addColors",
      value: function addColors(t, e) {
        return this.r = t.r + e.r, this.g = t.g + e.g, this.b = t.b + e.b, this;
      }
    }, {
      key: "addScalar",
      value: function addScalar(t) {
        return this.r += t, this.g += t, this.b += t, this;
      }
    }, {
      key: "sub",
      value: function sub(t) {
        return this.r = Math.max(0, this.r - t.r), this.g = Math.max(0, this.g - t.g), this.b = Math.max(0, this.b - t.b), this;
      }
    }, {
      key: "multiply",
      value: function multiply(t) {
        return this.r *= t.r, this.g *= t.g, this.b *= t.b, this;
      }
    }, {
      key: "multiplyScalar",
      value: function multiplyScalar(t) {
        return this.r *= t, this.g *= t, this.b *= t, this;
      }
    }, {
      key: "lerp",
      value: function lerp(t, e) {
        return this.r += (t.r - this.r) * e, this.g += (t.g - this.g) * e, this.b += (t.b - this.b) * e, this;
      }
    }, {
      key: "lerpColors",
      value: function lerpColors(t, e, n) {
        return this.r = t.r + (e.r - t.r) * n, this.g = t.g + (e.g - t.g) * n, this.b = t.b + (e.b - t.b) * n, this;
      }
    }, {
      key: "lerpHSL",
      value: function lerpHSL(t, e) {
        this.getHSL(qe), t.getHSL(Xe);
        var n = dt(qe.h, Xe.h, e),
            i = dt(qe.s, Xe.s, e),
            r = dt(qe.l, Xe.l, e);
        return this.setHSL(n, i, r), this;
      }
    }, {
      key: "equals",
      value: function equals(t) {
        return t.r === this.r && t.g === this.g && t.b === this.b;
      }
    }, {
      key: "fromArray",
      value: function fromArray(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        return this.r = t[e], this.g = t[e + 1], this.b = t[e + 2], this;
      }
    }, {
      key: "toArray",
      value: function toArray() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        return t[e] = this.r, t[e + 1] = this.g, t[e + 2] = this.b, t;
      }
    }, {
      key: "fromBufferAttribute",
      value: function fromBufferAttribute(t, e) {
        return this.r = t.getX(e), this.g = t.getY(e), this.b = t.getZ(e), !0 === t.normalized && (this.r /= 255, this.g /= 255, this.b /= 255), this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        return this.getHex();
      }
    }]);

    return Qe;
  }();

  Qe.NAMES = je, Qe.prototype.isColor = !0, Qe.prototype.r = 1, Qe.prototype.g = 1, Qe.prototype.b = 1;

  var Ke = /*#__PURE__*/function (_We) {
    _inherits(Ke, _We);

    var _super7 = _createSuper(Ke);

    function Ke(t) {
      var _this7;

      _classCallCheck(this, Ke);

      _this7 = _super7.call(this), _this7.type = "MeshBasicMaterial", _this7.color = new Qe(16777215), _this7.map = null, _this7.lightMap = null, _this7.lightMapIntensity = 1, _this7.aoMap = null, _this7.aoMapIntensity = 1, _this7.specularMap = null, _this7.alphaMap = null, _this7.envMap = null, _this7.combine = 0, _this7.reflectivity = 1, _this7.refractionRatio = .98, _this7.wireframe = !1, _this7.wireframeLinewidth = 1, _this7.wireframeLinecap = "round", _this7.wireframeLinejoin = "round", _this7.setValues(t);
      return _this7;
    }

    _createClass(Ke, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Ke.prototype), "copy", this).call(this, t), this.color.copy(t.color), this.map = t.map, this.lightMap = t.lightMap, this.lightMapIntensity = t.lightMapIntensity, this.aoMap = t.aoMap, this.aoMapIntensity = t.aoMapIntensity, this.specularMap = t.specularMap, this.alphaMap = t.alphaMap, this.envMap = t.envMap, this.combine = t.combine, this.reflectivity = t.reflectivity, this.refractionRatio = t.refractionRatio, this.wireframe = t.wireframe, this.wireframeLinewidth = t.wireframeLinewidth, this.wireframeLinecap = t.wireframeLinecap, this.wireframeLinejoin = t.wireframeLinejoin, this;
      }
    }]);

    return Ke;
  }(We);

  Ke.prototype.isMeshBasicMaterial = !0;
  var $e = new Rt(),
      tn = new vt();

  var en = /*#__PURE__*/function () {
    function en(t, e, n) {
      _classCallCheck(this, en);

      if (Array.isArray(t)) throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");
      this.name = "", this.array = t, this.itemSize = e, this.count = void 0 !== t ? t.length / e : 0, this.normalized = !0 === n, this.usage = et, this.updateRange = {
        offset: 0,
        count: -1
      }, this.version = 0;
    }

    _createClass(en, [{
      key: "onUploadCallback",
      value: function onUploadCallback() {}
    }, {
      key: "needsUpdate",
      set: function set(t) {
        !0 === t && this.version++;
      }
    }, {
      key: "setUsage",
      value: function setUsage(t) {
        return this.usage = t, this;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.name = t.name, this.array = new t.array.constructor(t.array), this.itemSize = t.itemSize, this.count = t.count, this.normalized = t.normalized, this.usage = t.usage, this;
      }
    }, {
      key: "copyAt",
      value: function copyAt(t, e, n) {
        t *= this.itemSize, n *= e.itemSize;

        for (var _i28 = 0, _r17 = this.itemSize; _i28 < _r17; _i28++) {
          this.array[t + _i28] = e.array[n + _i28];
        }

        return this;
      }
    }, {
      key: "copyArray",
      value: function copyArray(t) {
        return this.array.set(t), this;
      }
    }, {
      key: "copyColorsArray",
      value: function copyColorsArray(t) {
        var e = this.array;
        var n = 0;

        for (var _i29 = 0, _r18 = t.length; _i29 < _r18; _i29++) {
          var _r19 = t[_i29];
          void 0 === _r19 && (console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined", _i29), _r19 = new Qe()), e[n++] = _r19.r, e[n++] = _r19.g, e[n++] = _r19.b;
        }

        return this;
      }
    }, {
      key: "copyVector2sArray",
      value: function copyVector2sArray(t) {
        var e = this.array;
        var n = 0;

        for (var _i30 = 0, _r20 = t.length; _i30 < _r20; _i30++) {
          var _r21 = t[_i30];
          void 0 === _r21 && (console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined", _i30), _r21 = new vt()), e[n++] = _r21.x, e[n++] = _r21.y;
        }

        return this;
      }
    }, {
      key: "copyVector3sArray",
      value: function copyVector3sArray(t) {
        var e = this.array;
        var n = 0;

        for (var _i31 = 0, _r22 = t.length; _i31 < _r22; _i31++) {
          var _r23 = t[_i31];
          void 0 === _r23 && (console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined", _i31), _r23 = new Rt()), e[n++] = _r23.x, e[n++] = _r23.y, e[n++] = _r23.z;
        }

        return this;
      }
    }, {
      key: "copyVector4sArray",
      value: function copyVector4sArray(t) {
        var e = this.array;
        var n = 0;

        for (var _i32 = 0, _r24 = t.length; _i32 < _r24; _i32++) {
          var _r25 = t[_i32];
          void 0 === _r25 && (console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined", _i32), _r25 = new St()), e[n++] = _r25.x, e[n++] = _r25.y, e[n++] = _r25.z, e[n++] = _r25.w;
        }

        return this;
      }
    }, {
      key: "applyMatrix3",
      value: function applyMatrix3(t) {
        if (2 === this.itemSize) for (var _e21 = 0, _n30 = this.count; _e21 < _n30; _e21++) {
          tn.fromBufferAttribute(this, _e21), tn.applyMatrix3(t), this.setXY(_e21, tn.x, tn.y);
        } else if (3 === this.itemSize) for (var _e22 = 0, _n31 = this.count; _e22 < _n31; _e22++) {
          $e.fromBufferAttribute(this, _e22), $e.applyMatrix3(t), this.setXYZ(_e22, $e.x, $e.y, $e.z);
        }
        return this;
      }
    }, {
      key: "applyMatrix4",
      value: function applyMatrix4(t) {
        for (var _e23 = 0, _n32 = this.count; _e23 < _n32; _e23++) {
          $e.x = this.getX(_e23), $e.y = this.getY(_e23), $e.z = this.getZ(_e23), $e.applyMatrix4(t), this.setXYZ(_e23, $e.x, $e.y, $e.z);
        }

        return this;
      }
    }, {
      key: "applyNormalMatrix",
      value: function applyNormalMatrix(t) {
        for (var _e24 = 0, _n33 = this.count; _e24 < _n33; _e24++) {
          $e.x = this.getX(_e24), $e.y = this.getY(_e24), $e.z = this.getZ(_e24), $e.applyNormalMatrix(t), this.setXYZ(_e24, $e.x, $e.y, $e.z);
        }

        return this;
      }
    }, {
      key: "transformDirection",
      value: function transformDirection(t) {
        for (var _e25 = 0, _n34 = this.count; _e25 < _n34; _e25++) {
          $e.x = this.getX(_e25), $e.y = this.getY(_e25), $e.z = this.getZ(_e25), $e.transformDirection(t), this.setXYZ(_e25, $e.x, $e.y, $e.z);
        }

        return this;
      }
    }, {
      key: "set",
      value: function set(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        return this.array.set(t, e), this;
      }
    }, {
      key: "getX",
      value: function getX(t) {
        return this.array[t * this.itemSize];
      }
    }, {
      key: "setX",
      value: function setX(t, e) {
        return this.array[t * this.itemSize] = e, this;
      }
    }, {
      key: "getY",
      value: function getY(t) {
        return this.array[t * this.itemSize + 1];
      }
    }, {
      key: "setY",
      value: function setY(t, e) {
        return this.array[t * this.itemSize + 1] = e, this;
      }
    }, {
      key: "getZ",
      value: function getZ(t) {
        return this.array[t * this.itemSize + 2];
      }
    }, {
      key: "setZ",
      value: function setZ(t, e) {
        return this.array[t * this.itemSize + 2] = e, this;
      }
    }, {
      key: "getW",
      value: function getW(t) {
        return this.array[t * this.itemSize + 3];
      }
    }, {
      key: "setW",
      value: function setW(t, e) {
        return this.array[t * this.itemSize + 3] = e, this;
      }
    }, {
      key: "setXY",
      value: function setXY(t, e, n) {
        return t *= this.itemSize, this.array[t + 0] = e, this.array[t + 1] = n, this;
      }
    }, {
      key: "setXYZ",
      value: function setXYZ(t, e, n, i) {
        return t *= this.itemSize, this.array[t + 0] = e, this.array[t + 1] = n, this.array[t + 2] = i, this;
      }
    }, {
      key: "setXYZW",
      value: function setXYZW(t, e, n, i, r) {
        return t *= this.itemSize, this.array[t + 0] = e, this.array[t + 1] = n, this.array[t + 2] = i, this.array[t + 3] = r, this;
      }
    }, {
      key: "onUpload",
      value: function onUpload(t) {
        return this.onUploadCallback = t, this;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor(this.array, this.itemSize).copy(this);
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = {
          itemSize: this.itemSize,
          type: this.array.constructor.name,
          array: Array.prototype.slice.call(this.array),
          normalized: this.normalized
        };
        return "" !== this.name && (t.name = this.name), this.usage !== et && (t.usage = this.usage), 0 === this.updateRange.offset && -1 === this.updateRange.count || (t.updateRange = this.updateRange), t;
      }
    }]);

    return en;
  }();

  en.prototype.isBufferAttribute = !0;

  var nn = /*#__PURE__*/function (_en) {
    _inherits(nn, _en);

    var _super8 = _createSuper(nn);

    function nn(t, e, n) {
      _classCallCheck(this, nn);

      return _super8.call(this, new Int8Array(t), e, n);
    }

    return nn;
  }(en);

  var rn = /*#__PURE__*/function (_en2) {
    _inherits(rn, _en2);

    var _super9 = _createSuper(rn);

    function rn(t, e, n) {
      _classCallCheck(this, rn);

      return _super9.call(this, new Uint8Array(t), e, n);
    }

    return rn;
  }(en);

  var sn = /*#__PURE__*/function (_en3) {
    _inherits(sn, _en3);

    var _super10 = _createSuper(sn);

    function sn(t, e, n) {
      _classCallCheck(this, sn);

      return _super10.call(this, new Uint8ClampedArray(t), e, n);
    }

    return sn;
  }(en);

  var an = /*#__PURE__*/function (_en4) {
    _inherits(an, _en4);

    var _super11 = _createSuper(an);

    function an(t, e, n) {
      _classCallCheck(this, an);

      return _super11.call(this, new Int16Array(t), e, n);
    }

    return an;
  }(en);

  var on = /*#__PURE__*/function (_en5) {
    _inherits(on, _en5);

    var _super12 = _createSuper(on);

    function on(t, e, n) {
      _classCallCheck(this, on);

      return _super12.call(this, new Uint16Array(t), e, n);
    }

    return on;
  }(en);

  var ln = /*#__PURE__*/function (_en6) {
    _inherits(ln, _en6);

    var _super13 = _createSuper(ln);

    function ln(t, e, n) {
      _classCallCheck(this, ln);

      return _super13.call(this, new Int32Array(t), e, n);
    }

    return ln;
  }(en);

  var cn = /*#__PURE__*/function (_en7) {
    _inherits(cn, _en7);

    var _super14 = _createSuper(cn);

    function cn(t, e, n) {
      _classCallCheck(this, cn);

      return _super14.call(this, new Uint32Array(t), e, n);
    }

    return cn;
  }(en);

  var hn = /*#__PURE__*/function (_en8) {
    _inherits(hn, _en8);

    var _super15 = _createSuper(hn);

    function hn(t, e, n) {
      _classCallCheck(this, hn);

      return _super15.call(this, new Uint16Array(t), e, n);
    }

    return hn;
  }(en);

  hn.prototype.isFloat16BufferAttribute = !0;

  var un = /*#__PURE__*/function (_en9) {
    _inherits(un, _en9);

    var _super16 = _createSuper(un);

    function un(t, e, n) {
      _classCallCheck(this, un);

      return _super16.call(this, new Float32Array(t), e, n);
    }

    return un;
  }(en);

  var dn = /*#__PURE__*/function (_en10) {
    _inherits(dn, _en10);

    var _super17 = _createSuper(dn);

    function dn(t, e, n) {
      _classCallCheck(this, dn);

      return _super17.call(this, new Float64Array(t), e, n);
    }

    return dn;
  }(en);

  function pn(t) {
    if (0 === t.length) return -1 / 0;
    var e = t[0];

    for (var _n35 = 1, _i33 = t.length; _n35 < _i33; ++_n35) {
      t[_n35] > e && (e = t[_n35]);
    }

    return e;
  }

  var mn = {
    Int8Array: Int8Array,
    Uint8Array: Uint8Array,
    Uint8ClampedArray: Uint8ClampedArray,
    Int16Array: Int16Array,
    Uint16Array: Uint16Array,
    Int32Array: Int32Array,
    Uint32Array: Uint32Array,
    Float32Array: Float32Array,
    Float64Array: Float64Array
  };

  function fn(t, e) {
    return new mn[t](e);
  }

  var gn = 0;

  var vn = new ae(),
      yn = new Pe(),
      xn = new Rt(),
      _n = new It(),
      Mn = new It(),
      bn = new Rt();

  var wn = /*#__PURE__*/function (_rt5) {
    _inherits(wn, _rt5);

    var _super18 = _createSuper(wn);

    function wn() {
      var _this8;

      _classCallCheck(this, wn);

      _this8 = _super18.call(this), Object.defineProperty(_assertThisInitialized(_this8), "id", {
        value: gn++
      }), _this8.uuid = ct(), _this8.name = "", _this8.type = "BufferGeometry", _this8.index = null, _this8.attributes = {}, _this8.morphAttributes = {}, _this8.morphTargetsRelative = !1, _this8.groups = [], _this8.boundingBox = null, _this8.boundingSphere = null, _this8.drawRange = {
        start: 0,
        count: 1 / 0
      }, _this8.userData = {};
      return _this8;
    }

    _createClass(wn, [{
      key: "getIndex",
      value: function getIndex() {
        return this.index;
      }
    }, {
      key: "setIndex",
      value: function setIndex(t) {
        return Array.isArray(t) ? this.index = new (pn(t) > 65535 ? cn : on)(t, 1) : this.index = t, this;
      }
    }, {
      key: "getAttribute",
      value: function getAttribute(t) {
        return this.attributes[t];
      }
    }, {
      key: "setAttribute",
      value: function setAttribute(t, e) {
        return this.attributes[t] = e, this;
      }
    }, {
      key: "deleteAttribute",
      value: function deleteAttribute(t) {
        return delete this.attributes[t], this;
      }
    }, {
      key: "hasAttribute",
      value: function hasAttribute(t) {
        return void 0 !== this.attributes[t];
      }
    }, {
      key: "addGroup",
      value: function addGroup(t, e) {
        var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
        this.groups.push({
          start: t,
          count: e,
          materialIndex: n
        });
      }
    }, {
      key: "clearGroups",
      value: function clearGroups() {
        this.groups = [];
      }
    }, {
      key: "setDrawRange",
      value: function setDrawRange(t, e) {
        this.drawRange.start = t, this.drawRange.count = e;
      }
    }, {
      key: "applyMatrix4",
      value: function applyMatrix4(t) {
        var e = this.attributes.position;
        void 0 !== e && (e.applyMatrix4(t), e.needsUpdate = !0);
        var n = this.attributes.normal;

        if (void 0 !== n) {
          var _e26 = new yt().getNormalMatrix(t);

          n.applyNormalMatrix(_e26), n.needsUpdate = !0;
        }

        var i = this.attributes.tangent;
        return void 0 !== i && (i.transformDirection(t), i.needsUpdate = !0), null !== this.boundingBox && this.computeBoundingBox(), null !== this.boundingSphere && this.computeBoundingSphere(), this;
      }
    }, {
      key: "applyQuaternion",
      value: function applyQuaternion(t) {
        return vn.makeRotationFromQuaternion(t), this.applyMatrix4(vn), this;
      }
    }, {
      key: "rotateX",
      value: function rotateX(t) {
        return vn.makeRotationX(t), this.applyMatrix4(vn), this;
      }
    }, {
      key: "rotateY",
      value: function rotateY(t) {
        return vn.makeRotationY(t), this.applyMatrix4(vn), this;
      }
    }, {
      key: "rotateZ",
      value: function rotateZ(t) {
        return vn.makeRotationZ(t), this.applyMatrix4(vn), this;
      }
    }, {
      key: "translate",
      value: function translate(t, e, n) {
        return vn.makeTranslation(t, e, n), this.applyMatrix4(vn), this;
      }
    }, {
      key: "scale",
      value: function scale(t, e, n) {
        return vn.makeScale(t, e, n), this.applyMatrix4(vn), this;
      }
    }, {
      key: "lookAt",
      value: function lookAt(t) {
        return yn.lookAt(t), yn.updateMatrix(), this.applyMatrix4(yn.matrix), this;
      }
    }, {
      key: "center",
      value: function center() {
        return this.computeBoundingBox(), this.boundingBox.getCenter(xn).negate(), this.translate(xn.x, xn.y, xn.z), this;
      }
    }, {
      key: "setFromPoints",
      value: function setFromPoints(t) {
        var e = [];

        for (var _n36 = 0, _i34 = t.length; _n36 < _i34; _n36++) {
          var _i35 = t[_n36];
          e.push(_i35.x, _i35.y, _i35.z || 0);
        }

        return this.setAttribute("position", new un(e, 3)), this;
      }
    }, {
      key: "computeBoundingBox",
      value: function computeBoundingBox() {
        null === this.boundingBox && (this.boundingBox = new It());
        var t = this.attributes.position,
            e = this.morphAttributes.position;
        if (t && t.isGLBufferAttribute) return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".', this), void this.boundingBox.set(new Rt(-1 / 0, -1 / 0, -1 / 0), new Rt(1 / 0, 1 / 0, 1 / 0));

        if (void 0 !== t) {
          if (this.boundingBox.setFromBufferAttribute(t), e) for (var _t33 = 0, _n37 = e.length; _t33 < _n37; _t33++) {
            var _n38 = e[_t33];
            _n.setFromBufferAttribute(_n38), this.morphTargetsRelative ? (bn.addVectors(this.boundingBox.min, _n.min), this.boundingBox.expandByPoint(bn), bn.addVectors(this.boundingBox.max, _n.max), this.boundingBox.expandByPoint(bn)) : (this.boundingBox.expandByPoint(_n.min), this.boundingBox.expandByPoint(_n.max));
          }
        } else this.boundingBox.makeEmpty();

        (isNaN(this.boundingBox.min.x) || isNaN(this.boundingBox.min.y) || isNaN(this.boundingBox.min.z)) && console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.', this);
      }
    }, {
      key: "computeBoundingSphere",
      value: function computeBoundingSphere() {
        null === this.boundingSphere && (this.boundingSphere = new Qt());
        var t = this.attributes.position,
            e = this.morphAttributes.position;
        if (t && t.isGLBufferAttribute) return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".', this), void this.boundingSphere.set(new Rt(), 1 / 0);

        if (t) {
          var _n39 = this.boundingSphere.center;
          if (_n.setFromBufferAttribute(t), e) for (var _t34 = 0, _n40 = e.length; _t34 < _n40; _t34++) {
            var _n41 = e[_t34];
            Mn.setFromBufferAttribute(_n41), this.morphTargetsRelative ? (bn.addVectors(_n.min, Mn.min), _n.expandByPoint(bn), bn.addVectors(_n.max, Mn.max), _n.expandByPoint(bn)) : (_n.expandByPoint(Mn.min), _n.expandByPoint(Mn.max));
          }

          _n.getCenter(_n39);

          var _i36 = 0;

          for (var _e27 = 0, _r26 = t.count; _e27 < _r26; _e27++) {
            bn.fromBufferAttribute(t, _e27), _i36 = Math.max(_i36, _n39.distanceToSquared(bn));
          }

          if (e) for (var _r27 = 0, _s4 = e.length; _r27 < _s4; _r27++) {
            var _s5 = e[_r27],
                _a5 = this.morphTargetsRelative;

            for (var _e28 = 0, _r28 = _s5.count; _e28 < _r28; _e28++) {
              bn.fromBufferAttribute(_s5, _e28), _a5 && (xn.fromBufferAttribute(t, _e28), bn.add(xn)), _i36 = Math.max(_i36, _n39.distanceToSquared(bn));
            }
          }
          this.boundingSphere.radius = Math.sqrt(_i36), isNaN(this.boundingSphere.radius) && console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.', this);
        }
      }
    }, {
      key: "computeFaceNormals",
      value: function computeFaceNormals() {}
    }, {
      key: "computeTangents",
      value: function computeTangents() {
        var t = this.index,
            e = this.attributes;
        if (null === t || void 0 === e.position || void 0 === e.normal || void 0 === e.uv) return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");
        var n = t.array,
            i = e.position.array,
            r = e.normal.array,
            s = e.uv.array,
            a = i.length / 3;
        void 0 === e.tangent && this.setAttribute("tangent", new en(new Float32Array(4 * a), 4));
        var o = e.tangent.array,
            l = [],
            c = [];

        for (var _t35 = 0; _t35 < a; _t35++) {
          l[_t35] = new Rt(), c[_t35] = new Rt();
        }

        var h = new Rt(),
            u = new Rt(),
            d = new Rt(),
            p = new vt(),
            m = new vt(),
            f = new vt(),
            g = new Rt(),
            v = new Rt();

        function y(t, e, n) {
          h.fromArray(i, 3 * t), u.fromArray(i, 3 * e), d.fromArray(i, 3 * n), p.fromArray(s, 2 * t), m.fromArray(s, 2 * e), f.fromArray(s, 2 * n), u.sub(h), d.sub(h), m.sub(p), f.sub(p);
          var r = 1 / (m.x * f.y - f.x * m.y);
          isFinite(r) && (g.copy(u).multiplyScalar(f.y).addScaledVector(d, -m.y).multiplyScalar(r), v.copy(d).multiplyScalar(m.x).addScaledVector(u, -f.x).multiplyScalar(r), l[t].add(g), l[e].add(g), l[n].add(g), c[t].add(v), c[e].add(v), c[n].add(v));
        }

        var x = this.groups;
        0 === x.length && (x = [{
          start: 0,
          count: n.length
        }]);

        for (var _t36 = 0, _e29 = x.length; _t36 < _e29; ++_t36) {
          var _e30 = x[_t36],
              _i37 = _e30.start;

          for (var _t37 = _i37, _r29 = _i37 + _e30.count; _t37 < _r29; _t37 += 3) {
            y(n[_t37 + 0], n[_t37 + 1], n[_t37 + 2]);
          }
        }

        var _ = new Rt(),
            M = new Rt(),
            b = new Rt(),
            w = new Rt();

        function S(t) {
          b.fromArray(r, 3 * t), w.copy(b);
          var e = l[t];
          _.copy(e), _.sub(b.multiplyScalar(b.dot(e))).normalize(), M.crossVectors(w, e);
          var n = M.dot(c[t]) < 0 ? -1 : 1;
          o[4 * t] = _.x, o[4 * t + 1] = _.y, o[4 * t + 2] = _.z, o[4 * t + 3] = n;
        }

        for (var _t38 = 0, _e31 = x.length; _t38 < _e31; ++_t38) {
          var _e32 = x[_t38],
              _i38 = _e32.start;

          for (var _t39 = _i38, _r30 = _i38 + _e32.count; _t39 < _r30; _t39 += 3) {
            S(n[_t39 + 0]), S(n[_t39 + 1]), S(n[_t39 + 2]);
          }
        }
      }
    }, {
      key: "computeVertexNormals",
      value: function computeVertexNormals() {
        var t = this.index,
            e = this.getAttribute("position");

        if (void 0 !== e) {
          var _n42 = this.getAttribute("normal");

          if (void 0 === _n42) _n42 = new en(new Float32Array(3 * e.count), 3), this.setAttribute("normal", _n42);else for (var _t40 = 0, _e33 = _n42.count; _t40 < _e33; _t40++) {
            _n42.setXYZ(_t40, 0, 0, 0);
          }

          var _i39 = new Rt(),
              _r31 = new Rt(),
              _s6 = new Rt(),
              _a6 = new Rt(),
              _o7 = new Rt(),
              _l8 = new Rt(),
              _c6 = new Rt(),
              _h4 = new Rt();

          if (t) for (var _u = 0, _d = t.count; _u < _d; _u += 3) {
            var _d2 = t.getX(_u + 0),
                _p = t.getX(_u + 1),
                _m = t.getX(_u + 2);

            _i39.fromBufferAttribute(e, _d2), _r31.fromBufferAttribute(e, _p), _s6.fromBufferAttribute(e, _m), _c6.subVectors(_s6, _r31), _h4.subVectors(_i39, _r31), _c6.cross(_h4), _a6.fromBufferAttribute(_n42, _d2), _o7.fromBufferAttribute(_n42, _p), _l8.fromBufferAttribute(_n42, _m), _a6.add(_c6), _o7.add(_c6), _l8.add(_c6), _n42.setXYZ(_d2, _a6.x, _a6.y, _a6.z), _n42.setXYZ(_p, _o7.x, _o7.y, _o7.z), _n42.setXYZ(_m, _l8.x, _l8.y, _l8.z);
          } else for (var _t41 = 0, _a7 = e.count; _t41 < _a7; _t41 += 3) {
            _i39.fromBufferAttribute(e, _t41 + 0), _r31.fromBufferAttribute(e, _t41 + 1), _s6.fromBufferAttribute(e, _t41 + 2), _c6.subVectors(_s6, _r31), _h4.subVectors(_i39, _r31), _c6.cross(_h4), _n42.setXYZ(_t41 + 0, _c6.x, _c6.y, _c6.z), _n42.setXYZ(_t41 + 1, _c6.x, _c6.y, _c6.z), _n42.setXYZ(_t41 + 2, _c6.x, _c6.y, _c6.z);
          }
          this.normalizeNormals(), _n42.needsUpdate = !0;
        }
      }
    }, {
      key: "merge",
      value: function merge(t, e) {
        if (!t || !t.isBufferGeometry) return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.", t);
        void 0 === e && (e = 0, console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));
        var n = this.attributes;

        for (var _i40 in n) {
          if (void 0 === t.attributes[_i40]) continue;

          var _r32 = n[_i40].array,
              _s7 = t.attributes[_i40],
              _a8 = _s7.array,
              _o8 = _s7.itemSize * e,
              _l9 = Math.min(_a8.length, _r32.length - _o8);

          for (var _t42 = 0, _e34 = _o8; _t42 < _l9; _t42++, _e34++) {
            _r32[_e34] = _a8[_t42];
          }
        }

        return this;
      }
    }, {
      key: "normalizeNormals",
      value: function normalizeNormals() {
        var t = this.attributes.normal;

        for (var _e35 = 0, _n43 = t.count; _e35 < _n43; _e35++) {
          bn.fromBufferAttribute(t, _e35), bn.normalize(), t.setXYZ(_e35, bn.x, bn.y, bn.z);
        }
      }
    }, {
      key: "toNonIndexed",
      value: function toNonIndexed() {
        function t(t, e) {
          var n = t.array,
              i = t.itemSize,
              r = t.normalized,
              s = new n.constructor(e.length * i);
          var a = 0,
              o = 0;

          for (var _r33 = 0, _l10 = e.length; _r33 < _l10; _r33++) {
            a = t.isInterleavedBufferAttribute ? e[_r33] * t.data.stride + t.offset : e[_r33] * i;

            for (var _t43 = 0; _t43 < i; _t43++) {
              s[o++] = n[a++];
            }
          }

          return new en(s, i, r);
        }

        if (null === this.index) return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."), this;
        var e = new wn(),
            n = this.index.array,
            i = this.attributes;

        for (var _r34 in i) {
          var _s8 = t(i[_r34], n);

          e.setAttribute(_r34, _s8);
        }

        var r = this.morphAttributes;

        for (var _i41 in r) {
          var _s9 = [],
              _a9 = r[_i41];

          for (var _e36 = 0, _i42 = _a9.length; _e36 < _i42; _e36++) {
            var _i43 = t(_a9[_e36], n);

            _s9.push(_i43);
          }

          e.morphAttributes[_i41] = _s9;
        }

        e.morphTargetsRelative = this.morphTargetsRelative;
        var s = this.groups;

        for (var _t44 = 0, _n44 = s.length; _t44 < _n44; _t44++) {
          var _n45 = s[_t44];
          e.addGroup(_n45.start, _n45.count, _n45.materialIndex);
        }

        return e;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = {
          metadata: {
            version: 4.5,
            type: "BufferGeometry",
            generator: "BufferGeometry.toJSON"
          }
        };

        if (t.uuid = this.uuid, t.type = this.type, "" !== this.name && (t.name = this.name), Object.keys(this.userData).length > 0 && (t.userData = this.userData), void 0 !== this.parameters) {
          var _e37 = this.parameters;

          for (var _n46 in _e37) {
            void 0 !== _e37[_n46] && (t[_n46] = _e37[_n46]);
          }

          return t;
        }

        t.data = {
          attributes: {}
        };
        var e = this.index;
        null !== e && (t.data.index = {
          type: e.array.constructor.name,
          array: Array.prototype.slice.call(e.array)
        });
        var n = this.attributes;

        for (var _e38 in n) {
          var _i44 = n[_e38];
          t.data.attributes[_e38] = _i44.toJSON(t.data);
        }

        var i = {};
        var r = !1;

        for (var _e39 in this.morphAttributes) {
          var _n47 = this.morphAttributes[_e39],
              _s10 = [];

          for (var _e40 = 0, _i45 = _n47.length; _e40 < _i45; _e40++) {
            var _i46 = _n47[_e40];

            _s10.push(_i46.toJSON(t.data));
          }

          _s10.length > 0 && (i[_e39] = _s10, r = !0);
        }

        r && (t.data.morphAttributes = i, t.data.morphTargetsRelative = this.morphTargetsRelative);
        var s = this.groups;
        s.length > 0 && (t.data.groups = JSON.parse(JSON.stringify(s)));
        var a = this.boundingSphere;
        return null !== a && (t.data.boundingSphere = {
          center: a.center.toArray(),
          radius: a.radius
        }), t;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new wn().copy(this);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        this.index = null, this.attributes = {}, this.morphAttributes = {}, this.groups = [], this.boundingBox = null, this.boundingSphere = null;
        var e = {};
        this.name = t.name;
        var n = t.index;
        null !== n && this.setIndex(n.clone(e));
        var i = t.attributes;

        for (var _t45 in i) {
          var _n48 = i[_t45];
          this.setAttribute(_t45, _n48.clone(e));
        }

        var r = t.morphAttributes;

        for (var _t46 in r) {
          var _n49 = [],
              _i47 = r[_t46];

          for (var _t47 = 0, _r35 = _i47.length; _t47 < _r35; _t47++) {
            _n49.push(_i47[_t47].clone(e));
          }

          this.morphAttributes[_t46] = _n49;
        }

        this.morphTargetsRelative = t.morphTargetsRelative;
        var s = t.groups;

        for (var _t48 = 0, _e41 = s.length; _t48 < _e41; _t48++) {
          var _e42 = s[_t48];
          this.addGroup(_e42.start, _e42.count, _e42.materialIndex);
        }

        var a = t.boundingBox;
        null !== a && (this.boundingBox = a.clone());
        var o = t.boundingSphere;
        return null !== o && (this.boundingSphere = o.clone()), this.drawRange.start = t.drawRange.start, this.drawRange.count = t.drawRange.count, this.userData = t.userData, this;
      }
    }, {
      key: "dispose",
      value: function dispose() {
        this.dispatchEvent({
          type: "dispose"
        });
      }
    }]);

    return wn;
  }(rt);

  wn.prototype.isBufferGeometry = !0;
  var Sn = new ae(),
      Tn = new se(),
      En = new Qt(),
      An = new Rt(),
      Ln = new Rt(),
      Rn = new Rt(),
      Cn = new Rt(),
      Pn = new Rt(),
      In = new Rt(),
      Dn = new Rt(),
      Nn = new Rt(),
      Bn = new Rt(),
      zn = new vt(),
      Fn = new vt(),
      On = new vt(),
      Un = new Rt(),
      Hn = new Rt();

  var Gn = /*#__PURE__*/function (_Pe) {
    _inherits(Gn, _Pe);

    var _super19 = _createSuper(Gn);

    function Gn() {
      var _this9;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new wn();
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Ke();

      _classCallCheck(this, Gn);

      _this9 = _super19.call(this), _this9.type = "Mesh", _this9.geometry = t, _this9.material = e, _this9.updateMorphTargets();
      return _this9;
    }

    _createClass(Gn, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Gn.prototype), "copy", this).call(this, t), void 0 !== t.morphTargetInfluences && (this.morphTargetInfluences = t.morphTargetInfluences.slice()), void 0 !== t.morphTargetDictionary && (this.morphTargetDictionary = Object.assign({}, t.morphTargetDictionary)), this.material = t.material, this.geometry = t.geometry, this;
      }
    }, {
      key: "updateMorphTargets",
      value: function updateMorphTargets() {
        var t = this.geometry;

        if (t.isBufferGeometry) {
          var _e43 = t.morphAttributes,
              _n50 = Object.keys(_e43);

          if (_n50.length > 0) {
            var _t49 = _e43[_n50[0]];

            if (void 0 !== _t49) {
              this.morphTargetInfluences = [], this.morphTargetDictionary = {};

              for (var _e44 = 0, _n51 = _t49.length; _e44 < _n51; _e44++) {
                var _n52 = _t49[_e44].name || String(_e44);

                this.morphTargetInfluences.push(0), this.morphTargetDictionary[_n52] = _e44;
              }
            }
          }
        } else {
          var _e45 = t.morphTargets;
          void 0 !== _e45 && _e45.length > 0 && console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");
        }
      }
    }, {
      key: "raycast",
      value: function raycast(t, e) {
        var n = this.geometry,
            i = this.material,
            r = this.matrixWorld;
        if (void 0 === i) return;
        if (null === n.boundingSphere && n.computeBoundingSphere(), En.copy(n.boundingSphere), En.applyMatrix4(r), !1 === t.ray.intersectsSphere(En)) return;
        if (Sn.copy(r).invert(), Tn.copy(t.ray).applyMatrix4(Sn), null !== n.boundingBox && !1 === Tn.intersectsBox(n.boundingBox)) return;
        var s;

        if (n.isBufferGeometry) {
          var _r36 = n.index,
              _a10 = n.attributes.position,
              _o9 = n.morphAttributes.position,
              _l11 = n.morphTargetsRelative,
              _c7 = n.attributes.uv,
              _h5 = n.attributes.uv2,
              _u2 = n.groups,
              _d3 = n.drawRange;
          if (null !== _r36) {
            if (Array.isArray(i)) for (var _n53 = 0, _p2 = _u2.length; _n53 < _p2; _n53++) {
              var _p3 = _u2[_n53],
                  _m2 = i[_p3.materialIndex];

              for (var _n54 = Math.max(_p3.start, _d3.start), _i48 = Math.min(_p3.start + _p3.count, _d3.start + _d3.count); _n54 < _i48; _n54 += 3) {
                var _i49 = _r36.getX(_n54),
                    _u3 = _r36.getX(_n54 + 1),
                    _d4 = _r36.getX(_n54 + 2);

                s = kn(this, _m2, t, Tn, _a10, _o9, _l11, _c7, _h5, _i49, _u3, _d4), s && (s.faceIndex = Math.floor(_n54 / 3), s.face.materialIndex = _p3.materialIndex, e.push(s));
              }
            } else {
              for (var _n55 = Math.max(0, _d3.start), _u4 = Math.min(_r36.count, _d3.start + _d3.count); _n55 < _u4; _n55 += 3) {
                var _u5 = _r36.getX(_n55),
                    _d5 = _r36.getX(_n55 + 1),
                    _p4 = _r36.getX(_n55 + 2);

                s = kn(this, i, t, Tn, _a10, _o9, _l11, _c7, _h5, _u5, _d5, _p4), s && (s.faceIndex = Math.floor(_n55 / 3), e.push(s));
              }
            }
          } else if (void 0 !== _a10) if (Array.isArray(i)) for (var _n56 = 0, _r37 = _u2.length; _n56 < _r37; _n56++) {
            var _r38 = _u2[_n56],
                _p5 = i[_r38.materialIndex];

            for (var _n57 = Math.max(_r38.start, _d3.start), _i50 = Math.min(_r38.start + _r38.count, _d3.start + _d3.count); _n57 < _i50; _n57 += 3) {
              s = kn(this, _p5, t, Tn, _a10, _o9, _l11, _c7, _h5, _n57, _n57 + 1, _n57 + 2), s && (s.faceIndex = Math.floor(_n57 / 3), s.face.materialIndex = _r38.materialIndex, e.push(s));
            }
          } else {
            for (var _n58 = Math.max(0, _d3.start), _r39 = Math.min(_a10.count, _d3.start + _d3.count); _n58 < _r39; _n58 += 3) {
              s = kn(this, i, t, Tn, _a10, _o9, _l11, _c7, _h5, _n58, _n58 + 1, _n58 + 2), s && (s.faceIndex = Math.floor(_n58 / 3), e.push(s));
            }
          }
        } else n.isGeometry && console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");
      }
    }]);

    return Gn;
  }(Pe);

  function kn(t, e, n, i, r, s, a, o, l, c, h, u) {
    An.fromBufferAttribute(r, c), Ln.fromBufferAttribute(r, h), Rn.fromBufferAttribute(r, u);
    var d = t.morphTargetInfluences;

    if (s && d) {
      Dn.set(0, 0, 0), Nn.set(0, 0, 0), Bn.set(0, 0, 0);

      for (var _t50 = 0, _e46 = s.length; _t50 < _e46; _t50++) {
        var _e47 = d[_t50],
            _n59 = s[_t50];
        0 !== _e47 && (Cn.fromBufferAttribute(_n59, c), Pn.fromBufferAttribute(_n59, h), In.fromBufferAttribute(_n59, u), a ? (Dn.addScaledVector(Cn, _e47), Nn.addScaledVector(Pn, _e47), Bn.addScaledVector(In, _e47)) : (Dn.addScaledVector(Cn.sub(An), _e47), Nn.addScaledVector(Pn.sub(Ln), _e47), Bn.addScaledVector(In.sub(Rn), _e47)));
      }

      An.add(Dn), Ln.add(Nn), Rn.add(Bn);
    }

    t.isSkinnedMesh && (t.boneTransform(c, An), t.boneTransform(h, Ln), t.boneTransform(u, Rn));

    var p = function (t, e, n, i, r, s, a, o) {
      var l;
      if (l = 1 === e.side ? i.intersectTriangle(a, s, r, !0, o) : i.intersectTriangle(r, s, a, 2 !== e.side, o), null === l) return null;
      Hn.copy(o), Hn.applyMatrix4(t.matrixWorld);
      var c = n.ray.origin.distanceTo(Hn);
      return c < n.near || c > n.far ? null : {
        distance: c,
        point: Hn.clone(),
        object: t
      };
    }(t, e, n, i, An, Ln, Rn, Un);

    if (p) {
      o && (zn.fromBufferAttribute(o, c), Fn.fromBufferAttribute(o, h), On.fromBufferAttribute(o, u), p.uv = ke.getUV(Un, An, Ln, Rn, zn, Fn, On, new vt())), l && (zn.fromBufferAttribute(l, c), Fn.fromBufferAttribute(l, h), On.fromBufferAttribute(l, u), p.uv2 = ke.getUV(Un, An, Ln, Rn, zn, Fn, On, new vt()));
      var _t51 = {
        a: c,
        b: h,
        c: u,
        normal: new Rt(),
        materialIndex: 0
      };
      ke.getNormal(An, Ln, Rn, _t51.normal), p.face = _t51;
    }

    return p;
  }

  Gn.prototype.isMesh = !0;

  var Vn = /*#__PURE__*/function (_wn) {
    _inherits(Vn, _wn);

    var _super20 = _createSuper(Vn);

    function Vn() {
      var _this10;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;
      var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 1;

      _classCallCheck(this, Vn);

      _this10 = _super20.call(this), _this10.type = "BoxGeometry", _this10.parameters = {
        width: t,
        height: e,
        depth: n,
        widthSegments: i,
        heightSegments: r,
        depthSegments: s
      };

      var a = _assertThisInitialized(_this10);

      i = Math.floor(i), r = Math.floor(r), s = Math.floor(s);
      var o = [],
          l = [],
          c = [],
          h = [];
      var u = 0,
          d = 0;

      function p(t, e, n, i, r, s, p, m, f, g, v) {
        var y = s / f,
            x = p / g,
            _ = s / 2,
            M = p / 2,
            b = m / 2,
            w = f + 1,
            S = g + 1;

        var T = 0,
            E = 0;
        var A = new Rt();

        for (var _s11 = 0; _s11 < S; _s11++) {
          var _a11 = _s11 * x - M;

          for (var _o10 = 0; _o10 < w; _o10++) {
            var _u6 = _o10 * y - _;

            A[t] = _u6 * i, A[e] = _a11 * r, A[n] = b, l.push(A.x, A.y, A.z), A[t] = 0, A[e] = 0, A[n] = m > 0 ? 1 : -1, c.push(A.x, A.y, A.z), h.push(_o10 / f), h.push(1 - _s11 / g), T += 1;
          }
        }

        for (var _t52 = 0; _t52 < g; _t52++) {
          for (var _e48 = 0; _e48 < f; _e48++) {
            var _n60 = u + _e48 + w * _t52,
                _i51 = u + _e48 + w * (_t52 + 1),
                _r40 = u + (_e48 + 1) + w * (_t52 + 1),
                _s12 = u + (_e48 + 1) + w * _t52;

            o.push(_n60, _i51, _s12), o.push(_i51, _r40, _s12), E += 6;
          }
        }

        a.addGroup(d, E, v), d += E, u += T;
      }

      p("z", "y", "x", -1, -1, n, e, t, s, r, 0), p("z", "y", "x", 1, -1, n, e, -t, s, r, 1), p("x", "z", "y", 1, 1, t, n, e, i, s, 2), p("x", "z", "y", 1, -1, t, n, -e, i, s, 3), p("x", "y", "z", 1, -1, t, e, n, i, r, 4), p("x", "y", "z", -1, -1, t, e, -n, i, r, 5), _this10.setIndex(o), _this10.setAttribute("position", new un(l, 3)), _this10.setAttribute("normal", new un(c, 3)), _this10.setAttribute("uv", new un(h, 2));
      return _this10;
    }

    _createClass(Vn, null, [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new Vn(t.width, t.height, t.depth, t.widthSegments, t.heightSegments, t.depthSegments);
      }
    }]);

    return Vn;
  }(wn);

  function Wn(t) {
    var e = {};

    for (var _n61 in t) {
      e[_n61] = {};

      for (var _i52 in t[_n61]) {
        var _r41 = t[_n61][_i52];
        _r41 && (_r41.isColor || _r41.isMatrix3 || _r41.isMatrix4 || _r41.isVector2 || _r41.isVector3 || _r41.isVector4 || _r41.isTexture || _r41.isQuaternion) ? e[_n61][_i52] = _r41.clone() : Array.isArray(_r41) ? e[_n61][_i52] = _r41.slice() : e[_n61][_i52] = _r41;
      }
    }

    return e;
  }

  function jn(t) {
    var e = {};

    for (var _n62 = 0; _n62 < t.length; _n62++) {
      var _i53 = Wn(t[_n62]);

      for (var _t53 in _i53) {
        e[_t53] = _i53[_t53];
      }
    }

    return e;
  }

  var qn = {
    clone: Wn,
    merge: jn
  };

  var Xn = /*#__PURE__*/function (_We2) {
    _inherits(Xn, _We2);

    var _super21 = _createSuper(Xn);

    function Xn(t) {
      var _this11;

      _classCallCheck(this, Xn);

      _this11 = _super21.call(this), _this11.type = "ShaderMaterial", _this11.defines = {}, _this11.uniforms = {}, _this11.vertexShader = "void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}", _this11.fragmentShader = "void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}", _this11.linewidth = 1, _this11.wireframe = !1, _this11.wireframeLinewidth = 1, _this11.fog = !1, _this11.lights = !1, _this11.clipping = !1, _this11.extensions = {
        derivatives: !1,
        fragDepth: !1,
        drawBuffers: !1,
        shaderTextureLOD: !1
      }, _this11.defaultAttributeValues = {
        color: [1, 1, 1],
        uv: [0, 0],
        uv2: [0, 0]
      }, _this11.index0AttributeName = void 0, _this11.uniformsNeedUpdate = !1, _this11.glslVersion = null, void 0 !== t && (void 0 !== t.attributes && console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."), _this11.setValues(t));
      return _this11;
    }

    _createClass(Xn, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Xn.prototype), "copy", this).call(this, t), this.fragmentShader = t.fragmentShader, this.vertexShader = t.vertexShader, this.uniforms = Wn(t.uniforms), this.defines = Object.assign({}, t.defines), this.wireframe = t.wireframe, this.wireframeLinewidth = t.wireframeLinewidth, this.lights = t.lights, this.clipping = t.clipping, this.extensions = Object.assign({}, t.extensions), this.glslVersion = t.glslVersion, this;
      }
    }, {
      key: "toJSON",
      value: function toJSON(t) {
        var e = _get(_getPrototypeOf(Xn.prototype), "toJSON", this).call(this, t);

        e.glslVersion = this.glslVersion, e.uniforms = {};

        for (var _n63 in this.uniforms) {
          var _i54 = this.uniforms[_n63].value;
          _i54 && _i54.isTexture ? e.uniforms[_n63] = {
            type: "t",
            value: _i54.toJSON(t).uuid
          } : _i54 && _i54.isColor ? e.uniforms[_n63] = {
            type: "c",
            value: _i54.getHex()
          } : _i54 && _i54.isVector2 ? e.uniforms[_n63] = {
            type: "v2",
            value: _i54.toArray()
          } : _i54 && _i54.isVector3 ? e.uniforms[_n63] = {
            type: "v3",
            value: _i54.toArray()
          } : _i54 && _i54.isVector4 ? e.uniforms[_n63] = {
            type: "v4",
            value: _i54.toArray()
          } : _i54 && _i54.isMatrix3 ? e.uniforms[_n63] = {
            type: "m3",
            value: _i54.toArray()
          } : _i54 && _i54.isMatrix4 ? e.uniforms[_n63] = {
            type: "m4",
            value: _i54.toArray()
          } : e.uniforms[_n63] = {
            value: _i54
          };
        }

        Object.keys(this.defines).length > 0 && (e.defines = this.defines), e.vertexShader = this.vertexShader, e.fragmentShader = this.fragmentShader;
        var n = {};

        for (var _t54 in this.extensions) {
          !0 === this.extensions[_t54] && (n[_t54] = !0);
        }

        return Object.keys(n).length > 0 && (e.extensions = n), e;
      }
    }]);

    return Xn;
  }(We);

  Xn.prototype.isShaderMaterial = !0;

  var Yn = /*#__PURE__*/function (_Pe2) {
    _inherits(Yn, _Pe2);

    var _super22 = _createSuper(Yn);

    function Yn() {
      var _this12;

      _classCallCheck(this, Yn);

      _this12 = _super22.call(this), _this12.type = "Camera", _this12.matrixWorldInverse = new ae(), _this12.projectionMatrix = new ae(), _this12.projectionMatrixInverse = new ae();
      return _this12;
    }

    _createClass(Yn, [{
      key: "copy",
      value: function copy(t, e) {
        return _get(_getPrototypeOf(Yn.prototype), "copy", this).call(this, t, e), this.matrixWorldInverse.copy(t.matrixWorldInverse), this.projectionMatrix.copy(t.projectionMatrix), this.projectionMatrixInverse.copy(t.projectionMatrixInverse), this;
      }
    }, {
      key: "getWorldDirection",
      value: function getWorldDirection(t) {
        this.updateWorldMatrix(!0, !1);
        var e = this.matrixWorld.elements;
        return t.set(-e[8], -e[9], -e[10]).normalize();
      }
    }, {
      key: "updateMatrixWorld",
      value: function updateMatrixWorld(t) {
        _get(_getPrototypeOf(Yn.prototype), "updateMatrixWorld", this).call(this, t), this.matrixWorldInverse.copy(this.matrixWorld).invert();
      }
    }, {
      key: "updateWorldMatrix",
      value: function updateWorldMatrix(t, e) {
        _get(_getPrototypeOf(Yn.prototype), "updateWorldMatrix", this).call(this, t, e), this.matrixWorldInverse.copy(this.matrixWorld).invert();
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }]);

    return Yn;
  }(Pe);

  Yn.prototype.isCamera = !0;

  var Jn = /*#__PURE__*/function (_Yn) {
    _inherits(Jn, _Yn);

    var _super23 = _createSuper(Jn);

    function Jn() {
      var _this13;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 50;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : .1;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 2e3;

      _classCallCheck(this, Jn);

      _this13 = _super23.call(this), _this13.type = "PerspectiveCamera", _this13.fov = t, _this13.zoom = 1, _this13.near = n, _this13.far = i, _this13.focus = 10, _this13.aspect = e, _this13.view = null, _this13.filmGauge = 35, _this13.filmOffset = 0, _this13.updateProjectionMatrix();
      return _this13;
    }

    _createClass(Jn, [{
      key: "copy",
      value: function copy(t, e) {
        return _get(_getPrototypeOf(Jn.prototype), "copy", this).call(this, t, e), this.fov = t.fov, this.zoom = t.zoom, this.near = t.near, this.far = t.far, this.focus = t.focus, this.aspect = t.aspect, this.view = null === t.view ? null : Object.assign({}, t.view), this.filmGauge = t.filmGauge, this.filmOffset = t.filmOffset, this;
      }
    }, {
      key: "setFocalLength",
      value: function setFocalLength(t) {
        var e = .5 * this.getFilmHeight() / t;
        this.fov = 2 * lt * Math.atan(e), this.updateProjectionMatrix();
      }
    }, {
      key: "getFocalLength",
      value: function getFocalLength() {
        var t = Math.tan(.5 * ot * this.fov);
        return .5 * this.getFilmHeight() / t;
      }
    }, {
      key: "getEffectiveFOV",
      value: function getEffectiveFOV() {
        return 2 * lt * Math.atan(Math.tan(.5 * ot * this.fov) / this.zoom);
      }
    }, {
      key: "getFilmWidth",
      value: function getFilmWidth() {
        return this.filmGauge * Math.min(this.aspect, 1);
      }
    }, {
      key: "getFilmHeight",
      value: function getFilmHeight() {
        return this.filmGauge / Math.max(this.aspect, 1);
      }
    }, {
      key: "setViewOffset",
      value: function setViewOffset(t, e, n, i, r, s) {
        this.aspect = t / e, null === this.view && (this.view = {
          enabled: !0,
          fullWidth: 1,
          fullHeight: 1,
          offsetX: 0,
          offsetY: 0,
          width: 1,
          height: 1
        }), this.view.enabled = !0, this.view.fullWidth = t, this.view.fullHeight = e, this.view.offsetX = n, this.view.offsetY = i, this.view.width = r, this.view.height = s, this.updateProjectionMatrix();
      }
    }, {
      key: "clearViewOffset",
      value: function clearViewOffset() {
        null !== this.view && (this.view.enabled = !1), this.updateProjectionMatrix();
      }
    }, {
      key: "updateProjectionMatrix",
      value: function updateProjectionMatrix() {
        var t = this.near;
        var e = t * Math.tan(.5 * ot * this.fov) / this.zoom,
            n = 2 * e,
            i = this.aspect * n,
            r = -.5 * i;
        var s = this.view;

        if (null !== this.view && this.view.enabled) {
          var _t55 = s.fullWidth,
              _a12 = s.fullHeight;
          r += s.offsetX * i / _t55, e -= s.offsetY * n / _a12, i *= s.width / _t55, n *= s.height / _a12;
        }

        var a = this.filmOffset;
        0 !== a && (r += t * a / this.getFilmWidth()), this.projectionMatrix.makePerspective(r, r + i, e, e - n, t, this.far), this.projectionMatrixInverse.copy(this.projectionMatrix).invert();
      }
    }, {
      key: "toJSON",
      value: function toJSON(t) {
        var e = _get(_getPrototypeOf(Jn.prototype), "toJSON", this).call(this, t);

        return e.object.fov = this.fov, e.object.zoom = this.zoom, e.object.near = this.near, e.object.far = this.far, e.object.focus = this.focus, e.object.aspect = this.aspect, null !== this.view && (e.object.view = Object.assign({}, this.view)), e.object.filmGauge = this.filmGauge, e.object.filmOffset = this.filmOffset, e;
      }
    }]);

    return Jn;
  }(Yn);

  Jn.prototype.isPerspectiveCamera = !0;
  var Zn = 90;

  var Qn = /*#__PURE__*/function (_Pe3) {
    _inherits(Qn, _Pe3);

    var _super24 = _createSuper(Qn);

    function Qn(t, e, n) {
      var _this14;

      _classCallCheck(this, Qn);

      if (_this14 = _super24.call(this), _this14.type = "CubeCamera", !0 !== n.isWebGLCubeRenderTarget) return _possibleConstructorReturn(_this14, void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."));
      _this14.renderTarget = n;
      var i = new Jn(Zn, 1, t, e);
      i.layers = _this14.layers, i.up.set(0, -1, 0), i.lookAt(new Rt(1, 0, 0)), _this14.add(i);
      var r = new Jn(Zn, 1, t, e);
      r.layers = _this14.layers, r.up.set(0, -1, 0), r.lookAt(new Rt(-1, 0, 0)), _this14.add(r);
      var s = new Jn(Zn, 1, t, e);
      s.layers = _this14.layers, s.up.set(0, 0, 1), s.lookAt(new Rt(0, 1, 0)), _this14.add(s);
      var a = new Jn(Zn, 1, t, e);
      a.layers = _this14.layers, a.up.set(0, 0, -1), a.lookAt(new Rt(0, -1, 0)), _this14.add(a);
      var o = new Jn(Zn, 1, t, e);
      o.layers = _this14.layers, o.up.set(0, -1, 0), o.lookAt(new Rt(0, 0, 1)), _this14.add(o);
      var l = new Jn(Zn, 1, t, e);
      l.layers = _this14.layers, l.up.set(0, -1, 0), l.lookAt(new Rt(0, 0, -1)), _this14.add(l);
      return _possibleConstructorReturn(_this14);
    }

    _createClass(Qn, [{
      key: "update",
      value: function update(t, e) {
        null === this.parent && this.updateMatrixWorld();

        var n = this.renderTarget,
            _this$children = _slicedToArray(this.children, 6),
            i = _this$children[0],
            r = _this$children[1],
            s = _this$children[2],
            a = _this$children[3],
            o = _this$children[4],
            l = _this$children[5],
            c = t.xr.enabled,
            h = t.getRenderTarget();

        t.xr.enabled = !1;
        var u = n.texture.generateMipmaps;
        n.texture.generateMipmaps = !1, t.setRenderTarget(n, 0), t.render(e, i), t.setRenderTarget(n, 1), t.render(e, r), t.setRenderTarget(n, 2), t.render(e, s), t.setRenderTarget(n, 3), t.render(e, a), t.setRenderTarget(n, 4), t.render(e, o), n.texture.generateMipmaps = u, t.setRenderTarget(n, 5), t.render(e, l), t.setRenderTarget(h), t.xr.enabled = c;
      }
    }]);

    return Qn;
  }(Pe);

  var Kn = /*#__PURE__*/function (_bt) {
    _inherits(Kn, _bt);

    var _super25 = _createSuper(Kn);

    function Kn(t, e, n, i, s, a, o, l, c, h) {
      var _this15;

      _classCallCheck(this, Kn);

      _this15 = _super25.call(this, t = void 0 !== t ? t : [], e = void 0 !== e ? e : r, n, i, s, a, o = void 0 !== o ? o : T, l, c, h), _this15.flipY = !1;
      return _this15;
    }

    _createClass(Kn, [{
      key: "images",
      get: function get() {
        return this.image;
      },
      set: function set(t) {
        this.image = t;
      }
    }]);

    return Kn;
  }(bt);

  Kn.prototype.isCubeTexture = !0;

  var $n = /*#__PURE__*/function (_Tt3) {
    _inherits($n, _Tt3);

    var _super26 = _createSuper($n);

    function $n(t, e, n) {
      var _this16;

      _classCallCheck(this, $n);

      Number.isInteger(e) && (console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"), e = n), _this16 = _super26.call(this, t, t, e), e = e || {}, _this16.texture = new Kn(void 0, e.mapping, e.wrapS, e.wrapT, e.magFilter, e.minFilter, e.format, e.type, e.anisotropy, e.encoding), _this16.texture.isRenderTargetTexture = !0, _this16.texture.generateMipmaps = void 0 !== e.generateMipmaps && e.generateMipmaps, _this16.texture.minFilter = void 0 !== e.minFilter ? e.minFilter : g, _this16.texture._needsFlipEnvMap = !1;
      return _this16;
    }

    _createClass($n, [{
      key: "fromEquirectangularTexture",
      value: function fromEquirectangularTexture(t, e) {
        this.texture.type = e.type, this.texture.format = E, this.texture.encoding = e.encoding, this.texture.generateMipmaps = e.generateMipmaps, this.texture.minFilter = e.minFilter, this.texture.magFilter = e.magFilter;
        var n = {
          uniforms: {
            tEquirect: {
              value: null
            }
          },
          vertexShader: "\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",
          fragmentShader: "\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t"
        },
            i = new Vn(5, 5, 5),
            r = new Xn({
          name: "CubemapFromEquirect",
          uniforms: Wn(n.uniforms),
          vertexShader: n.vertexShader,
          fragmentShader: n.fragmentShader,
          side: 1,
          blending: 0
        });
        r.uniforms.tEquirect.value = e;
        var s = new Gn(i, r),
            a = e.minFilter;
        e.minFilter === y && (e.minFilter = g);
        return new Qn(1, 10, this).update(t, s), e.minFilter = a, s.geometry.dispose(), s.material.dispose(), this;
      }
    }, {
      key: "clear",
      value: function clear(t, e, n, i) {
        var r = t.getRenderTarget();

        for (var _r42 = 0; _r42 < 6; _r42++) {
          t.setRenderTarget(this, _r42), t.clear(e, n, i);
        }

        t.setRenderTarget(r);
      }
    }]);

    return $n;
  }(Tt);

  $n.prototype.isWebGLCubeRenderTarget = !0;
  var ti = new Rt(),
      ei = new Rt(),
      ni = new yt();

  var ii = /*#__PURE__*/function () {
    function ii() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Rt(1, 0, 0);
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;

      _classCallCheck(this, ii);

      this.normal = t, this.constant = e;
    }

    _createClass(ii, [{
      key: "set",
      value: function set(t, e) {
        return this.normal.copy(t), this.constant = e, this;
      }
    }, {
      key: "setComponents",
      value: function setComponents(t, e, n, i) {
        return this.normal.set(t, e, n), this.constant = i, this;
      }
    }, {
      key: "setFromNormalAndCoplanarPoint",
      value: function setFromNormalAndCoplanarPoint(t, e) {
        return this.normal.copy(t), this.constant = -e.dot(this.normal), this;
      }
    }, {
      key: "setFromCoplanarPoints",
      value: function setFromCoplanarPoints(t, e, n) {
        var i = ti.subVectors(n, e).cross(ei.subVectors(t, e)).normalize();
        return this.setFromNormalAndCoplanarPoint(i, t), this;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.normal.copy(t.normal), this.constant = t.constant, this;
      }
    }, {
      key: "normalize",
      value: function normalize() {
        var t = 1 / this.normal.length();
        return this.normal.multiplyScalar(t), this.constant *= t, this;
      }
    }, {
      key: "negate",
      value: function negate() {
        return this.constant *= -1, this.normal.negate(), this;
      }
    }, {
      key: "distanceToPoint",
      value: function distanceToPoint(t) {
        return this.normal.dot(t) + this.constant;
      }
    }, {
      key: "distanceToSphere",
      value: function distanceToSphere(t) {
        return this.distanceToPoint(t.center) - t.radius;
      }
    }, {
      key: "projectPoint",
      value: function projectPoint(t, e) {
        return e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t);
      }
    }, {
      key: "intersectLine",
      value: function intersectLine(t, e) {
        var n = t.delta(ti),
            i = this.normal.dot(n);
        if (0 === i) return 0 === this.distanceToPoint(t.start) ? e.copy(t.start) : null;
        var r = -(t.start.dot(this.normal) + this.constant) / i;
        return r < 0 || r > 1 ? null : e.copy(n).multiplyScalar(r).add(t.start);
      }
    }, {
      key: "intersectsLine",
      value: function intersectsLine(t) {
        var e = this.distanceToPoint(t.start),
            n = this.distanceToPoint(t.end);
        return e < 0 && n > 0 || n < 0 && e > 0;
      }
    }, {
      key: "intersectsBox",
      value: function intersectsBox(t) {
        return t.intersectsPlane(this);
      }
    }, {
      key: "intersectsSphere",
      value: function intersectsSphere(t) {
        return t.intersectsPlane(this);
      }
    }, {
      key: "coplanarPoint",
      value: function coplanarPoint(t) {
        return t.copy(this.normal).multiplyScalar(-this.constant);
      }
    }, {
      key: "applyMatrix4",
      value: function applyMatrix4(t, e) {
        var n = e || ni.getNormalMatrix(t),
            i = this.coplanarPoint(ti).applyMatrix4(t),
            r = this.normal.applyMatrix3(n).normalize();
        return this.constant = -i.dot(r), this;
      }
    }, {
      key: "translate",
      value: function translate(t) {
        return this.constant -= t.dot(this.normal), this;
      }
    }, {
      key: "equals",
      value: function equals(t) {
        return t.normal.equals(this.normal) && t.constant === this.constant;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }]);

    return ii;
  }();

  ii.prototype.isPlane = !0;
  var ri = new Qt(),
      si = new Rt();

  var ai = /*#__PURE__*/function () {
    function ai() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new ii();
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new ii();
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new ii();
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : new ii();
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : new ii();
      var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : new ii();

      _classCallCheck(this, ai);

      this.planes = [t, e, n, i, r, s];
    }

    _createClass(ai, [{
      key: "set",
      value: function set(t, e, n, i, r, s) {
        var a = this.planes;
        return a[0].copy(t), a[1].copy(e), a[2].copy(n), a[3].copy(i), a[4].copy(r), a[5].copy(s), this;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        var e = this.planes;

        for (var _n64 = 0; _n64 < 6; _n64++) {
          e[_n64].copy(t.planes[_n64]);
        }

        return this;
      }
    }, {
      key: "setFromProjectionMatrix",
      value: function setFromProjectionMatrix(t) {
        var e = this.planes,
            n = t.elements,
            i = n[0],
            r = n[1],
            s = n[2],
            a = n[3],
            o = n[4],
            l = n[5],
            c = n[6],
            h = n[7],
            u = n[8],
            d = n[9],
            p = n[10],
            m = n[11],
            f = n[12],
            g = n[13],
            v = n[14],
            y = n[15];
        return e[0].setComponents(a - i, h - o, m - u, y - f).normalize(), e[1].setComponents(a + i, h + o, m + u, y + f).normalize(), e[2].setComponents(a + r, h + l, m + d, y + g).normalize(), e[3].setComponents(a - r, h - l, m - d, y - g).normalize(), e[4].setComponents(a - s, h - c, m - p, y - v).normalize(), e[5].setComponents(a + s, h + c, m + p, y + v).normalize(), this;
      }
    }, {
      key: "intersectsObject",
      value: function intersectsObject(t) {
        var e = t.geometry;
        return null === e.boundingSphere && e.computeBoundingSphere(), ri.copy(e.boundingSphere).applyMatrix4(t.matrixWorld), this.intersectsSphere(ri);
      }
    }, {
      key: "intersectsSprite",
      value: function intersectsSprite(t) {
        return ri.center.set(0, 0, 0), ri.radius = .7071067811865476, ri.applyMatrix4(t.matrixWorld), this.intersectsSphere(ri);
      }
    }, {
      key: "intersectsSphere",
      value: function intersectsSphere(t) {
        var e = this.planes,
            n = t.center,
            i = -t.radius;

        for (var _t56 = 0; _t56 < 6; _t56++) {
          if (e[_t56].distanceToPoint(n) < i) return !1;
        }

        return !0;
      }
    }, {
      key: "intersectsBox",
      value: function intersectsBox(t) {
        var e = this.planes;

        for (var _n65 = 0; _n65 < 6; _n65++) {
          var _i55 = e[_n65];
          if (si.x = _i55.normal.x > 0 ? t.max.x : t.min.x, si.y = _i55.normal.y > 0 ? t.max.y : t.min.y, si.z = _i55.normal.z > 0 ? t.max.z : t.min.z, _i55.distanceToPoint(si) < 0) return !1;
        }

        return !0;
      }
    }, {
      key: "containsPoint",
      value: function containsPoint(t) {
        var e = this.planes;

        for (var _n66 = 0; _n66 < 6; _n66++) {
          if (e[_n66].distanceToPoint(t) < 0) return !1;
        }

        return !0;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }]);

    return ai;
  }();

  function oi() {
    var t = null,
        e = !1,
        n = null,
        i = null;

    function r(e, s) {
      n(e, s), i = t.requestAnimationFrame(r);
    }

    return {
      start: function start() {
        !0 !== e && null !== n && (i = t.requestAnimationFrame(r), e = !0);
      },
      stop: function stop() {
        t.cancelAnimationFrame(i), e = !1;
      },
      setAnimationLoop: function setAnimationLoop(t) {
        n = t;
      },
      setContext: function setContext(e) {
        t = e;
      }
    };
  }

  function li(t, e) {
    var n = e.isWebGL2,
        i = new WeakMap();
    return {
      get: function get(t) {
        return t.isInterleavedBufferAttribute && (t = t.data), i.get(t);
      },
      remove: function remove(e) {
        e.isInterleavedBufferAttribute && (e = e.data);
        var n = i.get(e);
        n && (t.deleteBuffer(n.buffer), i.delete(e));
      },
      update: function update(e, r) {
        if (e.isGLBufferAttribute) {
          var _t57 = i.get(e);

          return void ((!_t57 || _t57.version < e.version) && i.set(e, {
            buffer: e.buffer,
            type: e.type,
            bytesPerElement: e.elementSize,
            version: e.version
          }));
        }

        e.isInterleavedBufferAttribute && (e = e.data);
        var s = i.get(e);
        void 0 === s ? i.set(e, function (e, i) {
          var r = e.array,
              s = e.usage,
              a = t.createBuffer();
          t.bindBuffer(i, a), t.bufferData(i, r, s), e.onUploadCallback();
          var o = 5126;
          return r instanceof Float32Array ? o = 5126 : r instanceof Float64Array ? console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.") : r instanceof Uint16Array ? e.isFloat16BufferAttribute ? n ? o = 5131 : console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.") : o = 5123 : r instanceof Int16Array ? o = 5122 : r instanceof Uint32Array ? o = 5125 : r instanceof Int32Array ? o = 5124 : r instanceof Int8Array ? o = 5120 : (r instanceof Uint8Array || r instanceof Uint8ClampedArray) && (o = 5121), {
            buffer: a,
            type: o,
            bytesPerElement: r.BYTES_PER_ELEMENT,
            version: e.version
          };
        }(e, r)) : s.version < e.version && (!function (e, i, r) {
          var s = i.array,
              a = i.updateRange;
          t.bindBuffer(r, e), -1 === a.count ? t.bufferSubData(r, 0, s) : (n ? t.bufferSubData(r, a.offset * s.BYTES_PER_ELEMENT, s, a.offset, a.count) : t.bufferSubData(r, a.offset * s.BYTES_PER_ELEMENT, s.subarray(a.offset, a.offset + a.count)), a.count = -1);
        }(s.buffer, e, r), s.version = e.version);
      }
    };
  }

  var ci = /*#__PURE__*/function (_wn2) {
    _inherits(ci, _wn2);

    var _super27 = _createSuper(ci);

    function ci() {
      var _this17;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;

      _classCallCheck(this, ci);

      _this17 = _super27.call(this), _this17.type = "PlaneGeometry", _this17.parameters = {
        width: t,
        height: e,
        widthSegments: n,
        heightSegments: i
      };
      var r = t / 2,
          s = e / 2,
          a = Math.floor(n),
          o = Math.floor(i),
          l = a + 1,
          c = o + 1,
          h = t / a,
          u = e / o,
          d = [],
          p = [],
          m = [],
          f = [];

      for (var _t58 = 0; _t58 < c; _t58++) {
        var _e49 = _t58 * u - s;

        for (var _n67 = 0; _n67 < l; _n67++) {
          var _i56 = _n67 * h - r;

          p.push(_i56, -_e49, 0), m.push(0, 0, 1), f.push(_n67 / a), f.push(1 - _t58 / o);
        }
      }

      for (var _t59 = 0; _t59 < o; _t59++) {
        for (var _e50 = 0; _e50 < a; _e50++) {
          var _n68 = _e50 + l * _t59,
              _i57 = _e50 + l * (_t59 + 1),
              _r43 = _e50 + 1 + l * (_t59 + 1),
              _s13 = _e50 + 1 + l * _t59;

          d.push(_n68, _i57, _s13), d.push(_i57, _r43, _s13);
        }
      }

      _this17.setIndex(d), _this17.setAttribute("position", new un(p, 3)), _this17.setAttribute("normal", new un(m, 3)), _this17.setAttribute("uv", new un(f, 2));
      return _this17;
    }

    _createClass(ci, null, [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new ci(t.width, t.height, t.widthSegments, t.heightSegments);
      }
    }]);

    return ci;
  }(wn);

  var hi = {
    alphamap_fragment: "#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",
    alphamap_pars_fragment: "#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",
    alphatest_fragment: "#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",
    aomap_fragment: "#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",
    aomap_pars_fragment: "#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",
    begin_vertex: "vec3 transformed = vec3( position );",
    beginnormal_vertex: "vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",
    bsdfs: "vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in vec3 f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn ( f90 - f0 ) * fresnel + f0;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in vec3 f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, vec3( 1.0 ), dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",
    bumpmap_pars_fragment: "#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",
    clipping_planes_fragment: "#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",
    clipping_planes_pars_fragment: "#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",
    clipping_planes_pars_vertex: "#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",
    clipping_planes_vertex: "#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",
    color_fragment: "#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",
    color_pars_fragment: "#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",
    color_pars_vertex: "#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",
    color_vertex: "#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",
    common: "#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",
    cube_uv_reflection_fragment: "#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",
    defaultnormal_vertex: "vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",
    displacementmap_pars_vertex: "#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",
    displacementmap_vertex: "#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",
    emissivemap_fragment: "#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",
    emissivemap_pars_fragment: "#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",
    encodings_fragment: "gl_FragColor = linearToOutputTexel( gl_FragColor );",
    encodings_pars_fragment: "\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",
    envmap_fragment: "#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",
    envmap_common_pars_fragment: "#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",
    envmap_pars_fragment: "#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",
    envmap_pars_vertex: "#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",
    envmap_physical_pars_fragment: "#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",
    envmap_vertex: "#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",
    fog_vertex: "#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",
    fog_pars_vertex: "#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",
    fog_fragment: "#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",
    fog_pars_fragment: "#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",
    gradientmap_pars_fragment: "#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",
    lightmap_fragment: "#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",
    lightmap_pars_fragment: "#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",
    lights_lambert_vertex: "vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",
    lights_pars_begin: "uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",
    lights_toon_fragment: "ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",
    lights_toon_pars_fragment: "varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",
    lights_phong_fragment: "BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",
    lights_phong_pars_fragment: "varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",
    lights_physical_fragment: "PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\t#ifdef SPECULAR\n\t\tvec3 specularIntensityFactor = vec3( specularIntensity );\n\t\tvec3 specularTintFactor = specularTint;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARTINTMAP\n\t\t\tspecularTintFactor *= specularTintMapTexelToLinear( texture2D( specularTintMap, vUv ) ).rgb;\n\t\t#endif\n\t\tmaterial.specularColorF90 = mix( specularIntensityFactor, vec3( 1.0 ), metalnessFactor );\n\t#else\n\t\tvec3 specularIntensityFactor = vec3( 1.0 );\n\t\tvec3 specularTintFactor = vec3( 1.0 );\n\t\tmaterial.specularColorF90 = vec3( 1.0 );\n\t#endif\n\tmaterial.specularColor = mix( min( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ) * specularTintFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularColorF90 = vec3( 1.0 );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",
    lights_physical_pars_fragment: "struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n\tvec3 specularColorF90;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(\t\t0, 1,\t\t0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), vec3( 1.0 ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularColorF90, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",
    lights_fragment_begin: "\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",
    lights_fragment_maps: "#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",
    lights_fragment_end: "#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",
    logdepthbuf_fragment: "#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",
    logdepthbuf_pars_fragment: "#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",
    logdepthbuf_pars_vertex: "#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",
    logdepthbuf_vertex: "#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",
    map_fragment: "#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",
    map_pars_fragment: "#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",
    map_particle_fragment: "#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",
    map_particle_pars_fragment: "#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",
    metalnessmap_fragment: "float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",
    metalnessmap_pars_fragment: "#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",
    morphnormal_vertex: "#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",
    morphtarget_pars_vertex: "#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",
    morphtarget_vertex: "#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",
    normal_fragment_begin: "float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",
    normal_fragment_maps: "#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",
    normalmap_pars_fragment: "#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",
    clearcoat_normal_fragment_begin: "#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",
    clearcoat_normal_fragment_maps: "#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",
    clearcoat_pars_fragment: "#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",
    packing: "vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",
    premultiplied_alpha_fragment: "#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",
    project_vertex: "vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",
    dithering_fragment: "#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",
    dithering_pars_fragment: "#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",
    roughnessmap_fragment: "float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",
    roughnessmap_pars_fragment: "#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",
    shadowmap_pars_fragment: "#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t\tf.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",
    shadowmap_pars_vertex: "#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",
    shadowmap_vertex: "#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",
    shadowmask_pars_fragment: "float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",
    skinbase_vertex: "#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",
    skinning_pars_vertex: "#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",
    skinning_vertex: "#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",
    skinnormal_vertex: "#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",
    specularmap_fragment: "float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",
    specularmap_pars_fragment: "#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",
    tonemapping_fragment: "#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",
    tonemapping_pars_fragment: "#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(\t1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,\t1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,\t1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",
    transmission_fragment: "#ifdef USE_TRANSMISSION\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition.xyz / vWorldPosition.w;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tfloat ior = ( 1.0 + 0.4 * reflectivity ) / ( 1.0 - 0.4 * reflectivity );\n\tvec3 transmission = transmissionFactor * getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationTint, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission, transmissionFactor );\n#endif",
    transmission_pars_fragment: "#ifdef USE_TRANSMISSION\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec4 vWorldPosition;\n\tvec3 getVolumeTransmissionRay(vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix) {\n\t\tvec3 refractionVector = refract(-v, normalize(n), 1.0 / ior);\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length(vec3(modelMatrix[0].xyz));\n\t\tmodelScale.y = length(vec3(modelMatrix[1].xyz));\n\t\tmodelScale.z = length(vec3(modelMatrix[2].xyz));\n\t\treturn normalize(refractionVector) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness(float roughness, float ior) {\n\t\treturn roughness * clamp(ior * 2.0 - 2.0, 0.0, 1.0);\n\t}\n\tvec3 getTransmissionSample(vec2 fragCoord, float roughness, float ior) {\n\t\tfloat framebufferLod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness, ior);\n\t\treturn texture2DLodEXT(transmissionSamplerMap, fragCoord.xy, framebufferLod).rgb;\n\t}\n\tvec3 applyVolumeAttenuation(vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance) {\n\t\tif (attenuationDistance == 0.0) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log(attenuationColor) / attenuationDistance;\n\t\t\tvec3 transmittance = exp(-attenuationCoefficient * transmissionDistance);\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec3 getIBLVolumeRefraction(vec3 n, vec3 v, float perceptualRoughness, vec3 baseColor, vec3 specularColor,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay(n, v, thickness, ior, modelMatrix);\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4(refractedRayExit, 1.0);\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec3 transmittedLight = getTransmissionSample(refractionCoords, perceptualRoughness, ior);\n\t\tvec3 attenuatedColor = applyVolumeAttenuation(transmittedLight, length(transmissionRay), attenuationColor, attenuationDistance);\n\t\treturn (1.0 - specularColor) * attenuatedColor * baseColor;\n\t}\n#endif",
    uv_pars_fragment: "#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",
    uv_pars_vertex: "#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",
    uv_vertex: "#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",
    uv2_pars_fragment: "#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",
    uv2_pars_vertex: "#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",
    uv2_vertex: "#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",
    worldpos_vertex: "#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",
    background_frag: "uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",
    background_vert: "varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",
    cube_frag: "#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",
    cube_vert: "varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",
    depth_frag: "#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",
    depth_vert: "#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",
    distanceRGBA_frag: "#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",
    distanceRGBA_vert: "#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",
    equirect_frag: "uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",
    equirect_vert: "varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",
    linedashed_frag: "uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",
    linedashed_vert: "uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",
    meshbasic_frag: "uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
    meshbasic_vert: "#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",
    meshlambert_frag: "uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
    meshlambert_vert: "#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
    meshmatcap_frag: "#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
    meshmatcap_vert: "#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",
    meshtoon_frag: "#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
    meshtoon_vert: "#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
    meshphong_frag: "#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
    meshphong_vert: "#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
    meshphysical_frag: "#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationTint;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularTint;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARTINTMAP\n\t\tuniform sampler2D specularTintMap;\n\t#endif\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <transmission_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",
    meshphysical_vert: "#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#ifdef USE_TRANSMISSION\n\tvarying vec4 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition;\n#endif\n}",
    normal_frag: "#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",
    normal_vert: "#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",
    points_frag: "uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",
    points_vert: "uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",
    shadow_frag: "uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
    shadow_vert: "#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",
    sprite_frag: "uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",
    sprite_vert: "uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"
  },
      ui = {
    common: {
      diffuse: {
        value: new Qe(16777215)
      },
      opacity: {
        value: 1
      },
      map: {
        value: null
      },
      uvTransform: {
        value: new yt()
      },
      uv2Transform: {
        value: new yt()
      },
      alphaMap: {
        value: null
      }
    },
    specularmap: {
      specularMap: {
        value: null
      }
    },
    envmap: {
      envMap: {
        value: null
      },
      flipEnvMap: {
        value: -1
      },
      reflectivity: {
        value: 1
      },
      refractionRatio: {
        value: .98
      },
      maxMipLevel: {
        value: 0
      }
    },
    aomap: {
      aoMap: {
        value: null
      },
      aoMapIntensity: {
        value: 1
      }
    },
    lightmap: {
      lightMap: {
        value: null
      },
      lightMapIntensity: {
        value: 1
      }
    },
    emissivemap: {
      emissiveMap: {
        value: null
      }
    },
    bumpmap: {
      bumpMap: {
        value: null
      },
      bumpScale: {
        value: 1
      }
    },
    normalmap: {
      normalMap: {
        value: null
      },
      normalScale: {
        value: new vt(1, 1)
      }
    },
    displacementmap: {
      displacementMap: {
        value: null
      },
      displacementScale: {
        value: 1
      },
      displacementBias: {
        value: 0
      }
    },
    roughnessmap: {
      roughnessMap: {
        value: null
      }
    },
    metalnessmap: {
      metalnessMap: {
        value: null
      }
    },
    gradientmap: {
      gradientMap: {
        value: null
      }
    },
    fog: {
      fogDensity: {
        value: 25e-5
      },
      fogNear: {
        value: 1
      },
      fogFar: {
        value: 2e3
      },
      fogColor: {
        value: new Qe(16777215)
      }
    },
    lights: {
      ambientLightColor: {
        value: []
      },
      lightProbe: {
        value: []
      },
      directionalLights: {
        value: [],
        properties: {
          direction: {},
          color: {}
        }
      },
      directionalLightShadows: {
        value: [],
        properties: {
          shadowBias: {},
          shadowNormalBias: {},
          shadowRadius: {},
          shadowMapSize: {}
        }
      },
      directionalShadowMap: {
        value: []
      },
      directionalShadowMatrix: {
        value: []
      },
      spotLights: {
        value: [],
        properties: {
          color: {},
          position: {},
          direction: {},
          distance: {},
          coneCos: {},
          penumbraCos: {},
          decay: {}
        }
      },
      spotLightShadows: {
        value: [],
        properties: {
          shadowBias: {},
          shadowNormalBias: {},
          shadowRadius: {},
          shadowMapSize: {}
        }
      },
      spotShadowMap: {
        value: []
      },
      spotShadowMatrix: {
        value: []
      },
      pointLights: {
        value: [],
        properties: {
          color: {},
          position: {},
          decay: {},
          distance: {}
        }
      },
      pointLightShadows: {
        value: [],
        properties: {
          shadowBias: {},
          shadowNormalBias: {},
          shadowRadius: {},
          shadowMapSize: {},
          shadowCameraNear: {},
          shadowCameraFar: {}
        }
      },
      pointShadowMap: {
        value: []
      },
      pointShadowMatrix: {
        value: []
      },
      hemisphereLights: {
        value: [],
        properties: {
          direction: {},
          skyColor: {},
          groundColor: {}
        }
      },
      rectAreaLights: {
        value: [],
        properties: {
          color: {},
          position: {},
          width: {},
          height: {}
        }
      },
      ltc_1: {
        value: null
      },
      ltc_2: {
        value: null
      }
    },
    points: {
      diffuse: {
        value: new Qe(16777215)
      },
      opacity: {
        value: 1
      },
      size: {
        value: 1
      },
      scale: {
        value: 1
      },
      map: {
        value: null
      },
      alphaMap: {
        value: null
      },
      uvTransform: {
        value: new yt()
      }
    },
    sprite: {
      diffuse: {
        value: new Qe(16777215)
      },
      opacity: {
        value: 1
      },
      center: {
        value: new vt(.5, .5)
      },
      rotation: {
        value: 0
      },
      map: {
        value: null
      },
      alphaMap: {
        value: null
      },
      uvTransform: {
        value: new yt()
      }
    }
  },
      di = {
    basic: {
      uniforms: jn([ui.common, ui.specularmap, ui.envmap, ui.aomap, ui.lightmap, ui.fog]),
      vertexShader: hi.meshbasic_vert,
      fragmentShader: hi.meshbasic_frag
    },
    lambert: {
      uniforms: jn([ui.common, ui.specularmap, ui.envmap, ui.aomap, ui.lightmap, ui.emissivemap, ui.fog, ui.lights, {
        emissive: {
          value: new Qe(0)
        }
      }]),
      vertexShader: hi.meshlambert_vert,
      fragmentShader: hi.meshlambert_frag
    },
    phong: {
      uniforms: jn([ui.common, ui.specularmap, ui.envmap, ui.aomap, ui.lightmap, ui.emissivemap, ui.bumpmap, ui.normalmap, ui.displacementmap, ui.fog, ui.lights, {
        emissive: {
          value: new Qe(0)
        },
        specular: {
          value: new Qe(1118481)
        },
        shininess: {
          value: 30
        }
      }]),
      vertexShader: hi.meshphong_vert,
      fragmentShader: hi.meshphong_frag
    },
    standard: {
      uniforms: jn([ui.common, ui.envmap, ui.aomap, ui.lightmap, ui.emissivemap, ui.bumpmap, ui.normalmap, ui.displacementmap, ui.roughnessmap, ui.metalnessmap, ui.fog, ui.lights, {
        emissive: {
          value: new Qe(0)
        },
        roughness: {
          value: 1
        },
        metalness: {
          value: 0
        },
        envMapIntensity: {
          value: 1
        }
      }]),
      vertexShader: hi.meshphysical_vert,
      fragmentShader: hi.meshphysical_frag
    },
    toon: {
      uniforms: jn([ui.common, ui.aomap, ui.lightmap, ui.emissivemap, ui.bumpmap, ui.normalmap, ui.displacementmap, ui.gradientmap, ui.fog, ui.lights, {
        emissive: {
          value: new Qe(0)
        }
      }]),
      vertexShader: hi.meshtoon_vert,
      fragmentShader: hi.meshtoon_frag
    },
    matcap: {
      uniforms: jn([ui.common, ui.bumpmap, ui.normalmap, ui.displacementmap, ui.fog, {
        matcap: {
          value: null
        }
      }]),
      vertexShader: hi.meshmatcap_vert,
      fragmentShader: hi.meshmatcap_frag
    },
    points: {
      uniforms: jn([ui.points, ui.fog]),
      vertexShader: hi.points_vert,
      fragmentShader: hi.points_frag
    },
    dashed: {
      uniforms: jn([ui.common, ui.fog, {
        scale: {
          value: 1
        },
        dashSize: {
          value: 1
        },
        totalSize: {
          value: 2
        }
      }]),
      vertexShader: hi.linedashed_vert,
      fragmentShader: hi.linedashed_frag
    },
    depth: {
      uniforms: jn([ui.common, ui.displacementmap]),
      vertexShader: hi.depth_vert,
      fragmentShader: hi.depth_frag
    },
    normal: {
      uniforms: jn([ui.common, ui.bumpmap, ui.normalmap, ui.displacementmap, {
        opacity: {
          value: 1
        }
      }]),
      vertexShader: hi.normal_vert,
      fragmentShader: hi.normal_frag
    },
    sprite: {
      uniforms: jn([ui.sprite, ui.fog]),
      vertexShader: hi.sprite_vert,
      fragmentShader: hi.sprite_frag
    },
    background: {
      uniforms: {
        uvTransform: {
          value: new yt()
        },
        t2D: {
          value: null
        }
      },
      vertexShader: hi.background_vert,
      fragmentShader: hi.background_frag
    },
    cube: {
      uniforms: jn([ui.envmap, {
        opacity: {
          value: 1
        }
      }]),
      vertexShader: hi.cube_vert,
      fragmentShader: hi.cube_frag
    },
    equirect: {
      uniforms: {
        tEquirect: {
          value: null
        }
      },
      vertexShader: hi.equirect_vert,
      fragmentShader: hi.equirect_frag
    },
    distanceRGBA: {
      uniforms: jn([ui.common, ui.displacementmap, {
        referencePosition: {
          value: new Rt()
        },
        nearDistance: {
          value: 1
        },
        farDistance: {
          value: 1e3
        }
      }]),
      vertexShader: hi.distanceRGBA_vert,
      fragmentShader: hi.distanceRGBA_frag
    },
    shadow: {
      uniforms: jn([ui.lights, ui.fog, {
        color: {
          value: new Qe(0)
        },
        opacity: {
          value: 1
        }
      }]),
      vertexShader: hi.shadow_vert,
      fragmentShader: hi.shadow_frag
    }
  };

  function pi(t, e, n, i, r) {
    var s = new Qe(0);
    var a,
        o,
        c = 0,
        h = null,
        u = 0,
        d = null;

    function p(t, e) {
      n.buffers.color.setClear(t.r, t.g, t.b, e, r);
    }

    return {
      getClearColor: function getClearColor() {
        return s;
      },
      setClearColor: function setClearColor(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
        s.set(t), c = e, p(s, c);
      },
      getClearAlpha: function getClearAlpha() {
        return c;
      },
      setClearAlpha: function setClearAlpha(t) {
        c = t, p(s, c);
      },
      render: function render(n, r) {
        var m = !1,
            f = !0 === r.isScene ? r.background : null;
        f && f.isTexture && (f = e.get(f));
        var g = t.xr,
            v = g.getSession && g.getSession();
        v && "additive" === v.environmentBlendMode && (f = null), null === f ? p(s, c) : f && f.isColor && (p(f, 1), m = !0), (t.autoClear || m) && t.clear(t.autoClearColor, t.autoClearDepth, t.autoClearStencil), f && (f.isCubeTexture || f.mapping === l) ? (void 0 === o && (o = new Gn(new Vn(1, 1, 1), new Xn({
          name: "BackgroundCubeMaterial",
          uniforms: Wn(di.cube.uniforms),
          vertexShader: di.cube.vertexShader,
          fragmentShader: di.cube.fragmentShader,
          side: 1,
          depthTest: !1,
          depthWrite: !1,
          fog: !1
        })), o.geometry.deleteAttribute("normal"), o.geometry.deleteAttribute("uv"), o.onBeforeRender = function (t, e, n) {
          this.matrixWorld.copyPosition(n.matrixWorld);
        }, Object.defineProperty(o.material, "envMap", {
          get: function get() {
            return this.uniforms.envMap.value;
          }
        }), i.update(o)), o.material.uniforms.envMap.value = f, o.material.uniforms.flipEnvMap.value = f.isCubeTexture && !1 === f.isRenderTargetTexture ? -1 : 1, h === f && u === f.version && d === t.toneMapping || (o.material.needsUpdate = !0, h = f, u = f.version, d = t.toneMapping), n.unshift(o, o.geometry, o.material, 0, 0, null)) : f && f.isTexture && (void 0 === a && (a = new Gn(new ci(2, 2), new Xn({
          name: "BackgroundMaterial",
          uniforms: Wn(di.background.uniforms),
          vertexShader: di.background.vertexShader,
          fragmentShader: di.background.fragmentShader,
          side: 0,
          depthTest: !1,
          depthWrite: !1,
          fog: !1
        })), a.geometry.deleteAttribute("normal"), Object.defineProperty(a.material, "map", {
          get: function get() {
            return this.uniforms.t2D.value;
          }
        }), i.update(a)), a.material.uniforms.t2D.value = f, !0 === f.matrixAutoUpdate && f.updateMatrix(), a.material.uniforms.uvTransform.value.copy(f.matrix), h === f && u === f.version && d === t.toneMapping || (a.material.needsUpdate = !0, h = f, u = f.version, d = t.toneMapping), n.unshift(a, a.geometry, a.material, 0, 0, null));
      }
    };
  }

  function mi(t, e, n, i) {
    var r = t.getParameter(34921),
        s = i.isWebGL2 ? null : e.get("OES_vertex_array_object"),
        a = i.isWebGL2 || null !== s,
        o = {},
        l = d(null);
    var c = l;

    function h(e) {
      return i.isWebGL2 ? t.bindVertexArray(e) : s.bindVertexArrayOES(e);
    }

    function u(e) {
      return i.isWebGL2 ? t.deleteVertexArray(e) : s.deleteVertexArrayOES(e);
    }

    function d(t) {
      var e = [],
          n = [],
          i = [];

      for (var _t60 = 0; _t60 < r; _t60++) {
        e[_t60] = 0, n[_t60] = 0, i[_t60] = 0;
      }

      return {
        geometry: null,
        program: null,
        wireframe: !1,
        newAttributes: e,
        enabledAttributes: n,
        attributeDivisors: i,
        object: t,
        attributes: {},
        index: null
      };
    }

    function p() {
      var t = c.newAttributes;

      for (var _e51 = 0, _n69 = t.length; _e51 < _n69; _e51++) {
        t[_e51] = 0;
      }
    }

    function m(t) {
      f(t, 0);
    }

    function f(n, r) {
      var s = c.newAttributes,
          a = c.enabledAttributes,
          o = c.attributeDivisors;

      if (s[n] = 1, 0 === a[n] && (t.enableVertexAttribArray(n), a[n] = 1), o[n] !== r) {
        (i.isWebGL2 ? t : e.get("ANGLE_instanced_arrays"))[i.isWebGL2 ? "vertexAttribDivisor" : "vertexAttribDivisorANGLE"](n, r), o[n] = r;
      }
    }

    function g() {
      var e = c.newAttributes,
          n = c.enabledAttributes;

      for (var _i58 = 0, _r44 = n.length; _i58 < _r44; _i58++) {
        n[_i58] !== e[_i58] && (t.disableVertexAttribArray(_i58), n[_i58] = 0);
      }
    }

    function v(e, n, r, s, a, o) {
      !0 !== i.isWebGL2 || 5124 !== r && 5125 !== r ? t.vertexAttribPointer(e, n, r, s, a, o) : t.vertexAttribIPointer(e, n, r, a, o);
    }

    function y() {
      x(), c !== l && (c = l, h(c.object));
    }

    function x() {
      l.geometry = null, l.program = null, l.wireframe = !1;
    }

    return {
      setup: function setup(r, l, u, y, x) {
        var _ = !1;

        if (a) {
          var _e52 = function (e, n, r) {
            var a = !0 === r.wireframe;
            var l = o[e.id];
            void 0 === l && (l = {}, o[e.id] = l);
            var c = l[n.id];
            void 0 === c && (c = {}, l[n.id] = c);
            var h = c[a];
            void 0 === h && (h = d(i.isWebGL2 ? t.createVertexArray() : s.createVertexArrayOES()), c[a] = h);
            return h;
          }(y, u, l);

          c !== _e52 && (c = _e52, h(c.object)), _ = function (t, e) {
            var n = c.attributes,
                i = t.attributes;
            var r = 0;

            for (var _t61 in i) {
              var _e53 = n[_t61],
                  _s14 = i[_t61];
              if (void 0 === _e53) return !0;
              if (_e53.attribute !== _s14) return !0;
              if (_e53.data !== _s14.data) return !0;
              r++;
            }

            return c.attributesNum !== r || c.index !== e;
          }(y, x), _ && function (t, e) {
            var n = {},
                i = t.attributes;
            var r = 0;

            for (var _t62 in i) {
              var _e54 = i[_t62],
                  _s15 = {};
              _s15.attribute = _e54, _e54.data && (_s15.data = _e54.data), n[_t62] = _s15, r++;
            }

            c.attributes = n, c.attributesNum = r, c.index = e;
          }(y, x);
        } else {
          var _t63 = !0 === l.wireframe;

          c.geometry === y.id && c.program === u.id && c.wireframe === _t63 || (c.geometry = y.id, c.program = u.id, c.wireframe = _t63, _ = !0);
        }

        !0 === r.isInstancedMesh && (_ = !0), null !== x && n.update(x, 34963), _ && (!function (r, s, a, o) {
          if (!1 === i.isWebGL2 && (r.isInstancedMesh || o.isInstancedBufferGeometry) && null === e.get("ANGLE_instanced_arrays")) return;
          p();
          var l = o.attributes,
              c = a.getAttributes(),
              h = s.defaultAttributeValues;

          for (var _e55 in c) {
            var _i59 = c[_e55];

            if (_i59 >= 0) {
              var _s16 = l[_e55];

              if (void 0 !== _s16) {
                var _e56 = _s16.normalized,
                    _r45 = _s16.itemSize,
                    _a13 = n.get(_s16);

                if (void 0 === _a13) continue;
                var _l12 = _a13.buffer,
                    _c8 = _a13.type,
                    _h6 = _a13.bytesPerElement;

                if (_s16.isInterleavedBufferAttribute) {
                  var _n70 = _s16.data,
                      _a14 = _n70.stride,
                      _u7 = _s16.offset;
                  _n70 && _n70.isInstancedInterleavedBuffer ? (f(_i59, _n70.meshPerAttribute), void 0 === o._maxInstanceCount && (o._maxInstanceCount = _n70.meshPerAttribute * _n70.count)) : m(_i59), t.bindBuffer(34962, _l12), v(_i59, _r45, _c8, _e56, _a14 * _h6, _u7 * _h6);
                } else _s16.isInstancedBufferAttribute ? (f(_i59, _s16.meshPerAttribute), void 0 === o._maxInstanceCount && (o._maxInstanceCount = _s16.meshPerAttribute * _s16.count)) : m(_i59), t.bindBuffer(34962, _l12), v(_i59, _r45, _c8, _e56, 0, 0);
              } else if ("instanceMatrix" === _e55) {
                var _e57 = n.get(r.instanceMatrix);

                if (void 0 === _e57) continue;
                var _s17 = _e57.buffer,
                    _a15 = _e57.type;
                f(_i59 + 0, 1), f(_i59 + 1, 1), f(_i59 + 2, 1), f(_i59 + 3, 1), t.bindBuffer(34962, _s17), t.vertexAttribPointer(_i59 + 0, 4, _a15, !1, 64, 0), t.vertexAttribPointer(_i59 + 1, 4, _a15, !1, 64, 16), t.vertexAttribPointer(_i59 + 2, 4, _a15, !1, 64, 32), t.vertexAttribPointer(_i59 + 3, 4, _a15, !1, 64, 48);
              } else if ("instanceColor" === _e55) {
                var _e58 = n.get(r.instanceColor);

                if (void 0 === _e58) continue;
                var _s18 = _e58.buffer,
                    _a16 = _e58.type;
                f(_i59, 1), t.bindBuffer(34962, _s18), t.vertexAttribPointer(_i59, 3, _a16, !1, 12, 0);
              } else if (void 0 !== h) {
                var _n71 = h[_e55];
                if (void 0 !== _n71) switch (_n71.length) {
                  case 2:
                    t.vertexAttrib2fv(_i59, _n71);
                    break;

                  case 3:
                    t.vertexAttrib3fv(_i59, _n71);
                    break;

                  case 4:
                    t.vertexAttrib4fv(_i59, _n71);
                    break;

                  default:
                    t.vertexAttrib1fv(_i59, _n71);
                }
              }
            }
          }

          g();
        }(r, l, u, y), null !== x && t.bindBuffer(34963, n.get(x).buffer));
      },
      reset: y,
      resetDefaultState: x,
      dispose: function dispose() {
        y();

        for (var _t64 in o) {
          var _e59 = o[_t64];

          for (var _t65 in _e59) {
            var _n72 = _e59[_t65];

            for (var _t66 in _n72) {
              u(_n72[_t66].object), delete _n72[_t66];
            }

            delete _e59[_t65];
          }

          delete o[_t64];
        }
      },
      releaseStatesOfGeometry: function releaseStatesOfGeometry(t) {
        if (void 0 === o[t.id]) return;
        var e = o[t.id];

        for (var _t67 in e) {
          var _n73 = e[_t67];

          for (var _t68 in _n73) {
            u(_n73[_t68].object), delete _n73[_t68];
          }

          delete e[_t67];
        }

        delete o[t.id];
      },
      releaseStatesOfProgram: function releaseStatesOfProgram(t) {
        for (var _e60 in o) {
          var _n74 = o[_e60];
          if (void 0 === _n74[t.id]) continue;
          var _i60 = _n74[t.id];

          for (var _t69 in _i60) {
            u(_i60[_t69].object), delete _i60[_t69];
          }

          delete _n74[t.id];
        }
      },
      initAttributes: p,
      enableAttribute: m,
      disableUnusedAttributes: g
    };
  }

  function fi(t, e, n, i) {
    var r = i.isWebGL2;
    var s;
    this.setMode = function (t) {
      s = t;
    }, this.render = function (e, i) {
      t.drawArrays(s, e, i), n.update(i, s, 1);
    }, this.renderInstances = function (i, a, o) {
      if (0 === o) return;
      var l, c;
      if (r) l = t, c = "drawArraysInstanced";else if (l = e.get("ANGLE_instanced_arrays"), c = "drawArraysInstancedANGLE", null === l) return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
      l[c](s, i, a, o), n.update(a, s, o);
    };
  }

  function gi(t, e, n) {
    var i;

    function r(e) {
      if ("highp" === e) {
        if (t.getShaderPrecisionFormat(35633, 36338).precision > 0 && t.getShaderPrecisionFormat(35632, 36338).precision > 0) return "highp";
        e = "mediump";
      }

      return "mediump" === e && t.getShaderPrecisionFormat(35633, 36337).precision > 0 && t.getShaderPrecisionFormat(35632, 36337).precision > 0 ? "mediump" : "lowp";
    }

    var s = "undefined" != typeof WebGL2RenderingContext && t instanceof WebGL2RenderingContext || "undefined" != typeof WebGL2ComputeRenderingContext && t instanceof WebGL2ComputeRenderingContext;
    var a = void 0 !== n.precision ? n.precision : "highp";
    var o = r(a);
    o !== a && (console.warn("THREE.WebGLRenderer:", a, "not supported, using", o, "instead."), a = o);
    var l = s || e.has("WEBGL_draw_buffers"),
        c = !0 === n.logarithmicDepthBuffer,
        h = t.getParameter(34930),
        u = t.getParameter(35660),
        d = t.getParameter(3379),
        p = t.getParameter(34076),
        m = t.getParameter(34921),
        f = t.getParameter(36347),
        g = t.getParameter(36348),
        v = t.getParameter(36349),
        y = u > 0,
        x = s || e.has("OES_texture_float");
    return {
      isWebGL2: s,
      drawBuffers: l,
      getMaxAnisotropy: function getMaxAnisotropy() {
        if (void 0 !== i) return i;

        if (!0 === e.has("EXT_texture_filter_anisotropic")) {
          var _n75 = e.get("EXT_texture_filter_anisotropic");

          i = t.getParameter(_n75.MAX_TEXTURE_MAX_ANISOTROPY_EXT);
        } else i = 0;

        return i;
      },
      getMaxPrecision: r,
      precision: a,
      logarithmicDepthBuffer: c,
      maxTextures: h,
      maxVertexTextures: u,
      maxTextureSize: d,
      maxCubemapSize: p,
      maxAttributes: m,
      maxVertexUniforms: f,
      maxVaryings: g,
      maxFragmentUniforms: v,
      vertexTextures: y,
      floatFragmentTextures: x,
      floatVertexTextures: y && x,
      maxSamples: s ? t.getParameter(36183) : 0
    };
  }

  function vi(t) {
    var e = this;
    var n = null,
        i = 0,
        r = !1,
        s = !1;
    var a = new ii(),
        o = new yt(),
        l = {
      value: null,
      needsUpdate: !1
    };

    function c() {
      l.value !== n && (l.value = n, l.needsUpdate = i > 0), e.numPlanes = i, e.numIntersection = 0;
    }

    function h(t, n, i, r) {
      var s = null !== t ? t.length : 0;
      var c = null;

      if (0 !== s) {
        if (c = l.value, !0 !== r || null === c) {
          var _e61 = i + 4 * s,
              _r46 = n.matrixWorldInverse;

          o.getNormalMatrix(_r46), (null === c || c.length < _e61) && (c = new Float32Array(_e61));

          for (var _e62 = 0, _n76 = i; _e62 !== s; ++_e62, _n76 += 4) {
            a.copy(t[_e62]).applyMatrix4(_r46, o), a.normal.toArray(c, _n76), c[_n76 + 3] = a.constant;
          }
        }

        l.value = c, l.needsUpdate = !0;
      }

      return e.numPlanes = s, e.numIntersection = 0, c;
    }

    this.uniform = l, this.numPlanes = 0, this.numIntersection = 0, this.init = function (t, e, s) {
      var a = 0 !== t.length || e || 0 !== i || r;
      return r = e, n = h(t, s, 0), i = t.length, a;
    }, this.beginShadows = function () {
      s = !0, h(null);
    }, this.endShadows = function () {
      s = !1, c();
    }, this.setState = function (e, a, o) {
      var u = e.clippingPlanes,
          d = e.clipIntersection,
          p = e.clipShadows,
          m = t.get(e);
      if (!r || null === u || 0 === u.length || s && !p) s ? h(null) : c();else {
        var _t70 = s ? 0 : i,
            _e63 = 4 * _t70;

        var _r47 = m.clippingState || null;

        l.value = _r47, _r47 = h(u, a, _e63, o);

        for (var _t71 = 0; _t71 !== _e63; ++_t71) {
          _r47[_t71] = n[_t71];
        }

        m.clippingState = _r47, this.numIntersection = d ? this.numPlanes : 0, this.numPlanes += _t70;
      }
    };
  }

  function yi(t) {
    var e = new WeakMap();

    function n(t, e) {
      return e === a ? t.mapping = r : e === o && (t.mapping = s), t;
    }

    function i(t) {
      var n = t.target;
      n.removeEventListener("dispose", i);
      var r = e.get(n);
      void 0 !== r && (e.delete(n), r.dispose());
    }

    return {
      get: function get(r) {
        if (r && r.isTexture && !1 === r.isRenderTargetTexture) {
          var _s19 = r.mapping;

          if (_s19 === a || _s19 === o) {
            if (e.has(r)) {
              return n(e.get(r).texture, r.mapping);
            }

            {
              var _s20 = r.image;

              if (_s20 && _s20.height > 0) {
                var _a17 = t.getRenderTarget(),
                    _o11 = new $n(_s20.height / 2);

                return _o11.fromEquirectangularTexture(t, r), e.set(r, _o11), t.setRenderTarget(_a17), r.addEventListener("dispose", i), n(_o11.texture, r.mapping);
              }

              return null;
            }
          }
        }

        return r;
      },
      dispose: function dispose() {
        e = new WeakMap();
      }
    };
  }

  di.physical = {
    uniforms: jn([di.standard.uniforms, {
      clearcoat: {
        value: 0
      },
      clearcoatMap: {
        value: null
      },
      clearcoatRoughness: {
        value: 0
      },
      clearcoatRoughnessMap: {
        value: null
      },
      clearcoatNormalScale: {
        value: new vt(1, 1)
      },
      clearcoatNormalMap: {
        value: null
      },
      sheen: {
        value: new Qe(0)
      },
      transmission: {
        value: 0
      },
      transmissionMap: {
        value: null
      },
      transmissionSamplerSize: {
        value: new vt()
      },
      transmissionSamplerMap: {
        value: null
      },
      thickness: {
        value: 0
      },
      thicknessMap: {
        value: null
      },
      attenuationDistance: {
        value: 0
      },
      attenuationTint: {
        value: new Qe(0)
      },
      specularIntensity: {
        value: 0
      },
      specularIntensityMap: {
        value: null
      },
      specularTint: {
        value: new Qe(1, 1, 1)
      },
      specularTintMap: {
        value: null
      }
    }]),
    vertexShader: hi.meshphysical_vert,
    fragmentShader: hi.meshphysical_frag
  };

  var xi = /*#__PURE__*/function (_Yn2) {
    _inherits(xi, _Yn2);

    var _super28 = _createSuper(xi);

    function xi() {
      var _this18;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : -1;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : -1;
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : .1;
      var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 2e3;

      _classCallCheck(this, xi);

      _this18 = _super28.call(this), _this18.type = "OrthographicCamera", _this18.zoom = 1, _this18.view = null, _this18.left = t, _this18.right = e, _this18.top = n, _this18.bottom = i, _this18.near = r, _this18.far = s, _this18.updateProjectionMatrix();
      return _this18;
    }

    _createClass(xi, [{
      key: "copy",
      value: function copy(t, e) {
        return _get(_getPrototypeOf(xi.prototype), "copy", this).call(this, t, e), this.left = t.left, this.right = t.right, this.top = t.top, this.bottom = t.bottom, this.near = t.near, this.far = t.far, this.zoom = t.zoom, this.view = null === t.view ? null : Object.assign({}, t.view), this;
      }
    }, {
      key: "setViewOffset",
      value: function setViewOffset(t, e, n, i, r, s) {
        null === this.view && (this.view = {
          enabled: !0,
          fullWidth: 1,
          fullHeight: 1,
          offsetX: 0,
          offsetY: 0,
          width: 1,
          height: 1
        }), this.view.enabled = !0, this.view.fullWidth = t, this.view.fullHeight = e, this.view.offsetX = n, this.view.offsetY = i, this.view.width = r, this.view.height = s, this.updateProjectionMatrix();
      }
    }, {
      key: "clearViewOffset",
      value: function clearViewOffset() {
        null !== this.view && (this.view.enabled = !1), this.updateProjectionMatrix();
      }
    }, {
      key: "updateProjectionMatrix",
      value: function updateProjectionMatrix() {
        var t = (this.right - this.left) / (2 * this.zoom),
            e = (this.top - this.bottom) / (2 * this.zoom),
            n = (this.right + this.left) / 2,
            i = (this.top + this.bottom) / 2;
        var r = n - t,
            s = n + t,
            a = i + e,
            o = i - e;

        if (null !== this.view && this.view.enabled) {
          var _t72 = (this.right - this.left) / this.view.fullWidth / this.zoom,
              _e64 = (this.top - this.bottom) / this.view.fullHeight / this.zoom;

          r += _t72 * this.view.offsetX, s = r + _t72 * this.view.width, a -= _e64 * this.view.offsetY, o = a - _e64 * this.view.height;
        }

        this.projectionMatrix.makeOrthographic(r, s, a, o, this.near, this.far), this.projectionMatrixInverse.copy(this.projectionMatrix).invert();
      }
    }, {
      key: "toJSON",
      value: function toJSON(t) {
        var e = _get(_getPrototypeOf(xi.prototype), "toJSON", this).call(this, t);

        return e.object.zoom = this.zoom, e.object.left = this.left, e.object.right = this.right, e.object.top = this.top, e.object.bottom = this.bottom, e.object.near = this.near, e.object.far = this.far, null !== this.view && (e.object.view = Object.assign({}, this.view)), e;
      }
    }]);

    return xi;
  }(Yn);

  xi.prototype.isOrthographicCamera = !0;

  var _i = /*#__PURE__*/function (_Xn) {
    _inherits(_i, _Xn);

    var _super29 = _createSuper(_i);

    function _i(t) {
      var _this19;

      _classCallCheck(this, _i);

      _this19 = _super29.call(this, t), _this19.type = "RawShaderMaterial";
      return _this19;
    }

    return _i;
  }(Xn);

  _i.prototype.isRawShaderMaterial = !0;

  var Mi = Math.pow(2, 8),
      bi = [.125, .215, .35, .446, .526, .582],
      wi = 5 + bi.length,
      Si = 20,
      Ti = (_Ti = {}, _defineProperty(_Ti, X, 0), _defineProperty(_Ti, Y, 1), _defineProperty(_Ti, Z, 2), _defineProperty(_Ti, Q, 3), _defineProperty(_Ti, K, 4), _defineProperty(_Ti, $, 5), _defineProperty(_Ti, J, 6), _Ti),
      Ei = new Ke({
    side: 1,
    depthWrite: !1,
    depthTest: !1
  }),
      Ai = new Gn(new Vn(), Ei),
      Li = new xi(),
      _Hi = Hi(),
      Ri = _Hi._lodPlanes,
      Ci = _Hi._sizeLods,
      Pi = _Hi._sigmas,
      Ii = new Qe();

  var Di = null;
  var Ni = (1 + Math.sqrt(5)) / 2,
      Bi = 1 / Ni,
      zi = [new Rt(1, 1, 1), new Rt(-1, 1, 1), new Rt(1, 1, -1), new Rt(-1, 1, -1), new Rt(0, Ni, Bi), new Rt(0, Ni, -Bi), new Rt(Bi, 0, Ni), new Rt(-Bi, 0, Ni), new Rt(Ni, Bi, 0), new Rt(-Ni, Bi, 0)];

  function Fi(t) {
    var e = Math.max(t.r, t.g, t.b),
        n = Math.min(Math.max(Math.ceil(Math.log2(e)), -128), 127);
    t.multiplyScalar(Math.pow(2, -n));
    return (n + 128) / 255;
  }

  var Oi = /*#__PURE__*/function () {
    function Oi(t) {
      _classCallCheck(this, Oi);

      this._renderer = t, this._pingPongRenderTarget = null, this._blurMaterial = function (t) {
        var e = new Float32Array(t),
            n = new Rt(0, 1, 0);
        return new _i({
          name: "SphericalGaussianBlur",
          defines: {
            n: t
          },
          uniforms: {
            envMap: {
              value: null
            },
            samples: {
              value: 1
            },
            weights: {
              value: e
            },
            latitudinal: {
              value: !1
            },
            dTheta: {
              value: 0
            },
            mipInt: {
              value: 0
            },
            poleAxis: {
              value: n
            },
            inputEncoding: {
              value: Ti[3e3]
            },
            outputEncoding: {
              value: Ti[3e3]
            }
          },
          vertexShader: ji(),
          fragmentShader: "\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t".concat(qi(), "\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),
          blending: 0,
          depthTest: !1,
          depthWrite: !1
        });
      }(Si), this._equirectShader = null, this._cubemapShader = null, this._compileMaterial(this._blurMaterial);
    }

    _createClass(Oi, [{
      key: "fromScene",
      value: function fromScene(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : .1;
        var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 100;
        Di = this._renderer.getRenderTarget();

        var r = this._allocateTargets();

        return this._sceneToCubeUV(t, n, i, r), e > 0 && this._blur(r, 0, 0, e), this._applyPMREM(r), this._cleanup(r), r;
      }
    }, {
      key: "fromEquirectangular",
      value: function fromEquirectangular(t) {
        return this._fromTexture(t);
      }
    }, {
      key: "fromCubemap",
      value: function fromCubemap(t) {
        return this._fromTexture(t);
      }
    }, {
      key: "compileCubemapShader",
      value: function compileCubemapShader() {
        null === this._cubemapShader && (this._cubemapShader = Wi(), this._compileMaterial(this._cubemapShader));
      }
    }, {
      key: "compileEquirectangularShader",
      value: function compileEquirectangularShader() {
        null === this._equirectShader && (this._equirectShader = Vi(), this._compileMaterial(this._equirectShader));
      }
    }, {
      key: "dispose",
      value: function dispose() {
        this._blurMaterial.dispose(), null !== this._cubemapShader && this._cubemapShader.dispose(), null !== this._equirectShader && this._equirectShader.dispose();

        for (var _t73 = 0; _t73 < Ri.length; _t73++) {
          Ri[_t73].dispose();
        }
      }
    }, {
      key: "_cleanup",
      value: function _cleanup(t) {
        this._pingPongRenderTarget.dispose(), this._renderer.setRenderTarget(Di), t.scissorTest = !1, ki(t, 0, 0, t.width, t.height);
      }
    }, {
      key: "_fromTexture",
      value: function _fromTexture(t) {
        Di = this._renderer.getRenderTarget();

        var e = this._allocateTargets(t);

        return this._textureToCubeUV(t, e), this._applyPMREM(e), this._cleanup(e), e;
      }
    }, {
      key: "_allocateTargets",
      value: function _allocateTargets(t) {
        var e = {
          magFilter: p,
          minFilter: p,
          generateMipmaps: !1,
          type: x,
          format: 1023,
          encoding: Ui(t) ? t.encoding : Z,
          depthBuffer: !1
        },
            n = Gi(e);
        return n.depthBuffer = !t, this._pingPongRenderTarget = Gi(e), n;
      }
    }, {
      key: "_compileMaterial",
      value: function _compileMaterial(t) {
        var e = new Gn(Ri[0], t);

        this._renderer.compile(e, Li);
      }
    }, {
      key: "_sceneToCubeUV",
      value: function _sceneToCubeUV(t, e, n, i) {
        var r = new Jn(90, 1, e, n),
            s = [1, -1, 1, 1, 1, 1],
            a = [1, 1, 1, -1, -1, -1],
            o = this._renderer,
            l = o.autoClear,
            c = o.outputEncoding,
            h = o.toneMapping;
        o.getClearColor(Ii), o.toneMapping = 0, o.outputEncoding = X, o.autoClear = !1;
        var u = !1;
        var d = t.background;

        if (d) {
          if (d.isColor) {
            Ei.color.copy(d).convertSRGBToLinear(), t.background = null;

            var _e65 = Fi(Ei.color);

            Ei.opacity = _e65, u = !0;
          }
        } else {
          Ei.color.copy(Ii).convertSRGBToLinear();

          var _t74 = Fi(Ei.color);

          Ei.opacity = _t74, u = !0;
        }

        for (var _e66 = 0; _e66 < 6; _e66++) {
          var _n77 = _e66 % 3;

          0 == _n77 ? (r.up.set(0, s[_e66], 0), r.lookAt(a[_e66], 0, 0)) : 1 == _n77 ? (r.up.set(0, 0, s[_e66]), r.lookAt(0, a[_e66], 0)) : (r.up.set(0, s[_e66], 0), r.lookAt(0, 0, a[_e66])), ki(i, _n77 * Mi, _e66 > 2 ? Mi : 0, Mi, Mi), o.setRenderTarget(i), u && o.render(Ai, r), o.render(t, r);
        }

        o.toneMapping = h, o.outputEncoding = c, o.autoClear = l;
      }
    }, {
      key: "_textureToCubeUV",
      value: function _textureToCubeUV(t, e) {
        var n = this._renderer;
        t.isCubeTexture ? null == this._cubemapShader && (this._cubemapShader = Wi()) : null == this._equirectShader && (this._equirectShader = Vi());
        var i = t.isCubeTexture ? this._cubemapShader : this._equirectShader,
            r = new Gn(Ri[0], i),
            s = i.uniforms;
        s.envMap.value = t, t.isCubeTexture || s.texelSize.value.set(1 / t.image.width, 1 / t.image.height), s.inputEncoding.value = Ti[t.encoding], s.outputEncoding.value = Ti[e.texture.encoding], ki(e, 0, 0, 3 * Mi, 2 * Mi), n.setRenderTarget(e), n.render(r, Li);
      }
    }, {
      key: "_applyPMREM",
      value: function _applyPMREM(t) {
        var e = this._renderer,
            n = e.autoClear;
        e.autoClear = !1;

        for (var _e67 = 1; _e67 < wi; _e67++) {
          var _n78 = Math.sqrt(Pi[_e67] * Pi[_e67] - Pi[_e67 - 1] * Pi[_e67 - 1]),
              _i61 = zi[(_e67 - 1) % zi.length];

          this._blur(t, _e67 - 1, _e67, _n78, _i61);
        }

        e.autoClear = n;
      }
    }, {
      key: "_blur",
      value: function _blur(t, e, n, i, r) {
        var s = this._pingPongRenderTarget;
        this._halfBlur(t, s, e, n, i, "latitudinal", r), this._halfBlur(s, t, n, n, i, "longitudinal", r);
      }
    }, {
      key: "_halfBlur",
      value: function _halfBlur(t, e, n, i, r, s, a) {
        var o = this._renderer,
            l = this._blurMaterial;
        "latitudinal" !== s && "longitudinal" !== s && console.error("blur direction must be either latitudinal or longitudinal!");
        var c = new Gn(Ri[i], l),
            h = l.uniforms,
            u = Ci[n] - 1,
            d = isFinite(r) ? Math.PI / (2 * u) : 2 * Math.PI / 39,
            p = r / d,
            m = isFinite(r) ? 1 + Math.floor(3 * p) : Si;
        m > Si && console.warn("sigmaRadians, ".concat(r, ", is too large and will clip, as it requested ").concat(m, " samples when the maximum is set to 20"));
        var f = [];
        var g = 0;

        for (var _t75 = 0; _t75 < Si; ++_t75) {
          var _e68 = _t75 / p,
              _n79 = Math.exp(-_e68 * _e68 / 2);

          f.push(_n79), 0 == _t75 ? g += _n79 : _t75 < m && (g += 2 * _n79);
        }

        for (var _t76 = 0; _t76 < f.length; _t76++) {
          f[_t76] = f[_t76] / g;
        }

        h.envMap.value = t.texture, h.samples.value = m, h.weights.value = f, h.latitudinal.value = "latitudinal" === s, a && (h.poleAxis.value = a), h.dTheta.value = d, h.mipInt.value = 8 - n, h.inputEncoding.value = Ti[t.texture.encoding], h.outputEncoding.value = Ti[t.texture.encoding];
        var v = Ci[i];
        ki(e, 3 * Math.max(0, Mi - 2 * v), (0 === i ? 0 : 2 * Mi) + 2 * v * (i > 4 ? i - 8 + 4 : 0), 3 * v, 2 * v), o.setRenderTarget(e), o.render(c, Li);
      }
    }]);

    return Oi;
  }();

  function Ui(t) {
    return void 0 !== t && t.type === x && (t.encoding === X || t.encoding === Y || t.encoding === J);
  }

  function Hi() {
    var t = [],
        e = [],
        n = [];
    var i = 8;

    for (var _r48 = 0; _r48 < wi; _r48++) {
      var _s21 = Math.pow(2, i);

      e.push(_s21);

      var _a18 = 1 / _s21;

      _r48 > 4 ? _a18 = bi[_r48 - 8 + 4 - 1] : 0 == _r48 && (_a18 = 0), n.push(_a18);

      var _o12 = 1 / (_s21 - 1),
          _l13 = -_o12 / 2,
          _c9 = 1 + _o12 / 2,
          _h7 = [_l13, _l13, _c9, _l13, _c9, _c9, _l13, _l13, _c9, _c9, _l13, _c9],
          _u8 = 6,
          _d6 = 6,
          _p6 = 3,
          _m3 = 2,
          _f = 1,
          _g = new Float32Array(_p6 * _d6 * _u8),
          _v2 = new Float32Array(_m3 * _d6 * _u8),
          _y2 = new Float32Array(_f * _d6 * _u8);

      for (var _t77 = 0; _t77 < _u8; _t77++) {
        var _e69 = _t77 % 3 * 2 / 3 - 1,
            _n80 = _t77 > 2 ? 0 : -1,
            _i62 = [_e69, _n80, 0, _e69 + 2 / 3, _n80, 0, _e69 + 2 / 3, _n80 + 1, 0, _e69, _n80, 0, _e69 + 2 / 3, _n80 + 1, 0, _e69, _n80 + 1, 0];

        _g.set(_i62, _p6 * _d6 * _t77), _v2.set(_h7, _m3 * _d6 * _t77);
        var _r49 = [_t77, _t77, _t77, _t77, _t77, _t77];

        _y2.set(_r49, _f * _d6 * _t77);
      }

      var _x2 = new wn();

      _x2.setAttribute("position", new en(_g, _p6)), _x2.setAttribute("uv", new en(_v2, _m3)), _x2.setAttribute("faceIndex", new en(_y2, _f)), t.push(_x2), i > 4 && i--;
    }

    return {
      _lodPlanes: t,
      _sizeLods: e,
      _sigmas: n
    };
  }

  function Gi(t) {
    var e = new Tt(3 * Mi, 3 * Mi, t);
    return e.texture.mapping = l, e.texture.name = "PMREM.cubeUv", e.scissorTest = !0, e;
  }

  function ki(t, e, n, i, r) {
    t.viewport.set(e, n, i, r), t.scissor.set(e, n, i, r);
  }

  function Vi() {
    var t = new vt(1, 1);
    return new _i({
      name: "EquirectangularToCubeUV",
      uniforms: {
        envMap: {
          value: null
        },
        texelSize: {
          value: t
        },
        inputEncoding: {
          value: Ti[3e3]
        },
        outputEncoding: {
          value: Ti[3e3]
        }
      },
      vertexShader: ji(),
      fragmentShader: "\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t".concat(qi(), "\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),
      blending: 0,
      depthTest: !1,
      depthWrite: !1
    });
  }

  function Wi() {
    return new _i({
      name: "CubemapToCubeUV",
      uniforms: {
        envMap: {
          value: null
        },
        inputEncoding: {
          value: Ti[3e3]
        },
        outputEncoding: {
          value: Ti[3e3]
        }
      },
      vertexShader: ji(),
      fragmentShader: "\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t".concat(qi(), "\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),
      blending: 0,
      depthTest: !1,
      depthWrite: !1
    });
  }

  function ji() {
    return "\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t";
  }

  function qi() {
    return "\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t";
  }

  function Xi(t) {
    var e = new WeakMap(),
        n = null;

    function i(t) {
      var n = t.target;
      n.removeEventListener("dispose", i);
      var r = e.get(n);
      void 0 !== r && (r.delete(n), r.dispose());
    }

    return {
      get: function get(l) {
        if (l && l.isTexture && !1 === l.isRenderTargetTexture) {
          var _c10 = l.mapping,
              _h8 = _c10 === a || _c10 === o,
              _u9 = _c10 === r || _c10 === s;

          if (_h8 || _u9) {
            if (e.has(l)) return e.get(l).texture;
            {
              var _r50 = l.image;

              if (_h8 && _r50 && _r50.height > 0 || _u9 && _r50 && function (t) {
                var e = 0;
                var n = 6;

                for (var _i63 = 0; _i63 < n; _i63++) {
                  void 0 !== t[_i63] && e++;
                }

                return e === n;
              }(_r50)) {
                var _r51 = t.getRenderTarget();

                null === n && (n = new Oi(t));

                var _s22 = _h8 ? n.fromEquirectangular(l) : n.fromCubemap(l);

                return e.set(l, _s22), t.setRenderTarget(_r51), l.addEventListener("dispose", i), _s22.texture;
              }

              return null;
            }
          }
        }

        return l;
      },
      dispose: function dispose() {
        e = new WeakMap(), null !== n && (n.dispose(), n = null);
      }
    };
  }

  function Yi(t) {
    var e = {};

    function n(n) {
      if (void 0 !== e[n]) return e[n];
      var i;

      switch (n) {
        case "WEBGL_depth_texture":
          i = t.getExtension("WEBGL_depth_texture") || t.getExtension("MOZ_WEBGL_depth_texture") || t.getExtension("WEBKIT_WEBGL_depth_texture");
          break;

        case "EXT_texture_filter_anisotropic":
          i = t.getExtension("EXT_texture_filter_anisotropic") || t.getExtension("MOZ_EXT_texture_filter_anisotropic") || t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");
          break;

        case "WEBGL_compressed_texture_s3tc":
          i = t.getExtension("WEBGL_compressed_texture_s3tc") || t.getExtension("MOZ_WEBGL_compressed_texture_s3tc") || t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");
          break;

        case "WEBGL_compressed_texture_pvrtc":
          i = t.getExtension("WEBGL_compressed_texture_pvrtc") || t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");
          break;

        default:
          i = t.getExtension(n);
      }

      return e[n] = i, i;
    }

    return {
      has: function has(t) {
        return null !== n(t);
      },
      init: function init(t) {
        t.isWebGL2 ? n("EXT_color_buffer_float") : (n("WEBGL_depth_texture"), n("OES_texture_float"), n("OES_texture_half_float"), n("OES_texture_half_float_linear"), n("OES_standard_derivatives"), n("OES_element_index_uint"), n("OES_vertex_array_object"), n("ANGLE_instanced_arrays")), n("OES_texture_float_linear"), n("EXT_color_buffer_half_float");
      },
      get: function get(t) {
        var e = n(t);
        return null === e && console.warn("THREE.WebGLRenderer: " + t + " extension not supported."), e;
      }
    };
  }

  function Ji(t, e, n, i) {
    var r = {},
        s = new WeakMap();

    function a(t) {
      var o = t.target;
      null !== o.index && e.remove(o.index);

      for (var _t78 in o.attributes) {
        e.remove(o.attributes[_t78]);
      }

      o.removeEventListener("dispose", a), delete r[o.id];
      var l = s.get(o);
      l && (e.remove(l), s.delete(o)), i.releaseStatesOfGeometry(o), !0 === o.isInstancedBufferGeometry && delete o._maxInstanceCount, n.memory.geometries--;
    }

    function o(t) {
      var n = [],
          i = t.index,
          r = t.attributes.position;
      var a = 0;

      if (null !== i) {
        var _t79 = i.array;
        a = i.version;

        for (var _e70 = 0, _i64 = _t79.length; _e70 < _i64; _e70 += 3) {
          var _i65 = _t79[_e70 + 0],
              _r52 = _t79[_e70 + 1],
              _s23 = _t79[_e70 + 2];
          n.push(_i65, _r52, _r52, _s23, _s23, _i65);
        }
      } else {
        var _t80 = r.array;
        a = r.version;

        for (var _e71 = 0, _i66 = _t80.length / 3 - 1; _e71 < _i66; _e71 += 3) {
          var _t81 = _e71 + 0,
              _i67 = _e71 + 1,
              _r53 = _e71 + 2;

          n.push(_t81, _i67, _i67, _r53, _r53, _t81);
        }
      }

      var o = new (pn(n) > 65535 ? cn : on)(n, 1);
      o.version = a;
      var l = s.get(t);
      l && e.remove(l), s.set(t, o);
    }

    return {
      get: function get(t, e) {
        return !0 === r[e.id] || (e.addEventListener("dispose", a), r[e.id] = !0, n.memory.geometries++), e;
      },
      update: function update(t) {
        var n = t.attributes;

        for (var _t82 in n) {
          e.update(n[_t82], 34962);
        }

        var i = t.morphAttributes;

        for (var _t83 in i) {
          var _n81 = i[_t83];

          for (var _t84 = 0, _i68 = _n81.length; _t84 < _i68; _t84++) {
            e.update(_n81[_t84], 34962);
          }
        }
      },
      getWireframeAttribute: function getWireframeAttribute(t) {
        var e = s.get(t);

        if (e) {
          var _n82 = t.index;
          null !== _n82 && e.version < _n82.version && o(t);
        } else o(t);

        return s.get(t);
      }
    };
  }

  function Zi(t, e, n, i) {
    var r = i.isWebGL2;
    var s, a, o;
    this.setMode = function (t) {
      s = t;
    }, this.setIndex = function (t) {
      a = t.type, o = t.bytesPerElement;
    }, this.render = function (e, i) {
      t.drawElements(s, i, a, e * o), n.update(i, s, 1);
    }, this.renderInstances = function (i, l, c) {
      if (0 === c) return;
      var h, u;
      if (r) h = t, u = "drawElementsInstanced";else if (h = e.get("ANGLE_instanced_arrays"), u = "drawElementsInstancedANGLE", null === h) return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");
      h[u](s, l, a, i * o, c), n.update(l, s, c);
    };
  }

  function Qi(t) {
    var e = {
      frame: 0,
      calls: 0,
      triangles: 0,
      points: 0,
      lines: 0
    };
    return {
      memory: {
        geometries: 0,
        textures: 0
      },
      render: e,
      programs: null,
      autoReset: !0,
      reset: function reset() {
        e.frame++, e.calls = 0, e.triangles = 0, e.points = 0, e.lines = 0;
      },
      update: function update(t, n, i) {
        switch (e.calls++, n) {
          case 4:
            e.triangles += i * (t / 3);
            break;

          case 1:
            e.lines += i * (t / 2);
            break;

          case 3:
            e.lines += i * (t - 1);
            break;

          case 2:
            e.lines += i * t;
            break;

          case 0:
            e.points += i * t;
            break;

          default:
            console.error("THREE.WebGLInfo: Unknown draw mode:", n);
        }
      }
    };
  }

  function Ki(t, e) {
    return t[0] - e[0];
  }

  function $i(t, e) {
    return Math.abs(e[1]) - Math.abs(t[1]);
  }

  function tr(t) {
    var e = {},
        n = new Float32Array(8),
        i = [];

    for (var _t85 = 0; _t85 < 8; _t85++) {
      i[_t85] = [_t85, 0];
    }

    return {
      update: function update(r, s, a, o) {
        var l = r.morphTargetInfluences,
            c = void 0 === l ? 0 : l.length;
        var h = e[s.id];

        if (void 0 === h || h.length !== c) {
          h = [];

          for (var _t86 = 0; _t86 < c; _t86++) {
            h[_t86] = [_t86, 0];
          }

          e[s.id] = h;
        }

        for (var _t87 = 0; _t87 < c; _t87++) {
          var _e72 = h[_t87];
          _e72[0] = _t87, _e72[1] = l[_t87];
        }

        h.sort($i);

        for (var _t88 = 0; _t88 < 8; _t88++) {
          _t88 < c && h[_t88][1] ? (i[_t88][0] = h[_t88][0], i[_t88][1] = h[_t88][1]) : (i[_t88][0] = Number.MAX_SAFE_INTEGER, i[_t88][1] = 0);
        }

        i.sort(Ki);
        var u = s.morphAttributes.position,
            d = s.morphAttributes.normal;
        var p = 0;

        for (var _t89 = 0; _t89 < 8; _t89++) {
          var _e73 = i[_t89],
              _r54 = _e73[0],
              _a19 = _e73[1];
          _r54 !== Number.MAX_SAFE_INTEGER && _a19 ? (u && s.getAttribute("morphTarget" + _t89) !== u[_r54] && s.setAttribute("morphTarget" + _t89, u[_r54]), d && s.getAttribute("morphNormal" + _t89) !== d[_r54] && s.setAttribute("morphNormal" + _t89, d[_r54]), n[_t89] = _a19, p += _a19) : (u && !0 === s.hasAttribute("morphTarget" + _t89) && s.deleteAttribute("morphTarget" + _t89), d && !0 === s.hasAttribute("morphNormal" + _t89) && s.deleteAttribute("morphNormal" + _t89), n[_t89] = 0);
        }

        var m = s.morphTargetsRelative ? 1 : 1 - p;
        o.getUniforms().setValue(t, "morphTargetBaseInfluence", m), o.getUniforms().setValue(t, "morphTargetInfluences", n);
      }
    };
  }

  function er(t, e, n, i) {
    var r = new WeakMap();

    function s(t) {
      var e = t.target;
      e.removeEventListener("dispose", s), n.remove(e.instanceMatrix), null !== e.instanceColor && n.remove(e.instanceColor);
    }

    return {
      update: function update(t) {
        var a = i.render.frame,
            o = t.geometry,
            l = e.get(t, o);
        return r.get(l) !== a && (e.update(l), r.set(l, a)), t.isInstancedMesh && (!1 === t.hasEventListener("dispose", s) && t.addEventListener("dispose", s), n.update(t.instanceMatrix, 34962), null !== t.instanceColor && n.update(t.instanceColor, 34962)), l;
      },
      dispose: function dispose() {
        r = new WeakMap();
      }
    };
  }

  var nr = /*#__PURE__*/function (_bt2) {
    _inherits(nr, _bt2);

    var _super30 = _createSuper(nr);

    function nr() {
      var _this20;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;

      _classCallCheck(this, nr);

      _this20 = _super30.call(this, null), _this20.image = {
        data: t,
        width: e,
        height: n,
        depth: i
      }, _this20.magFilter = p, _this20.minFilter = p, _this20.wrapR = u, _this20.generateMipmaps = !1, _this20.flipY = !1, _this20.unpackAlignment = 1, _this20.needsUpdate = !0;
      return _this20;
    }

    return nr;
  }(bt);

  nr.prototype.isDataTexture2DArray = !0;

  var ir = /*#__PURE__*/function (_bt3) {
    _inherits(ir, _bt3);

    var _super31 = _createSuper(ir);

    function ir() {
      var _this21;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;

      _classCallCheck(this, ir);

      _this21 = _super31.call(this, null), _this21.image = {
        data: t,
        width: e,
        height: n,
        depth: i
      }, _this21.magFilter = p, _this21.minFilter = p, _this21.wrapR = u, _this21.generateMipmaps = !1, _this21.flipY = !1, _this21.unpackAlignment = 1, _this21.needsUpdate = !0;
      return _this21;
    }

    return ir;
  }(bt);

  ir.prototype.isDataTexture3D = !0;
  var rr = new bt(),
      sr = new nr(),
      ar = new ir(),
      or = new Kn(),
      lr = [],
      cr = [],
      hr = new Float32Array(16),
      ur = new Float32Array(9),
      dr = new Float32Array(4);

  function pr(t, e, n) {
    var i = t[0];
    if (i <= 0 || i > 0) return t;
    var r = e * n;
    var s = lr[r];

    if (void 0 === s && (s = new Float32Array(r), lr[r] = s), 0 !== e) {
      i.toArray(s, 0);

      for (var _i69 = 1, _r55 = 0; _i69 !== e; ++_i69) {
        _r55 += n, t[_i69].toArray(s, _r55);
      }
    }

    return s;
  }

  function mr(t, e) {
    if (t.length !== e.length) return !1;

    for (var _n83 = 0, _i70 = t.length; _n83 < _i70; _n83++) {
      if (t[_n83] !== e[_n83]) return !1;
    }

    return !0;
  }

  function fr(t, e) {
    for (var _n84 = 0, _i71 = e.length; _n84 < _i71; _n84++) {
      t[_n84] = e[_n84];
    }
  }

  function gr(t, e) {
    var n = cr[e];
    void 0 === n && (n = new Int32Array(e), cr[e] = n);

    for (var _i72 = 0; _i72 !== e; ++_i72) {
      n[_i72] = t.allocateTextureUnit();
    }

    return n;
  }

  function vr(t, e) {
    var n = this.cache;
    n[0] !== e && (t.uniform1f(this.addr, e), n[0] = e);
  }

  function yr(t, e) {
    var n = this.cache;
    if (void 0 !== e.x) n[0] === e.x && n[1] === e.y || (t.uniform2f(this.addr, e.x, e.y), n[0] = e.x, n[1] = e.y);else {
      if (mr(n, e)) return;
      t.uniform2fv(this.addr, e), fr(n, e);
    }
  }

  function xr(t, e) {
    var n = this.cache;
    if (void 0 !== e.x) n[0] === e.x && n[1] === e.y && n[2] === e.z || (t.uniform3f(this.addr, e.x, e.y, e.z), n[0] = e.x, n[1] = e.y, n[2] = e.z);else if (void 0 !== e.r) n[0] === e.r && n[1] === e.g && n[2] === e.b || (t.uniform3f(this.addr, e.r, e.g, e.b), n[0] = e.r, n[1] = e.g, n[2] = e.b);else {
      if (mr(n, e)) return;
      t.uniform3fv(this.addr, e), fr(n, e);
    }
  }

  function _r(t, e) {
    var n = this.cache;
    if (void 0 !== e.x) n[0] === e.x && n[1] === e.y && n[2] === e.z && n[3] === e.w || (t.uniform4f(this.addr, e.x, e.y, e.z, e.w), n[0] = e.x, n[1] = e.y, n[2] = e.z, n[3] = e.w);else {
      if (mr(n, e)) return;
      t.uniform4fv(this.addr, e), fr(n, e);
    }
  }

  function Mr(t, e) {
    var n = this.cache,
        i = e.elements;

    if (void 0 === i) {
      if (mr(n, e)) return;
      t.uniformMatrix2fv(this.addr, !1, e), fr(n, e);
    } else {
      if (mr(n, i)) return;
      dr.set(i), t.uniformMatrix2fv(this.addr, !1, dr), fr(n, i);
    }
  }

  function br(t, e) {
    var n = this.cache,
        i = e.elements;

    if (void 0 === i) {
      if (mr(n, e)) return;
      t.uniformMatrix3fv(this.addr, !1, e), fr(n, e);
    } else {
      if (mr(n, i)) return;
      ur.set(i), t.uniformMatrix3fv(this.addr, !1, ur), fr(n, i);
    }
  }

  function wr(t, e) {
    var n = this.cache,
        i = e.elements;

    if (void 0 === i) {
      if (mr(n, e)) return;
      t.uniformMatrix4fv(this.addr, !1, e), fr(n, e);
    } else {
      if (mr(n, i)) return;
      hr.set(i), t.uniformMatrix4fv(this.addr, !1, hr), fr(n, i);
    }
  }

  function Sr(t, e) {
    var n = this.cache;
    n[0] !== e && (t.uniform1i(this.addr, e), n[0] = e);
  }

  function Tr(t, e) {
    var n = this.cache;
    mr(n, e) || (t.uniform2iv(this.addr, e), fr(n, e));
  }

  function Er(t, e) {
    var n = this.cache;
    mr(n, e) || (t.uniform3iv(this.addr, e), fr(n, e));
  }

  function Ar(t, e) {
    var n = this.cache;
    mr(n, e) || (t.uniform4iv(this.addr, e), fr(n, e));
  }

  function Lr(t, e) {
    var n = this.cache;
    n[0] !== e && (t.uniform1ui(this.addr, e), n[0] = e);
  }

  function Rr(t, e) {
    var n = this.cache;
    mr(n, e) || (t.uniform2uiv(this.addr, e), fr(n, e));
  }

  function Cr(t, e) {
    var n = this.cache;
    mr(n, e) || (t.uniform3uiv(this.addr, e), fr(n, e));
  }

  function Pr(t, e) {
    var n = this.cache;
    mr(n, e) || (t.uniform4uiv(this.addr, e), fr(n, e));
  }

  function Ir(t, e, n) {
    var i = this.cache,
        r = n.allocateTextureUnit();
    i[0] !== r && (t.uniform1i(this.addr, r), i[0] = r), n.safeSetTexture2D(e || rr, r);
  }

  function Dr(t, e, n) {
    var i = this.cache,
        r = n.allocateTextureUnit();
    i[0] !== r && (t.uniform1i(this.addr, r), i[0] = r), n.setTexture3D(e || ar, r);
  }

  function Nr(t, e, n) {
    var i = this.cache,
        r = n.allocateTextureUnit();
    i[0] !== r && (t.uniform1i(this.addr, r), i[0] = r), n.safeSetTextureCube(e || or, r);
  }

  function Br(t, e, n) {
    var i = this.cache,
        r = n.allocateTextureUnit();
    i[0] !== r && (t.uniform1i(this.addr, r), i[0] = r), n.setTexture2DArray(e || sr, r);
  }

  function zr(t, e) {
    t.uniform1fv(this.addr, e);
  }

  function Fr(t, e) {
    var n = pr(e, this.size, 2);
    t.uniform2fv(this.addr, n);
  }

  function Or(t, e) {
    var n = pr(e, this.size, 3);
    t.uniform3fv(this.addr, n);
  }

  function Ur(t, e) {
    var n = pr(e, this.size, 4);
    t.uniform4fv(this.addr, n);
  }

  function Hr(t, e) {
    var n = pr(e, this.size, 4);
    t.uniformMatrix2fv(this.addr, !1, n);
  }

  function Gr(t, e) {
    var n = pr(e, this.size, 9);
    t.uniformMatrix3fv(this.addr, !1, n);
  }

  function kr(t, e) {
    var n = pr(e, this.size, 16);
    t.uniformMatrix4fv(this.addr, !1, n);
  }

  function Vr(t, e) {
    t.uniform1iv(this.addr, e);
  }

  function Wr(t, e) {
    t.uniform2iv(this.addr, e);
  }

  function jr(t, e) {
    t.uniform3iv(this.addr, e);
  }

  function qr(t, e) {
    t.uniform4iv(this.addr, e);
  }

  function Xr(t, e) {
    t.uniform1uiv(this.addr, e);
  }

  function Yr(t, e) {
    t.uniform2uiv(this.addr, e);
  }

  function Jr(t, e) {
    t.uniform3uiv(this.addr, e);
  }

  function Zr(t, e) {
    t.uniform4uiv(this.addr, e);
  }

  function Qr(t, e, n) {
    var i = e.length,
        r = gr(n, i);
    t.uniform1iv(this.addr, r);

    for (var _t90 = 0; _t90 !== i; ++_t90) {
      n.safeSetTexture2D(e[_t90] || rr, r[_t90]);
    }
  }

  function Kr(t, e, n) {
    var i = e.length,
        r = gr(n, i);
    t.uniform1iv(this.addr, r);

    for (var _t91 = 0; _t91 !== i; ++_t91) {
      n.safeSetTextureCube(e[_t91] || or, r[_t91]);
    }
  }

  function $r(t, e, n) {
    this.id = t, this.addr = n, this.cache = [], this.setValue = function (t) {
      switch (t) {
        case 5126:
          return vr;

        case 35664:
          return yr;

        case 35665:
          return xr;

        case 35666:
          return _r;

        case 35674:
          return Mr;

        case 35675:
          return br;

        case 35676:
          return wr;

        case 5124:
        case 35670:
          return Sr;

        case 35667:
        case 35671:
          return Tr;

        case 35668:
        case 35672:
          return Er;

        case 35669:
        case 35673:
          return Ar;

        case 5125:
          return Lr;

        case 36294:
          return Rr;

        case 36295:
          return Cr;

        case 36296:
          return Pr;

        case 35678:
        case 36198:
        case 36298:
        case 36306:
        case 35682:
          return Ir;

        case 35679:
        case 36299:
        case 36307:
          return Dr;

        case 35680:
        case 36300:
        case 36308:
        case 36293:
          return Nr;

        case 36289:
        case 36303:
        case 36311:
        case 36292:
          return Br;
      }
    }(e.type);
  }

  function ts(t, e, n) {
    this.id = t, this.addr = n, this.cache = [], this.size = e.size, this.setValue = function (t) {
      switch (t) {
        case 5126:
          return zr;

        case 35664:
          return Fr;

        case 35665:
          return Or;

        case 35666:
          return Ur;

        case 35674:
          return Hr;

        case 35675:
          return Gr;

        case 35676:
          return kr;

        case 5124:
        case 35670:
          return Vr;

        case 35667:
        case 35671:
          return Wr;

        case 35668:
        case 35672:
          return jr;

        case 35669:
        case 35673:
          return qr;

        case 5125:
          return Xr;

        case 36294:
          return Yr;

        case 36295:
          return Jr;

        case 36296:
          return Zr;

        case 35678:
        case 36198:
        case 36298:
        case 36306:
        case 35682:
          return Qr;

        case 35680:
        case 36300:
        case 36308:
        case 36293:
          return Kr;
      }
    }(e.type);
  }

  function es(t) {
    this.id = t, this.seq = [], this.map = {};
  }

  ts.prototype.updateCache = function (t) {
    var e = this.cache;
    t instanceof Float32Array && e.length !== t.length && (this.cache = new Float32Array(t.length)), fr(e, t);
  }, es.prototype.setValue = function (t, e, n) {
    var i = this.seq;

    for (var _r56 = 0, _s24 = i.length; _r56 !== _s24; ++_r56) {
      var _s25 = i[_r56];

      _s25.setValue(t, e[_s25.id], n);
    }
  };
  var ns = /(\w+)(\])?(\[|\.)?/g;

  function is(t, e) {
    t.seq.push(e), t.map[e.id] = e;
  }

  function rs(t, e, n) {
    var i = t.name,
        r = i.length;

    for (ns.lastIndex = 0;;) {
      var _s26 = ns.exec(i),
          _a20 = ns.lastIndex;

      var _o13 = _s26[1];

      var _l14 = "]" === _s26[2],
          _c11 = _s26[3];

      if (_l14 && (_o13 |= 0), void 0 === _c11 || "[" === _c11 && _a20 + 2 === r) {
        is(n, void 0 === _c11 ? new $r(_o13, t, e) : new ts(_o13, t, e));
        break;
      }

      {
        var _t92 = n.map[_o13];
        void 0 === _t92 && (_t92 = new es(_o13), is(n, _t92)), n = _t92;
      }
    }
  }

  function ss(t, e) {
    this.seq = [], this.map = {};
    var n = t.getProgramParameter(e, 35718);

    for (var _i73 = 0; _i73 < n; ++_i73) {
      var _n85 = t.getActiveUniform(e, _i73);

      rs(_n85, t.getUniformLocation(e, _n85.name), this);
    }
  }

  function as(t, e, n) {
    var i = t.createShader(e);
    return t.shaderSource(i, n), t.compileShader(i), i;
  }

  ss.prototype.setValue = function (t, e, n, i) {
    var r = this.map[e];
    void 0 !== r && r.setValue(t, n, i);
  }, ss.prototype.setOptional = function (t, e, n) {
    var i = e[n];
    void 0 !== i && this.setValue(t, n, i);
  }, ss.upload = function (t, e, n, i) {
    for (var _r57 = 0, _s27 = e.length; _r57 !== _s27; ++_r57) {
      var _s28 = e[_r57],
          _a21 = n[_s28.id];
      !1 !== _a21.needsUpdate && _s28.setValue(t, _a21.value, i);
    }
  }, ss.seqWithValue = function (t, e) {
    var n = [];

    for (var _i74 = 0, _r58 = t.length; _i74 !== _r58; ++_i74) {
      var _r59 = t[_i74];
      _r59.id in e && n.push(_r59);
    }

    return n;
  };
  var os = 0;

  function ls(t) {
    switch (t) {
      case X:
        return ["Linear", "( value )"];

      case Y:
        return ["sRGB", "( value )"];

      case Z:
        return ["RGBE", "( value )"];

      case Q:
        return ["RGBM", "( value, 7.0 )"];

      case K:
        return ["RGBM", "( value, 16.0 )"];

      case $:
        return ["RGBD", "( value, 256.0 )"];

      case J:
        return ["Gamma", "( value, float( GAMMA_FACTOR ) )"];

      case 3003:
        return ["LogLuv", "( value )"];

      default:
        return console.warn("THREE.WebGLProgram: Unsupported encoding:", t), ["Linear", "( value )"];
    }
  }

  function cs(t, e, n) {
    var i = t.getShaderParameter(e, 35713),
        r = t.getShaderInfoLog(e).trim();
    if (i && "" === r) return "";
    return "THREE.WebGLShader: gl.getShaderInfoLog() " + n + "\n" + r + function (t) {
      var e = t.split("\n");

      for (var _t93 = 0; _t93 < e.length; _t93++) {
        e[_t93] = _t93 + 1 + ": " + e[_t93];
      }

      return e.join("\n");
    }(t.getShaderSource(e));
  }

  function hs(t, e) {
    var n = ls(e);
    return "vec4 " + t + "( vec4 value ) { return " + n[0] + "ToLinear" + n[1] + "; }";
  }

  function us(t, e) {
    var n = ls(e);
    return "vec4 " + t + "( vec4 value ) { return LinearTo" + n[0] + n[1] + "; }";
  }

  function ds(t, e) {
    var n;

    switch (e) {
      case 1:
        n = "Linear";
        break;

      case 2:
        n = "Reinhard";
        break;

      case 3:
        n = "OptimizedCineon";
        break;

      case 4:
        n = "ACESFilmic";
        break;

      case 5:
        n = "Custom";
        break;

      default:
        console.warn("THREE.WebGLProgram: Unsupported toneMapping:", e), n = "Linear";
    }

    return "vec3 " + t + "( vec3 color ) { return " + n + "ToneMapping( color ); }";
  }

  function ps(t) {
    return "" !== t;
  }

  function ms(t, e) {
    return t.replace(/NUM_DIR_LIGHTS/g, e.numDirLights).replace(/NUM_SPOT_LIGHTS/g, e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g, e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g, e.numPointLights).replace(/NUM_HEMI_LIGHTS/g, e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g, e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g, e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g, e.numPointLightShadows);
  }

  function fs(t, e) {
    return t.replace(/NUM_CLIPPING_PLANES/g, e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g, e.numClippingPlanes - e.numClipIntersection);
  }

  var gs = /^[ \t]*#include +<([\w\d./]+)>/gm;

  function vs(t) {
    return t.replace(gs, ys);
  }

  function ys(t, e) {
    var n = hi[e];
    if (void 0 === n) throw new Error("Can not resolve #include <" + e + ">");
    return vs(n);
  }

  var xs = /#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,
      _s = /#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;

  function Ms(t) {
    return t.replace(_s, ws).replace(xs, bs);
  }

  function bs(t, e, n, i) {
    return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."), ws(t, e, n, i);
  }

  function ws(t, e, n, i) {
    var r = "";

    for (var _t94 = parseInt(e); _t94 < parseInt(n); _t94++) {
      r += i.replace(/\[\s*i\s*\]/g, "[ " + _t94 + " ]").replace(/UNROLLED_LOOP_INDEX/g, _t94);
    }

    return r;
  }

  function Ss(t) {
    var e = "precision " + t.precision + " float;\nprecision " + t.precision + " int;";
    return "highp" === t.precision ? e += "\n#define HIGH_PRECISION" : "mediump" === t.precision ? e += "\n#define MEDIUM_PRECISION" : "lowp" === t.precision && (e += "\n#define LOW_PRECISION"), e;
  }

  function Ts(t, e, n, i) {
    var a = t.getContext(),
        o = n.defines;
    var h = n.vertexShader,
        u = n.fragmentShader;

    var d = function (t) {
      var e = "SHADOWMAP_TYPE_BASIC";
      return 1 === t.shadowMapType ? e = "SHADOWMAP_TYPE_PCF" : 2 === t.shadowMapType ? e = "SHADOWMAP_TYPE_PCF_SOFT" : 3 === t.shadowMapType && (e = "SHADOWMAP_TYPE_VSM"), e;
    }(n),
        p = function (t) {
      var e = "ENVMAP_TYPE_CUBE";
      if (t.envMap) switch (t.envMapMode) {
        case r:
        case s:
          e = "ENVMAP_TYPE_CUBE";
          break;

        case l:
        case c:
          e = "ENVMAP_TYPE_CUBE_UV";
      }
      return e;
    }(n),
        m = function (t) {
      var e = "ENVMAP_MODE_REFLECTION";
      if (t.envMap) switch (t.envMapMode) {
        case s:
        case c:
          e = "ENVMAP_MODE_REFRACTION";
      }
      return e;
    }(n),
        f = function (t) {
      var e = "ENVMAP_BLENDING_NONE";
      if (t.envMap) switch (t.combine) {
        case 0:
          e = "ENVMAP_BLENDING_MULTIPLY";
          break;

        case 1:
          e = "ENVMAP_BLENDING_MIX";
          break;

        case 2:
          e = "ENVMAP_BLENDING_ADD";
      }
      return e;
    }(n),
        g = t.gammaFactor > 0 ? t.gammaFactor : 1,
        v = n.isWebGL2 ? "" : function (t) {
      return [t.extensionDerivatives || t.envMapCubeUV || t.bumpMap || t.tangentSpaceNormalMap || t.clearcoatNormalMap || t.flatShading || "physical" === t.shaderID ? "#extension GL_OES_standard_derivatives : enable" : "", (t.extensionFragDepth || t.logarithmicDepthBuffer) && t.rendererExtensionFragDepth ? "#extension GL_EXT_frag_depth : enable" : "", t.extensionDrawBuffers && t.rendererExtensionDrawBuffers ? "#extension GL_EXT_draw_buffers : require" : "", (t.extensionShaderTextureLOD || t.envMap || t.transmission > 0) && t.rendererExtensionShaderTextureLod ? "#extension GL_EXT_shader_texture_lod : enable" : ""].filter(ps).join("\n");
    }(n),
        y = function (t) {
      var e = [];

      for (var _n86 in t) {
        var _i75 = t[_n86];
        !1 !== _i75 && e.push("#define " + _n86 + " " + _i75);
      }

      return e.join("\n");
    }(o),
        x = a.createProgram();

    var _,
        M,
        b = n.glslVersion ? "#version " + n.glslVersion + "\n" : "";

    n.isRawShaderMaterial ? (_ = [y].filter(ps).join("\n"), _.length > 0 && (_ += "\n"), M = [v, y].filter(ps).join("\n"), M.length > 0 && (M += "\n")) : (_ = [Ss(n), "#define SHADER_NAME " + n.shaderName, y, n.instancing ? "#define USE_INSTANCING" : "", n.instancingColor ? "#define USE_INSTANCING_COLOR" : "", n.supportsVertexTextures ? "#define VERTEX_TEXTURES" : "", "#define GAMMA_FACTOR " + g, "#define MAX_BONES " + n.maxBones, n.useFog && n.fog ? "#define USE_FOG" : "", n.useFog && n.fogExp2 ? "#define FOG_EXP2" : "", n.map ? "#define USE_MAP" : "", n.envMap ? "#define USE_ENVMAP" : "", n.envMap ? "#define " + m : "", n.lightMap ? "#define USE_LIGHTMAP" : "", n.aoMap ? "#define USE_AOMAP" : "", n.emissiveMap ? "#define USE_EMISSIVEMAP" : "", n.bumpMap ? "#define USE_BUMPMAP" : "", n.normalMap ? "#define USE_NORMALMAP" : "", n.normalMap && n.objectSpaceNormalMap ? "#define OBJECTSPACE_NORMALMAP" : "", n.normalMap && n.tangentSpaceNormalMap ? "#define TANGENTSPACE_NORMALMAP" : "", n.clearcoatMap ? "#define USE_CLEARCOATMAP" : "", n.clearcoatRoughnessMap ? "#define USE_CLEARCOAT_ROUGHNESSMAP" : "", n.clearcoatNormalMap ? "#define USE_CLEARCOAT_NORMALMAP" : "", n.displacementMap && n.supportsVertexTextures ? "#define USE_DISPLACEMENTMAP" : "", n.specularMap ? "#define USE_SPECULARMAP" : "", n.specularIntensityMap ? "#define USE_SPECULARINTENSITYMAP" : "", n.specularTintMap ? "#define USE_SPECULARTINTMAP" : "", n.roughnessMap ? "#define USE_ROUGHNESSMAP" : "", n.metalnessMap ? "#define USE_METALNESSMAP" : "", n.alphaMap ? "#define USE_ALPHAMAP" : "", n.transmission ? "#define USE_TRANSMISSION" : "", n.transmissionMap ? "#define USE_TRANSMISSIONMAP" : "", n.thicknessMap ? "#define USE_THICKNESSMAP" : "", n.vertexTangents ? "#define USE_TANGENT" : "", n.vertexColors ? "#define USE_COLOR" : "", n.vertexAlphas ? "#define USE_COLOR_ALPHA" : "", n.vertexUvs ? "#define USE_UV" : "", n.uvsVertexOnly ? "#define UVS_VERTEX_ONLY" : "", n.flatShading ? "#define FLAT_SHADED" : "", n.skinning ? "#define USE_SKINNING" : "", n.useVertexTexture ? "#define BONE_TEXTURE" : "", n.morphTargets ? "#define USE_MORPHTARGETS" : "", n.morphNormals && !1 === n.flatShading ? "#define USE_MORPHNORMALS" : "", n.doubleSided ? "#define DOUBLE_SIDED" : "", n.flipSided ? "#define FLIP_SIDED" : "", n.shadowMapEnabled ? "#define USE_SHADOWMAP" : "", n.shadowMapEnabled ? "#define " + d : "", n.sizeAttenuation ? "#define USE_SIZEATTENUATION" : "", n.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "", n.logarithmicDepthBuffer && n.rendererExtensionFragDepth ? "#define USE_LOGDEPTHBUF_EXT" : "", "uniform mat4 modelMatrix;", "uniform mat4 modelViewMatrix;", "uniform mat4 projectionMatrix;", "uniform mat4 viewMatrix;", "uniform mat3 normalMatrix;", "uniform vec3 cameraPosition;", "uniform bool isOrthographic;", "#ifdef USE_INSTANCING", "\tattribute mat4 instanceMatrix;", "#endif", "#ifdef USE_INSTANCING_COLOR", "\tattribute vec3 instanceColor;", "#endif", "attribute vec3 position;", "attribute vec3 normal;", "attribute vec2 uv;", "#ifdef USE_TANGENT", "\tattribute vec4 tangent;", "#endif", "#if defined( USE_COLOR_ALPHA )", "\tattribute vec4 color;", "#elif defined( USE_COLOR )", "\tattribute vec3 color;", "#endif", "#ifdef USE_MORPHTARGETS", "\tattribute vec3 morphTarget0;", "\tattribute vec3 morphTarget1;", "\tattribute vec3 morphTarget2;", "\tattribute vec3 morphTarget3;", "\t#ifdef USE_MORPHNORMALS", "\t\tattribute vec3 morphNormal0;", "\t\tattribute vec3 morphNormal1;", "\t\tattribute vec3 morphNormal2;", "\t\tattribute vec3 morphNormal3;", "\t#else", "\t\tattribute vec3 morphTarget4;", "\t\tattribute vec3 morphTarget5;", "\t\tattribute vec3 morphTarget6;", "\t\tattribute vec3 morphTarget7;", "\t#endif", "#endif", "#ifdef USE_SKINNING", "\tattribute vec4 skinIndex;", "\tattribute vec4 skinWeight;", "#endif", "\n"].filter(ps).join("\n"), M = [v, Ss(n), "#define SHADER_NAME " + n.shaderName, y, n.alphaTest ? "#define ALPHATEST " + n.alphaTest + (n.alphaTest % 1 ? "" : ".0") : "", "#define GAMMA_FACTOR " + g, n.useFog && n.fog ? "#define USE_FOG" : "", n.useFog && n.fogExp2 ? "#define FOG_EXP2" : "", n.map ? "#define USE_MAP" : "", n.matcap ? "#define USE_MATCAP" : "", n.envMap ? "#define USE_ENVMAP" : "", n.envMap ? "#define " + p : "", n.envMap ? "#define " + m : "", n.envMap ? "#define " + f : "", n.lightMap ? "#define USE_LIGHTMAP" : "", n.aoMap ? "#define USE_AOMAP" : "", n.emissiveMap ? "#define USE_EMISSIVEMAP" : "", n.bumpMap ? "#define USE_BUMPMAP" : "", n.normalMap ? "#define USE_NORMALMAP" : "", n.normalMap && n.objectSpaceNormalMap ? "#define OBJECTSPACE_NORMALMAP" : "", n.normalMap && n.tangentSpaceNormalMap ? "#define TANGENTSPACE_NORMALMAP" : "", n.clearcoatMap ? "#define USE_CLEARCOATMAP" : "", n.clearcoatRoughnessMap ? "#define USE_CLEARCOAT_ROUGHNESSMAP" : "", n.clearcoatNormalMap ? "#define USE_CLEARCOAT_NORMALMAP" : "", n.specularMap ? "#define USE_SPECULARMAP" : "", n.specularIntensityMap ? "#define USE_SPECULARINTENSITYMAP" : "", n.specularTintMap ? "#define USE_SPECULARTINTMAP" : "", n.roughnessMap ? "#define USE_ROUGHNESSMAP" : "", n.metalnessMap ? "#define USE_METALNESSMAP" : "", n.alphaMap ? "#define USE_ALPHAMAP" : "", n.sheen ? "#define USE_SHEEN" : "", n.transmission ? "#define USE_TRANSMISSION" : "", n.transmissionMap ? "#define USE_TRANSMISSIONMAP" : "", n.thicknessMap ? "#define USE_THICKNESSMAP" : "", n.vertexTangents ? "#define USE_TANGENT" : "", n.vertexColors || n.instancingColor ? "#define USE_COLOR" : "", n.vertexAlphas ? "#define USE_COLOR_ALPHA" : "", n.vertexUvs ? "#define USE_UV" : "", n.uvsVertexOnly ? "#define UVS_VERTEX_ONLY" : "", n.gradientMap ? "#define USE_GRADIENTMAP" : "", n.flatShading ? "#define FLAT_SHADED" : "", n.doubleSided ? "#define DOUBLE_SIDED" : "", n.flipSided ? "#define FLIP_SIDED" : "", n.shadowMapEnabled ? "#define USE_SHADOWMAP" : "", n.shadowMapEnabled ? "#define " + d : "", n.premultipliedAlpha ? "#define PREMULTIPLIED_ALPHA" : "", n.physicallyCorrectLights ? "#define PHYSICALLY_CORRECT_LIGHTS" : "", n.logarithmicDepthBuffer ? "#define USE_LOGDEPTHBUF" : "", n.logarithmicDepthBuffer && n.rendererExtensionFragDepth ? "#define USE_LOGDEPTHBUF_EXT" : "", (n.extensionShaderTextureLOD || n.envMap) && n.rendererExtensionShaderTextureLod ? "#define TEXTURE_LOD_EXT" : "", "uniform mat4 viewMatrix;", "uniform vec3 cameraPosition;", "uniform bool isOrthographic;", 0 !== n.toneMapping ? "#define TONE_MAPPING" : "", 0 !== n.toneMapping ? hi.tonemapping_pars_fragment : "", 0 !== n.toneMapping ? ds("toneMapping", n.toneMapping) : "", n.dithering ? "#define DITHERING" : "", hi.encodings_pars_fragment, n.map ? hs("mapTexelToLinear", n.mapEncoding) : "", n.matcap ? hs("matcapTexelToLinear", n.matcapEncoding) : "", n.envMap ? hs("envMapTexelToLinear", n.envMapEncoding) : "", n.emissiveMap ? hs("emissiveMapTexelToLinear", n.emissiveMapEncoding) : "", n.specularTintMap ? hs("specularTintMapTexelToLinear", n.specularTintMapEncoding) : "", n.lightMap ? hs("lightMapTexelToLinear", n.lightMapEncoding) : "", us("linearToOutputTexel", n.outputEncoding), n.depthPacking ? "#define DEPTH_PACKING " + n.depthPacking : "", "\n"].filter(ps).join("\n")), h = vs(h), h = ms(h, n), h = fs(h, n), u = vs(u), u = ms(u, n), u = fs(u, n), h = Ms(h), u = Ms(u), n.isWebGL2 && !0 !== n.isRawShaderMaterial && (b = "#version 300 es\n", _ = ["#define attribute in", "#define varying out", "#define texture2D texture"].join("\n") + "\n" + _, M = ["#define varying in", n.glslVersion === it ? "" : "out highp vec4 pc_fragColor;", n.glslVersion === it ? "" : "#define gl_FragColor pc_fragColor", "#define gl_FragDepthEXT gl_FragDepth", "#define texture2D texture", "#define textureCube texture", "#define texture2DProj textureProj", "#define texture2DLodEXT textureLod", "#define texture2DProjLodEXT textureProjLod", "#define textureCubeLodEXT textureLod", "#define texture2DGradEXT textureGrad", "#define texture2DProjGradEXT textureProjGrad", "#define textureCubeGradEXT textureGrad"].join("\n") + "\n" + M);
    var w = b + M + u,
        S = as(a, 35633, b + _ + h),
        T = as(a, 35632, w);

    if (a.attachShader(x, S), a.attachShader(x, T), void 0 !== n.index0AttributeName ? a.bindAttribLocation(x, 0, n.index0AttributeName) : !0 === n.morphTargets && a.bindAttribLocation(x, 0, "position"), a.linkProgram(x), t.debug.checkShaderErrors) {
      var _t95 = a.getProgramInfoLog(x).trim(),
          _e74 = a.getShaderInfoLog(S).trim(),
          _n87 = a.getShaderInfoLog(T).trim();

      var _i76 = !0,
          _r60 = !0;

      if (!1 === a.getProgramParameter(x, 35714)) {
        _i76 = !1;

        var _e75 = cs(a, S, "vertex"),
            _n88 = cs(a, T, "fragment");

        console.error("THREE.WebGLProgram: shader error: ", a.getError(), "35715", a.getProgramParameter(x, 35715), "gl.getProgramInfoLog", _t95, _e75, _n88);
      } else "" !== _t95 ? console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()", _t95) : "" !== _e74 && "" !== _n87 || (_r60 = !1);

      _r60 && (this.diagnostics = {
        runnable: _i76,
        programLog: _t95,
        vertexShader: {
          log: _e74,
          prefix: _
        },
        fragmentShader: {
          log: _n87,
          prefix: M
        }
      });
    }

    var E, A;
    return a.deleteShader(S), a.deleteShader(T), this.getUniforms = function () {
      return void 0 === E && (E = new ss(a, x)), E;
    }, this.getAttributes = function () {
      return void 0 === A && (A = function (t, e) {
        var n = {},
            i = t.getProgramParameter(e, 35721);

        for (var _r61 = 0; _r61 < i; _r61++) {
          var _i77 = t.getActiveAttrib(e, _r61).name;
          n[_i77] = t.getAttribLocation(e, _i77);
        }

        return n;
      }(a, x)), A;
    }, this.destroy = function () {
      i.releaseStatesOfProgram(this), a.deleteProgram(x), this.program = void 0;
    }, this.name = n.shaderName, this.id = os++, this.cacheKey = e, this.usedTimes = 1, this.program = x, this.vertexShader = S, this.fragmentShader = T, this;
  }

  function Es(t, e, n, i, r, s, a) {
    var o = [],
        h = r.isWebGL2,
        u = r.logarithmicDepthBuffer,
        d = r.floatVertexTextures,
        p = r.maxVertexUniforms,
        m = r.vertexTextures;
    var f = r.precision;
    var g = {
      MeshDepthMaterial: "depth",
      MeshDistanceMaterial: "distanceRGBA",
      MeshNormalMaterial: "normal",
      MeshBasicMaterial: "basic",
      MeshLambertMaterial: "lambert",
      MeshPhongMaterial: "phong",
      MeshToonMaterial: "toon",
      MeshStandardMaterial: "physical",
      MeshPhysicalMaterial: "physical",
      MeshMatcapMaterial: "matcap",
      LineBasicMaterial: "basic",
      LineDashedMaterial: "dashed",
      PointsMaterial: "points",
      ShadowMaterial: "shadow",
      SpriteMaterial: "sprite"
    },
        v = ["precision", "isWebGL2", "supportsVertexTextures", "outputEncoding", "instancing", "instancingColor", "map", "mapEncoding", "matcap", "matcapEncoding", "envMap", "envMapMode", "envMapEncoding", "envMapCubeUV", "lightMap", "lightMapEncoding", "aoMap", "emissiveMap", "emissiveMapEncoding", "bumpMap", "normalMap", "objectSpaceNormalMap", "tangentSpaceNormalMap", "clearcoatMap", "clearcoatRoughnessMap", "clearcoatNormalMap", "displacementMap", "specularMap", "specularIntensityMap", "specularTintMap", "specularTintMapEncoding", "roughnessMap", "metalnessMap", "gradientMap", "alphaMap", "combine", "vertexColors", "vertexAlphas", "vertexTangents", "vertexUvs", "uvsVertexOnly", "fog", "useFog", "fogExp2", "flatShading", "sizeAttenuation", "logarithmicDepthBuffer", "skinning", "maxBones", "useVertexTexture", "morphTargets", "morphNormals", "premultipliedAlpha", "numDirLights", "numPointLights", "numSpotLights", "numHemiLights", "numRectAreaLights", "numDirLightShadows", "numPointLightShadows", "numSpotLightShadows", "shadowMapEnabled", "shadowMapType", "toneMapping", "physicallyCorrectLights", "alphaTest", "doubleSided", "flipSided", "numClippingPlanes", "numClipIntersection", "depthPacking", "dithering", "sheen", "transmission", "transmissionMap", "thicknessMap"];

    function y(t) {
      var e;
      return t && t.isTexture ? e = t.encoding : t && t.isWebGLRenderTarget ? (console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."), e = t.texture.encoding) : e = X, e;
    }

    return {
      getParameters: function getParameters(s, o, v, x, _) {
        var M = x.fog,
            b = s.isMeshStandardMaterial ? x.environment : null,
            w = (s.isMeshStandardMaterial ? n : e).get(s.envMap || b),
            S = g[s.type],
            T = _.isSkinnedMesh ? function (t) {
          var e = t.skeleton.bones;
          if (d) return 1024;
          {
            var _t96 = p,
                _n89 = Math.floor((_t96 - 20) / 4),
                _i78 = Math.min(_n89, e.length);

            return _i78 < e.length ? (console.warn("THREE.WebGLRenderer: Skeleton has " + e.length + " bones. This GPU supports " + _i78 + "."), 0) : _i78;
          }
        }(_) : 0;
        var E, A;

        if (null !== s.precision && (f = r.getMaxPrecision(s.precision), f !== s.precision && console.warn("THREE.WebGLProgram.getParameters:", s.precision, "not supported, using", f, "instead.")), S) {
          var _t97 = di[S];
          E = _t97.vertexShader, A = _t97.fragmentShader;
        } else E = s.vertexShader, A = s.fragmentShader;

        var L = t.getRenderTarget();
        return {
          isWebGL2: h,
          shaderID: S,
          shaderName: s.type,
          vertexShader: E,
          fragmentShader: A,
          defines: s.defines,
          isRawShaderMaterial: !0 === s.isRawShaderMaterial,
          glslVersion: s.glslVersion,
          precision: f,
          instancing: !0 === _.isInstancedMesh,
          instancingColor: !0 === _.isInstancedMesh && null !== _.instanceColor,
          supportsVertexTextures: m,
          outputEncoding: null !== L ? y(L.texture) : t.outputEncoding,
          map: !!s.map,
          mapEncoding: y(s.map),
          matcap: !!s.matcap,
          matcapEncoding: y(s.matcap),
          envMap: !!w,
          envMapMode: w && w.mapping,
          envMapEncoding: y(w),
          envMapCubeUV: !!w && (w.mapping === l || w.mapping === c),
          lightMap: !!s.lightMap,
          lightMapEncoding: y(s.lightMap),
          aoMap: !!s.aoMap,
          emissiveMap: !!s.emissiveMap,
          emissiveMapEncoding: y(s.emissiveMap),
          bumpMap: !!s.bumpMap,
          normalMap: !!s.normalMap,
          objectSpaceNormalMap: 1 === s.normalMapType,
          tangentSpaceNormalMap: 0 === s.normalMapType,
          clearcoatMap: !!s.clearcoatMap,
          clearcoatRoughnessMap: !!s.clearcoatRoughnessMap,
          clearcoatNormalMap: !!s.clearcoatNormalMap,
          displacementMap: !!s.displacementMap,
          roughnessMap: !!s.roughnessMap,
          metalnessMap: !!s.metalnessMap,
          specularMap: !!s.specularMap,
          specularIntensityMap: !!s.specularIntensityMap,
          specularTintMap: !!s.specularTintMap,
          specularTintMapEncoding: y(s.specularTintMap),
          alphaMap: !!s.alphaMap,
          gradientMap: !!s.gradientMap,
          sheen: !!s.sheen,
          transmission: !!s.transmission,
          transmissionMap: !!s.transmissionMap,
          thicknessMap: !!s.thicknessMap,
          combine: s.combine,
          vertexTangents: s.normalMap && _.geometry && _.geometry.attributes.tangent,
          vertexColors: s.vertexColors,
          vertexAlphas: !0 === s.vertexColors && _.geometry && _.geometry.attributes.color && 4 === _.geometry.attributes.color.itemSize,
          vertexUvs: !!(s.map || s.bumpMap || s.normalMap || s.specularMap || s.alphaMap || s.emissiveMap || s.roughnessMap || s.metalnessMap || s.clearcoatMap || s.clearcoatRoughnessMap || s.clearcoatNormalMap || s.displacementMap || s.transmissionMap || s.thicknessMap || s.specularIntensityMap || s.specularTintMap),
          uvsVertexOnly: !(s.map || s.bumpMap || s.normalMap || s.specularMap || s.alphaMap || s.emissiveMap || s.roughnessMap || s.metalnessMap || s.clearcoatNormalMap || s.transmission || s.transmissionMap || s.thicknessMap || s.specularIntensityMap || s.specularTintMap || !s.displacementMap),
          fog: !!M,
          useFog: s.fog,
          fogExp2: M && M.isFogExp2,
          flatShading: !!s.flatShading,
          sizeAttenuation: s.sizeAttenuation,
          logarithmicDepthBuffer: u,
          skinning: !0 === _.isSkinnedMesh && T > 0,
          maxBones: T,
          useVertexTexture: d,
          morphTargets: _.geometry && void 0 !== _.geometry.morphAttributes.position,
          morphNormals: _.geometry && void 0 !== _.geometry.morphAttributes.normal,
          numDirLights: o.directional.length,
          numPointLights: o.point.length,
          numSpotLights: o.spot.length,
          numRectAreaLights: o.rectArea.length,
          numHemiLights: o.hemi.length,
          numDirLightShadows: o.directionalShadowMap.length,
          numPointLightShadows: o.pointShadowMap.length,
          numSpotLightShadows: o.spotShadowMap.length,
          numClippingPlanes: a.numPlanes,
          numClipIntersection: a.numIntersection,
          dithering: s.dithering,
          shadowMapEnabled: t.shadowMap.enabled && v.length > 0,
          shadowMapType: t.shadowMap.type,
          toneMapping: s.toneMapped ? t.toneMapping : 0,
          physicallyCorrectLights: t.physicallyCorrectLights,
          premultipliedAlpha: s.premultipliedAlpha,
          alphaTest: s.alphaTest,
          doubleSided: 2 === s.side,
          flipSided: 1 === s.side,
          depthPacking: void 0 !== s.depthPacking && s.depthPacking,
          index0AttributeName: s.index0AttributeName,
          extensionDerivatives: s.extensions && s.extensions.derivatives,
          extensionFragDepth: s.extensions && s.extensions.fragDepth,
          extensionDrawBuffers: s.extensions && s.extensions.drawBuffers,
          extensionShaderTextureLOD: s.extensions && s.extensions.shaderTextureLOD,
          rendererExtensionFragDepth: h || i.has("EXT_frag_depth"),
          rendererExtensionDrawBuffers: h || i.has("WEBGL_draw_buffers"),
          rendererExtensionShaderTextureLod: h || i.has("EXT_shader_texture_lod"),
          customProgramCacheKey: s.customProgramCacheKey()
        };
      },
      getProgramCacheKey: function getProgramCacheKey(e) {
        var n = [];
        if (e.shaderID ? n.push(e.shaderID) : (n.push(e.fragmentShader), n.push(e.vertexShader)), void 0 !== e.defines) for (var _t98 in e.defines) {
          n.push(_t98), n.push(e.defines[_t98]);
        }

        if (!1 === e.isRawShaderMaterial) {
          for (var _t99 = 0; _t99 < v.length; _t99++) {
            n.push(e[v[_t99]]);
          }

          n.push(t.outputEncoding), n.push(t.gammaFactor);
        }

        return n.push(e.customProgramCacheKey), n.join();
      },
      getUniforms: function getUniforms(t) {
        var e = g[t.type];
        var n;

        if (e) {
          var _t100 = di[e];
          n = qn.clone(_t100.uniforms);
        } else n = t.uniforms;

        return n;
      },
      acquireProgram: function acquireProgram(e, n) {
        var i;

        for (var _t101 = 0, _e76 = o.length; _t101 < _e76; _t101++) {
          var _e77 = o[_t101];

          if (_e77.cacheKey === n) {
            i = _e77, ++i.usedTimes;
            break;
          }
        }

        return void 0 === i && (i = new Ts(t, n, e, s), o.push(i)), i;
      },
      releaseProgram: function releaseProgram(t) {
        if (0 == --t.usedTimes) {
          var _e78 = o.indexOf(t);

          o[_e78] = o[o.length - 1], o.pop(), t.destroy();
        }
      },
      programs: o
    };
  }

  function As() {
    var t = new WeakMap();
    return {
      get: function get(e) {
        var n = t.get(e);
        return void 0 === n && (n = {}, t.set(e, n)), n;
      },
      remove: function remove(e) {
        t.delete(e);
      },
      update: function update(e, n, i) {
        t.get(e)[n] = i;
      },
      dispose: function dispose() {
        t = new WeakMap();
      }
    };
  }

  function Ls(t, e) {
    return t.groupOrder !== e.groupOrder ? t.groupOrder - e.groupOrder : t.renderOrder !== e.renderOrder ? t.renderOrder - e.renderOrder : t.program !== e.program ? t.program.id - e.program.id : t.material.id !== e.material.id ? t.material.id - e.material.id : t.z !== e.z ? t.z - e.z : t.id - e.id;
  }

  function Rs(t, e) {
    return t.groupOrder !== e.groupOrder ? t.groupOrder - e.groupOrder : t.renderOrder !== e.renderOrder ? t.renderOrder - e.renderOrder : t.z !== e.z ? e.z - t.z : t.id - e.id;
  }

  function Cs(t) {
    var e = [];
    var n = 0;
    var i = [],
        r = [],
        s = [],
        a = {
      id: -1
    };

    function o(i, r, s, o, l, c) {
      var h = e[n];
      var u = t.get(s);
      return void 0 === h ? (h = {
        id: i.id,
        object: i,
        geometry: r,
        material: s,
        program: u.program || a,
        groupOrder: o,
        renderOrder: i.renderOrder,
        z: l,
        group: c
      }, e[n] = h) : (h.id = i.id, h.object = i, h.geometry = r, h.material = s, h.program = u.program || a, h.groupOrder = o, h.renderOrder = i.renderOrder, h.z = l, h.group = c), n++, h;
    }

    return {
      opaque: i,
      transmissive: r,
      transparent: s,
      init: function init() {
        n = 0, i.length = 0, r.length = 0, s.length = 0;
      },
      push: function push(t, e, n, a, l, c) {
        var h = o(t, e, n, a, l, c);
        n.transmission > 0 ? r.push(h) : !0 === n.transparent ? s.push(h) : i.push(h);
      },
      unshift: function unshift(t, e, n, a, l, c) {
        var h = o(t, e, n, a, l, c);
        n.transmission > 0 ? r.unshift(h) : !0 === n.transparent ? s.unshift(h) : i.unshift(h);
      },
      finish: function finish() {
        for (var _t102 = n, _i79 = e.length; _t102 < _i79; _t102++) {
          var _n90 = e[_t102];
          if (null === _n90.id) break;
          _n90.id = null, _n90.object = null, _n90.geometry = null, _n90.material = null, _n90.program = null, _n90.group = null;
        }
      },
      sort: function sort(t, e) {
        i.length > 1 && i.sort(t || Ls), r.length > 1 && r.sort(e || Rs), s.length > 1 && s.sort(e || Rs);
      }
    };
  }

  function Ps(t) {
    var e = new WeakMap();
    return {
      get: function get(n, i) {
        var r;
        return !1 === e.has(n) ? (r = new Cs(t), e.set(n, [r])) : i >= e.get(n).length ? (r = new Cs(t), e.get(n).push(r)) : r = e.get(n)[i], r;
      },
      dispose: function dispose() {
        e = new WeakMap();
      }
    };
  }

  function Is() {
    var t = {};
    return {
      get: function get(e) {
        if (void 0 !== t[e.id]) return t[e.id];
        var n;

        switch (e.type) {
          case "DirectionalLight":
            n = {
              direction: new Rt(),
              color: new Qe()
            };
            break;

          case "SpotLight":
            n = {
              position: new Rt(),
              direction: new Rt(),
              color: new Qe(),
              distance: 0,
              coneCos: 0,
              penumbraCos: 0,
              decay: 0
            };
            break;

          case "PointLight":
            n = {
              position: new Rt(),
              color: new Qe(),
              distance: 0,
              decay: 0
            };
            break;

          case "HemisphereLight":
            n = {
              direction: new Rt(),
              skyColor: new Qe(),
              groundColor: new Qe()
            };
            break;

          case "RectAreaLight":
            n = {
              color: new Qe(),
              position: new Rt(),
              halfWidth: new Rt(),
              halfHeight: new Rt()
            };
        }

        return t[e.id] = n, n;
      }
    };
  }

  var Ds = 0;

  function Ns(t, e) {
    return (e.castShadow ? 1 : 0) - (t.castShadow ? 1 : 0);
  }

  function Bs(t, e) {
    var n = new Is(),
        i = function () {
      var t = {};
      return {
        get: function get(e) {
          if (void 0 !== t[e.id]) return t[e.id];
          var n;

          switch (e.type) {
            case "DirectionalLight":
            case "SpotLight":
              n = {
                shadowBias: 0,
                shadowNormalBias: 0,
                shadowRadius: 1,
                shadowMapSize: new vt()
              };
              break;

            case "PointLight":
              n = {
                shadowBias: 0,
                shadowNormalBias: 0,
                shadowRadius: 1,
                shadowMapSize: new vt(),
                shadowCameraNear: 1,
                shadowCameraFar: 1e3
              };
          }

          return t[e.id] = n, n;
        }
      };
    }(),
        r = {
      version: 0,
      hash: {
        directionalLength: -1,
        pointLength: -1,
        spotLength: -1,
        rectAreaLength: -1,
        hemiLength: -1,
        numDirectionalShadows: -1,
        numPointShadows: -1,
        numSpotShadows: -1
      },
      ambient: [0, 0, 0],
      probe: [],
      directional: [],
      directionalShadow: [],
      directionalShadowMap: [],
      directionalShadowMatrix: [],
      spot: [],
      spotShadow: [],
      spotShadowMap: [],
      spotShadowMatrix: [],
      rectArea: [],
      rectAreaLTC1: null,
      rectAreaLTC2: null,
      point: [],
      pointShadow: [],
      pointShadowMap: [],
      pointShadowMatrix: [],
      hemi: []
    };

    for (var _t103 = 0; _t103 < 9; _t103++) {
      r.probe.push(new Rt());
    }

    var s = new Rt(),
        a = new ae(),
        o = new ae();
    return {
      setup: function setup(s) {
        var a = 0,
            o = 0,
            l = 0;

        for (var _t104 = 0; _t104 < 9; _t104++) {
          r.probe[_t104].set(0, 0, 0);
        }

        var c = 0,
            h = 0,
            u = 0,
            d = 0,
            p = 0,
            m = 0,
            f = 0,
            g = 0;
        s.sort(Ns);

        for (var _t105 = 0, _e79 = s.length; _t105 < _e79; _t105++) {
          var _e80 = s[_t105],
              _v3 = _e80.color,
              _y3 = _e80.intensity,
              _x3 = _e80.distance,
              _3 = _e80.shadow && _e80.shadow.map ? _e80.shadow.map.texture : null;

          if (_e80.isAmbientLight) a += _v3.r * _y3, o += _v3.g * _y3, l += _v3.b * _y3;else if (_e80.isLightProbe) for (var _t106 = 0; _t106 < 9; _t106++) {
            r.probe[_t106].addScaledVector(_e80.sh.coefficients[_t106], _y3);
          } else if (_e80.isDirectionalLight) {
            var _t107 = n.get(_e80);

            if (_t107.color.copy(_e80.color).multiplyScalar(_e80.intensity), _e80.castShadow) {
              var _t108 = _e80.shadow,
                  _n91 = i.get(_e80);

              _n91.shadowBias = _t108.bias, _n91.shadowNormalBias = _t108.normalBias, _n91.shadowRadius = _t108.radius, _n91.shadowMapSize = _t108.mapSize, r.directionalShadow[c] = _n91, r.directionalShadowMap[c] = _3, r.directionalShadowMatrix[c] = _e80.shadow.matrix, m++;
            }

            r.directional[c] = _t107, c++;
          } else if (_e80.isSpotLight) {
            var _t109 = n.get(_e80);

            if (_t109.position.setFromMatrixPosition(_e80.matrixWorld), _t109.color.copy(_v3).multiplyScalar(_y3), _t109.distance = _x3, _t109.coneCos = Math.cos(_e80.angle), _t109.penumbraCos = Math.cos(_e80.angle * (1 - _e80.penumbra)), _t109.decay = _e80.decay, _e80.castShadow) {
              var _t110 = _e80.shadow,
                  _n92 = i.get(_e80);

              _n92.shadowBias = _t110.bias, _n92.shadowNormalBias = _t110.normalBias, _n92.shadowRadius = _t110.radius, _n92.shadowMapSize = _t110.mapSize, r.spotShadow[u] = _n92, r.spotShadowMap[u] = _3, r.spotShadowMatrix[u] = _e80.shadow.matrix, g++;
            }

            r.spot[u] = _t109, u++;
          } else if (_e80.isRectAreaLight) {
            var _t111 = n.get(_e80);

            _t111.color.copy(_v3).multiplyScalar(_y3), _t111.halfWidth.set(.5 * _e80.width, 0, 0), _t111.halfHeight.set(0, .5 * _e80.height, 0), r.rectArea[d] = _t111, d++;
          } else if (_e80.isPointLight) {
            var _t112 = n.get(_e80);

            if (_t112.color.copy(_e80.color).multiplyScalar(_e80.intensity), _t112.distance = _e80.distance, _t112.decay = _e80.decay, _e80.castShadow) {
              var _t113 = _e80.shadow,
                  _n93 = i.get(_e80);

              _n93.shadowBias = _t113.bias, _n93.shadowNormalBias = _t113.normalBias, _n93.shadowRadius = _t113.radius, _n93.shadowMapSize = _t113.mapSize, _n93.shadowCameraNear = _t113.camera.near, _n93.shadowCameraFar = _t113.camera.far, r.pointShadow[h] = _n93, r.pointShadowMap[h] = _3, r.pointShadowMatrix[h] = _e80.shadow.matrix, f++;
            }

            r.point[h] = _t112, h++;
          } else if (_e80.isHemisphereLight) {
            var _t114 = n.get(_e80);

            _t114.skyColor.copy(_e80.color).multiplyScalar(_y3), _t114.groundColor.copy(_e80.groundColor).multiplyScalar(_y3), r.hemi[p] = _t114, p++;
          }
        }

        d > 0 && (e.isWebGL2 || !0 === t.has("OES_texture_float_linear") ? (r.rectAreaLTC1 = ui.LTC_FLOAT_1, r.rectAreaLTC2 = ui.LTC_FLOAT_2) : !0 === t.has("OES_texture_half_float_linear") ? (r.rectAreaLTC1 = ui.LTC_HALF_1, r.rectAreaLTC2 = ui.LTC_HALF_2) : console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")), r.ambient[0] = a, r.ambient[1] = o, r.ambient[2] = l;
        var v = r.hash;
        v.directionalLength === c && v.pointLength === h && v.spotLength === u && v.rectAreaLength === d && v.hemiLength === p && v.numDirectionalShadows === m && v.numPointShadows === f && v.numSpotShadows === g || (r.directional.length = c, r.spot.length = u, r.rectArea.length = d, r.point.length = h, r.hemi.length = p, r.directionalShadow.length = m, r.directionalShadowMap.length = m, r.pointShadow.length = f, r.pointShadowMap.length = f, r.spotShadow.length = g, r.spotShadowMap.length = g, r.directionalShadowMatrix.length = m, r.pointShadowMatrix.length = f, r.spotShadowMatrix.length = g, v.directionalLength = c, v.pointLength = h, v.spotLength = u, v.rectAreaLength = d, v.hemiLength = p, v.numDirectionalShadows = m, v.numPointShadows = f, v.numSpotShadows = g, r.version = Ds++);
      },
      setupView: function setupView(t, e) {
        var n = 0,
            i = 0,
            l = 0,
            c = 0,
            h = 0;
        var u = e.matrixWorldInverse;

        for (var _e81 = 0, _d7 = t.length; _e81 < _d7; _e81++) {
          var _d8 = t[_e81];

          if (_d8.isDirectionalLight) {
            var _t115 = r.directional[n];
            _t115.direction.setFromMatrixPosition(_d8.matrixWorld), s.setFromMatrixPosition(_d8.target.matrixWorld), _t115.direction.sub(s), _t115.direction.transformDirection(u), n++;
          } else if (_d8.isSpotLight) {
            var _t116 = r.spot[l];
            _t116.position.setFromMatrixPosition(_d8.matrixWorld), _t116.position.applyMatrix4(u), _t116.direction.setFromMatrixPosition(_d8.matrixWorld), s.setFromMatrixPosition(_d8.target.matrixWorld), _t116.direction.sub(s), _t116.direction.transformDirection(u), l++;
          } else if (_d8.isRectAreaLight) {
            var _t117 = r.rectArea[c];
            _t117.position.setFromMatrixPosition(_d8.matrixWorld), _t117.position.applyMatrix4(u), o.identity(), a.copy(_d8.matrixWorld), a.premultiply(u), o.extractRotation(a), _t117.halfWidth.set(.5 * _d8.width, 0, 0), _t117.halfHeight.set(0, .5 * _d8.height, 0), _t117.halfWidth.applyMatrix4(o), _t117.halfHeight.applyMatrix4(o), c++;
          } else if (_d8.isPointLight) {
            var _t118 = r.point[i];
            _t118.position.setFromMatrixPosition(_d8.matrixWorld), _t118.position.applyMatrix4(u), i++;
          } else if (_d8.isHemisphereLight) {
            var _t119 = r.hemi[h];
            _t119.direction.setFromMatrixPosition(_d8.matrixWorld), _t119.direction.transformDirection(u), _t119.direction.normalize(), h++;
          }
        }
      },
      state: r
    };
  }

  function zs(t, e) {
    var n = new Bs(t, e),
        i = [],
        r = [];
    return {
      init: function init() {
        i.length = 0, r.length = 0;
      },
      state: {
        lightsArray: i,
        shadowsArray: r,
        lights: n
      },
      setupLights: function setupLights() {
        n.setup(i);
      },
      setupLightsView: function setupLightsView(t) {
        n.setupView(i, t);
      },
      pushLight: function pushLight(t) {
        i.push(t);
      },
      pushShadow: function pushShadow(t) {
        r.push(t);
      }
    };
  }

  function Fs(t, e) {
    var n = new WeakMap();
    return {
      get: function get(i) {
        var r = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        var s;
        return !1 === n.has(i) ? (s = new zs(t, e), n.set(i, [s])) : r >= n.get(i).length ? (s = new zs(t, e), n.get(i).push(s)) : s = n.get(i)[r], s;
      },
      dispose: function dispose() {
        n = new WeakMap();
      }
    };
  }

  var Os = /*#__PURE__*/function (_We3) {
    _inherits(Os, _We3);

    var _super32 = _createSuper(Os);

    function Os(t) {
      var _this22;

      _classCallCheck(this, Os);

      _this22 = _super32.call(this), _this22.type = "MeshDepthMaterial", _this22.depthPacking = 3200, _this22.map = null, _this22.alphaMap = null, _this22.displacementMap = null, _this22.displacementScale = 1, _this22.displacementBias = 0, _this22.wireframe = !1, _this22.wireframeLinewidth = 1, _this22.fog = !1, _this22.setValues(t);
      return _this22;
    }

    _createClass(Os, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Os.prototype), "copy", this).call(this, t), this.depthPacking = t.depthPacking, this.map = t.map, this.alphaMap = t.alphaMap, this.displacementMap = t.displacementMap, this.displacementScale = t.displacementScale, this.displacementBias = t.displacementBias, this.wireframe = t.wireframe, this.wireframeLinewidth = t.wireframeLinewidth, this;
      }
    }]);

    return Os;
  }(We);

  Os.prototype.isMeshDepthMaterial = !0;

  var Us = /*#__PURE__*/function (_We4) {
    _inherits(Us, _We4);

    var _super33 = _createSuper(Us);

    function Us(t) {
      var _this23;

      _classCallCheck(this, Us);

      _this23 = _super33.call(this), _this23.type = "MeshDistanceMaterial", _this23.referencePosition = new Rt(), _this23.nearDistance = 1, _this23.farDistance = 1e3, _this23.map = null, _this23.alphaMap = null, _this23.displacementMap = null, _this23.displacementScale = 1, _this23.displacementBias = 0, _this23.fog = !1, _this23.setValues(t);
      return _this23;
    }

    _createClass(Us, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Us.prototype), "copy", this).call(this, t), this.referencePosition.copy(t.referencePosition), this.nearDistance = t.nearDistance, this.farDistance = t.farDistance, this.map = t.map, this.alphaMap = t.alphaMap, this.displacementMap = t.displacementMap, this.displacementScale = t.displacementScale, this.displacementBias = t.displacementBias, this;
      }
    }]);

    return Us;
  }(We);

  Us.prototype.isMeshDistanceMaterial = !0;

  function Hs(t, e, n) {
    var i = new ai();
    var r = new vt(),
        s = new vt(),
        a = new St(),
        o = new Os({
      depthPacking: 3201
    }),
        l = new Us(),
        c = {},
        h = n.maxTextureSize,
        u = {
      0: 1,
      1: 0,
      2: 2
    },
        d = new Xn({
      defines: {
        SAMPLE_RATE: 2 / 8,
        HALF_SAMPLE_RATE: 1 / 8
      },
      uniforms: {
        shadow_pass: {
          value: null
        },
        resolution: {
          value: new vt()
        },
        radius: {
          value: 4
        }
      },
      vertexShader: "void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",
      fragmentShader: "uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"
    }),
        m = d.clone();
    m.defines.HORIZONTAL_PASS = 1;
    var f = new wn();
    f.setAttribute("position", new en(new Float32Array([-1, -1, .5, 3, -1, .5, -1, 3, .5]), 3));
    var v = new Gn(f, d),
        y = this;

    function x(n, i) {
      var r = e.update(v);
      d.uniforms.shadow_pass.value = n.map.texture, d.uniforms.resolution.value = n.mapSize, d.uniforms.radius.value = n.radius, t.setRenderTarget(n.mapPass), t.clear(), t.renderBufferDirect(i, null, r, d, v, null), m.uniforms.shadow_pass.value = n.mapPass.texture, m.uniforms.resolution.value = n.mapSize, m.uniforms.radius.value = n.radius, t.setRenderTarget(n.map), t.clear(), t.renderBufferDirect(i, null, r, m, v, null);
    }

    function _(e, n, i, r, s, a, h) {
      var d = null;
      var p = !0 === r.isPointLight ? e.customDistanceMaterial : e.customDepthMaterial;

      if (d = void 0 !== p ? p : !0 === r.isPointLight ? l : o, t.localClippingEnabled && !0 === i.clipShadows && 0 !== i.clippingPlanes.length) {
        var _t120 = d.uuid,
            _e82 = i.uuid;
        var _n94 = c[_t120];
        void 0 === _n94 && (_n94 = {}, c[_t120] = _n94);
        var _r62 = _n94[_e82];
        void 0 === _r62 && (_r62 = d.clone(), _n94[_e82] = _r62), d = _r62;
      }

      return d.visible = i.visible, d.wireframe = i.wireframe, d.side = 3 === h ? null !== i.shadowSide ? i.shadowSide : i.side : null !== i.shadowSide ? i.shadowSide : u[i.side], d.clipShadows = i.clipShadows, d.clippingPlanes = i.clippingPlanes, d.clipIntersection = i.clipIntersection, d.wireframeLinewidth = i.wireframeLinewidth, d.linewidth = i.linewidth, !0 === r.isPointLight && !0 === d.isMeshDistanceMaterial && (d.referencePosition.setFromMatrixPosition(r.matrixWorld), d.nearDistance = s, d.farDistance = a), d;
    }

    function M(n, r, s, a, o) {
      if (!1 === n.visible) return;

      if (n.layers.test(r.layers) && (n.isMesh || n.isLine || n.isPoints) && (n.castShadow || n.receiveShadow && 3 === o) && (!n.frustumCulled || i.intersectsObject(n))) {
        n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse, n.matrixWorld);

        var _i80 = e.update(n),
            _r63 = n.material;

        if (Array.isArray(_r63)) {
          var _e83 = _i80.groups;

          for (var _l15 = 0, _c12 = _e83.length; _l15 < _c12; _l15++) {
            var _c13 = _e83[_l15],
                _h9 = _r63[_c13.materialIndex];

            if (_h9 && _h9.visible) {
              var _e84 = _(n, 0, _h9, a, s.near, s.far, o);

              t.renderBufferDirect(s, null, _i80, _e84, n, _c13);
            }
          }
        } else if (_r63.visible) {
          var _e85 = _(n, 0, _r63, a, s.near, s.far, o);

          t.renderBufferDirect(s, null, _i80, _e85, n, null);
        }
      }

      var l = n.children;

      for (var _t121 = 0, _e86 = l.length; _t121 < _e86; _t121++) {
        M(l[_t121], r, s, a, o);
      }
    }

    this.enabled = !1, this.autoUpdate = !0, this.needsUpdate = !1, this.type = 1, this.render = function (e, n, o) {
      if (!1 === y.enabled) return;
      if (!1 === y.autoUpdate && !1 === y.needsUpdate) return;
      if (0 === e.length) return;
      var l = t.getRenderTarget(),
          c = t.getActiveCubeFace(),
          u = t.getActiveMipmapLevel(),
          d = t.state;
      d.setBlending(0), d.buffers.color.setClear(1, 1, 1, 1), d.buffers.depth.setTest(!0), d.setScissorTest(!1);

      for (var _l16 = 0, _c14 = e.length; _l16 < _c14; _l16++) {
        var _c15 = e[_l16],
            _u10 = _c15.shadow;

        if (void 0 === _u10) {
          console.warn("THREE.WebGLShadowMap:", _c15, "has no shadow.");
          continue;
        }

        if (!1 === _u10.autoUpdate && !1 === _u10.needsUpdate) continue;
        r.copy(_u10.mapSize);

        var _m4 = _u10.getFrameExtents();

        if (r.multiply(_m4), s.copy(_u10.mapSize), (r.x > h || r.y > h) && (r.x > h && (s.x = Math.floor(h / _m4.x), r.x = s.x * _m4.x, _u10.mapSize.x = s.x), r.y > h && (s.y = Math.floor(h / _m4.y), r.y = s.y * _m4.y, _u10.mapSize.y = s.y)), null === _u10.map && !_u10.isPointLightShadow && 3 === this.type) {
          var _t122 = {
            minFilter: g,
            magFilter: g,
            format: E
          };
          _u10.map = new Tt(r.x, r.y, _t122), _u10.map.texture.name = _c15.name + ".shadowMap", _u10.mapPass = new Tt(r.x, r.y, _t122), _u10.camera.updateProjectionMatrix();
        }

        if (null === _u10.map) {
          var _t123 = {
            minFilter: p,
            magFilter: p,
            format: E
          };
          _u10.map = new Tt(r.x, r.y, _t123), _u10.map.texture.name = _c15.name + ".shadowMap", _u10.camera.updateProjectionMatrix();
        }

        t.setRenderTarget(_u10.map), t.clear();

        var _f2 = _u10.getViewportCount();

        for (var _t124 = 0; _t124 < _f2; _t124++) {
          var _e87 = _u10.getViewport(_t124);

          a.set(s.x * _e87.x, s.y * _e87.y, s.x * _e87.z, s.y * _e87.w), d.viewport(a), _u10.updateMatrices(_c15, _t124), i = _u10.getFrustum(), M(n, o, _u10.camera, _c15, this.type);
        }

        _u10.isPointLightShadow || 3 !== this.type || x(_u10, o), _u10.needsUpdate = !1;
      }

      y.needsUpdate = !1, t.setRenderTarget(l, c, u);
    };
  }

  function Gs(t, e, i) {
    var _H;

    var r = i.isWebGL2;
    var s = new function () {
      var e = !1;
      var n = new St();
      var i = null;
      var r = new St(0, 0, 0, 0);
      return {
        setMask: function setMask(n) {
          i === n || e || (t.colorMask(n, n, n, n), i = n);
        },
        setLocked: function setLocked(t) {
          e = t;
        },
        setClear: function setClear(e, i, s, a, o) {
          !0 === o && (e *= a, i *= a, s *= a), n.set(e, i, s, a), !1 === r.equals(n) && (t.clearColor(e, i, s, a), r.copy(n));
        },
        reset: function reset() {
          e = !1, i = null, r.set(-1, 0, 0, 0);
        }
      };
    }(),
        a = new function () {
      var e = !1,
          n = null,
          i = null,
          r = null;
      return {
        setTest: function setTest(t) {
          t ? O(2929) : U(2929);
        },
        setMask: function setMask(i) {
          n === i || e || (t.depthMask(i), n = i);
        },
        setFunc: function setFunc(e) {
          if (i !== e) {
            if (e) switch (e) {
              case 0:
                t.depthFunc(512);
                break;

              case 1:
                t.depthFunc(519);
                break;

              case 2:
                t.depthFunc(513);
                break;

              case 3:
                t.depthFunc(515);
                break;

              case 4:
                t.depthFunc(514);
                break;

              case 5:
                t.depthFunc(518);
                break;

              case 6:
                t.depthFunc(516);
                break;

              case 7:
                t.depthFunc(517);
                break;

              default:
                t.depthFunc(515);
            } else t.depthFunc(515);
            i = e;
          }
        },
        setLocked: function setLocked(t) {
          e = t;
        },
        setClear: function setClear(e) {
          r !== e && (t.clearDepth(e), r = e);
        },
        reset: function reset() {
          e = !1, n = null, i = null, r = null;
        }
      };
    }(),
        o = new function () {
      var e = !1,
          n = null,
          i = null,
          r = null,
          s = null,
          a = null,
          o = null,
          l = null,
          c = null;
      return {
        setTest: function setTest(t) {
          e || (t ? O(2960) : U(2960));
        },
        setMask: function setMask(i) {
          n === i || e || (t.stencilMask(i), n = i);
        },
        setFunc: function setFunc(e, n, a) {
          i === e && r === n && s === a || (t.stencilFunc(e, n, a), i = e, r = n, s = a);
        },
        setOp: function setOp(e, n, i) {
          a === e && o === n && l === i || (t.stencilOp(e, n, i), a = e, o = n, l = i);
        },
        setLocked: function setLocked(t) {
          e = t;
        },
        setClear: function setClear(e) {
          c !== e && (t.clearStencil(e), c = e);
        },
        reset: function reset() {
          e = !1, n = null, i = null, r = null, s = null, a = null, o = null, l = null, c = null;
        }
      };
    }();

    var l = {},
        c = null,
        h = {},
        u = null,
        d = !1,
        p = null,
        m = null,
        f = null,
        g = null,
        v = null,
        y = null,
        x = null,
        _ = !1,
        M = null,
        b = null,
        w = null,
        S = null,
        T = null;

    var E = t.getParameter(35661);
    var A = !1,
        L = 0;
    var R = t.getParameter(7938);
    -1 !== R.indexOf("WebGL") ? (L = parseFloat(/^WebGL (\d)/.exec(R)[1]), A = L >= 1) : -1 !== R.indexOf("OpenGL ES") && (L = parseFloat(/^OpenGL ES (\d)/.exec(R)[1]), A = L >= 2);
    var C = null,
        P = {};
    var I = t.getParameter(3088),
        D = t.getParameter(2978),
        N = new St().fromArray(I),
        B = new St().fromArray(D);

    function z(e, n, i) {
      var r = new Uint8Array(4),
          s = t.createTexture();
      t.bindTexture(e, s), t.texParameteri(e, 10241, 9728), t.texParameteri(e, 10240, 9728);

      for (var _e88 = 0; _e88 < i; _e88++) {
        t.texImage2D(n + _e88, 0, 6408, 1, 1, 0, 6408, 5121, r);
      }

      return s;
    }

    var F = {};

    function O(e) {
      !0 !== l[e] && (t.enable(e), l[e] = !0);
    }

    function U(e) {
      !1 !== l[e] && (t.disable(e), l[e] = !1);
    }

    F[3553] = z(3553, 3553, 1), F[34067] = z(34067, 34069, 6), s.setClear(0, 0, 0, 1), a.setClear(1), o.setClear(0), O(2929), a.setFunc(3), V(!1), W(1), O(2884), k(0);
    var H = (_H = {}, _defineProperty(_H, n, 32774), _defineProperty(_H, 101, 32778), _defineProperty(_H, 102, 32779), _H);
    if (r) H[103] = 32775, H[104] = 32776;else {
      var _t125 = e.get("EXT_blend_minmax");

      null !== _t125 && (H[103] = _t125.MIN_EXT, H[104] = _t125.MAX_EXT);
    }
    var G = {
      200: 0,
      201: 1,
      202: 768,
      204: 770,
      210: 776,
      208: 774,
      206: 772,
      203: 769,
      205: 771,
      209: 775,
      207: 773
    };

    function k(e, i, r, s, a, o, l, c) {
      if (0 !== e) {
        if (!1 === d && (O(3042), d = !0), 5 === e) a = a || i, o = o || r, l = l || s, i === m && a === v || (t.blendEquationSeparate(H[i], H[a]), m = i, v = a), r === f && s === g && o === y && l === x || (t.blendFuncSeparate(G[r], G[s], G[o], G[l]), f = r, g = s, y = o, x = l), p = e, _ = null;else if (e !== p || c !== _) {
          if (m === n && v === n || (t.blendEquation(32774), m = n, v = n), c) switch (e) {
            case 1:
              t.blendFuncSeparate(1, 771, 1, 771);
              break;

            case 2:
              t.blendFunc(1, 1);
              break;

            case 3:
              t.blendFuncSeparate(0, 0, 769, 771);
              break;

            case 4:
              t.blendFuncSeparate(0, 768, 0, 770);
              break;

            default:
              console.error("THREE.WebGLState: Invalid blending: ", e);
          } else switch (e) {
            case 1:
              t.blendFuncSeparate(770, 771, 1, 771);
              break;

            case 2:
              t.blendFunc(770, 1);
              break;

            case 3:
              t.blendFunc(0, 769);
              break;

            case 4:
              t.blendFunc(0, 768);
              break;

            default:
              console.error("THREE.WebGLState: Invalid blending: ", e);
          }
          f = null, g = null, y = null, x = null, p = e, _ = c;
        }
      } else !0 === d && (U(3042), d = !1);
    }

    function V(e) {
      M !== e && (e ? t.frontFace(2304) : t.frontFace(2305), M = e);
    }

    function W(e) {
      0 !== e ? (O(2884), e !== b && (1 === e ? t.cullFace(1029) : 2 === e ? t.cullFace(1028) : t.cullFace(1032))) : U(2884), b = e;
    }

    function j(e, n, i) {
      e ? (O(32823), S === n && T === i || (t.polygonOffset(n, i), S = n, T = i)) : U(32823);
    }

    function q(e) {
      void 0 === e && (e = 33984 + E - 1), C !== e && (t.activeTexture(e), C = e);
    }

    return {
      buffers: {
        color: s,
        depth: a,
        stencil: o
      },
      enable: O,
      disable: U,
      bindFramebuffer: function bindFramebuffer(e, n) {
        return null === n && null !== c && (n = c), h[e] !== n && (t.bindFramebuffer(e, n), h[e] = n, r && (36009 === e && (h[36160] = n), 36160 === e && (h[36009] = n)), !0);
      },
      bindXRFramebuffer: function bindXRFramebuffer(e) {
        e !== c && (t.bindFramebuffer(36160, e), c = e);
      },
      useProgram: function useProgram(e) {
        return u !== e && (t.useProgram(e), u = e, !0);
      },
      setBlending: k,
      setMaterial: function setMaterial(t, e) {
        2 === t.side ? U(2884) : O(2884);
        var n = 1 === t.side;
        e && (n = !n), V(n), 1 === t.blending && !1 === t.transparent ? k(0) : k(t.blending, t.blendEquation, t.blendSrc, t.blendDst, t.blendEquationAlpha, t.blendSrcAlpha, t.blendDstAlpha, t.premultipliedAlpha), a.setFunc(t.depthFunc), a.setTest(t.depthTest), a.setMask(t.depthWrite), s.setMask(t.colorWrite);
        var i = t.stencilWrite;
        o.setTest(i), i && (o.setMask(t.stencilWriteMask), o.setFunc(t.stencilFunc, t.stencilRef, t.stencilFuncMask), o.setOp(t.stencilFail, t.stencilZFail, t.stencilZPass)), j(t.polygonOffset, t.polygonOffsetFactor, t.polygonOffsetUnits), !0 === t.alphaToCoverage ? O(32926) : U(32926);
      },
      setFlipSided: V,
      setCullFace: W,
      setLineWidth: function setLineWidth(e) {
        e !== w && (A && t.lineWidth(e), w = e);
      },
      setPolygonOffset: j,
      setScissorTest: function setScissorTest(t) {
        t ? O(3089) : U(3089);
      },
      activeTexture: q,
      bindTexture: function bindTexture(e, n) {
        null === C && q();
        var i = P[C];
        void 0 === i && (i = {
          type: void 0,
          texture: void 0
        }, P[C] = i), i.type === e && i.texture === n || (t.bindTexture(e, n || F[e]), i.type = e, i.texture = n);
      },
      unbindTexture: function unbindTexture() {
        var e = P[C];
        void 0 !== e && void 0 !== e.type && (t.bindTexture(e.type, null), e.type = void 0, e.texture = void 0);
      },
      compressedTexImage2D: function compressedTexImage2D() {
        try {
          t.compressedTexImage2D.apply(t, arguments);
        } catch (t) {
          console.error("THREE.WebGLState:", t);
        }
      },
      texImage2D: function texImage2D() {
        try {
          t.texImage2D.apply(t, arguments);
        } catch (t) {
          console.error("THREE.WebGLState:", t);
        }
      },
      texImage3D: function texImage3D() {
        try {
          t.texImage3D.apply(t, arguments);
        } catch (t) {
          console.error("THREE.WebGLState:", t);
        }
      },
      scissor: function scissor(e) {
        !1 === N.equals(e) && (t.scissor(e.x, e.y, e.z, e.w), N.copy(e));
      },
      viewport: function viewport(e) {
        !1 === B.equals(e) && (t.viewport(e.x, e.y, e.z, e.w), B.copy(e));
      },
      reset: function reset() {
        t.disable(3042), t.disable(2884), t.disable(2929), t.disable(32823), t.disable(3089), t.disable(2960), t.disable(32926), t.blendEquation(32774), t.blendFunc(1, 0), t.blendFuncSeparate(1, 0, 1, 0), t.colorMask(!0, !0, !0, !0), t.clearColor(0, 0, 0, 0), t.depthMask(!0), t.depthFunc(513), t.clearDepth(1), t.stencilMask(4294967295), t.stencilFunc(519, 0, 4294967295), t.stencilOp(7680, 7680, 7680), t.clearStencil(0), t.cullFace(1029), t.frontFace(2305), t.polygonOffset(0, 0), t.activeTexture(33984), t.bindFramebuffer(36160, null), !0 === r && (t.bindFramebuffer(36009, null), t.bindFramebuffer(36008, null)), t.useProgram(null), t.lineWidth(1), t.scissor(0, 0, t.canvas.width, t.canvas.height), t.viewport(0, 0, t.canvas.width, t.canvas.height), l = {}, C = null, P = {}, c = null, h = {}, u = null, d = !1, p = null, m = null, f = null, g = null, v = null, y = null, x = null, _ = !1, M = null, b = null, w = null, S = null, T = null, N.set(0, 0, t.canvas.width, t.canvas.height), B.set(0, 0, t.canvas.width, t.canvas.height), s.reset(), a.reset(), o.reset();
      }
    };
  }

  function ks(t, e, n, i, r, s, a) {
    var _j, _q;

    var o = r.isWebGL2,
        l = r.maxTextures,
        c = r.maxCubemapSize,
        x = r.maxTextureSize,
        R = r.maxSamples,
        C = new WeakMap();
    var P,
        I = !1;

    try {
      I = "undefined" != typeof OffscreenCanvas && null !== new OffscreenCanvas(1, 1).getContext("2d");
    } catch (t) {}

    function D(t, e) {
      return I ? new OffscreenCanvas(t, e) : document.createElementNS("http://www.w3.org/1999/xhtml", "canvas");
    }

    function N(t, e, n, i) {
      var r = 1;

      if ((t.width > i || t.height > i) && (r = i / Math.max(t.width, t.height)), r < 1 || !0 === e) {
        if ("undefined" != typeof HTMLImageElement && t instanceof HTMLImageElement || "undefined" != typeof HTMLCanvasElement && t instanceof HTMLCanvasElement || "undefined" != typeof ImageBitmap && t instanceof ImageBitmap) {
          var _i81 = e ? ft : Math.floor,
              _s29 = _i81(r * t.width),
              _a22 = _i81(r * t.height);

          void 0 === P && (P = D(_s29, _a22));

          var _o14 = n ? D(_s29, _a22) : P;

          _o14.width = _s29, _o14.height = _a22;
          return _o14.getContext("2d").drawImage(t, 0, 0, _s29, _a22), console.warn("THREE.WebGLRenderer: Texture has been resized from (" + t.width + "x" + t.height + ") to (" + _s29 + "x" + _a22 + ")."), _o14;
        }

        return "data" in t && console.warn("THREE.WebGLRenderer: Image in DataTexture is too big (" + t.width + "x" + t.height + ")."), t;
      }

      return t;
    }

    function B(t) {
      return pt(t.width) && pt(t.height);
    }

    function z(t, e) {
      return t.generateMipmaps && e && t.minFilter !== p && t.minFilter !== g;
    }

    function F(e, n, r, s) {
      var a = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;
      t.generateMipmap(e);
      i.get(n).__maxMipLevel = Math.log2(Math.max(r, s, a));
    }

    function O(n, i, r) {
      if (!1 === o) return i;

      if (null !== n) {
        if (void 0 !== t[n]) return t[n];
        console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '" + n + "'");
      }

      var s = i;
      return 6403 === i && (5126 === r && (s = 33326), 5131 === r && (s = 33325), 5121 === r && (s = 33321)), 6407 === i && (5126 === r && (s = 34837), 5131 === r && (s = 34843), 5121 === r && (s = 32849)), 6408 === i && (5126 === r && (s = 34836), 5131 === r && (s = 34842), 5121 === r && (s = 32856)), 33325 !== s && 33326 !== s && 34842 !== s && 34836 !== s || e.get("EXT_color_buffer_float"), s;
    }

    function U(t) {
      return t === p || t === m || t === f ? 9728 : 9729;
    }

    function H(e) {
      var n = e.target;
      n.removeEventListener("dispose", H), function (e) {
        var n = i.get(e);
        if (void 0 === n.__webglInit) return;
        t.deleteTexture(n.__webglTexture), i.remove(e);
      }(n), n.isVideoTexture && C.delete(n), a.memory.textures--;
    }

    function G(e) {
      var n = e.target;
      n.removeEventListener("dispose", G), function (e) {
        var n = e.texture,
            r = i.get(e),
            s = i.get(n);
        if (!e) return;
        void 0 !== s.__webglTexture && (t.deleteTexture(s.__webglTexture), a.memory.textures--);
        e.depthTexture && e.depthTexture.dispose();
        if (e.isWebGLCubeRenderTarget) for (var _e89 = 0; _e89 < 6; _e89++) {
          t.deleteFramebuffer(r.__webglFramebuffer[_e89]), r.__webglDepthbuffer && t.deleteRenderbuffer(r.__webglDepthbuffer[_e89]);
        } else t.deleteFramebuffer(r.__webglFramebuffer), r.__webglDepthbuffer && t.deleteRenderbuffer(r.__webglDepthbuffer), r.__webglMultisampledFramebuffer && t.deleteFramebuffer(r.__webglMultisampledFramebuffer), r.__webglColorRenderbuffer && t.deleteRenderbuffer(r.__webglColorRenderbuffer), r.__webglDepthRenderbuffer && t.deleteRenderbuffer(r.__webglDepthRenderbuffer);
        if (e.isWebGLMultipleRenderTargets) for (var _e90 = 0, _r64 = n.length; _e90 < _r64; _e90++) {
          var _r65 = i.get(n[_e90]);

          _r65.__webglTexture && (t.deleteTexture(_r65.__webglTexture), a.memory.textures--), i.remove(n[_e90]);
        }
        i.remove(n), i.remove(e);
      }(n);
    }

    var k = 0;

    function V(t, e) {
      var r = i.get(t);

      if (t.isVideoTexture && function (t) {
        var e = a.render.frame;
        C.get(t) !== e && (C.set(t, e), t.update());
      }(t), t.version > 0 && r.__version !== t.version) {
        var _n95 = t.image;
        if (void 0 === _n95) console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else {
          if (!1 !== _n95.complete) return void J(r, t, e);
          console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");
        }
      }

      n.activeTexture(33984 + e), n.bindTexture(3553, r.__webglTexture);
    }

    function W(e, r) {
      var a = i.get(e);
      e.version > 0 && a.__version !== e.version ? function (e, i, r) {
        if (6 !== i.image.length) return;
        Y(e, i), n.activeTexture(33984 + r), n.bindTexture(34067, e.__webglTexture), t.pixelStorei(37440, i.flipY), t.pixelStorei(37441, i.premultiplyAlpha), t.pixelStorei(3317, i.unpackAlignment), t.pixelStorei(37443, 0);
        var a = i && (i.isCompressedTexture || i.image[0].isCompressedTexture),
            l = i.image[0] && i.image[0].isDataTexture,
            h = [];

        for (var _t126 = 0; _t126 < 6; _t126++) {
          h[_t126] = a || l ? l ? i.image[_t126].image : i.image[_t126] : N(i.image[_t126], !1, !0, c);
        }

        var u = h[0],
            d = B(u) || o,
            p = s.convert(i.format),
            m = s.convert(i.type),
            f = O(i.internalFormat, p, m);
        var g;

        if (X(34067, i, d), a) {
          for (var _t127 = 0; _t127 < 6; _t127++) {
            g = h[_t127].mipmaps;

            for (var _e91 = 0; _e91 < g.length; _e91++) {
              var _r66 = g[_e91];
              i.format !== E && i.format !== T ? null !== p ? n.compressedTexImage2D(34069 + _t127, _e91, f, _r66.width, _r66.height, 0, _r66.data) : console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()") : n.texImage2D(34069 + _t127, _e91, f, _r66.width, _r66.height, 0, p, m, _r66.data);
            }
          }

          e.__maxMipLevel = g.length - 1;
        } else {
          g = i.mipmaps;

          for (var _t128 = 0; _t128 < 6; _t128++) {
            if (l) {
              n.texImage2D(34069 + _t128, 0, f, h[_t128].width, h[_t128].height, 0, p, m, h[_t128].data);

              for (var _e92 = 0; _e92 < g.length; _e92++) {
                var _i82 = g[_e92].image[_t128].image;
                n.texImage2D(34069 + _t128, _e92 + 1, f, _i82.width, _i82.height, 0, p, m, _i82.data);
              }
            } else {
              n.texImage2D(34069 + _t128, 0, f, p, m, h[_t128]);

              for (var _e93 = 0; _e93 < g.length; _e93++) {
                var _i83 = g[_e93];
                n.texImage2D(34069 + _t128, _e93 + 1, f, p, m, _i83.image[_t128]);
              }
            }
          }

          e.__maxMipLevel = g.length;
        }

        z(i, d) && F(34067, i, u.width, u.height);
        e.__version = i.version, i.onUpdate && i.onUpdate(i);
      }(a, e, r) : (n.activeTexture(33984 + r), n.bindTexture(34067, a.__webglTexture));
    }

    var j = (_j = {}, _defineProperty(_j, h, 10497), _defineProperty(_j, u, 33071), _defineProperty(_j, d, 33648), _j),
        q = (_q = {}, _defineProperty(_q, p, 9728), _defineProperty(_q, m, 9984), _defineProperty(_q, f, 9986), _defineProperty(_q, g, 9729), _defineProperty(_q, v, 9985), _defineProperty(_q, y, 9987), _q);

    function X(n, s, a) {
      if (a ? (t.texParameteri(n, 10242, j[s.wrapS]), t.texParameteri(n, 10243, j[s.wrapT]), 32879 !== n && 35866 !== n || t.texParameteri(n, 32882, j[s.wrapR]), t.texParameteri(n, 10240, q[s.magFilter]), t.texParameteri(n, 10241, q[s.minFilter])) : (t.texParameteri(n, 10242, 33071), t.texParameteri(n, 10243, 33071), 32879 !== n && 35866 !== n || t.texParameteri(n, 32882, 33071), s.wrapS === u && s.wrapT === u || console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."), t.texParameteri(n, 10240, U(s.magFilter)), t.texParameteri(n, 10241, U(s.minFilter)), s.minFilter !== p && s.minFilter !== g && console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")), !0 === e.has("EXT_texture_filter_anisotropic")) {
        var _a23 = e.get("EXT_texture_filter_anisotropic");

        if (s.type === b && !1 === e.has("OES_texture_float_linear")) return;
        if (!1 === o && s.type === w && !1 === e.has("OES_texture_half_float_linear")) return;
        (s.anisotropy > 1 || i.get(s).__currentAnisotropy) && (t.texParameterf(n, _a23.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(s.anisotropy, r.getMaxAnisotropy())), i.get(s).__currentAnisotropy = s.anisotropy);
      }
    }

    function Y(e, n) {
      void 0 === e.__webglInit && (e.__webglInit = !0, n.addEventListener("dispose", H), e.__webglTexture = t.createTexture(), a.memory.textures++);
    }

    function J(e, i, r) {
      var a = 3553;
      i.isDataTexture2DArray && (a = 35866), i.isDataTexture3D && (a = 32879), Y(e, i), n.activeTexture(33984 + r), n.bindTexture(a, e.__webglTexture), t.pixelStorei(37440, i.flipY), t.pixelStorei(37441, i.premultiplyAlpha), t.pixelStorei(3317, i.unpackAlignment), t.pixelStorei(37443, 0);

      var l = function (t) {
        return !o && (t.wrapS !== u || t.wrapT !== u || t.minFilter !== p && t.minFilter !== g);
      }(i) && !1 === B(i.image),
          c = N(i.image, l, !1, x),
          h = B(c) || o,
          d = s.convert(i.format);

      var m,
          f = s.convert(i.type),
          v = O(i.internalFormat, d, f);
      X(a, i, h);
      var y = i.mipmaps;
      if (i.isDepthTexture) v = 6402, o ? v = i.type === b ? 36012 : i.type === M ? 33190 : i.type === S ? 35056 : 33189 : i.type === b && console.error("WebGLRenderer: Floating point depth texture requires WebGL2."), i.format === A && 6402 === v && i.type !== _ && i.type !== M && (console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."), i.type = _, f = s.convert(i.type)), i.format === L && 6402 === v && (v = 34041, i.type !== S && (console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."), i.type = S, f = s.convert(i.type))), n.texImage2D(3553, 0, v, c.width, c.height, 0, d, f, null);else if (i.isDataTexture) {
        if (y.length > 0 && h) {
          for (var _t129 = 0, _e94 = y.length; _t129 < _e94; _t129++) {
            m = y[_t129], n.texImage2D(3553, _t129, v, m.width, m.height, 0, d, f, m.data);
          }

          i.generateMipmaps = !1, e.__maxMipLevel = y.length - 1;
        } else n.texImage2D(3553, 0, v, c.width, c.height, 0, d, f, c.data), e.__maxMipLevel = 0;
      } else if (i.isCompressedTexture) {
        for (var _t130 = 0, _e95 = y.length; _t130 < _e95; _t130++) {
          m = y[_t130], i.format !== E && i.format !== T ? null !== d ? n.compressedTexImage2D(3553, _t130, v, m.width, m.height, 0, m.data) : console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()") : n.texImage2D(3553, _t130, v, m.width, m.height, 0, d, f, m.data);
        }

        e.__maxMipLevel = y.length - 1;
      } else if (i.isDataTexture2DArray) n.texImage3D(35866, 0, v, c.width, c.height, c.depth, 0, d, f, c.data), e.__maxMipLevel = 0;else if (i.isDataTexture3D) n.texImage3D(32879, 0, v, c.width, c.height, c.depth, 0, d, f, c.data), e.__maxMipLevel = 0;else if (y.length > 0 && h) {
        for (var _t131 = 0, _e96 = y.length; _t131 < _e96; _t131++) {
          m = y[_t131], n.texImage2D(3553, _t131, v, d, f, m);
        }

        i.generateMipmaps = !1, e.__maxMipLevel = y.length - 1;
      } else n.texImage2D(3553, 0, v, d, f, c), e.__maxMipLevel = 0;
      z(i, h) && F(a, i, c.width, c.height), e.__version = i.version, i.onUpdate && i.onUpdate(i);
    }

    function Z(e, r, a, o, l) {
      var c = s.convert(a.format),
          h = s.convert(a.type),
          u = O(a.internalFormat, c, h);
      32879 === l || 35866 === l ? n.texImage3D(l, 0, u, r.width, r.height, r.depth, 0, c, h, null) : n.texImage2D(l, 0, u, r.width, r.height, 0, c, h, null), n.bindFramebuffer(36160, e), t.framebufferTexture2D(36160, o, l, i.get(a).__webglTexture, 0), n.bindFramebuffer(36160, null);
    }

    function Q(e, n, i) {
      if (t.bindRenderbuffer(36161, e), n.depthBuffer && !n.stencilBuffer) {
        var _r67 = 33189;

        if (i) {
          var _e97 = n.depthTexture;
          _e97 && _e97.isDepthTexture && (_e97.type === b ? _r67 = 36012 : _e97.type === M && (_r67 = 33190));

          var _i84 = $(n);

          t.renderbufferStorageMultisample(36161, _i84, _r67, n.width, n.height);
        } else t.renderbufferStorage(36161, _r67, n.width, n.height);

        t.framebufferRenderbuffer(36160, 36096, 36161, e);
      } else if (n.depthBuffer && n.stencilBuffer) {
        if (i) {
          var _e98 = $(n);

          t.renderbufferStorageMultisample(36161, _e98, 35056, n.width, n.height);
        } else t.renderbufferStorage(36161, 34041, n.width, n.height);

        t.framebufferRenderbuffer(36160, 33306, 36161, e);
      } else {
        var _e99 = !0 === n.isWebGLMultipleRenderTargets ? n.texture[0] : n.texture,
            _r68 = s.convert(_e99.format),
            _a24 = s.convert(_e99.type),
            _o15 = O(_e99.internalFormat, _r68, _a24);

        if (i) {
          var _e100 = $(n);

          t.renderbufferStorageMultisample(36161, _e100, _o15, n.width, n.height);
        } else t.renderbufferStorage(36161, _o15, n.width, n.height);
      }

      t.bindRenderbuffer(36161, null);
    }

    function K(e) {
      var r = i.get(e),
          s = !0 === e.isWebGLCubeRenderTarget;

      if (e.depthTexture) {
        if (s) throw new Error("target.depthTexture not supported in Cube render targets");
        !function (e, r) {
          if (r && r.isWebGLCubeRenderTarget) throw new Error("Depth Texture with cube render targets is not supported");
          if (n.bindFramebuffer(36160, e), !r.depthTexture || !r.depthTexture.isDepthTexture) throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");
          i.get(r.depthTexture).__webglTexture && r.depthTexture.image.width === r.width && r.depthTexture.image.height === r.height || (r.depthTexture.image.width = r.width, r.depthTexture.image.height = r.height, r.depthTexture.needsUpdate = !0), V(r.depthTexture, 0);

          var s = i.get(r.depthTexture).__webglTexture;

          if (r.depthTexture.format === A) t.framebufferTexture2D(36160, 36096, 3553, s, 0);else {
            if (r.depthTexture.format !== L) throw new Error("Unknown depthTexture format");
            t.framebufferTexture2D(36160, 33306, 3553, s, 0);
          }
        }(r.__webglFramebuffer, e);
      } else if (s) {
        r.__webglDepthbuffer = [];

        for (var _i85 = 0; _i85 < 6; _i85++) {
          n.bindFramebuffer(36160, r.__webglFramebuffer[_i85]), r.__webglDepthbuffer[_i85] = t.createRenderbuffer(), Q(r.__webglDepthbuffer[_i85], e, !1);
        }
      } else n.bindFramebuffer(36160, r.__webglFramebuffer), r.__webglDepthbuffer = t.createRenderbuffer(), Q(r.__webglDepthbuffer, e, !1);

      n.bindFramebuffer(36160, null);
    }

    function $(t) {
      return o && t.isWebGLMultisampleRenderTarget ? Math.min(R, t.samples) : 0;
    }

    var tt = !1,
        et = !1;
    this.allocateTextureUnit = function () {
      var t = k;
      return t >= l && console.warn("THREE.WebGLTextures: Trying to use " + t + " texture units while this GPU supports only " + l), k += 1, t;
    }, this.resetTextureUnits = function () {
      k = 0;
    }, this.setTexture2D = V, this.setTexture2DArray = function (t, e) {
      var r = i.get(t);
      t.version > 0 && r.__version !== t.version ? J(r, t, e) : (n.activeTexture(33984 + e), n.bindTexture(35866, r.__webglTexture));
    }, this.setTexture3D = function (t, e) {
      var r = i.get(t);
      t.version > 0 && r.__version !== t.version ? J(r, t, e) : (n.activeTexture(33984 + e), n.bindTexture(32879, r.__webglTexture));
    }, this.setTextureCube = W, this.setupRenderTarget = function (e) {
      var l = e.texture,
          c = i.get(e),
          h = i.get(l);
      e.addEventListener("dispose", G), !0 !== e.isWebGLMultipleRenderTargets && (h.__webglTexture = t.createTexture(), h.__version = l.version, a.memory.textures++);
      var u = !0 === e.isWebGLCubeRenderTarget,
          d = !0 === e.isWebGLMultipleRenderTargets,
          p = !0 === e.isWebGLMultisampleRenderTarget,
          m = l.isDataTexture3D || l.isDataTexture2DArray,
          f = B(e) || o;

      if (!o || l.format !== T || l.type !== b && l.type !== w || (l.format = E, console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")), u) {
        c.__webglFramebuffer = [];

        for (var _e101 = 0; _e101 < 6; _e101++) {
          c.__webglFramebuffer[_e101] = t.createFramebuffer();
        }
      } else if (c.__webglFramebuffer = t.createFramebuffer(), d) {
        if (r.drawBuffers) {
          var _n96 = e.texture;

          for (var _e102 = 0, _r69 = _n96.length; _e102 < _r69; _e102++) {
            var _r70 = i.get(_n96[_e102]);

            void 0 === _r70.__webglTexture && (_r70.__webglTexture = t.createTexture(), a.memory.textures++);
          }
        } else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");
      } else if (p) if (o) {
        c.__webglMultisampledFramebuffer = t.createFramebuffer(), c.__webglColorRenderbuffer = t.createRenderbuffer(), t.bindRenderbuffer(36161, c.__webglColorRenderbuffer);

        var _i86 = s.convert(l.format),
            _r71 = s.convert(l.type),
            _a25 = O(l.internalFormat, _i86, _r71),
            _o16 = $(e);

        t.renderbufferStorageMultisample(36161, _o16, _a25, e.width, e.height), n.bindFramebuffer(36160, c.__webglMultisampledFramebuffer), t.framebufferRenderbuffer(36160, 36064, 36161, c.__webglColorRenderbuffer), t.bindRenderbuffer(36161, null), e.depthBuffer && (c.__webglDepthRenderbuffer = t.createRenderbuffer(), Q(c.__webglDepthRenderbuffer, e, !0)), n.bindFramebuffer(36160, null);
      } else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");

      if (u) {
        n.bindTexture(34067, h.__webglTexture), X(34067, l, f);

        for (var _t132 = 0; _t132 < 6; _t132++) {
          Z(c.__webglFramebuffer[_t132], e, l, 36064, 34069 + _t132);
        }

        z(l, f) && F(34067, l, e.width, e.height), n.bindTexture(34067, null);
      } else if (d) {
        var _t133 = e.texture;

        for (var _r72 = 0, _s30 = _t133.length; _r72 < _s30; _r72++) {
          var _s31 = _t133[_r72],
              _a26 = i.get(_s31);

          n.bindTexture(3553, _a26.__webglTexture), X(3553, _s31, f), Z(c.__webglFramebuffer, e, _s31, 36064 + _r72, 3553), z(_s31, f) && F(3553, _s31, e.width, e.height);
        }

        n.bindTexture(3553, null);
      } else {
        var _t134 = 3553;
        if (m) if (o) {
          _t134 = l.isDataTexture3D ? 32879 : 35866;
        } else console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.");
        n.bindTexture(_t134, h.__webglTexture), X(_t134, l, f), Z(c.__webglFramebuffer, e, l, 36064, _t134), z(l, f) && F(_t134, l, e.width, e.height, e.depth), n.bindTexture(_t134, null);
      }

      e.depthBuffer && K(e);
    }, this.updateRenderTargetMipmap = function (t) {
      var e = B(t) || o,
          r = !0 === t.isWebGLMultipleRenderTargets ? t.texture : [t.texture];

      for (var _s32 = 0, _a27 = r.length; _s32 < _a27; _s32++) {
        var _a28 = r[_s32];

        if (z(_a28, e)) {
          var _e103 = t.isWebGLCubeRenderTarget ? 34067 : 3553,
              _r73 = i.get(_a28).__webglTexture;

          n.bindTexture(_e103, _r73), F(_e103, _a28, t.width, t.height), n.bindTexture(_e103, null);
        }
      }
    }, this.updateMultisampleRenderTarget = function (e) {
      if (e.isWebGLMultisampleRenderTarget) if (o) {
        var _r74 = e.width,
            _s33 = e.height;
        var _a29 = 16384;
        e.depthBuffer && (_a29 |= 256), e.stencilBuffer && (_a29 |= 1024);

        var _o17 = i.get(e);

        n.bindFramebuffer(36008, _o17.__webglMultisampledFramebuffer), n.bindFramebuffer(36009, _o17.__webglFramebuffer), t.blitFramebuffer(0, 0, _r74, _s33, 0, 0, _r74, _s33, _a29, 9728), n.bindFramebuffer(36008, null), n.bindFramebuffer(36009, _o17.__webglMultisampledFramebuffer);
      } else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");
    }, this.safeSetTexture2D = function (t, e) {
      t && t.isWebGLRenderTarget && (!1 === tt && (console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."), tt = !0), t = t.texture), V(t, e);
    }, this.safeSetTextureCube = function (t, e) {
      t && t.isWebGLCubeRenderTarget && (!1 === et && (console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."), et = !0), t = t.texture), W(t, e);
    };
  }

  function Vs(t, e, n) {
    var i = n.isWebGL2;
    return {
      convert: function convert(t) {
        var n;
        if (t === x) return 5121;
        if (1017 === t) return 32819;
        if (1018 === t) return 32820;
        if (1019 === t) return 33635;
        if (1010 === t) return 5120;
        if (1011 === t) return 5122;
        if (t === _) return 5123;
        if (1013 === t) return 5124;
        if (t === M) return 5125;
        if (t === b) return 5126;
        if (t === w) return i ? 5131 : (n = e.get("OES_texture_half_float"), null !== n ? n.HALF_FLOAT_OES : null);
        if (1021 === t) return 6406;
        if (t === T) return 6407;
        if (t === E) return 6408;
        if (1024 === t) return 6409;
        if (1025 === t) return 6410;
        if (t === A) return 6402;
        if (t === L) return 34041;
        if (1028 === t) return 6403;
        if (1029 === t) return 36244;
        if (1030 === t) return 33319;
        if (1031 === t) return 33320;
        if (1032 === t) return 36248;
        if (1033 === t) return 36249;

        if (t === R || t === C || t === P || t === I) {
          if (n = e.get("WEBGL_compressed_texture_s3tc"), null === n) return null;
          if (t === R) return n.COMPRESSED_RGB_S3TC_DXT1_EXT;
          if (t === C) return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;
          if (t === P) return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;
          if (t === I) return n.COMPRESSED_RGBA_S3TC_DXT5_EXT;
        }

        if (t === D || t === N || t === B || t === z) {
          if (n = e.get("WEBGL_compressed_texture_pvrtc"), null === n) return null;
          if (t === D) return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;
          if (t === N) return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;
          if (t === B) return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;
          if (t === z) return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG;
        }

        if (36196 === t) return n = e.get("WEBGL_compressed_texture_etc1"), null !== n ? n.COMPRESSED_RGB_ETC1_WEBGL : null;

        if ((t === F || t === O) && (n = e.get("WEBGL_compressed_texture_etc"), null !== n)) {
          if (t === F) return n.COMPRESSED_RGB8_ETC2;
          if (t === O) return n.COMPRESSED_RGBA8_ETC2_EAC;
        }

        return 37808 === t || 37809 === t || 37810 === t || 37811 === t || 37812 === t || 37813 === t || 37814 === t || 37815 === t || 37816 === t || 37817 === t || 37818 === t || 37819 === t || 37820 === t || 37821 === t || 37840 === t || 37841 === t || 37842 === t || 37843 === t || 37844 === t || 37845 === t || 37846 === t || 37847 === t || 37848 === t || 37849 === t || 37850 === t || 37851 === t || 37852 === t || 37853 === t ? (n = e.get("WEBGL_compressed_texture_astc"), null !== n ? t : null) : 36492 === t ? (n = e.get("EXT_texture_compression_bptc"), null !== n ? t : null) : t === S ? i ? 34042 : (n = e.get("WEBGL_depth_texture"), null !== n ? n.UNSIGNED_INT_24_8_WEBGL : null) : void 0;
      }
    };
  }

  var Ws = /*#__PURE__*/function (_Jn) {
    _inherits(Ws, _Jn);

    var _super34 = _createSuper(Ws);

    function Ws() {
      var _this24;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];

      _classCallCheck(this, Ws);

      _this24 = _super34.call(this), _this24.cameras = t;
      return _this24;
    }

    return Ws;
  }(Jn);

  Ws.prototype.isArrayCamera = !0;

  var js = /*#__PURE__*/function (_Pe4) {
    _inherits(js, _Pe4);

    var _super35 = _createSuper(js);

    function js() {
      var _this25;

      _classCallCheck(this, js);

      _this25 = _super35.call(this), _this25.type = "Group";
      return _this25;
    }

    return js;
  }(Pe);

  js.prototype.isGroup = !0;
  var qs = {
    type: "move"
  };

  var Xs = /*#__PURE__*/function () {
    function Xs() {
      _classCallCheck(this, Xs);

      this._targetRay = null, this._grip = null, this._hand = null;
    }

    _createClass(Xs, [{
      key: "getHandSpace",
      value: function getHandSpace() {
        return null === this._hand && (this._hand = new js(), this._hand.matrixAutoUpdate = !1, this._hand.visible = !1, this._hand.joints = {}, this._hand.inputState = {
          pinching: !1
        }), this._hand;
      }
    }, {
      key: "getTargetRaySpace",
      value: function getTargetRaySpace() {
        return null === this._targetRay && (this._targetRay = new js(), this._targetRay.matrixAutoUpdate = !1, this._targetRay.visible = !1, this._targetRay.hasLinearVelocity = !1, this._targetRay.linearVelocity = new Rt(), this._targetRay.hasAngularVelocity = !1, this._targetRay.angularVelocity = new Rt()), this._targetRay;
      }
    }, {
      key: "getGripSpace",
      value: function getGripSpace() {
        return null === this._grip && (this._grip = new js(), this._grip.matrixAutoUpdate = !1, this._grip.visible = !1, this._grip.hasLinearVelocity = !1, this._grip.linearVelocity = new Rt(), this._grip.hasAngularVelocity = !1, this._grip.angularVelocity = new Rt()), this._grip;
      }
    }, {
      key: "dispatchEvent",
      value: function dispatchEvent(t) {
        return null !== this._targetRay && this._targetRay.dispatchEvent(t), null !== this._grip && this._grip.dispatchEvent(t), null !== this._hand && this._hand.dispatchEvent(t), this;
      }
    }, {
      key: "disconnect",
      value: function disconnect(t) {
        return this.dispatchEvent({
          type: "disconnected",
          data: t
        }), null !== this._targetRay && (this._targetRay.visible = !1), null !== this._grip && (this._grip.visible = !1), null !== this._hand && (this._hand.visible = !1), this;
      }
    }, {
      key: "update",
      value: function update(t, e, n) {
        var i = null,
            r = null,
            s = null;
        var a = this._targetRay,
            o = this._grip,
            l = this._hand;
        if (t && "visible-blurred" !== e.session.visibilityState) if (null !== a && (i = e.getPose(t.targetRaySpace, n), null !== i && (a.matrix.fromArray(i.transform.matrix), a.matrix.decompose(a.position, a.rotation, a.scale), i.linearVelocity ? (a.hasLinearVelocity = !0, a.linearVelocity.copy(i.linearVelocity)) : a.hasLinearVelocity = !1, i.angularVelocity ? (a.hasAngularVelocity = !0, a.angularVelocity.copy(i.angularVelocity)) : a.hasAngularVelocity = !1, this.dispatchEvent(qs))), l && t.hand) {
          s = !0;

          var _iterator = _createForOfIteratorHelper(t.hand.values()),
              _step;

          try {
            for (_iterator.s(); !(_step = _iterator.n()).done;) {
              var _i88 = _step.value;

              var _t135 = e.getJointPose(_i88, n);

              if (void 0 === l.joints[_i88.jointName]) {
                var _t136 = new js();

                _t136.matrixAutoUpdate = !1, _t136.visible = !1, l.joints[_i88.jointName] = _t136, l.add(_t136);
              }

              var _r76 = l.joints[_i88.jointName];
              null !== _t135 && (_r76.matrix.fromArray(_t135.transform.matrix), _r76.matrix.decompose(_r76.position, _r76.rotation, _r76.scale), _r76.jointRadius = _t135.radius), _r76.visible = null !== _t135;
            }
          } catch (err) {
            _iterator.e(err);
          } finally {
            _iterator.f();
          }

          var _i87 = l.joints["index-finger-tip"],
              _r75 = l.joints["thumb-tip"],
              _a30 = _i87.position.distanceTo(_r75.position),
              _o18 = .02,
              _c16 = .005;

          l.inputState.pinching && _a30 > _o18 + _c16 ? (l.inputState.pinching = !1, this.dispatchEvent({
            type: "pinchend",
            handedness: t.handedness,
            target: this
          })) : !l.inputState.pinching && _a30 <= _o18 - _c16 && (l.inputState.pinching = !0, this.dispatchEvent({
            type: "pinchstart",
            handedness: t.handedness,
            target: this
          }));
        } else null !== o && t.gripSpace && (r = e.getPose(t.gripSpace, n), null !== r && (o.matrix.fromArray(r.transform.matrix), o.matrix.decompose(o.position, o.rotation, o.scale), r.linearVelocity ? (o.hasLinearVelocity = !0, o.linearVelocity.copy(r.linearVelocity)) : o.hasLinearVelocity = !1, r.angularVelocity ? (o.hasAngularVelocity = !0, o.angularVelocity.copy(r.angularVelocity)) : o.hasAngularVelocity = !1));
        return null !== a && (a.visible = null !== i), null !== o && (o.visible = null !== r), null !== l && (l.visible = null !== s), this;
      }
    }]);

    return Xs;
  }();

  var Ys = /*#__PURE__*/function (_rt6) {
    _inherits(Ys, _rt6);

    var _super36 = _createSuper(Ys);

    function Ys(t, e) {
      var _this26;

      _classCallCheck(this, Ys);

      _this26 = _super36.call(this);

      var n = _assertThisInitialized(_this26),
          i = t.state;

      var r = null,
          s = 1,
          a = null,
          o = "local-floor",
          l = null,
          c = null,
          h = null,
          u = null,
          d = null;
      var p = [],
          m = new Map(),
          f = new Jn();
      f.layers.enable(1), f.viewport = new St();
      var g = new Jn();
      g.layers.enable(2), g.viewport = new St();
      var v = [f, g],
          y = new Ws();
      y.layers.enable(1), y.layers.enable(2);
      var x = null,
          _ = null;

      function M(t) {
        var e = m.get(t.inputSource);
        e && e.dispatchEvent({
          type: t.type,
          data: t.inputSource
        });
      }

      function b() {
        m.forEach(function (t, e) {
          t.disconnect(e);
        }), m.clear(), x = null, _ = null, i.bindXRFramebuffer(null), t.setRenderTarget(t.getRenderTarget()), L.stop(), n.isPresenting = !1, n.dispatchEvent({
          type: "sessionend"
        });
      }

      function w(t) {
        var e = r.inputSources;

        for (var _t137 = 0; _t137 < p.length; _t137++) {
          m.set(e[_t137], p[_t137]);
        }

        for (var _e104 = 0; _e104 < t.removed.length; _e104++) {
          var _n97 = t.removed[_e104],
              _i89 = m.get(_n97);

          _i89 && (_i89.dispatchEvent({
            type: "disconnected",
            data: _n97
          }), m.delete(_n97));
        }

        for (var _e105 = 0; _e105 < t.added.length; _e105++) {
          var _n98 = t.added[_e105],
              _i90 = m.get(_n98);

          _i90 && _i90.dispatchEvent({
            type: "connected",
            data: _n98
          });
        }
      }

      _this26.cameraAutoUpdate = !0, _this26.enabled = !1, _this26.isPresenting = !1, _this26.getController = function (t) {
        var e = p[t];
        return void 0 === e && (e = new Xs(), p[t] = e), e.getTargetRaySpace();
      }, _this26.getControllerGrip = function (t) {
        var e = p[t];
        return void 0 === e && (e = new Xs(), p[t] = e), e.getGripSpace();
      }, _this26.getHand = function (t) {
        var e = p[t];
        return void 0 === e && (e = new Xs(), p[t] = e), e.getHandSpace();
      }, _this26.setFramebufferScaleFactor = function (t) {
        s = t, !0 === n.isPresenting && console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.");
      }, _this26.setReferenceSpaceType = function (t) {
        o = t, !0 === n.isPresenting && console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.");
      }, _this26.getReferenceSpace = function () {
        return a;
      }, _this26.getSession = function () {
        return r;
      }, _this26.setSession = /*#__PURE__*/function () {
        var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(t) {
          var _t138, _n99, _n100, _n101, _i91;

          return regeneratorRuntime.wrap(function _callee$(_context) {
            while (1) {
              switch (_context.prev = _context.next) {
                case 0:
                  if (!(r = t, null !== r)) {
                    _context.next = 21;
                    break;
                  }

                  r.addEventListener("select", M), r.addEventListener("selectstart", M), r.addEventListener("selectend", M), r.addEventListener("squeeze", M), r.addEventListener("squeezestart", M), r.addEventListener("squeezeend", M), r.addEventListener("end", b), r.addEventListener("inputsourceschange", w);
                  _t138 = e.getContextAttributes();
                  _context.t0 = !0 !== _t138.xrCompatible;

                  if (!_context.t0) {
                    _context.next = 7;
                    break;
                  }

                  _context.next = 7;
                  return e.makeXRCompatible();

                case 7:
                  if (!(void 0 === r.renderState.layers)) {
                    _context.next = 12;
                    break;
                  }

                  _n99 = {
                    antialias: _t138.antialias,
                    alpha: _t138.alpha,
                    depth: _t138.depth,
                    stencil: _t138.stencil,
                    framebufferScaleFactor: s
                  };
                  d = new XRWebGLLayer(r, e, _n99), r.updateRenderState({
                    baseLayer: d
                  });
                  _context.next = 14;
                  break;

                case 12:
                  _n100 = 0;

                  if (_t138.antialias) {
                    _n101 = {
                      antialias: !0,
                      alpha: _t138.alpha,
                      depth: _t138.depth,
                      stencil: _t138.stencil,
                      framebufferScaleFactor: s
                    };
                    d = new XRWebGLLayer(r, e, _n101), r.updateRenderState({
                      layers: [d]
                    });
                  } else {
                    _t138.depth && (_n100 = _t138.stencil ? 34041 : 6402);
                    _i91 = {
                      colorFormat: _t138.alpha ? 6408 : 6407,
                      depthFormat: _n100,
                      scaleFactor: s
                    };
                    c = new XRWebGLBinding(r, e), u = c.createProjectionLayer(_i91), h = e.createFramebuffer(), r.updateRenderState({
                      layers: [u]
                    });
                  }

                case 14:
                  _context.next = 16;
                  return r.requestReferenceSpace(o);

                case 16:
                  a = _context.sent;
                  L.setContext(r);
                  L.start();
                  n.isPresenting = !0;
                  n.dispatchEvent({
                    type: "sessionstart"
                  });

                case 21:
                case "end":
                  return _context.stop();
              }
            }
          }, _callee);
        }));

        return function (_x4) {
          return _ref.apply(this, arguments);
        };
      }();
      var S = new Rt(),
          T = new Rt();

      function E(t, e) {
        null === e ? t.matrixWorld.copy(t.matrix) : t.matrixWorld.multiplyMatrices(e.matrixWorld, t.matrix), t.matrixWorldInverse.copy(t.matrixWorld).invert();
      }

      _this26.updateCamera = function (t) {
        if (null === r) return;
        y.near = g.near = f.near = t.near, y.far = g.far = f.far = t.far, x === y.near && _ === y.far || (r.updateRenderState({
          depthNear: y.near,
          depthFar: y.far
        }), x = y.near, _ = y.far);
        var e = t.parent,
            n = y.cameras;
        E(y, e);

        for (var _t139 = 0; _t139 < n.length; _t139++) {
          E(n[_t139], e);
        }

        y.matrixWorld.decompose(y.position, y.quaternion, y.scale), t.position.copy(y.position), t.quaternion.copy(y.quaternion), t.scale.copy(y.scale), t.matrix.copy(y.matrix), t.matrixWorld.copy(y.matrixWorld);
        var i = t.children;

        for (var _t140 = 0, _e106 = i.length; _t140 < _e106; _t140++) {
          i[_t140].updateMatrixWorld(!0);
        }

        2 === n.length ? function (t, e, n) {
          S.setFromMatrixPosition(e.matrixWorld), T.setFromMatrixPosition(n.matrixWorld);
          var i = S.distanceTo(T),
              r = e.projectionMatrix.elements,
              s = n.projectionMatrix.elements,
              a = r[14] / (r[10] - 1),
              o = r[14] / (r[10] + 1),
              l = (r[9] + 1) / r[5],
              c = (r[9] - 1) / r[5],
              h = (r[8] - 1) / r[0],
              u = (s[8] + 1) / s[0],
              d = a * h,
              p = a * u,
              m = i / (-h + u),
              f = m * -h;
          e.matrixWorld.decompose(t.position, t.quaternion, t.scale), t.translateX(f), t.translateZ(m), t.matrixWorld.compose(t.position, t.quaternion, t.scale), t.matrixWorldInverse.copy(t.matrixWorld).invert();

          var g = a + m,
              v = o + m,
              y = d - f,
              x = p + (i - f),
              _ = l * o / v * g,
              M = c * o / v * g;

          t.projectionMatrix.makePerspective(y, x, _, M, g, v);
        }(y, f, g) : y.projectionMatrix.copy(f.projectionMatrix);
      }, _this26.getCamera = function () {
        return y;
      }, _this26.getFoveation = function () {
        return null !== u ? u.fixedFoveation : null !== d ? d.fixedFoveation : void 0;
      }, _this26.setFoveation = function (t) {
        null !== u && (u.fixedFoveation = t), null !== d && void 0 !== d.fixedFoveation && (d.fixedFoveation = t);
      };
      var A = null;
      var L = new oi();
      L.setAnimationLoop(function (t, n) {
        if (l = n.getViewerPose(a), null !== l) {
          var _t141 = l.views;
          null !== d && i.bindXRFramebuffer(d.framebuffer);

          var _n102 = !1;

          _t141.length !== y.cameras.length && (y.cameras.length = 0, _n102 = !0);

          for (var _r77 = 0; _r77 < _t141.length; _r77++) {
            var _s34 = _t141[_r77];
            var _a31 = null;
            if (null !== d) _a31 = d.getViewport(_s34);else {
              var _t142 = c.getViewSubImage(u, _s34);

              i.bindXRFramebuffer(h), void 0 !== _t142.depthStencilTexture && e.framebufferTexture2D(36160, 36096, 3553, _t142.depthStencilTexture, 0), e.framebufferTexture2D(36160, 36064, 3553, _t142.colorTexture, 0), _a31 = _t142.viewport;
            }
            var _o19 = v[_r77];
            _o19.matrix.fromArray(_s34.transform.matrix), _o19.projectionMatrix.fromArray(_s34.projectionMatrix), _o19.viewport.set(_a31.x, _a31.y, _a31.width, _a31.height), 0 === _r77 && y.matrix.copy(_o19.matrix), !0 === _n102 && y.cameras.push(_o19);
          }
        }

        var s = r.inputSources;

        for (var _t143 = 0; _t143 < p.length; _t143++) {
          var _e107 = p[_t143],
              _i92 = s[_t143];

          _e107.update(_i92, n, a);
        }

        A && A(t, n);
      }), _this26.setAnimationLoop = function (t) {
        A = t;
      }, _this26.dispose = function () {};
      return _this26;
    }

    return Ys;
  }(rt);

  function Js(t) {
    function e(e, n) {
      e.opacity.value = n.opacity, n.color && e.diffuse.value.copy(n.color), n.emissive && e.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity), n.map && (e.map.value = n.map), n.alphaMap && (e.alphaMap.value = n.alphaMap), n.specularMap && (e.specularMap.value = n.specularMap);
      var i = t.get(n).envMap;

      if (i) {
        e.envMap.value = i, e.flipEnvMap.value = i.isCubeTexture && !1 === i.isRenderTargetTexture ? -1 : 1, e.reflectivity.value = n.reflectivity, e.refractionRatio.value = n.refractionRatio;

        var _r78 = t.get(i).__maxMipLevel;

        void 0 !== _r78 && (e.maxMipLevel.value = _r78);
      }

      var r, s;
      n.lightMap && (e.lightMap.value = n.lightMap, e.lightMapIntensity.value = n.lightMapIntensity), n.aoMap && (e.aoMap.value = n.aoMap, e.aoMapIntensity.value = n.aoMapIntensity), n.map ? r = n.map : n.specularMap ? r = n.specularMap : n.displacementMap ? r = n.displacementMap : n.normalMap ? r = n.normalMap : n.bumpMap ? r = n.bumpMap : n.roughnessMap ? r = n.roughnessMap : n.metalnessMap ? r = n.metalnessMap : n.alphaMap ? r = n.alphaMap : n.emissiveMap ? r = n.emissiveMap : n.clearcoatMap ? r = n.clearcoatMap : n.clearcoatNormalMap ? r = n.clearcoatNormalMap : n.clearcoatRoughnessMap ? r = n.clearcoatRoughnessMap : n.specularIntensityMap ? r = n.specularIntensityMap : n.specularTintMap && (r = n.specularTintMap), void 0 !== r && (r.isWebGLRenderTarget && (r = r.texture), !0 === r.matrixAutoUpdate && r.updateMatrix(), e.uvTransform.value.copy(r.matrix)), n.aoMap ? s = n.aoMap : n.lightMap && (s = n.lightMap), void 0 !== s && (s.isWebGLRenderTarget && (s = s.texture), !0 === s.matrixAutoUpdate && s.updateMatrix(), e.uv2Transform.value.copy(s.matrix));
    }

    function n(e, n) {
      e.roughness.value = n.roughness, e.metalness.value = n.metalness, n.roughnessMap && (e.roughnessMap.value = n.roughnessMap), n.metalnessMap && (e.metalnessMap.value = n.metalnessMap), n.emissiveMap && (e.emissiveMap.value = n.emissiveMap), n.bumpMap && (e.bumpMap.value = n.bumpMap, e.bumpScale.value = n.bumpScale, 1 === n.side && (e.bumpScale.value *= -1)), n.normalMap && (e.normalMap.value = n.normalMap, e.normalScale.value.copy(n.normalScale), 1 === n.side && e.normalScale.value.negate()), n.displacementMap && (e.displacementMap.value = n.displacementMap, e.displacementScale.value = n.displacementScale, e.displacementBias.value = n.displacementBias);
      t.get(n).envMap && (e.envMapIntensity.value = n.envMapIntensity);
    }

    return {
      refreshFogUniforms: function refreshFogUniforms(t, e) {
        t.fogColor.value.copy(e.color), e.isFog ? (t.fogNear.value = e.near, t.fogFar.value = e.far) : e.isFogExp2 && (t.fogDensity.value = e.density);
      },
      refreshMaterialUniforms: function refreshMaterialUniforms(t, i, r, s, a) {
        i.isMeshBasicMaterial ? e(t, i) : i.isMeshLambertMaterial ? (e(t, i), function (t, e) {
          e.emissiveMap && (t.emissiveMap.value = e.emissiveMap);
        }(t, i)) : i.isMeshToonMaterial ? (e(t, i), function (t, e) {
          e.gradientMap && (t.gradientMap.value = e.gradientMap);
          e.emissiveMap && (t.emissiveMap.value = e.emissiveMap);
          e.bumpMap && (t.bumpMap.value = e.bumpMap, t.bumpScale.value = e.bumpScale, 1 === e.side && (t.bumpScale.value *= -1));
          e.normalMap && (t.normalMap.value = e.normalMap, t.normalScale.value.copy(e.normalScale), 1 === e.side && t.normalScale.value.negate());
          e.displacementMap && (t.displacementMap.value = e.displacementMap, t.displacementScale.value = e.displacementScale, t.displacementBias.value = e.displacementBias);
        }(t, i)) : i.isMeshPhongMaterial ? (e(t, i), function (t, e) {
          t.specular.value.copy(e.specular), t.shininess.value = Math.max(e.shininess, 1e-4), e.emissiveMap && (t.emissiveMap.value = e.emissiveMap);
          e.bumpMap && (t.bumpMap.value = e.bumpMap, t.bumpScale.value = e.bumpScale, 1 === e.side && (t.bumpScale.value *= -1));
          e.normalMap && (t.normalMap.value = e.normalMap, t.normalScale.value.copy(e.normalScale), 1 === e.side && t.normalScale.value.negate());
          e.displacementMap && (t.displacementMap.value = e.displacementMap, t.displacementScale.value = e.displacementScale, t.displacementBias.value = e.displacementBias);
        }(t, i)) : i.isMeshStandardMaterial ? (e(t, i), i.isMeshPhysicalMaterial ? function (t, e, i) {
          n(t, e), t.reflectivity.value = e.reflectivity, t.clearcoat.value = e.clearcoat, t.clearcoatRoughness.value = e.clearcoatRoughness, e.sheen && t.sheen.value.copy(e.sheen);
          e.clearcoatMap && (t.clearcoatMap.value = e.clearcoatMap);
          e.clearcoatRoughnessMap && (t.clearcoatRoughnessMap.value = e.clearcoatRoughnessMap);
          e.clearcoatNormalMap && (t.clearcoatNormalScale.value.copy(e.clearcoatNormalScale), t.clearcoatNormalMap.value = e.clearcoatNormalMap, 1 === e.side && t.clearcoatNormalScale.value.negate());
          t.transmission.value = e.transmission, e.transmissionMap && (t.transmissionMap.value = e.transmissionMap);
          e.transmission > 0 && (t.transmissionSamplerMap.value = i.texture, t.transmissionSamplerSize.value.set(i.width, i.height));
          t.thickness.value = e.thickness, e.thicknessMap && (t.thicknessMap.value = e.thicknessMap);
          t.attenuationDistance.value = e.attenuationDistance, t.attenuationTint.value.copy(e.attenuationTint), t.specularIntensity.value = e.specularIntensity, t.specularTint.value.copy(e.specularTint), e.specularIntensityMap && (t.specularIntensityMap.value = e.specularIntensityMap);
          e.specularTintMap && (t.specularTintMap.value = e.specularTintMap);
        }(t, i, a) : n(t, i)) : i.isMeshMatcapMaterial ? (e(t, i), function (t, e) {
          e.matcap && (t.matcap.value = e.matcap);
          e.bumpMap && (t.bumpMap.value = e.bumpMap, t.bumpScale.value = e.bumpScale, 1 === e.side && (t.bumpScale.value *= -1));
          e.normalMap && (t.normalMap.value = e.normalMap, t.normalScale.value.copy(e.normalScale), 1 === e.side && t.normalScale.value.negate());
          e.displacementMap && (t.displacementMap.value = e.displacementMap, t.displacementScale.value = e.displacementScale, t.displacementBias.value = e.displacementBias);
        }(t, i)) : i.isMeshDepthMaterial ? (e(t, i), function (t, e) {
          e.displacementMap && (t.displacementMap.value = e.displacementMap, t.displacementScale.value = e.displacementScale, t.displacementBias.value = e.displacementBias);
        }(t, i)) : i.isMeshDistanceMaterial ? (e(t, i), function (t, e) {
          e.displacementMap && (t.displacementMap.value = e.displacementMap, t.displacementScale.value = e.displacementScale, t.displacementBias.value = e.displacementBias);
          t.referencePosition.value.copy(e.referencePosition), t.nearDistance.value = e.nearDistance, t.farDistance.value = e.farDistance;
        }(t, i)) : i.isMeshNormalMaterial ? (e(t, i), function (t, e) {
          e.bumpMap && (t.bumpMap.value = e.bumpMap, t.bumpScale.value = e.bumpScale, 1 === e.side && (t.bumpScale.value *= -1));
          e.normalMap && (t.normalMap.value = e.normalMap, t.normalScale.value.copy(e.normalScale), 1 === e.side && t.normalScale.value.negate());
          e.displacementMap && (t.displacementMap.value = e.displacementMap, t.displacementScale.value = e.displacementScale, t.displacementBias.value = e.displacementBias);
        }(t, i)) : i.isLineBasicMaterial ? (function (t, e) {
          t.diffuse.value.copy(e.color), t.opacity.value = e.opacity;
        }(t, i), i.isLineDashedMaterial && function (t, e) {
          t.dashSize.value = e.dashSize, t.totalSize.value = e.dashSize + e.gapSize, t.scale.value = e.scale;
        }(t, i)) : i.isPointsMaterial ? function (t, e, n, i) {
          t.diffuse.value.copy(e.color), t.opacity.value = e.opacity, t.size.value = e.size * n, t.scale.value = .5 * i, e.map && (t.map.value = e.map);
          e.alphaMap && (t.alphaMap.value = e.alphaMap);
          var r;
          e.map ? r = e.map : e.alphaMap && (r = e.alphaMap);
          void 0 !== r && (!0 === r.matrixAutoUpdate && r.updateMatrix(), t.uvTransform.value.copy(r.matrix));
        }(t, i, r, s) : i.isSpriteMaterial ? function (t, e) {
          t.diffuse.value.copy(e.color), t.opacity.value = e.opacity, t.rotation.value = e.rotation, e.map && (t.map.value = e.map);
          e.alphaMap && (t.alphaMap.value = e.alphaMap);
          var n;
          e.map ? n = e.map : e.alphaMap && (n = e.alphaMap);
          void 0 !== n && (!0 === n.matrixAutoUpdate && n.updateMatrix(), t.uvTransform.value.copy(n.matrix));
        }(t, i) : i.isShadowMaterial ? (t.color.value.copy(i.color), t.opacity.value = i.opacity) : i.isShaderMaterial && (i.uniformsNeedUpdate = !1);
      }
    };
  }

  function Zs() {
    var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    var e = void 0 !== t.canvas ? t.canvas : function () {
      var t = document.createElementNS("http://www.w3.org/1999/xhtml", "canvas");
      return t.style.display = "block", t;
    }(),
        n = void 0 !== t.context ? t.context : null,
        i = void 0 !== t.alpha && t.alpha,
        r = void 0 === t.depth || t.depth,
        s = void 0 === t.stencil || t.stencil,
        a = void 0 !== t.antialias && t.antialias,
        o = void 0 === t.premultipliedAlpha || t.premultipliedAlpha,
        l = void 0 !== t.preserveDrawingBuffer && t.preserveDrawingBuffer,
        c = void 0 !== t.powerPreference ? t.powerPreference : "default",
        h = void 0 !== t.failIfMajorPerformanceCaveat && t.failIfMajorPerformanceCaveat;
    var d = null,
        m = null;
    var f = [],
        g = [];
    this.domElement = e, this.debug = {
      checkShaderErrors: !0
    }, this.autoClear = !0, this.autoClearColor = !0, this.autoClearDepth = !0, this.autoClearStencil = !0, this.sortObjects = !0, this.clippingPlanes = [], this.localClippingEnabled = !1, this.gammaFactor = 2, this.outputEncoding = X, this.physicallyCorrectLights = !1, this.toneMapping = 0, this.toneMappingExposure = 1;
    var v = this;

    var _ = !1,
        M = 0,
        S = 0,
        T = null,
        A = -1,
        L = null;

    var R = new St(),
        C = new St();
    var P = null,
        I = e.width,
        D = e.height,
        N = 1,
        B = null,
        z = null;
    var F = new St(0, 0, I, D),
        O = new St(0, 0, I, D);
    var U = !1;
    var H = [],
        G = new ai();
    var k = !1,
        V = !1,
        W = null;
    var j = new ae(),
        q = new Rt(),
        Y = {
      background: null,
      fog: null,
      environment: null,
      overrideMaterial: null,
      isScene: !0
    };

    function J() {
      return null === T ? N : 1;
    }

    var Z,
        Q,
        K,
        $,
        tt,
        et,
        nt,
        it,
        rt,
        st,
        at,
        ot,
        lt,
        ct,
        ht,
        ut,
        dt,
        pt,
        mt,
        ft,
        gt,
        vt,
        yt,
        xt = n;

    function _t(t, n) {
      for (var _i93 = 0; _i93 < t.length; _i93++) {
        var _r79 = t[_i93],
            _s35 = e.getContext(_r79, n);

        if (null !== _s35) return _s35;
      }

      return null;
    }

    try {
      var _t144 = {
        alpha: i,
        depth: r,
        stencil: s,
        antialias: a,
        premultipliedAlpha: o,
        preserveDrawingBuffer: l,
        powerPreference: c,
        failIfMajorPerformanceCaveat: h
      };

      if (e.addEventListener("webglcontextlost", wt, !1), e.addEventListener("webglcontextrestored", Et, !1), null === xt) {
        var _e108 = ["webgl2", "webgl", "experimental-webgl"];
        if (!0 === v.isWebGL1Renderer && _e108.shift(), xt = _t(_e108, _t144), null === xt) throw _t(_e108) ? new Error("Error creating WebGL context with your selected attributes.") : new Error("Error creating WebGL context.");
      }

      void 0 === xt.getShaderPrecisionFormat && (xt.getShaderPrecisionFormat = function () {
        return {
          rangeMin: 1,
          rangeMax: 1,
          precision: 1
        };
      });
    } catch (t) {
      throw console.error("THREE.WebGLRenderer: " + t.message), t;
    }

    function Mt() {
      Z = new Yi(xt), Q = new gi(xt, Z, t), Z.init(Q), vt = new Vs(xt, Z, Q), K = new Gs(xt, Z, Q), H[0] = 1029, $ = new Qi(xt), tt = new As(), et = new ks(xt, Z, K, tt, Q, vt, $), nt = new yi(v), it = new Xi(v), rt = new li(xt, Q), yt = new mi(xt, Z, rt, Q), st = new Ji(xt, rt, $, yt), at = new er(xt, st, rt, $), mt = new tr(xt), ut = new vi(tt), ot = new Es(v, nt, it, Z, Q, yt, ut), lt = new Js(tt), ct = new Ps(tt), ht = new Fs(Z, Q), pt = new pi(v, nt, K, at, o), dt = new Hs(v, at, Q), ft = new fi(xt, Z, $, Q), gt = new Zi(xt, Z, $, Q), $.programs = ot.programs, v.capabilities = Q, v.extensions = Z, v.properties = tt, v.renderLists = ct, v.shadowMap = dt, v.state = K, v.info = $;
    }

    Mt();
    var bt = new Ys(v, xt);

    function wt(t) {
      t.preventDefault(), console.log("THREE.WebGLRenderer: Context Lost."), _ = !0;
    }

    function Et() {
      console.log("THREE.WebGLRenderer: Context Restored."), _ = !1;
      var t = $.autoReset,
          e = dt.enabled,
          n = dt.autoUpdate,
          i = dt.needsUpdate,
          r = dt.type;
      Mt(), $.autoReset = t, dt.enabled = e, dt.autoUpdate = n, dt.needsUpdate = i, dt.type = r;
    }

    function Lt(t) {
      var e = t.target;
      e.removeEventListener("dispose", Lt), function (t) {
        (function (t) {
          var e = tt.get(t).programs;
          void 0 !== e && e.forEach(function (t) {
            ot.releaseProgram(t);
          });
        })(t), tt.remove(t);
      }(e);
    }

    this.xr = bt, this.getContext = function () {
      return xt;
    }, this.getContextAttributes = function () {
      return xt.getContextAttributes();
    }, this.forceContextLoss = function () {
      var t = Z.get("WEBGL_lose_context");
      t && t.loseContext();
    }, this.forceContextRestore = function () {
      var t = Z.get("WEBGL_lose_context");
      t && t.restoreContext();
    }, this.getPixelRatio = function () {
      return N;
    }, this.setPixelRatio = function (t) {
      void 0 !== t && (N = t, this.setSize(I, D, !1));
    }, this.getSize = function (t) {
      return t.set(I, D);
    }, this.setSize = function (t, n, i) {
      bt.isPresenting ? console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.") : (I = t, D = n, e.width = Math.floor(t * N), e.height = Math.floor(n * N), !1 !== i && (e.style.width = t + "px", e.style.height = n + "px"), this.setViewport(0, 0, t, n));
    }, this.getDrawingBufferSize = function (t) {
      return t.set(I * N, D * N).floor();
    }, this.setDrawingBufferSize = function (t, n, i) {
      I = t, D = n, N = i, e.width = Math.floor(t * i), e.height = Math.floor(n * i), this.setViewport(0, 0, t, n);
    }, this.getCurrentViewport = function (t) {
      return t.copy(R);
    }, this.getViewport = function (t) {
      return t.copy(F);
    }, this.setViewport = function (t, e, n, i) {
      t.isVector4 ? F.set(t.x, t.y, t.z, t.w) : F.set(t, e, n, i), K.viewport(R.copy(F).multiplyScalar(N).floor());
    }, this.getScissor = function (t) {
      return t.copy(O);
    }, this.setScissor = function (t, e, n, i) {
      t.isVector4 ? O.set(t.x, t.y, t.z, t.w) : O.set(t, e, n, i), K.scissor(C.copy(O).multiplyScalar(N).floor());
    }, this.getScissorTest = function () {
      return U;
    }, this.setScissorTest = function (t) {
      K.setScissorTest(U = t);
    }, this.setOpaqueSort = function (t) {
      B = t;
    }, this.setTransparentSort = function (t) {
      z = t;
    }, this.getClearColor = function (t) {
      return t.copy(pt.getClearColor());
    }, this.setClearColor = function () {
      pt.setClearColor.apply(pt, arguments);
    }, this.getClearAlpha = function () {
      return pt.getClearAlpha();
    }, this.setClearAlpha = function () {
      pt.setClearAlpha.apply(pt, arguments);
    }, this.clear = function (t, e, n) {
      var i = 0;
      (void 0 === t || t) && (i |= 16384), (void 0 === e || e) && (i |= 256), (void 0 === n || n) && (i |= 1024), xt.clear(i);
    }, this.clearColor = function () {
      this.clear(!0, !1, !1);
    }, this.clearDepth = function () {
      this.clear(!1, !0, !1);
    }, this.clearStencil = function () {
      this.clear(!1, !1, !0);
    }, this.dispose = function () {
      e.removeEventListener("webglcontextlost", wt, !1), e.removeEventListener("webglcontextrestored", Et, !1), ct.dispose(), ht.dispose(), tt.dispose(), nt.dispose(), it.dispose(), at.dispose(), yt.dispose(), bt.dispose(), bt.removeEventListener("sessionstart", Pt), bt.removeEventListener("sessionend", It), W && (W.dispose(), W = null), Dt.stop();
    }, this.renderBufferImmediate = function (t, e) {
      yt.initAttributes();
      var n = tt.get(t);
      t.hasPositions && !n.position && (n.position = xt.createBuffer()), t.hasNormals && !n.normal && (n.normal = xt.createBuffer()), t.hasUvs && !n.uv && (n.uv = xt.createBuffer()), t.hasColors && !n.color && (n.color = xt.createBuffer());
      var i = e.getAttributes();
      t.hasPositions && (xt.bindBuffer(34962, n.position), xt.bufferData(34962, t.positionArray, 35048), yt.enableAttribute(i.position), xt.vertexAttribPointer(i.position, 3, 5126, !1, 0, 0)), t.hasNormals && (xt.bindBuffer(34962, n.normal), xt.bufferData(34962, t.normalArray, 35048), yt.enableAttribute(i.normal), xt.vertexAttribPointer(i.normal, 3, 5126, !1, 0, 0)), t.hasUvs && (xt.bindBuffer(34962, n.uv), xt.bufferData(34962, t.uvArray, 35048), yt.enableAttribute(i.uv), xt.vertexAttribPointer(i.uv, 2, 5126, !1, 0, 0)), t.hasColors && (xt.bindBuffer(34962, n.color), xt.bufferData(34962, t.colorArray, 35048), yt.enableAttribute(i.color), xt.vertexAttribPointer(i.color, 3, 5126, !1, 0, 0)), yt.disableUnusedAttributes(), xt.drawArrays(4, 0, t.count), t.count = 0;
    }, this.renderBufferDirect = function (t, e, n, i, r, s) {
      null === e && (e = Y);
      var a = r.isMesh && r.matrixWorld.determinant() < 0,
          o = Ut(t, e, i, r);
      K.setMaterial(i, a);
      var l = n.index;
      var c = n.attributes.position;

      if (null === l) {
        if (void 0 === c || 0 === c.count) return;
      } else if (0 === l.count) return;

      var h,
          u = 1;
      !0 === i.wireframe && (l = st.getWireframeAttribute(n), u = 2), void 0 === n.morphAttributes.position && void 0 === n.morphAttributes.normal || mt.update(r, n, i, o), yt.setup(r, i, o, n, l);
      var d = ft;
      null !== l && (h = rt.get(l), d = gt, d.setIndex(h));

      var p = null !== l ? l.count : c.count,
          m = n.drawRange.start * u,
          f = n.drawRange.count * u,
          g = null !== s ? s.start * u : 0,
          v = null !== s ? s.count * u : 1 / 0,
          y = Math.max(m, g),
          x = Math.min(p, m + f, g + v) - 1,
          _ = Math.max(0, x - y + 1);

      if (0 !== _) {
        if (r.isMesh) !0 === i.wireframe ? (K.setLineWidth(i.wireframeLinewidth * J()), d.setMode(1)) : d.setMode(4);else if (r.isLine) {
          var _t145 = i.linewidth;
          void 0 === _t145 && (_t145 = 1), K.setLineWidth(_t145 * J()), r.isLineSegments ? d.setMode(1) : r.isLineLoop ? d.setMode(2) : d.setMode(3);
        } else r.isPoints ? d.setMode(0) : r.isSprite && d.setMode(4);
        if (r.isInstancedMesh) d.renderInstances(y, _, r.count);else if (n.isInstancedBufferGeometry) {
          var _t146 = Math.min(n.instanceCount, n._maxInstanceCount);

          d.renderInstances(y, _, _t146);
        } else d.render(y, _);
      }
    }, this.compile = function (t, e) {
      m = ht.get(t), m.init(), g.push(m), t.traverseVisible(function (t) {
        t.isLight && t.layers.test(e.layers) && (m.pushLight(t), t.castShadow && m.pushShadow(t));
      }), m.setupLights(), t.traverse(function (e) {
        var n = e.material;
        if (n) if (Array.isArray(n)) for (var _i94 = 0; _i94 < n.length; _i94++) {
          Ft(n[_i94], t, e);
        } else Ft(n, t, e);
      }), g.pop(), m = null;
    };
    var Ct = null;

    function Pt() {
      Dt.stop();
    }

    function It() {
      Dt.start();
    }

    var Dt = new oi();

    function Nt(t, e, n, i) {
      if (!1 === t.visible) return;
      if (t.layers.test(e.layers)) if (t.isGroup) n = t.renderOrder;else if (t.isLOD) !0 === t.autoUpdate && t.update(e);else if (t.isLight) m.pushLight(t), t.castShadow && m.pushShadow(t);else if (t.isSprite) {
        if (!t.frustumCulled || G.intersectsSprite(t)) {
          i && q.setFromMatrixPosition(t.matrixWorld).applyMatrix4(j);

          var _e109 = at.update(t),
              _r80 = t.material;

          _r80.visible && d.push(t, _e109, _r80, n, q.z, null);
        }
      } else if (t.isImmediateRenderObject) i && q.setFromMatrixPosition(t.matrixWorld).applyMatrix4(j), d.push(t, null, t.material, n, q.z, null);else if ((t.isMesh || t.isLine || t.isPoints) && (t.isSkinnedMesh && t.skeleton.frame !== $.render.frame && (t.skeleton.update(), t.skeleton.frame = $.render.frame), !t.frustumCulled || G.intersectsObject(t))) {
        i && q.setFromMatrixPosition(t.matrixWorld).applyMatrix4(j);

        var _e110 = at.update(t),
            _r81 = t.material;

        if (Array.isArray(_r81)) {
          var _i95 = _e110.groups;

          for (var _s36 = 0, _a32 = _i95.length; _s36 < _a32; _s36++) {
            var _a33 = _i95[_s36],
                _o20 = _r81[_a33.materialIndex];
            _o20 && _o20.visible && d.push(t, _e110, _o20, n, q.z, _a33);
          }
        } else _r81.visible && d.push(t, _e110, _r81, n, q.z, null);
      }
      var r = t.children;

      for (var _t147 = 0, _s37 = r.length; _t147 < _s37; _t147++) {
        Nt(r[_t147], e, n, i);
      }
    }

    function Bt(t, e, n) {
      var i = !0 === e.isScene ? e.overrideMaterial : null;

      if (n.isArrayCamera) {
        var _r82 = n.cameras;

        for (var _n103 = 0, _s38 = _r82.length; _n103 < _s38; _n103++) {
          var _s39 = _r82[_n103];
          K.viewport(R.copy(_s39.viewport)), m.setupLightsView(_s39);

          for (var _n104 = 0, _r83 = t.length; _n104 < _r83; _n104++) {
            var _r84 = t[_n104],
                _a34 = _r84.object,
                _o21 = _r84.geometry,
                _l17 = null === i ? _r84.material : i,
                _c17 = _r84.group;

            _a34.layers.test(_s39.layers) && zt(_a34, e, _s39, _o21, _l17, _c17);
          }
        }
      } else for (var _r85 = 0, _s40 = t.length; _r85 < _s40; _r85++) {
        var _s41 = t[_r85];
        zt(_s41.object, e, n, _s41.geometry, null === i ? _s41.material : i, _s41.group);
      }
    }

    function zt(t, e, n, i, r, s) {
      if (t.onBeforeRender(v, e, n, i, r, s), t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse, t.matrixWorld), t.normalMatrix.getNormalMatrix(t.modelViewMatrix), t.isImmediateRenderObject) {
        var _i96 = Ut(n, e, r, t);

        K.setMaterial(r), yt.reset(), function (t, e) {
          t.render(function (t) {
            v.renderBufferImmediate(t, e);
          });
        }(t, _i96);
      } else !0 === r.transparent && 2 === r.side ? (r.side = 1, r.needsUpdate = !0, v.renderBufferDirect(n, e, i, r, t, s), r.side = 0, r.needsUpdate = !0, v.renderBufferDirect(n, e, i, r, t, s), r.side = 2) : v.renderBufferDirect(n, e, i, r, t, s);

      t.onAfterRender(v, e, n, i, r, s);
    }

    function Ft(t, e, n) {
      !0 !== e.isScene && (e = Y);
      var i = tt.get(t),
          r = m.state.lights,
          s = m.state.shadowsArray,
          a = r.state.version,
          o = ot.getParameters(t, r.state, s, e, n),
          l = ot.getProgramCacheKey(o);
      var c = i.programs;
      i.environment = t.isMeshStandardMaterial ? e.environment : null, i.fog = e.fog, i.envMap = (t.isMeshStandardMaterial ? it : nt).get(t.envMap || i.environment), void 0 === c && (t.addEventListener("dispose", Lt), c = new Map(), i.programs = c);
      var h = c.get(l);

      if (void 0 !== h) {
        if (i.currentProgram === h && i.lightsStateVersion === a) return Ot(t, o), h;
      } else o.uniforms = ot.getUniforms(t), t.onBuild(o, v), t.onBeforeCompile(o, v), h = ot.acquireProgram(o, l), c.set(l, h), i.uniforms = o.uniforms;

      var u = i.uniforms;
      (t.isShaderMaterial || t.isRawShaderMaterial) && !0 !== t.clipping || (u.clippingPlanes = ut.uniform), Ot(t, o), i.needsLights = function (t) {
        return t.isMeshLambertMaterial || t.isMeshToonMaterial || t.isMeshPhongMaterial || t.isMeshStandardMaterial || t.isShadowMaterial || t.isShaderMaterial && !0 === t.lights;
      }(t), i.lightsStateVersion = a, i.needsLights && (u.ambientLightColor.value = r.state.ambient, u.lightProbe.value = r.state.probe, u.directionalLights.value = r.state.directional, u.directionalLightShadows.value = r.state.directionalShadow, u.spotLights.value = r.state.spot, u.spotLightShadows.value = r.state.spotShadow, u.rectAreaLights.value = r.state.rectArea, u.ltc_1.value = r.state.rectAreaLTC1, u.ltc_2.value = r.state.rectAreaLTC2, u.pointLights.value = r.state.point, u.pointLightShadows.value = r.state.pointShadow, u.hemisphereLights.value = r.state.hemi, u.directionalShadowMap.value = r.state.directionalShadowMap, u.directionalShadowMatrix.value = r.state.directionalShadowMatrix, u.spotShadowMap.value = r.state.spotShadowMap, u.spotShadowMatrix.value = r.state.spotShadowMatrix, u.pointShadowMap.value = r.state.pointShadowMap, u.pointShadowMatrix.value = r.state.pointShadowMatrix);
      var d = h.getUniforms(),
          p = ss.seqWithValue(d.seq, u);
      return i.currentProgram = h, i.uniformsList = p, h;
    }

    function Ot(t, e) {
      var n = tt.get(t);
      n.outputEncoding = e.outputEncoding, n.instancing = e.instancing, n.skinning = e.skinning, n.morphTargets = e.morphTargets, n.morphNormals = e.morphNormals, n.numClippingPlanes = e.numClippingPlanes, n.numIntersection = e.numClipIntersection, n.vertexAlphas = e.vertexAlphas, n.vertexTangents = e.vertexTangents;
    }

    function Ut(t, e, n, i) {
      !0 !== e.isScene && (e = Y), et.resetTextureUnits();
      var r = e.fog,
          s = n.isMeshStandardMaterial ? e.environment : null,
          a = null === T ? v.outputEncoding : T.texture.encoding,
          o = (n.isMeshStandardMaterial ? it : nt).get(n.envMap || s),
          l = !0 === n.vertexColors && i.geometry && i.geometry.attributes.color && 4 === i.geometry.attributes.color.itemSize,
          c = i.geometry && i.geometry.attributes.tangent,
          h = i.geometry && i.geometry.morphAttributes.position,
          u = i.geometry && i.geometry.morphAttributes.normal,
          d = tt.get(n),
          p = m.state.lights;

      if (!0 === k && (!0 === V || t !== L)) {
        var _e111 = t === L && n.id === A;

        ut.setState(n, t, _e111);
      }

      var f = !1;
      n.version === d.__version ? d.needsLights && d.lightsStateVersion !== p.state.version || d.outputEncoding !== a || i.isInstancedMesh && !1 === d.instancing ? f = !0 : i.isInstancedMesh || !0 !== d.instancing ? i.isSkinnedMesh && !1 === d.skinning ? f = !0 : i.isSkinnedMesh || !0 !== d.skinning ? d.envMap !== o || n.fog && d.fog !== r ? f = !0 : void 0 === d.numClippingPlanes || d.numClippingPlanes === ut.numPlanes && d.numIntersection === ut.numIntersection ? (d.vertexAlphas !== l || d.vertexTangents !== c || d.morphTargets !== h || d.morphNormals !== u) && (f = !0) : f = !0 : f = !0 : f = !0 : (f = !0, d.__version = n.version);
      var g = d.currentProgram;
      !0 === f && (g = Ft(n, e, i));

      var y = !1,
          x = !1,
          _ = !1;

      var M = g.getUniforms(),
          b = d.uniforms;

      if (K.useProgram(g.program) && (y = !0, x = !0, _ = !0), n.id !== A && (A = n.id, x = !0), y || L !== t) {
        if (M.setValue(xt, "projectionMatrix", t.projectionMatrix), Q.logarithmicDepthBuffer && M.setValue(xt, "logDepthBufFC", 2 / (Math.log(t.far + 1) / Math.LN2)), L !== t && (L = t, x = !0, _ = !0), n.isShaderMaterial || n.isMeshPhongMaterial || n.isMeshToonMaterial || n.isMeshStandardMaterial || n.envMap) {
          var _e112 = M.map.cameraPosition;
          void 0 !== _e112 && _e112.setValue(xt, q.setFromMatrixPosition(t.matrixWorld));
        }

        (n.isMeshPhongMaterial || n.isMeshToonMaterial || n.isMeshLambertMaterial || n.isMeshBasicMaterial || n.isMeshStandardMaterial || n.isShaderMaterial) && M.setValue(xt, "isOrthographic", !0 === t.isOrthographicCamera), (n.isMeshPhongMaterial || n.isMeshToonMaterial || n.isMeshLambertMaterial || n.isMeshBasicMaterial || n.isMeshStandardMaterial || n.isShaderMaterial || n.isShadowMaterial || i.isSkinnedMesh) && M.setValue(xt, "viewMatrix", t.matrixWorldInverse);
      }

      if (i.isSkinnedMesh) {
        M.setOptional(xt, i, "bindMatrix"), M.setOptional(xt, i, "bindMatrixInverse");
        var _t148 = i.skeleton;
        _t148 && (Q.floatVertexTextures ? (null === _t148.boneTexture && _t148.computeBoneTexture(), M.setValue(xt, "boneTexture", _t148.boneTexture, et), M.setValue(xt, "boneTextureSize", _t148.boneTextureSize)) : M.setOptional(xt, _t148, "boneMatrices"));
      }

      var w, S;
      return (x || d.receiveShadow !== i.receiveShadow) && (d.receiveShadow = i.receiveShadow, M.setValue(xt, "receiveShadow", i.receiveShadow)), x && (M.setValue(xt, "toneMappingExposure", v.toneMappingExposure), d.needsLights && (S = _, (w = b).ambientLightColor.needsUpdate = S, w.lightProbe.needsUpdate = S, w.directionalLights.needsUpdate = S, w.directionalLightShadows.needsUpdate = S, w.pointLights.needsUpdate = S, w.pointLightShadows.needsUpdate = S, w.spotLights.needsUpdate = S, w.spotLightShadows.needsUpdate = S, w.rectAreaLights.needsUpdate = S, w.hemisphereLights.needsUpdate = S), r && n.fog && lt.refreshFogUniforms(b, r), lt.refreshMaterialUniforms(b, n, N, D, W), ss.upload(xt, d.uniformsList, b, et)), n.isShaderMaterial && !0 === n.uniformsNeedUpdate && (ss.upload(xt, d.uniformsList, b, et), n.uniformsNeedUpdate = !1), n.isSpriteMaterial && M.setValue(xt, "center", i.center), M.setValue(xt, "modelViewMatrix", i.modelViewMatrix), M.setValue(xt, "normalMatrix", i.normalMatrix), M.setValue(xt, "modelMatrix", i.matrixWorld), g;
    }

    Dt.setAnimationLoop(function (t) {
      Ct && Ct(t);
    }), "undefined" != typeof window && Dt.setContext(window), this.setAnimationLoop = function (t) {
      Ct = t, bt.setAnimationLoop(t), null === t ? Dt.stop() : Dt.start();
    }, bt.addEventListener("sessionstart", Pt), bt.addEventListener("sessionend", It), this.render = function (t, e) {
      if (void 0 !== e && !0 !== e.isCamera) return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");
      if (!0 === _) return;
      !0 === t.autoUpdate && t.updateMatrixWorld(), null === e.parent && e.updateMatrixWorld(), !0 === bt.enabled && !0 === bt.isPresenting && (!0 === bt.cameraAutoUpdate && bt.updateCamera(e), e = bt.getCamera()), !0 === t.isScene && t.onBeforeRender(v, t, e, T), m = ht.get(t, g.length), m.init(), g.push(m), j.multiplyMatrices(e.projectionMatrix, e.matrixWorldInverse), G.setFromProjectionMatrix(j), V = this.localClippingEnabled, k = ut.init(this.clippingPlanes, V, e), d = ct.get(t, f.length), d.init(), f.push(d), Nt(t, e, 0, v.sortObjects), d.finish(), !0 === v.sortObjects && d.sort(B, z), !0 === k && ut.beginShadows();
      var n = m.state.shadowsArray;
      dt.render(n, t, e), m.setupLights(), m.setupLightsView(e), !0 === k && ut.endShadows(), !0 === this.info.autoReset && this.info.reset(), pt.render(d, t);
      var i = d.opaque,
          r = d.transmissive,
          s = d.transparent;
      i.length > 0 && Bt(i, t, e), r.length > 0 && function (t, e, n, i) {
        if (null === W) {
          var _t149 = !0 === a && !0 === Q.isWebGL2;

          W = new (_t149 ? At : Tt)(1024, 1024, {
            generateMipmaps: !0,
            type: null !== vt.convert(w) ? w : x,
            minFilter: y,
            magFilter: p,
            wrapS: u,
            wrapT: u
          });
        }

        var r = v.getRenderTarget();
        v.setRenderTarget(W), v.clear();
        var s = v.toneMapping;
        v.toneMapping = 0, Bt(t, n, i), v.toneMapping = s, et.updateMultisampleRenderTarget(W), et.updateRenderTargetMipmap(W), v.setRenderTarget(r), Bt(e, n, i);
      }(i, r, t, e), s.length > 0 && Bt(s, t, e), null !== T && (et.updateMultisampleRenderTarget(T), et.updateRenderTargetMipmap(T)), !0 === t.isScene && t.onAfterRender(v, t, e), K.buffers.depth.setTest(!0), K.buffers.depth.setMask(!0), K.buffers.color.setMask(!0), K.setPolygonOffset(!1), yt.resetDefaultState(), A = -1, L = null, g.pop(), m = g.length > 0 ? g[g.length - 1] : null, f.pop(), d = f.length > 0 ? f[f.length - 1] : null;
    }, this.getActiveCubeFace = function () {
      return M;
    }, this.getActiveMipmapLevel = function () {
      return S;
    }, this.getRenderTarget = function () {
      return T;
    }, this.setRenderTarget = function (t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      T = t, M = e, S = n, t && void 0 === tt.get(t).__webglFramebuffer && et.setupRenderTarget(t);
      var i = null,
          r = !1,
          s = !1;

      if (t) {
        var _n105 = t.texture;
        (_n105.isDataTexture3D || _n105.isDataTexture2DArray) && (s = !0);

        var _a35 = tt.get(t).__webglFramebuffer;

        t.isWebGLCubeRenderTarget ? (i = _a35[e], r = !0) : i = t.isWebGLMultisampleRenderTarget ? tt.get(t).__webglMultisampledFramebuffer : _a35, R.copy(t.viewport), C.copy(t.scissor), P = t.scissorTest;
      } else R.copy(F).multiplyScalar(N).floor(), C.copy(O).multiplyScalar(N).floor(), P = U;

      if (K.bindFramebuffer(36160, i) && Q.drawBuffers) {
        var _e113 = !1;

        if (t) {
          if (t.isWebGLMultipleRenderTargets) {
            var _n106 = t.texture;

            if (H.length !== _n106.length || 36064 !== H[0]) {
              for (var _t150 = 0, _e114 = _n106.length; _t150 < _e114; _t150++) {
                H[_t150] = 36064 + _t150;
              }

              H.length = _n106.length, _e113 = !0;
            }
          } else 1 === H.length && 36064 === H[0] || (H[0] = 36064, H.length = 1, _e113 = !0);
        } else 1 === H.length && 1029 === H[0] || (H[0] = 1029, H.length = 1, _e113 = !0);
        _e113 && (Q.isWebGL2 ? xt.drawBuffers(H) : Z.get("WEBGL_draw_buffers").drawBuffersWEBGL(H));
      }

      if (K.viewport(R), K.scissor(C), K.setScissorTest(P), r) {
        var _i97 = tt.get(t.texture);

        xt.framebufferTexture2D(36160, 36064, 34069 + e, _i97.__webglTexture, n);
      } else if (s) {
        var _i98 = tt.get(t.texture),
            _r86 = e || 0;

        xt.framebufferTextureLayer(36160, 36064, _i98.__webglTexture, n || 0, _r86);
      }
    }, this.readRenderTargetPixels = function (t, e, n, i, r, s, a) {
      if (!t || !t.isWebGLRenderTarget) return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");

      var o = tt.get(t).__webglFramebuffer;

      if (t.isWebGLCubeRenderTarget && void 0 !== a && (o = o[a]), o) {
        K.bindFramebuffer(36160, o);

        try {
          var _a36 = t.texture,
              _o22 = _a36.format,
              _l18 = _a36.type;
          if (_o22 !== E && vt.convert(_o22) !== xt.getParameter(35739)) return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");

          var _c18 = _l18 === w && (Z.has("EXT_color_buffer_half_float") || Q.isWebGL2 && Z.has("EXT_color_buffer_float"));

          if (!(_l18 === x || vt.convert(_l18) === xt.getParameter(35738) || _l18 === b && (Q.isWebGL2 || Z.has("OES_texture_float") || Z.has("WEBGL_color_buffer_float")) || _c18)) return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");
          36053 === xt.checkFramebufferStatus(36160) ? e >= 0 && e <= t.width - i && n >= 0 && n <= t.height - r && xt.readPixels(e, n, i, r, vt.convert(_o22), vt.convert(_l18), s) : console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.");
        } finally {
          var _t151 = null !== T ? tt.get(T).__webglFramebuffer : null;

          K.bindFramebuffer(36160, _t151);
        }
      }
    }, this.copyFramebufferToTexture = function (t, e) {
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      var i = Math.pow(2, -n),
          r = Math.floor(e.image.width * i),
          s = Math.floor(e.image.height * i);
      var a = vt.convert(e.format);
      Q.isWebGL2 && (6407 === a && (a = 32849), 6408 === a && (a = 32856)), et.setTexture2D(e, 0), xt.copyTexImage2D(3553, n, a, t.x, t.y, r, s, 0), K.unbindTexture();
    }, this.copyTextureToTexture = function (t, e, n) {
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;
      var r = e.image.width,
          s = e.image.height,
          a = vt.convert(n.format),
          o = vt.convert(n.type);
      et.setTexture2D(n, 0), xt.pixelStorei(37440, n.flipY), xt.pixelStorei(37441, n.premultiplyAlpha), xt.pixelStorei(3317, n.unpackAlignment), e.isDataTexture ? xt.texSubImage2D(3553, i, t.x, t.y, r, s, a, o, e.image.data) : e.isCompressedTexture ? xt.compressedTexSubImage2D(3553, i, t.x, t.y, e.mipmaps[0].width, e.mipmaps[0].height, a, e.mipmaps[0].data) : xt.texSubImage2D(3553, i, t.x, t.y, a, o, e.image), 0 === i && n.generateMipmaps && xt.generateMipmap(3553), K.unbindTexture();
    }, this.copyTextureToTexture3D = function (t, e, n, i) {
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;
      if (v.isWebGL1Renderer) return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");
      var s = t.max.x - t.min.x + 1,
          a = t.max.y - t.min.y + 1,
          o = t.max.z - t.min.z + 1,
          l = vt.convert(i.format),
          c = vt.convert(i.type);
      var h;
      if (i.isDataTexture3D) et.setTexture3D(i, 0), h = 32879;else {
        if (!i.isDataTexture2DArray) return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");
        et.setTexture2DArray(i, 0), h = 35866;
      }
      xt.pixelStorei(37440, i.flipY), xt.pixelStorei(37441, i.premultiplyAlpha), xt.pixelStorei(3317, i.unpackAlignment);
      var u = xt.getParameter(3314),
          d = xt.getParameter(32878),
          p = xt.getParameter(3316),
          m = xt.getParameter(3315),
          f = xt.getParameter(32877),
          g = n.isCompressedTexture ? n.mipmaps[0] : n.image;
      xt.pixelStorei(3314, g.width), xt.pixelStorei(32878, g.height), xt.pixelStorei(3316, t.min.x), xt.pixelStorei(3315, t.min.y), xt.pixelStorei(32877, t.min.z), n.isDataTexture || n.isDataTexture3D ? xt.texSubImage3D(h, r, e.x, e.y, e.z, s, a, o, l, c, g.data) : n.isCompressedTexture ? (console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."), xt.compressedTexSubImage3D(h, r, e.x, e.y, e.z, s, a, o, l, g.data)) : xt.texSubImage3D(h, r, e.x, e.y, e.z, s, a, o, l, c, g), xt.pixelStorei(3314, u), xt.pixelStorei(32878, d), xt.pixelStorei(3316, p), xt.pixelStorei(3315, m), xt.pixelStorei(32877, f), 0 === r && i.generateMipmaps && xt.generateMipmap(h), K.unbindTexture();
    }, this.initTexture = function (t) {
      et.setTexture2D(t, 0), K.unbindTexture();
    }, this.resetState = function () {
      M = 0, S = 0, T = null, K.reset(), yt.reset();
    }, "undefined" != typeof __THREE_DEVTOOLS__ && __THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe", {
      detail: this
    }));
  }

  var Qs = /*#__PURE__*/function (_Zs) {
    _inherits(Qs, _Zs);

    var _super37 = _createSuper(Qs);

    function Qs() {
      _classCallCheck(this, Qs);

      return _super37.apply(this, arguments);
    }

    return Qs;
  }(Zs);

  Qs.prototype.isWebGL1Renderer = !0;

  var Ks = /*#__PURE__*/function () {
    function Ks(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 25e-5;

      _classCallCheck(this, Ks);

      this.name = "", this.color = new Qe(t), this.density = e;
    }

    _createClass(Ks, [{
      key: "clone",
      value: function clone() {
        return new Ks(this.color, this.density);
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        return {
          type: "FogExp2",
          color: this.color.getHex(),
          density: this.density
        };
      }
    }]);

    return Ks;
  }();

  Ks.prototype.isFogExp2 = !0;

  var $s = /*#__PURE__*/function () {
    function $s(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1e3;

      _classCallCheck(this, $s);

      this.name = "", this.color = new Qe(t), this.near = e, this.far = n;
    }

    _createClass($s, [{
      key: "clone",
      value: function clone() {
        return new $s(this.color, this.near, this.far);
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        return {
          type: "Fog",
          color: this.color.getHex(),
          near: this.near,
          far: this.far
        };
      }
    }]);

    return $s;
  }();

  $s.prototype.isFog = !0;

  var ta = /*#__PURE__*/function (_Pe5) {
    _inherits(ta, _Pe5);

    var _super38 = _createSuper(ta);

    function ta() {
      var _this27;

      _classCallCheck(this, ta);

      _this27 = _super38.call(this), _this27.type = "Scene", _this27.background = null, _this27.environment = null, _this27.fog = null, _this27.overrideMaterial = null, _this27.autoUpdate = !0, "undefined" != typeof __THREE_DEVTOOLS__ && __THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe", {
        detail: _assertThisInitialized(_this27)
      }));
      return _this27;
    }

    _createClass(ta, [{
      key: "copy",
      value: function copy(t, e) {
        return _get(_getPrototypeOf(ta.prototype), "copy", this).call(this, t, e), null !== t.background && (this.background = t.background.clone()), null !== t.environment && (this.environment = t.environment.clone()), null !== t.fog && (this.fog = t.fog.clone()), null !== t.overrideMaterial && (this.overrideMaterial = t.overrideMaterial.clone()), this.autoUpdate = t.autoUpdate, this.matrixAutoUpdate = t.matrixAutoUpdate, this;
      }
    }, {
      key: "toJSON",
      value: function toJSON(t) {
        var e = _get(_getPrototypeOf(ta.prototype), "toJSON", this).call(this, t);

        return null !== this.fog && (e.object.fog = this.fog.toJSON()), e;
      }
    }]);

    return ta;
  }(Pe);

  ta.prototype.isScene = !0;

  var ea = /*#__PURE__*/function () {
    function ea(t, e) {
      _classCallCheck(this, ea);

      this.array = t, this.stride = e, this.count = void 0 !== t ? t.length / e : 0, this.usage = et, this.updateRange = {
        offset: 0,
        count: -1
      }, this.version = 0, this.uuid = ct();
    }

    _createClass(ea, [{
      key: "onUploadCallback",
      value: function onUploadCallback() {}
    }, {
      key: "needsUpdate",
      set: function set(t) {
        !0 === t && this.version++;
      }
    }, {
      key: "setUsage",
      value: function setUsage(t) {
        return this.usage = t, this;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.array = new t.array.constructor(t.array), this.count = t.count, this.stride = t.stride, this.usage = t.usage, this;
      }
    }, {
      key: "copyAt",
      value: function copyAt(t, e, n) {
        t *= this.stride, n *= e.stride;

        for (var _i99 = 0, _r87 = this.stride; _i99 < _r87; _i99++) {
          this.array[t + _i99] = e.array[n + _i99];
        }

        return this;
      }
    }, {
      key: "set",
      value: function set(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        return this.array.set(t, e), this;
      }
    }, {
      key: "clone",
      value: function clone(t) {
        void 0 === t.arrayBuffers && (t.arrayBuffers = {}), void 0 === this.array.buffer._uuid && (this.array.buffer._uuid = ct()), void 0 === t.arrayBuffers[this.array.buffer._uuid] && (t.arrayBuffers[this.array.buffer._uuid] = this.array.slice(0).buffer);
        var e = new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),
            n = new this.constructor(e, this.stride);
        return n.setUsage(this.usage), n;
      }
    }, {
      key: "onUpload",
      value: function onUpload(t) {
        return this.onUploadCallback = t, this;
      }
    }, {
      key: "toJSON",
      value: function toJSON(t) {
        return void 0 === t.arrayBuffers && (t.arrayBuffers = {}), void 0 === this.array.buffer._uuid && (this.array.buffer._uuid = ct()), void 0 === t.arrayBuffers[this.array.buffer._uuid] && (t.arrayBuffers[this.array.buffer._uuid] = Array.prototype.slice.call(new Uint32Array(this.array.buffer))), {
          uuid: this.uuid,
          buffer: this.array.buffer._uuid,
          type: this.array.constructor.name,
          stride: this.stride
        };
      }
    }]);

    return ea;
  }();

  ea.prototype.isInterleavedBuffer = !0;
  var na = new Rt();

  var ia = /*#__PURE__*/function () {
    function ia(t, e, n) {
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : !1;

      _classCallCheck(this, ia);

      this.name = "", this.data = t, this.itemSize = e, this.offset = n, this.normalized = !0 === i;
    }

    _createClass(ia, [{
      key: "count",
      get: function get() {
        return this.data.count;
      }
    }, {
      key: "array",
      get: function get() {
        return this.data.array;
      }
    }, {
      key: "needsUpdate",
      set: function set(t) {
        this.data.needsUpdate = t;
      }
    }, {
      key: "applyMatrix4",
      value: function applyMatrix4(t) {
        for (var _e115 = 0, _n107 = this.data.count; _e115 < _n107; _e115++) {
          na.x = this.getX(_e115), na.y = this.getY(_e115), na.z = this.getZ(_e115), na.applyMatrix4(t), this.setXYZ(_e115, na.x, na.y, na.z);
        }

        return this;
      }
    }, {
      key: "applyNormalMatrix",
      value: function applyNormalMatrix(t) {
        for (var _e116 = 0, _n108 = this.count; _e116 < _n108; _e116++) {
          na.x = this.getX(_e116), na.y = this.getY(_e116), na.z = this.getZ(_e116), na.applyNormalMatrix(t), this.setXYZ(_e116, na.x, na.y, na.z);
        }

        return this;
      }
    }, {
      key: "transformDirection",
      value: function transformDirection(t) {
        for (var _e117 = 0, _n109 = this.count; _e117 < _n109; _e117++) {
          na.x = this.getX(_e117), na.y = this.getY(_e117), na.z = this.getZ(_e117), na.transformDirection(t), this.setXYZ(_e117, na.x, na.y, na.z);
        }

        return this;
      }
    }, {
      key: "setX",
      value: function setX(t, e) {
        return this.data.array[t * this.data.stride + this.offset] = e, this;
      }
    }, {
      key: "setY",
      value: function setY(t, e) {
        return this.data.array[t * this.data.stride + this.offset + 1] = e, this;
      }
    }, {
      key: "setZ",
      value: function setZ(t, e) {
        return this.data.array[t * this.data.stride + this.offset + 2] = e, this;
      }
    }, {
      key: "setW",
      value: function setW(t, e) {
        return this.data.array[t * this.data.stride + this.offset + 3] = e, this;
      }
    }, {
      key: "getX",
      value: function getX(t) {
        return this.data.array[t * this.data.stride + this.offset];
      }
    }, {
      key: "getY",
      value: function getY(t) {
        return this.data.array[t * this.data.stride + this.offset + 1];
      }
    }, {
      key: "getZ",
      value: function getZ(t) {
        return this.data.array[t * this.data.stride + this.offset + 2];
      }
    }, {
      key: "getW",
      value: function getW(t) {
        return this.data.array[t * this.data.stride + this.offset + 3];
      }
    }, {
      key: "setXY",
      value: function setXY(t, e, n) {
        return t = t * this.data.stride + this.offset, this.data.array[t + 0] = e, this.data.array[t + 1] = n, this;
      }
    }, {
      key: "setXYZ",
      value: function setXYZ(t, e, n, i) {
        return t = t * this.data.stride + this.offset, this.data.array[t + 0] = e, this.data.array[t + 1] = n, this.data.array[t + 2] = i, this;
      }
    }, {
      key: "setXYZW",
      value: function setXYZW(t, e, n, i, r) {
        return t = t * this.data.stride + this.offset, this.data.array[t + 0] = e, this.data.array[t + 1] = n, this.data.array[t + 2] = i, this.data.array[t + 3] = r, this;
      }
    }, {
      key: "clone",
      value: function clone(t) {
        if (void 0 === t) {
          console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");
          var _t152 = [];

          for (var _e118 = 0; _e118 < this.count; _e118++) {
            var _n110 = _e118 * this.data.stride + this.offset;

            for (var _e119 = 0; _e119 < this.itemSize; _e119++) {
              _t152.push(this.data.array[_n110 + _e119]);
            }
          }

          return new en(new this.array.constructor(_t152), this.itemSize, this.normalized);
        }

        return void 0 === t.interleavedBuffers && (t.interleavedBuffers = {}), void 0 === t.interleavedBuffers[this.data.uuid] && (t.interleavedBuffers[this.data.uuid] = this.data.clone(t)), new ia(t.interleavedBuffers[this.data.uuid], this.itemSize, this.offset, this.normalized);
      }
    }, {
      key: "toJSON",
      value: function toJSON(t) {
        if (void 0 === t) {
          console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");
          var _t153 = [];

          for (var _e120 = 0; _e120 < this.count; _e120++) {
            var _n111 = _e120 * this.data.stride + this.offset;

            for (var _e121 = 0; _e121 < this.itemSize; _e121++) {
              _t153.push(this.data.array[_n111 + _e121]);
            }
          }

          return {
            itemSize: this.itemSize,
            type: this.array.constructor.name,
            array: _t153,
            normalized: this.normalized
          };
        }

        return void 0 === t.interleavedBuffers && (t.interleavedBuffers = {}), void 0 === t.interleavedBuffers[this.data.uuid] && (t.interleavedBuffers[this.data.uuid] = this.data.toJSON(t)), {
          isInterleavedBufferAttribute: !0,
          itemSize: this.itemSize,
          data: this.data.uuid,
          offset: this.offset,
          normalized: this.normalized
        };
      }
    }]);

    return ia;
  }();

  ia.prototype.isInterleavedBufferAttribute = !0;

  var ra = /*#__PURE__*/function (_We5) {
    _inherits(ra, _We5);

    var _super39 = _createSuper(ra);

    function ra(t) {
      var _this28;

      _classCallCheck(this, ra);

      _this28 = _super39.call(this), _this28.type = "SpriteMaterial", _this28.color = new Qe(16777215), _this28.map = null, _this28.alphaMap = null, _this28.rotation = 0, _this28.sizeAttenuation = !0, _this28.transparent = !0, _this28.setValues(t);
      return _this28;
    }

    _createClass(ra, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(ra.prototype), "copy", this).call(this, t), this.color.copy(t.color), this.map = t.map, this.alphaMap = t.alphaMap, this.rotation = t.rotation, this.sizeAttenuation = t.sizeAttenuation, this;
      }
    }]);

    return ra;
  }(We);

  var sa;
  ra.prototype.isSpriteMaterial = !0;
  var aa = new Rt(),
      oa = new Rt(),
      la = new Rt(),
      ca = new vt(),
      ha = new vt(),
      ua = new ae(),
      da = new Rt(),
      pa = new Rt(),
      ma = new Rt(),
      fa = new vt(),
      ga = new vt(),
      va = new vt();

  var ya = /*#__PURE__*/function (_Pe6) {
    _inherits(ya, _Pe6);

    var _super40 = _createSuper(ya);

    function ya(t) {
      var _this29;

      _classCallCheck(this, ya);

      if (_this29 = _super40.call(this), _this29.type = "Sprite", void 0 === sa) {
        sa = new wn();

        var _t154 = new Float32Array([-.5, -.5, 0, 0, 0, .5, -.5, 0, 1, 0, .5, .5, 0, 1, 1, -.5, .5, 0, 0, 1]),
            _e122 = new ea(_t154, 5);

        sa.setIndex([0, 1, 2, 0, 2, 3]), sa.setAttribute("position", new ia(_e122, 3, 0, !1)), sa.setAttribute("uv", new ia(_e122, 2, 3, !1));
      }

      _this29.geometry = sa, _this29.material = void 0 !== t ? t : new ra(), _this29.center = new vt(.5, .5);
      return _possibleConstructorReturn(_this29);
    }

    _createClass(ya, [{
      key: "raycast",
      value: function raycast(t, e) {
        null === t.camera && console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'), oa.setFromMatrixScale(this.matrixWorld), ua.copy(t.camera.matrixWorld), this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse, this.matrixWorld), la.setFromMatrixPosition(this.modelViewMatrix), t.camera.isPerspectiveCamera && !1 === this.material.sizeAttenuation && oa.multiplyScalar(-la.z);
        var n = this.material.rotation;
        var i, r;
        0 !== n && (r = Math.cos(n), i = Math.sin(n));
        var s = this.center;
        xa(da.set(-.5, -.5, 0), la, s, oa, i, r), xa(pa.set(.5, -.5, 0), la, s, oa, i, r), xa(ma.set(.5, .5, 0), la, s, oa, i, r), fa.set(0, 0), ga.set(1, 0), va.set(1, 1);
        var a = t.ray.intersectTriangle(da, pa, ma, !1, aa);
        if (null === a && (xa(pa.set(-.5, .5, 0), la, s, oa, i, r), ga.set(0, 1), a = t.ray.intersectTriangle(da, ma, pa, !1, aa), null === a)) return;
        var o = t.ray.origin.distanceTo(aa);
        o < t.near || o > t.far || e.push({
          distance: o,
          point: aa.clone(),
          uv: ke.getUV(aa, da, pa, ma, fa, ga, va, new vt()),
          face: null,
          object: this
        });
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(ya.prototype), "copy", this).call(this, t), void 0 !== t.center && this.center.copy(t.center), this.material = t.material, this;
      }
    }]);

    return ya;
  }(Pe);

  function xa(t, e, n, i, r, s) {
    ca.subVectors(t, n).addScalar(.5).multiply(i), void 0 !== r ? (ha.x = s * ca.x - r * ca.y, ha.y = r * ca.x + s * ca.y) : ha.copy(ca), t.copy(e), t.x += ha.x, t.y += ha.y, t.applyMatrix4(ua);
  }

  ya.prototype.isSprite = !0;

  var _a = new Rt(),
      Ma = new Rt();

  var ba = /*#__PURE__*/function (_Pe7) {
    _inherits(ba, _Pe7);

    var _super41 = _createSuper(ba);

    function ba() {
      var _this30;

      _classCallCheck(this, ba);

      _this30 = _super41.call(this), _this30._currentLevel = 0, _this30.type = "LOD", Object.defineProperties(_assertThisInitialized(_this30), {
        levels: {
          enumerable: !0,
          value: []
        },
        isLOD: {
          value: !0
        }
      }), _this30.autoUpdate = !0;
      return _this30;
    }

    _createClass(ba, [{
      key: "copy",
      value: function copy(t) {
        _get(_getPrototypeOf(ba.prototype), "copy", this).call(this, t, !1);

        var e = t.levels;

        for (var _t155 = 0, _n112 = e.length; _t155 < _n112; _t155++) {
          var _n113 = e[_t155];
          this.addLevel(_n113.object.clone(), _n113.distance);
        }

        return this.autoUpdate = t.autoUpdate, this;
      }
    }, {
      key: "addLevel",
      value: function addLevel(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        e = Math.abs(e);
        var n = this.levels;
        var i;

        for (i = 0; i < n.length && !(e < n[i].distance); i++) {
          ;
        }

        return n.splice(i, 0, {
          distance: e,
          object: t
        }), this.add(t), this;
      }
    }, {
      key: "getCurrentLevel",
      value: function getCurrentLevel() {
        return this._currentLevel;
      }
    }, {
      key: "getObjectForDistance",
      value: function getObjectForDistance(t) {
        var e = this.levels;

        if (e.length > 0) {
          var _n114, _i100;

          for (_n114 = 1, _i100 = e.length; _n114 < _i100 && !(t < e[_n114].distance); _n114++) {
            ;
          }

          return e[_n114 - 1].object;
        }

        return null;
      }
    }, {
      key: "raycast",
      value: function raycast(t, e) {
        if (this.levels.length > 0) {
          _a.setFromMatrixPosition(this.matrixWorld);

          var _n115 = t.ray.origin.distanceTo(_a);

          this.getObjectForDistance(_n115).raycast(t, e);
        }
      }
    }, {
      key: "update",
      value: function update(t) {
        var e = this.levels;

        if (e.length > 1) {
          _a.setFromMatrixPosition(t.matrixWorld), Ma.setFromMatrixPosition(this.matrixWorld);

          var _n116 = _a.distanceTo(Ma) / t.zoom;

          var _i101, _r88;

          for (e[0].object.visible = !0, _i101 = 1, _r88 = e.length; _i101 < _r88 && _n116 >= e[_i101].distance; _i101++) {
            e[_i101 - 1].object.visible = !1, e[_i101].object.visible = !0;
          }

          for (this._currentLevel = _i101 - 1; _i101 < _r88; _i101++) {
            e[_i101].object.visible = !1;
          }
        }
      }
    }, {
      key: "toJSON",
      value: function toJSON(t) {
        var e = _get(_getPrototypeOf(ba.prototype), "toJSON", this).call(this, t);

        !1 === this.autoUpdate && (e.object.autoUpdate = !1), e.object.levels = [];
        var n = this.levels;

        for (var _t156 = 0, _i102 = n.length; _t156 < _i102; _t156++) {
          var _i103 = n[_t156];
          e.object.levels.push({
            object: _i103.object.uuid,
            distance: _i103.distance
          });
        }

        return e;
      }
    }]);

    return ba;
  }(Pe);

  var wa = new Rt(),
      Sa = new St(),
      Ta = new St(),
      Ea = new Rt(),
      Aa = new ae();

  var La = /*#__PURE__*/function (_Gn) {
    _inherits(La, _Gn);

    var _super42 = _createSuper(La);

    function La(t, e) {
      var _this31;

      _classCallCheck(this, La);

      _this31 = _super42.call(this, t, e), _this31.type = "SkinnedMesh", _this31.bindMode = "attached", _this31.bindMatrix = new ae(), _this31.bindMatrixInverse = new ae();
      return _this31;
    }

    _createClass(La, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(La.prototype), "copy", this).call(this, t), this.bindMode = t.bindMode, this.bindMatrix.copy(t.bindMatrix), this.bindMatrixInverse.copy(t.bindMatrixInverse), this.skeleton = t.skeleton, this;
      }
    }, {
      key: "bind",
      value: function bind(t, e) {
        this.skeleton = t, void 0 === e && (this.updateMatrixWorld(!0), this.skeleton.calculateInverses(), e = this.matrixWorld), this.bindMatrix.copy(e), this.bindMatrixInverse.copy(e).invert();
      }
    }, {
      key: "pose",
      value: function pose() {
        this.skeleton.pose();
      }
    }, {
      key: "normalizeSkinWeights",
      value: function normalizeSkinWeights() {
        var t = new St(),
            e = this.geometry.attributes.skinWeight;

        for (var _n117 = 0, _i104 = e.count; _n117 < _i104; _n117++) {
          t.x = e.getX(_n117), t.y = e.getY(_n117), t.z = e.getZ(_n117), t.w = e.getW(_n117);

          var _i105 = 1 / t.manhattanLength();

          _i105 !== 1 / 0 ? t.multiplyScalar(_i105) : t.set(1, 0, 0, 0), e.setXYZW(_n117, t.x, t.y, t.z, t.w);
        }
      }
    }, {
      key: "updateMatrixWorld",
      value: function updateMatrixWorld(t) {
        _get(_getPrototypeOf(La.prototype), "updateMatrixWorld", this).call(this, t), "attached" === this.bindMode ? this.bindMatrixInverse.copy(this.matrixWorld).invert() : "detached" === this.bindMode ? this.bindMatrixInverse.copy(this.bindMatrix).invert() : console.warn("THREE.SkinnedMesh: Unrecognized bindMode: " + this.bindMode);
      }
    }, {
      key: "boneTransform",
      value: function boneTransform(t, e) {
        var n = this.skeleton,
            i = this.geometry;
        Sa.fromBufferAttribute(i.attributes.skinIndex, t), Ta.fromBufferAttribute(i.attributes.skinWeight, t), wa.fromBufferAttribute(i.attributes.position, t).applyMatrix4(this.bindMatrix), e.set(0, 0, 0);

        for (var _t157 = 0; _t157 < 4; _t157++) {
          var _i106 = Ta.getComponent(_t157);

          if (0 !== _i106) {
            var _r89 = Sa.getComponent(_t157);

            Aa.multiplyMatrices(n.bones[_r89].matrixWorld, n.boneInverses[_r89]), e.addScaledVector(Ea.copy(wa).applyMatrix4(Aa), _i106);
          }
        }

        return e.applyMatrix4(this.bindMatrixInverse);
      }
    }]);

    return La;
  }(Gn);

  La.prototype.isSkinnedMesh = !0;

  var Ra = /*#__PURE__*/function (_Pe8) {
    _inherits(Ra, _Pe8);

    var _super43 = _createSuper(Ra);

    function Ra() {
      var _this32;

      _classCallCheck(this, Ra);

      _this32 = _super43.call(this), _this32.type = "Bone";
      return _this32;
    }

    return Ra;
  }(Pe);

  Ra.prototype.isBone = !0;

  var Ca = /*#__PURE__*/function (_bt4) {
    _inherits(Ca, _bt4);

    var _super44 = _createSuper(Ca);

    function Ca() {
      var _this33;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
      var i = arguments.length > 3 ? arguments[3] : undefined;
      var r = arguments.length > 4 ? arguments[4] : undefined;
      var s = arguments.length > 5 ? arguments[5] : undefined;
      var a = arguments.length > 6 ? arguments[6] : undefined;
      var o = arguments.length > 7 ? arguments[7] : undefined;
      var l = arguments.length > 8 && arguments[8] !== undefined ? arguments[8] : 1003;
      var c = arguments.length > 9 && arguments[9] !== undefined ? arguments[9] : 1003;
      var h = arguments.length > 10 ? arguments[10] : undefined;
      var u = arguments.length > 11 ? arguments[11] : undefined;

      _classCallCheck(this, Ca);

      _this33 = _super44.call(this, null, s, a, o, l, c, i, r, h, u), _this33.image = {
        data: t,
        width: e,
        height: n
      }, _this33.magFilter = l, _this33.minFilter = c, _this33.generateMipmaps = !1, _this33.flipY = !1, _this33.unpackAlignment = 1, _this33.needsUpdate = !0;
      return _this33;
    }

    return Ca;
  }(bt);

  Ca.prototype.isDataTexture = !0;
  var Pa = new ae(),
      Ia = new ae();

  var Da = /*#__PURE__*/function () {
    function Da() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];

      _classCallCheck(this, Da);

      this.uuid = ct(), this.bones = t.slice(0), this.boneInverses = e, this.boneMatrices = null, this.boneTexture = null, this.boneTextureSize = 0, this.frame = -1, this.init();
    }

    _createClass(Da, [{
      key: "init",
      value: function init() {
        var t = this.bones,
            e = this.boneInverses;
        if (this.boneMatrices = new Float32Array(16 * t.length), 0 === e.length) this.calculateInverses();else if (t.length !== e.length) {
          console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."), this.boneInverses = [];

          for (var _t158 = 0, _e123 = this.bones.length; _t158 < _e123; _t158++) {
            this.boneInverses.push(new ae());
          }
        }
      }
    }, {
      key: "calculateInverses",
      value: function calculateInverses() {
        this.boneInverses.length = 0;

        for (var _t159 = 0, _e124 = this.bones.length; _t159 < _e124; _t159++) {
          var _e125 = new ae();

          this.bones[_t159] && _e125.copy(this.bones[_t159].matrixWorld).invert(), this.boneInverses.push(_e125);
        }
      }
    }, {
      key: "pose",
      value: function pose() {
        for (var _t160 = 0, _e126 = this.bones.length; _t160 < _e126; _t160++) {
          var _e127 = this.bones[_t160];
          _e127 && _e127.matrixWorld.copy(this.boneInverses[_t160]).invert();
        }

        for (var _t161 = 0, _e128 = this.bones.length; _t161 < _e128; _t161++) {
          var _e129 = this.bones[_t161];
          _e129 && (_e129.parent && _e129.parent.isBone ? (_e129.matrix.copy(_e129.parent.matrixWorld).invert(), _e129.matrix.multiply(_e129.matrixWorld)) : _e129.matrix.copy(_e129.matrixWorld), _e129.matrix.decompose(_e129.position, _e129.quaternion, _e129.scale));
        }
      }
    }, {
      key: "update",
      value: function update() {
        var t = this.bones,
            e = this.boneInverses,
            n = this.boneMatrices,
            i = this.boneTexture;

        for (var _i107 = 0, _r90 = t.length; _i107 < _r90; _i107++) {
          var _r91 = t[_i107] ? t[_i107].matrixWorld : Ia;

          Pa.multiplyMatrices(_r91, e[_i107]), Pa.toArray(n, 16 * _i107);
        }

        null !== i && (i.needsUpdate = !0);
      }
    }, {
      key: "clone",
      value: function clone() {
        return new Da(this.bones, this.boneInverses);
      }
    }, {
      key: "computeBoneTexture",
      value: function computeBoneTexture() {
        var t = Math.sqrt(4 * this.bones.length);
        t = mt(t), t = Math.max(t, 4);
        var e = new Float32Array(t * t * 4);
        e.set(this.boneMatrices);
        var n = new Ca(e, t, t, E, b);
        return this.boneMatrices = e, this.boneTexture = n, this.boneTextureSize = t, this;
      }
    }, {
      key: "getBoneByName",
      value: function getBoneByName(t) {
        for (var _e130 = 0, _n118 = this.bones.length; _e130 < _n118; _e130++) {
          var _n119 = this.bones[_e130];
          if (_n119.name === t) return _n119;
        }
      }
    }, {
      key: "dispose",
      value: function dispose() {
        null !== this.boneTexture && (this.boneTexture.dispose(), this.boneTexture = null);
      }
    }, {
      key: "fromJSON",
      value: function fromJSON(t, e) {
        this.uuid = t.uuid;

        for (var _n120 = 0, _i108 = t.bones.length; _n120 < _i108; _n120++) {
          var _i109 = t.bones[_n120];
          var _r92 = e[_i109];
          void 0 === _r92 && (console.warn("THREE.Skeleton: No bone found with UUID:", _i109), _r92 = new Ra()), this.bones.push(_r92), this.boneInverses.push(new ae().fromArray(t.boneInverses[_n120]));
        }

        return this.init(), this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = {
          metadata: {
            version: 4.5,
            type: "Skeleton",
            generator: "Skeleton.toJSON"
          },
          bones: [],
          boneInverses: []
        };
        t.uuid = this.uuid;
        var e = this.bones,
            n = this.boneInverses;

        for (var _i110 = 0, _r93 = e.length; _i110 < _r93; _i110++) {
          var _r94 = e[_i110];
          t.bones.push(_r94.uuid);
          var _s42 = n[_i110];
          t.boneInverses.push(_s42.toArray());
        }

        return t;
      }
    }]);

    return Da;
  }();

  var Na = new ae(),
      Ba = new ae(),
      za = [],
      Fa = new Gn();

  var Oa = /*#__PURE__*/function (_Gn2) {
    _inherits(Oa, _Gn2);

    var _super45 = _createSuper(Oa);

    function Oa(t, e, n) {
      var _this34;

      _classCallCheck(this, Oa);

      _this34 = _super45.call(this, t, e), _this34.instanceMatrix = new en(new Float32Array(16 * n), 16), _this34.instanceColor = null, _this34.count = n, _this34.frustumCulled = !1;
      return _this34;
    }

    _createClass(Oa, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Oa.prototype), "copy", this).call(this, t), this.instanceMatrix.copy(t.instanceMatrix), null !== t.instanceColor && (this.instanceColor = t.instanceColor.clone()), this.count = t.count, this;
      }
    }, {
      key: "getColorAt",
      value: function getColorAt(t, e) {
        e.fromArray(this.instanceColor.array, 3 * t);
      }
    }, {
      key: "getMatrixAt",
      value: function getMatrixAt(t, e) {
        e.fromArray(this.instanceMatrix.array, 16 * t);
      }
    }, {
      key: "raycast",
      value: function raycast(t, e) {
        var n = this.matrixWorld,
            i = this.count;
        if (Fa.geometry = this.geometry, Fa.material = this.material, void 0 !== Fa.material) for (var _r95 = 0; _r95 < i; _r95++) {
          this.getMatrixAt(_r95, Na), Ba.multiplyMatrices(n, Na), Fa.matrixWorld = Ba, Fa.raycast(t, za);

          for (var _t162 = 0, _n121 = za.length; _t162 < _n121; _t162++) {
            var _n122 = za[_t162];
            _n122.instanceId = _r95, _n122.object = this, e.push(_n122);
          }

          za.length = 0;
        }
      }
    }, {
      key: "setColorAt",
      value: function setColorAt(t, e) {
        null === this.instanceColor && (this.instanceColor = new en(new Float32Array(3 * this.instanceMatrix.count), 3)), e.toArray(this.instanceColor.array, 3 * t);
      }
    }, {
      key: "setMatrixAt",
      value: function setMatrixAt(t, e) {
        e.toArray(this.instanceMatrix.array, 16 * t);
      }
    }, {
      key: "updateMorphTargets",
      value: function updateMorphTargets() {}
    }, {
      key: "dispose",
      value: function dispose() {
        this.dispatchEvent({
          type: "dispose"
        });
      }
    }]);

    return Oa;
  }(Gn);

  Oa.prototype.isInstancedMesh = !0;

  var Ua = /*#__PURE__*/function (_We6) {
    _inherits(Ua, _We6);

    var _super46 = _createSuper(Ua);

    function Ua(t) {
      var _this35;

      _classCallCheck(this, Ua);

      _this35 = _super46.call(this), _this35.type = "LineBasicMaterial", _this35.color = new Qe(16777215), _this35.linewidth = 1, _this35.linecap = "round", _this35.linejoin = "round", _this35.setValues(t);
      return _this35;
    }

    _createClass(Ua, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Ua.prototype), "copy", this).call(this, t), this.color.copy(t.color), this.linewidth = t.linewidth, this.linecap = t.linecap, this.linejoin = t.linejoin, this;
      }
    }]);

    return Ua;
  }(We);

  Ua.prototype.isLineBasicMaterial = !0;
  var Ha = new Rt(),
      Ga = new Rt(),
      ka = new ae(),
      Va = new se(),
      Wa = new Qt();

  var ja = /*#__PURE__*/function (_Pe9) {
    _inherits(ja, _Pe9);

    var _super47 = _createSuper(ja);

    function ja() {
      var _this36;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new wn();
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Ua();

      _classCallCheck(this, ja);

      _this36 = _super47.call(this), _this36.type = "Line", _this36.geometry = t, _this36.material = e, _this36.updateMorphTargets();
      return _this36;
    }

    _createClass(ja, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(ja.prototype), "copy", this).call(this, t), this.material = t.material, this.geometry = t.geometry, this;
      }
    }, {
      key: "computeLineDistances",
      value: function computeLineDistances() {
        var t = this.geometry;
        if (t.isBufferGeometry) {
          if (null === t.index) {
            var _e131 = t.attributes.position,
                _n123 = [0];

            for (var _t163 = 1, _i111 = _e131.count; _t163 < _i111; _t163++) {
              Ha.fromBufferAttribute(_e131, _t163 - 1), Ga.fromBufferAttribute(_e131, _t163), _n123[_t163] = _n123[_t163 - 1], _n123[_t163] += Ha.distanceTo(Ga);
            }

            t.setAttribute("lineDistance", new un(_n123, 1));
          } else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");
        } else t.isGeometry && console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");
        return this;
      }
    }, {
      key: "raycast",
      value: function raycast(t, e) {
        var n = this.geometry,
            i = this.matrixWorld,
            r = t.params.Line.threshold,
            s = n.drawRange;
        if (null === n.boundingSphere && n.computeBoundingSphere(), Wa.copy(n.boundingSphere), Wa.applyMatrix4(i), Wa.radius += r, !1 === t.ray.intersectsSphere(Wa)) return;
        ka.copy(i).invert(), Va.copy(t.ray).applyMatrix4(ka);
        var a = r / ((this.scale.x + this.scale.y + this.scale.z) / 3),
            o = a * a,
            l = new Rt(),
            c = new Rt(),
            h = new Rt(),
            u = new Rt(),
            d = this.isLineSegments ? 2 : 1;

        if (n.isBufferGeometry) {
          var _i112 = n.index,
              _r96 = n.attributes.position;

          if (null !== _i112) {
            for (var _n124 = Math.max(0, s.start), _a37 = Math.min(_i112.count, s.start + s.count) - 1; _n124 < _a37; _n124 += d) {
              var _s43 = _i112.getX(_n124),
                  _a38 = _i112.getX(_n124 + 1);

              l.fromBufferAttribute(_r96, _s43), c.fromBufferAttribute(_r96, _a38);
              if (Va.distanceSqToSegment(l, c, u, h) > o) continue;
              u.applyMatrix4(this.matrixWorld);

              var _d9 = t.ray.origin.distanceTo(u);

              _d9 < t.near || _d9 > t.far || e.push({
                distance: _d9,
                point: h.clone().applyMatrix4(this.matrixWorld),
                index: _n124,
                face: null,
                faceIndex: null,
                object: this
              });
            }
          } else {
            for (var _n125 = Math.max(0, s.start), _i113 = Math.min(_r96.count, s.start + s.count) - 1; _n125 < _i113; _n125 += d) {
              l.fromBufferAttribute(_r96, _n125), c.fromBufferAttribute(_r96, _n125 + 1);
              if (Va.distanceSqToSegment(l, c, u, h) > o) continue;
              u.applyMatrix4(this.matrixWorld);

              var _i114 = t.ray.origin.distanceTo(u);

              _i114 < t.near || _i114 > t.far || e.push({
                distance: _i114,
                point: h.clone().applyMatrix4(this.matrixWorld),
                index: _n125,
                face: null,
                faceIndex: null,
                object: this
              });
            }
          }
        } else n.isGeometry && console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");
      }
    }, {
      key: "updateMorphTargets",
      value: function updateMorphTargets() {
        var t = this.geometry;

        if (t.isBufferGeometry) {
          var _e132 = t.morphAttributes,
              _n126 = Object.keys(_e132);

          if (_n126.length > 0) {
            var _t164 = _e132[_n126[0]];

            if (void 0 !== _t164) {
              this.morphTargetInfluences = [], this.morphTargetDictionary = {};

              for (var _e133 = 0, _n127 = _t164.length; _e133 < _n127; _e133++) {
                var _n128 = _t164[_e133].name || String(_e133);

                this.morphTargetInfluences.push(0), this.morphTargetDictionary[_n128] = _e133;
              }
            }
          }
        } else {
          var _e134 = t.morphTargets;
          void 0 !== _e134 && _e134.length > 0 && console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.");
        }
      }
    }]);

    return ja;
  }(Pe);

  ja.prototype.isLine = !0;
  var qa = new Rt(),
      Xa = new Rt();

  var Ya = /*#__PURE__*/function (_ja) {
    _inherits(Ya, _ja);

    var _super48 = _createSuper(Ya);

    function Ya(t, e) {
      var _this37;

      _classCallCheck(this, Ya);

      _this37 = _super48.call(this, t, e), _this37.type = "LineSegments";
      return _this37;
    }

    _createClass(Ya, [{
      key: "computeLineDistances",
      value: function computeLineDistances() {
        var t = this.geometry;
        if (t.isBufferGeometry) {
          if (null === t.index) {
            var _e135 = t.attributes.position,
                _n129 = [];

            for (var _t165 = 0, _i115 = _e135.count; _t165 < _i115; _t165 += 2) {
              qa.fromBufferAttribute(_e135, _t165), Xa.fromBufferAttribute(_e135, _t165 + 1), _n129[_t165] = 0 === _t165 ? 0 : _n129[_t165 - 1], _n129[_t165 + 1] = _n129[_t165] + qa.distanceTo(Xa);
            }

            t.setAttribute("lineDistance", new un(_n129, 1));
          } else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");
        } else t.isGeometry && console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");
        return this;
      }
    }]);

    return Ya;
  }(ja);

  Ya.prototype.isLineSegments = !0;

  var Ja = /*#__PURE__*/function (_ja2) {
    _inherits(Ja, _ja2);

    var _super49 = _createSuper(Ja);

    function Ja(t, e) {
      var _this38;

      _classCallCheck(this, Ja);

      _this38 = _super49.call(this, t, e), _this38.type = "LineLoop";
      return _this38;
    }

    return Ja;
  }(ja);

  Ja.prototype.isLineLoop = !0;

  var Za = /*#__PURE__*/function (_We7) {
    _inherits(Za, _We7);

    var _super50 = _createSuper(Za);

    function Za(t) {
      var _this39;

      _classCallCheck(this, Za);

      _this39 = _super50.call(this), _this39.type = "PointsMaterial", _this39.color = new Qe(16777215), _this39.map = null, _this39.alphaMap = null, _this39.size = 1, _this39.sizeAttenuation = !0, _this39.setValues(t);
      return _this39;
    }

    _createClass(Za, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Za.prototype), "copy", this).call(this, t), this.color.copy(t.color), this.map = t.map, this.alphaMap = t.alphaMap, this.size = t.size, this.sizeAttenuation = t.sizeAttenuation, this;
      }
    }]);

    return Za;
  }(We);

  Za.prototype.isPointsMaterial = !0;
  var Qa = new ae(),
      Ka = new se(),
      $a = new Qt(),
      to = new Rt();

  var eo = /*#__PURE__*/function (_Pe10) {
    _inherits(eo, _Pe10);

    var _super51 = _createSuper(eo);

    function eo() {
      var _this40;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new wn();
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Za();

      _classCallCheck(this, eo);

      _this40 = _super51.call(this), _this40.type = "Points", _this40.geometry = t, _this40.material = e, _this40.updateMorphTargets();
      return _this40;
    }

    _createClass(eo, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(eo.prototype), "copy", this).call(this, t), this.material = t.material, this.geometry = t.geometry, this;
      }
    }, {
      key: "raycast",
      value: function raycast(t, e) {
        var n = this.geometry,
            i = this.matrixWorld,
            r = t.params.Points.threshold,
            s = n.drawRange;
        if (null === n.boundingSphere && n.computeBoundingSphere(), $a.copy(n.boundingSphere), $a.applyMatrix4(i), $a.radius += r, !1 === t.ray.intersectsSphere($a)) return;
        Qa.copy(i).invert(), Ka.copy(t.ray).applyMatrix4(Qa);
        var a = r / ((this.scale.x + this.scale.y + this.scale.z) / 3),
            o = a * a;

        if (n.isBufferGeometry) {
          var _r97 = n.index,
              _a39 = n.attributes.position;

          if (null !== _r97) {
            for (var _n130 = Math.max(0, s.start), _l19 = Math.min(_r97.count, s.start + s.count); _n130 < _l19; _n130++) {
              var _s44 = _r97.getX(_n130);

              to.fromBufferAttribute(_a39, _s44), no(to, _s44, o, i, t, e, this);
            }
          } else {
            for (var _n131 = Math.max(0, s.start), _r98 = Math.min(_a39.count, s.start + s.count); _n131 < _r98; _n131++) {
              to.fromBufferAttribute(_a39, _n131), no(to, _n131, o, i, t, e, this);
            }
          }
        } else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");
      }
    }, {
      key: "updateMorphTargets",
      value: function updateMorphTargets() {
        var t = this.geometry;

        if (t.isBufferGeometry) {
          var _e136 = t.morphAttributes,
              _n132 = Object.keys(_e136);

          if (_n132.length > 0) {
            var _t166 = _e136[_n132[0]];

            if (void 0 !== _t166) {
              this.morphTargetInfluences = [], this.morphTargetDictionary = {};

              for (var _e137 = 0, _n133 = _t166.length; _e137 < _n133; _e137++) {
                var _n134 = _t166[_e137].name || String(_e137);

                this.morphTargetInfluences.push(0), this.morphTargetDictionary[_n134] = _e137;
              }
            }
          }
        } else {
          var _e138 = t.morphTargets;
          void 0 !== _e138 && _e138.length > 0 && console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.");
        }
      }
    }]);

    return eo;
  }(Pe);

  function no(t, e, n, i, r, s, a) {
    var o = Ka.distanceSqToPoint(t);

    if (o < n) {
      var _n135 = new Rt();

      Ka.closestPointToPoint(t, _n135), _n135.applyMatrix4(i);

      var _l20 = r.ray.origin.distanceTo(_n135);

      if (_l20 < r.near || _l20 > r.far) return;
      s.push({
        distance: _l20,
        distanceToRay: Math.sqrt(o),
        point: _n135,
        index: e,
        face: null,
        object: a
      });
    }
  }

  eo.prototype.isPoints = !0;

  var io = /*#__PURE__*/function (_bt5) {
    _inherits(io, _bt5);

    var _super52 = _createSuper(io);

    function io(t, e, n, i, r, s, a, o, l) {
      var _this41;

      _classCallCheck(this, io);

      _this41 = _super52.call(this, t, e, n, i, r, s, a, o, l), _this41.format = void 0 !== a ? a : T, _this41.minFilter = void 0 !== s ? s : g, _this41.magFilter = void 0 !== r ? r : g, _this41.generateMipmaps = !1;

      var c = _assertThisInitialized(_this41);

      "requestVideoFrameCallback" in t && t.requestVideoFrameCallback(function e() {
        c.needsUpdate = !0, t.requestVideoFrameCallback(e);
      });
      return _this41;
    }

    _createClass(io, [{
      key: "clone",
      value: function clone() {
        return new this.constructor(this.image).copy(this);
      }
    }, {
      key: "update",
      value: function update() {
        var t = this.image;
        !1 === "requestVideoFrameCallback" in t && t.readyState >= t.HAVE_CURRENT_DATA && (this.needsUpdate = !0);
      }
    }]);

    return io;
  }(bt);

  io.prototype.isVideoTexture = !0;

  var ro = /*#__PURE__*/function (_bt6) {
    _inherits(ro, _bt6);

    var _super53 = _createSuper(ro);

    function ro(t, e, n, i, r, s, a, o, l, c, h, u) {
      var _this42;

      _classCallCheck(this, ro);

      _this42 = _super53.call(this, null, s, a, o, l, c, i, r, h, u), _this42.image = {
        width: e,
        height: n
      }, _this42.mipmaps = t, _this42.flipY = !1, _this42.generateMipmaps = !1;
      return _this42;
    }

    return ro;
  }(bt);

  ro.prototype.isCompressedTexture = !0;

  var so = /*#__PURE__*/function (_bt7) {
    _inherits(so, _bt7);

    var _super54 = _createSuper(so);

    function so(t, e, n, i, r, s, a, o, l) {
      var _this43;

      _classCallCheck(this, so);

      _this43 = _super54.call(this, t, e, n, i, r, s, a, o, l), _this43.needsUpdate = !0;
      return _this43;
    }

    return so;
  }(bt);

  so.prototype.isCanvasTexture = !0;

  var ao = /*#__PURE__*/function (_bt8) {
    _inherits(ao, _bt8);

    var _super55 = _createSuper(ao);

    function ao(t, e, n, i, r, s, a, o, l, c) {
      var _this44;

      _classCallCheck(this, ao);

      if ((c = void 0 !== c ? c : A) !== A && c !== L) throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");
      void 0 === n && c === A && (n = _), void 0 === n && c === L && (n = S), _this44 = _super55.call(this, null, i, r, s, a, o, c, n, l), _this44.image = {
        width: t,
        height: e
      }, _this44.magFilter = void 0 !== a ? a : p, _this44.minFilter = void 0 !== o ? o : p, _this44.flipY = !1, _this44.generateMipmaps = !1;
      return _this44;
    }

    return ao;
  }(bt);

  ao.prototype.isDepthTexture = !0;

  var oo = /*#__PURE__*/function (_wn3) {
    _inherits(oo, _wn3);

    var _super56 = _createSuper(oo);

    function oo() {
      var _this45;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 8;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 2 * Math.PI;

      _classCallCheck(this, oo);

      _this45 = _super56.call(this), _this45.type = "CircleGeometry", _this45.parameters = {
        radius: t,
        segments: e,
        thetaStart: n,
        thetaLength: i
      }, e = Math.max(3, e);
      var r = [],
          s = [],
          a = [],
          o = [],
          l = new Rt(),
          c = new vt();
      s.push(0, 0, 0), a.push(0, 0, 1), o.push(.5, .5);

      for (var _r99 = 0, _h10 = 3; _r99 <= e; _r99++, _h10 += 3) {
        var _u11 = n + _r99 / e * i;

        l.x = t * Math.cos(_u11), l.y = t * Math.sin(_u11), s.push(l.x, l.y, l.z), a.push(0, 0, 1), c.x = (s[_h10] / t + 1) / 2, c.y = (s[_h10 + 1] / t + 1) / 2, o.push(c.x, c.y);
      }

      for (var _t167 = 1; _t167 <= e; _t167++) {
        r.push(_t167, _t167 + 1, 0);
      }

      _this45.setIndex(r), _this45.setAttribute("position", new un(s, 3)), _this45.setAttribute("normal", new un(a, 3)), _this45.setAttribute("uv", new un(o, 2));
      return _this45;
    }

    _createClass(oo, null, [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new oo(t.radius, t.segments, t.thetaStart, t.thetaLength);
      }
    }]);

    return oo;
  }(wn);

  var lo = /*#__PURE__*/function (_wn4) {
    _inherits(lo, _wn4);

    var _super57 = _createSuper(lo);

    function lo() {
      var _this46;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 8;
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1;
      var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : !1;
      var a = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 0;
      var o = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : 2 * Math.PI;

      _classCallCheck(this, lo);

      _this46 = _super57.call(this), _this46.type = "CylinderGeometry", _this46.parameters = {
        radiusTop: t,
        radiusBottom: e,
        height: n,
        radialSegments: i,
        heightSegments: r,
        openEnded: s,
        thetaStart: a,
        thetaLength: o
      };

      var l = _assertThisInitialized(_this46);

      i = Math.floor(i), r = Math.floor(r);
      var c = [],
          h = [],
          u = [],
          d = [];
      var p = 0;
      var m = [],
          f = n / 2;
      var g = 0;

      function v(n) {
        var r = p,
            s = new vt(),
            m = new Rt();
        var v = 0;
        var y = !0 === n ? t : e,
            x = !0 === n ? 1 : -1;

        for (var _t168 = 1; _t168 <= i; _t168++) {
          h.push(0, f * x, 0), u.push(0, x, 0), d.push(.5, .5), p++;
        }

        var _ = p;

        for (var _t169 = 0; _t169 <= i; _t169++) {
          var _e139 = _t169 / i * o + a,
              _n136 = Math.cos(_e139),
              _r100 = Math.sin(_e139);

          m.x = y * _r100, m.y = f * x, m.z = y * _n136, h.push(m.x, m.y, m.z), u.push(0, x, 0), s.x = .5 * _n136 + .5, s.y = .5 * _r100 * x + .5, d.push(s.x, s.y), p++;
        }

        for (var _t170 = 0; _t170 < i; _t170++) {
          var _e140 = r + _t170,
              _i116 = _ + _t170;

          !0 === n ? c.push(_i116, _i116 + 1, _e140) : c.push(_i116 + 1, _i116, _e140), v += 3;
        }

        l.addGroup(g, v, !0 === n ? 1 : 2), g += v;
      }

      !function () {
        var s = new Rt(),
            v = new Rt();
        var y = 0;
        var x = (e - t) / n;

        for (var _l21 = 0; _l21 <= r; _l21++) {
          var _c19 = [],
              _g2 = _l21 / r,
              _y4 = _g2 * (e - t) + t;

          for (var _t171 = 0; _t171 <= i; _t171++) {
            var _e141 = _t171 / i,
                _r101 = _e141 * o + a,
                _l22 = Math.sin(_r101),
                _m5 = Math.cos(_r101);

            v.x = _y4 * _l22, v.y = -_g2 * n + f, v.z = _y4 * _m5, h.push(v.x, v.y, v.z), s.set(_l22, x, _m5).normalize(), u.push(s.x, s.y, s.z), d.push(_e141, 1 - _g2), _c19.push(p++);
          }

          m.push(_c19);
        }

        for (var _t172 = 0; _t172 < i; _t172++) {
          for (var _e142 = 0; _e142 < r; _e142++) {
            var _n137 = m[_e142][_t172],
                _i117 = m[_e142 + 1][_t172],
                _r102 = m[_e142 + 1][_t172 + 1],
                _s45 = m[_e142][_t172 + 1];
            c.push(_n137, _i117, _s45), c.push(_i117, _r102, _s45), y += 6;
          }
        }

        l.addGroup(g, y, 0), g += y;
      }(), !1 === s && (t > 0 && v(!0), e > 0 && v(!1)), _this46.setIndex(c), _this46.setAttribute("position", new un(h, 3)), _this46.setAttribute("normal", new un(u, 3)), _this46.setAttribute("uv", new un(d, 2));
      return _this46;
    }

    _createClass(lo, null, [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new lo(t.radiusTop, t.radiusBottom, t.height, t.radialSegments, t.heightSegments, t.openEnded, t.thetaStart, t.thetaLength);
      }
    }]);

    return lo;
  }(wn);

  var co = /*#__PURE__*/function (_lo) {
    _inherits(co, _lo);

    var _super58 = _createSuper(co);

    function co() {
      var _this47;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 8;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : !1;
      var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;
      var a = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : 2 * Math.PI;

      _classCallCheck(this, co);

      _this47 = _super58.call(this, 0, t, e, n, i, r, s, a), _this47.type = "ConeGeometry", _this47.parameters = {
        radius: t,
        height: e,
        radialSegments: n,
        heightSegments: i,
        openEnded: r,
        thetaStart: s,
        thetaLength: a
      };
      return _this47;
    }

    _createClass(co, null, [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new co(t.radius, t.height, t.radialSegments, t.heightSegments, t.openEnded, t.thetaStart, t.thetaLength);
      }
    }]);

    return co;
  }(lo);

  var ho = /*#__PURE__*/function (_wn5) {
    _inherits(ho, _wn5);

    var _super59 = _createSuper(ho);

    function ho(t, e) {
      var _this48;

      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;

      _classCallCheck(this, ho);

      _this48 = _super59.call(this), _this48.type = "PolyhedronGeometry", _this48.parameters = {
        vertices: t,
        indices: e,
        radius: n,
        detail: i
      };
      var r = [],
          s = [];

      function a(t, e, n, i) {
        var r = i + 1,
            s = [];

        for (var _i118 = 0; _i118 <= r; _i118++) {
          s[_i118] = [];

          var _a40 = t.clone().lerp(n, _i118 / r),
              _o23 = e.clone().lerp(n, _i118 / r),
              _l23 = r - _i118;

          for (var _t173 = 0; _t173 <= _l23; _t173++) {
            s[_i118][_t173] = 0 === _t173 && _i118 === r ? _a40 : _a40.clone().lerp(_o23, _t173 / _l23);
          }
        }

        for (var _t174 = 0; _t174 < r; _t174++) {
          for (var _e143 = 0; _e143 < 2 * (r - _t174) - 1; _e143++) {
            var _n138 = Math.floor(_e143 / 2);

            _e143 % 2 == 0 ? (o(s[_t174][_n138 + 1]), o(s[_t174 + 1][_n138]), o(s[_t174][_n138])) : (o(s[_t174][_n138 + 1]), o(s[_t174 + 1][_n138 + 1]), o(s[_t174 + 1][_n138]));
          }
        }
      }

      function o(t) {
        r.push(t.x, t.y, t.z);
      }

      function l(e, n) {
        var i = 3 * e;
        n.x = t[i + 0], n.y = t[i + 1], n.z = t[i + 2];
      }

      function c(t, e, n, i) {
        i < 0 && 1 === t.x && (s[e] = t.x - 1), 0 === n.x && 0 === n.z && (s[e] = i / 2 / Math.PI + .5);
      }

      function h(t) {
        return Math.atan2(t.z, -t.x);
      }

      !function (t) {
        var n = new Rt(),
            i = new Rt(),
            r = new Rt();

        for (var _s46 = 0; _s46 < e.length; _s46 += 3) {
          l(e[_s46 + 0], n), l(e[_s46 + 1], i), l(e[_s46 + 2], r), a(n, i, r, t);
        }
      }(i), function (t) {
        var e = new Rt();

        for (var _n139 = 0; _n139 < r.length; _n139 += 3) {
          e.x = r[_n139 + 0], e.y = r[_n139 + 1], e.z = r[_n139 + 2], e.normalize().multiplyScalar(t), r[_n139 + 0] = e.x, r[_n139 + 1] = e.y, r[_n139 + 2] = e.z;
        }
      }(n), function () {
        var t = new Rt();

        for (var _n140 = 0; _n140 < r.length; _n140 += 3) {
          t.x = r[_n140 + 0], t.y = r[_n140 + 1], t.z = r[_n140 + 2];

          var _i119 = h(t) / 2 / Math.PI + .5,
              _a41 = (e = t, Math.atan2(-e.y, Math.sqrt(e.x * e.x + e.z * e.z)) / Math.PI + .5);

          s.push(_i119, 1 - _a41);
        }

        var e;
        (function () {
          var t = new Rt(),
              e = new Rt(),
              n = new Rt(),
              i = new Rt(),
              a = new vt(),
              o = new vt(),
              l = new vt();

          for (var _u12 = 0, _d10 = 0; _u12 < r.length; _u12 += 9, _d10 += 6) {
            t.set(r[_u12 + 0], r[_u12 + 1], r[_u12 + 2]), e.set(r[_u12 + 3], r[_u12 + 4], r[_u12 + 5]), n.set(r[_u12 + 6], r[_u12 + 7], r[_u12 + 8]), a.set(s[_d10 + 0], s[_d10 + 1]), o.set(s[_d10 + 2], s[_d10 + 3]), l.set(s[_d10 + 4], s[_d10 + 5]), i.copy(t).add(e).add(n).divideScalar(3);

            var _p7 = h(i);

            c(a, _d10 + 0, t, _p7), c(o, _d10 + 2, e, _p7), c(l, _d10 + 4, n, _p7);
          }
        })(), function () {
          for (var _t175 = 0; _t175 < s.length; _t175 += 6) {
            var _e144 = s[_t175 + 0],
                _n141 = s[_t175 + 2],
                _i120 = s[_t175 + 4],
                _r103 = Math.max(_e144, _n141, _i120),
                _a42 = Math.min(_e144, _n141, _i120);

            _r103 > .9 && _a42 < .1 && (_e144 < .2 && (s[_t175 + 0] += 1), _n141 < .2 && (s[_t175 + 2] += 1), _i120 < .2 && (s[_t175 + 4] += 1));
          }
        }();
      }(), _this48.setAttribute("position", new un(r, 3)), _this48.setAttribute("normal", new un(r.slice(), 3)), _this48.setAttribute("uv", new un(s, 2)), 0 === i ? _this48.computeVertexNormals() : _this48.normalizeNormals();
      return _this48;
    }

    _createClass(ho, null, [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new ho(t.vertices, t.indices, t.radius, t.details);
      }
    }]);

    return ho;
  }(wn);

  var uo = /*#__PURE__*/function (_ho) {
    _inherits(uo, _ho);

    var _super60 = _createSuper(uo);

    function uo() {
      var _this49;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;

      _classCallCheck(this, uo);

      var n = (1 + Math.sqrt(5)) / 2,
          i = 1 / n;
      _this49 = _super60.call(this, [-1, -1, -1, -1, -1, 1, -1, 1, -1, -1, 1, 1, 1, -1, -1, 1, -1, 1, 1, 1, -1, 1, 1, 1, 0, -i, -n, 0, -i, n, 0, i, -n, 0, i, n, -i, -n, 0, -i, n, 0, i, -n, 0, i, n, 0, -n, 0, -i, n, 0, -i, -n, 0, i, n, 0, i], [3, 11, 7, 3, 7, 15, 3, 15, 13, 7, 19, 17, 7, 17, 6, 7, 6, 15, 17, 4, 8, 17, 8, 10, 17, 10, 6, 8, 0, 16, 8, 16, 2, 8, 2, 10, 0, 12, 1, 0, 1, 18, 0, 18, 16, 6, 10, 2, 6, 2, 13, 6, 13, 15, 2, 16, 18, 2, 18, 3, 2, 3, 13, 18, 1, 9, 18, 9, 11, 18, 11, 3, 4, 14, 12, 4, 12, 0, 4, 0, 8, 11, 9, 5, 11, 5, 19, 11, 19, 7, 19, 5, 14, 19, 14, 4, 19, 4, 17, 1, 12, 14, 1, 14, 5, 1, 5, 9], t, e), _this49.type = "DodecahedronGeometry", _this49.parameters = {
        radius: t,
        detail: e
      };
      return _this49;
    }

    _createClass(uo, null, [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new uo(t.radius, t.detail);
      }
    }]);

    return uo;
  }(ho);

  var po = new Rt(),
      mo = new Rt(),
      fo = new Rt(),
      go = new ke();

  var vo = /*#__PURE__*/function (_wn6) {
    _inherits(vo, _wn6);

    var _super61 = _createSuper(vo);

    function vo(t, e) {
      var _this50;

      _classCallCheck(this, vo);

      if (_this50 = _super61.call(this), _this50.type = "EdgesGeometry", _this50.parameters = {
        thresholdAngle: e
      }, e = void 0 !== e ? e : 1, !0 === t.isGeometry) return _possibleConstructorReturn(_this50, void console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."));
      var n = Math.cos(ot * e),
          i = t.getIndex(),
          r = t.getAttribute("position"),
          s = i ? i.count : r.count,
          a = [0, 0, 0],
          o = ["a", "b", "c"],
          l = new Array(3),
          c = {},
          h = [];

      for (var _t176 = 0; _t176 < s; _t176 += 3) {
        i ? (a[0] = i.getX(_t176), a[1] = i.getX(_t176 + 1), a[2] = i.getX(_t176 + 2)) : (a[0] = _t176, a[1] = _t176 + 1, a[2] = _t176 + 2);
        var _e145 = go.a,
            _s47 = go.b,
            _u13 = go.c;
        if (_e145.fromBufferAttribute(r, a[0]), _s47.fromBufferAttribute(r, a[1]), _u13.fromBufferAttribute(r, a[2]), go.getNormal(fo), l[0] = "".concat(_e145.x, ",").concat(_e145.y, ",").concat(_e145.z), l[1] = "".concat(_s47.x, ",").concat(_s47.y, ",").concat(_s47.z), l[2] = "".concat(_u13.x, ",").concat(_u13.y, ",").concat(_u13.z), l[0] !== l[1] && l[1] !== l[2] && l[2] !== l[0]) for (var _t177 = 0; _t177 < 3; _t177++) {
          var _e146 = (_t177 + 1) % 3,
              _i121 = l[_t177],
              _r104 = l[_e146],
              _s48 = go[o[_t177]],
              _u14 = go[o[_e146]],
              _d11 = "".concat(_i121, "_").concat(_r104),
              _p8 = "".concat(_r104, "_").concat(_i121);

          _p8 in c && c[_p8] ? (fo.dot(c[_p8].normal) <= n && (h.push(_s48.x, _s48.y, _s48.z), h.push(_u14.x, _u14.y, _u14.z)), c[_p8] = null) : _d11 in c || (c[_d11] = {
            index0: a[_t177],
            index1: a[_e146],
            normal: fo.clone()
          });
        }
      }

      for (var _t178 in c) {
        if (c[_t178]) {
          var _c$_t = c[_t178],
              _e147 = _c$_t.index0,
              _n142 = _c$_t.index1;
          po.fromBufferAttribute(r, _e147), mo.fromBufferAttribute(r, _n142), h.push(po.x, po.y, po.z), h.push(mo.x, mo.y, mo.z);
        }
      }

      _this50.setAttribute("position", new un(h, 3));

      return _possibleConstructorReturn(_this50);
    }

    return vo;
  }(wn);

  var yo = /*#__PURE__*/function () {
    function yo() {
      _classCallCheck(this, yo);

      this.type = "Curve", this.arcLengthDivisions = 200;
    }

    _createClass(yo, [{
      key: "getPoint",
      value: function getPoint() {
        return console.warn("THREE.Curve: .getPoint() not implemented."), null;
      }
    }, {
      key: "getPointAt",
      value: function getPointAt(t, e) {
        var n = this.getUtoTmapping(t);
        return this.getPoint(n, e);
      }
    }, {
      key: "getPoints",
      value: function getPoints() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 5;
        var e = [];

        for (var _n143 = 0; _n143 <= t; _n143++) {
          e.push(this.getPoint(_n143 / t));
        }

        return e;
      }
    }, {
      key: "getSpacedPoints",
      value: function getSpacedPoints() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 5;
        var e = [];

        for (var _n144 = 0; _n144 <= t; _n144++) {
          e.push(this.getPointAt(_n144 / t));
        }

        return e;
      }
    }, {
      key: "getLength",
      value: function getLength() {
        var t = this.getLengths();
        return t[t.length - 1];
      }
    }, {
      key: "getLengths",
      value: function getLengths() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this.arcLengthDivisions;
        if (this.cacheArcLengths && this.cacheArcLengths.length === t + 1 && !this.needsUpdate) return this.cacheArcLengths;
        this.needsUpdate = !1;
        var e = [];
        var n,
            i = this.getPoint(0),
            r = 0;
        e.push(0);

        for (var _s49 = 1; _s49 <= t; _s49++) {
          n = this.getPoint(_s49 / t), r += n.distanceTo(i), e.push(r), i = n;
        }

        return this.cacheArcLengths = e, e;
      }
    }, {
      key: "updateArcLengths",
      value: function updateArcLengths() {
        this.needsUpdate = !0, this.getLengths();
      }
    }, {
      key: "getUtoTmapping",
      value: function getUtoTmapping(t, e) {
        var n = this.getLengths();
        var i = 0;
        var r = n.length;
        var s;
        s = e || t * n[r - 1];
        var a,
            o = 0,
            l = r - 1;

        for (; o <= l;) {
          if (i = Math.floor(o + (l - o) / 2), a = n[i] - s, a < 0) o = i + 1;else {
            if (!(a > 0)) {
              l = i;
              break;
            }

            l = i - 1;
          }
        }

        if (i = l, n[i] === s) return i / (r - 1);
        var c = n[i];
        return (i + (s - c) / (n[i + 1] - c)) / (r - 1);
      }
    }, {
      key: "getTangent",
      value: function getTangent(t, e) {
        var n = 1e-4;
        var i = t - n,
            r = t + n;
        i < 0 && (i = 0), r > 1 && (r = 1);
        var s = this.getPoint(i),
            a = this.getPoint(r),
            o = e || (s.isVector2 ? new vt() : new Rt());
        return o.copy(a).sub(s).normalize(), o;
      }
    }, {
      key: "getTangentAt",
      value: function getTangentAt(t, e) {
        var n = this.getUtoTmapping(t);
        return this.getTangent(n, e);
      }
    }, {
      key: "computeFrenetFrames",
      value: function computeFrenetFrames(t, e) {
        var n = new Rt(),
            i = [],
            r = [],
            s = [],
            a = new Rt(),
            o = new ae();

        for (var _e148 = 0; _e148 <= t; _e148++) {
          var _n145 = _e148 / t;

          i[_e148] = this.getTangentAt(_n145, new Rt()), i[_e148].normalize();
        }

        r[0] = new Rt(), s[0] = new Rt();
        var l = Number.MAX_VALUE;
        var c = Math.abs(i[0].x),
            h = Math.abs(i[0].y),
            u = Math.abs(i[0].z);
        c <= l && (l = c, n.set(1, 0, 0)), h <= l && (l = h, n.set(0, 1, 0)), u <= l && n.set(0, 0, 1), a.crossVectors(i[0], n).normalize(), r[0].crossVectors(i[0], a), s[0].crossVectors(i[0], r[0]);

        for (var _e149 = 1; _e149 <= t; _e149++) {
          if (r[_e149] = r[_e149 - 1].clone(), s[_e149] = s[_e149 - 1].clone(), a.crossVectors(i[_e149 - 1], i[_e149]), a.length() > Number.EPSILON) {
            a.normalize();

            var _t179 = Math.acos(ht(i[_e149 - 1].dot(i[_e149]), -1, 1));

            r[_e149].applyMatrix4(o.makeRotationAxis(a, _t179));
          }

          s[_e149].crossVectors(i[_e149], r[_e149]);
        }

        if (!0 === e) {
          var _e150 = Math.acos(ht(r[0].dot(r[t]), -1, 1));

          _e150 /= t, i[0].dot(a.crossVectors(r[0], r[t])) > 0 && (_e150 = -_e150);

          for (var _n146 = 1; _n146 <= t; _n146++) {
            r[_n146].applyMatrix4(o.makeRotationAxis(i[_n146], _e150 * _n146)), s[_n146].crossVectors(i[_n146], r[_n146]);
          }
        }

        return {
          tangents: i,
          normals: r,
          binormals: s
        };
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.arcLengthDivisions = t.arcLengthDivisions, this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = {
          metadata: {
            version: 4.5,
            type: "Curve",
            generator: "Curve.toJSON"
          }
        };
        return t.arcLengthDivisions = this.arcLengthDivisions, t.type = this.type, t;
      }
    }, {
      key: "fromJSON",
      value: function fromJSON(t) {
        return this.arcLengthDivisions = t.arcLengthDivisions, this;
      }
    }]);

    return yo;
  }();

  var xo = /*#__PURE__*/function (_yo) {
    _inherits(xo, _yo);

    var _super62 = _createSuper(xo);

    function xo() {
      var _this51;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;
      var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 2 * Math.PI;
      var a = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : !1;
      var o = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : 0;

      _classCallCheck(this, xo);

      _this51 = _super62.call(this), _this51.type = "EllipseCurve", _this51.aX = t, _this51.aY = e, _this51.xRadius = n, _this51.yRadius = i, _this51.aStartAngle = r, _this51.aEndAngle = s, _this51.aClockwise = a, _this51.aRotation = o;
      return _this51;
    }

    _createClass(xo, [{
      key: "getPoint",
      value: function getPoint(t, e) {
        var n = e || new vt(),
            i = 2 * Math.PI;
        var r = this.aEndAngle - this.aStartAngle;
        var s = Math.abs(r) < Number.EPSILON;

        for (; r < 0;) {
          r += i;
        }

        for (; r > i;) {
          r -= i;
        }

        r < Number.EPSILON && (r = s ? 0 : i), !0 !== this.aClockwise || s || (r === i ? r = -i : r -= i);
        var a = this.aStartAngle + t * r;
        var o = this.aX + this.xRadius * Math.cos(a),
            l = this.aY + this.yRadius * Math.sin(a);

        if (0 !== this.aRotation) {
          var _t180 = Math.cos(this.aRotation),
              _e151 = Math.sin(this.aRotation),
              _n147 = o - this.aX,
              _i122 = l - this.aY;

          o = _n147 * _t180 - _i122 * _e151 + this.aX, l = _n147 * _e151 + _i122 * _t180 + this.aY;
        }

        return n.set(o, l);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(xo.prototype), "copy", this).call(this, t), this.aX = t.aX, this.aY = t.aY, this.xRadius = t.xRadius, this.yRadius = t.yRadius, this.aStartAngle = t.aStartAngle, this.aEndAngle = t.aEndAngle, this.aClockwise = t.aClockwise, this.aRotation = t.aRotation, this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(xo.prototype), "toJSON", this).call(this);

        return t.aX = this.aX, t.aY = this.aY, t.xRadius = this.xRadius, t.yRadius = this.yRadius, t.aStartAngle = this.aStartAngle, t.aEndAngle = this.aEndAngle, t.aClockwise = this.aClockwise, t.aRotation = this.aRotation, t;
      }
    }, {
      key: "fromJSON",
      value: function fromJSON(t) {
        return _get(_getPrototypeOf(xo.prototype), "fromJSON", this).call(this, t), this.aX = t.aX, this.aY = t.aY, this.xRadius = t.xRadius, this.yRadius = t.yRadius, this.aStartAngle = t.aStartAngle, this.aEndAngle = t.aEndAngle, this.aClockwise = t.aClockwise, this.aRotation = t.aRotation, this;
      }
    }]);

    return xo;
  }(yo);

  xo.prototype.isEllipseCurve = !0;

  var _o = /*#__PURE__*/function (_xo) {
    _inherits(_o, _xo);

    var _super63 = _createSuper(_o);

    function _o(t, e, n, i, r, s) {
      var _this52;

      _classCallCheck(this, _o);

      _this52 = _super63.call(this, t, e, n, n, i, r, s), _this52.type = "ArcCurve";
      return _this52;
    }

    return _o;
  }(xo);

  function Mo() {
    var t = 0,
        e = 0,
        n = 0,
        i = 0;

    function r(r, s, a, o) {
      t = r, e = a, n = -3 * r + 3 * s - 2 * a - o, i = 2 * r - 2 * s + a + o;
    }

    return {
      initCatmullRom: function initCatmullRom(t, e, n, i, s) {
        r(e, n, s * (n - t), s * (i - e));
      },
      initNonuniformCatmullRom: function initNonuniformCatmullRom(t, e, n, i, s, a, o) {
        var l = (e - t) / s - (n - t) / (s + a) + (n - e) / a,
            c = (n - e) / a - (i - e) / (a + o) + (i - n) / o;
        l *= a, c *= a, r(e, n, l, c);
      },
      calc: function calc(r) {
        var s = r * r;
        return t + e * r + n * s + i * (s * r);
      }
    };
  }

  _o.prototype.isArcCurve = !0;
  var bo = new Rt(),
      wo = new Mo(),
      So = new Mo(),
      To = new Mo();

  var Eo = /*#__PURE__*/function (_yo2) {
    _inherits(Eo, _yo2);

    var _super64 = _createSuper(Eo);

    function Eo() {
      var _this53;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : "centripetal";
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : .5;

      _classCallCheck(this, Eo);

      _this53 = _super64.call(this), _this53.type = "CatmullRomCurve3", _this53.points = t, _this53.closed = e, _this53.curveType = n, _this53.tension = i;
      return _this53;
    }

    _createClass(Eo, [{
      key: "getPoint",
      value: function getPoint(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Rt();
        var n = e,
            i = this.points,
            r = i.length,
            s = (r - (this.closed ? 0 : 1)) * t;
        var a,
            o,
            l = Math.floor(s),
            c = s - l;
        this.closed ? l += l > 0 ? 0 : (Math.floor(Math.abs(l) / r) + 1) * r : 0 === c && l === r - 1 && (l = r - 2, c = 1), this.closed || l > 0 ? a = i[(l - 1) % r] : (bo.subVectors(i[0], i[1]).add(i[0]), a = bo);
        var h = i[l % r],
            u = i[(l + 1) % r];

        if (this.closed || l + 2 < r ? o = i[(l + 2) % r] : (bo.subVectors(i[r - 1], i[r - 2]).add(i[r - 1]), o = bo), "centripetal" === this.curveType || "chordal" === this.curveType) {
          var _t181 = "chordal" === this.curveType ? .5 : .25;

          var _e152 = Math.pow(a.distanceToSquared(h), _t181),
              _n148 = Math.pow(h.distanceToSquared(u), _t181),
              _i123 = Math.pow(u.distanceToSquared(o), _t181);

          _n148 < 1e-4 && (_n148 = 1), _e152 < 1e-4 && (_e152 = _n148), _i123 < 1e-4 && (_i123 = _n148), wo.initNonuniformCatmullRom(a.x, h.x, u.x, o.x, _e152, _n148, _i123), So.initNonuniformCatmullRom(a.y, h.y, u.y, o.y, _e152, _n148, _i123), To.initNonuniformCatmullRom(a.z, h.z, u.z, o.z, _e152, _n148, _i123);
        } else "catmullrom" === this.curveType && (wo.initCatmullRom(a.x, h.x, u.x, o.x, this.tension), So.initCatmullRom(a.y, h.y, u.y, o.y, this.tension), To.initCatmullRom(a.z, h.z, u.z, o.z, this.tension));

        return n.set(wo.calc(c), So.calc(c), To.calc(c)), n;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        _get(_getPrototypeOf(Eo.prototype), "copy", this).call(this, t), this.points = [];

        for (var _e153 = 0, _n149 = t.points.length; _e153 < _n149; _e153++) {
          var _n150 = t.points[_e153];
          this.points.push(_n150.clone());
        }

        return this.closed = t.closed, this.curveType = t.curveType, this.tension = t.tension, this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(Eo.prototype), "toJSON", this).call(this);

        t.points = [];

        for (var _e154 = 0, _n151 = this.points.length; _e154 < _n151; _e154++) {
          var _n152 = this.points[_e154];
          t.points.push(_n152.toArray());
        }

        return t.closed = this.closed, t.curveType = this.curveType, t.tension = this.tension, t;
      }
    }, {
      key: "fromJSON",
      value: function fromJSON(t) {
        _get(_getPrototypeOf(Eo.prototype), "fromJSON", this).call(this, t), this.points = [];

        for (var _e155 = 0, _n153 = t.points.length; _e155 < _n153; _e155++) {
          var _n154 = t.points[_e155];
          this.points.push(new Rt().fromArray(_n154));
        }

        return this.closed = t.closed, this.curveType = t.curveType, this.tension = t.tension, this;
      }
    }]);

    return Eo;
  }(yo);

  function Ao(t, e, n, i, r) {
    var s = .5 * (i - e),
        a = .5 * (r - n),
        o = t * t;
    return (2 * n - 2 * i + s + a) * (t * o) + (-3 * n + 3 * i - 2 * s - a) * o + s * t + n;
  }

  function Lo(t, e, n, i) {
    return function (t, e) {
      var n = 1 - t;
      return n * n * e;
    }(t, e) + function (t, e) {
      return 2 * (1 - t) * t * e;
    }(t, n) + function (t, e) {
      return t * t * e;
    }(t, i);
  }

  function Ro(t, e, n, i, r) {
    return function (t, e) {
      var n = 1 - t;
      return n * n * n * e;
    }(t, e) + function (t, e) {
      var n = 1 - t;
      return 3 * n * n * t * e;
    }(t, n) + function (t, e) {
      return 3 * (1 - t) * t * t * e;
    }(t, i) + function (t, e) {
      return t * t * t * e;
    }(t, r);
  }

  Eo.prototype.isCatmullRomCurve3 = !0;

  var Co = /*#__PURE__*/function (_yo3) {
    _inherits(Co, _yo3);

    var _super65 = _createSuper(Co);

    function Co() {
      var _this54;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new vt();
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new vt();
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new vt();
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : new vt();

      _classCallCheck(this, Co);

      _this54 = _super65.call(this), _this54.type = "CubicBezierCurve", _this54.v0 = t, _this54.v1 = e, _this54.v2 = n, _this54.v3 = i;
      return _this54;
    }

    _createClass(Co, [{
      key: "getPoint",
      value: function getPoint(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new vt();
        var n = e,
            i = this.v0,
            r = this.v1,
            s = this.v2,
            a = this.v3;
        return n.set(Ro(t, i.x, r.x, s.x, a.x), Ro(t, i.y, r.y, s.y, a.y)), n;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Co.prototype), "copy", this).call(this, t), this.v0.copy(t.v0), this.v1.copy(t.v1), this.v2.copy(t.v2), this.v3.copy(t.v3), this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(Co.prototype), "toJSON", this).call(this);

        return t.v0 = this.v0.toArray(), t.v1 = this.v1.toArray(), t.v2 = this.v2.toArray(), t.v3 = this.v3.toArray(), t;
      }
    }, {
      key: "fromJSON",
      value: function fromJSON(t) {
        return _get(_getPrototypeOf(Co.prototype), "fromJSON", this).call(this, t), this.v0.fromArray(t.v0), this.v1.fromArray(t.v1), this.v2.fromArray(t.v2), this.v3.fromArray(t.v3), this;
      }
    }]);

    return Co;
  }(yo);

  Co.prototype.isCubicBezierCurve = !0;

  var Po = /*#__PURE__*/function (_yo4) {
    _inherits(Po, _yo4);

    var _super66 = _createSuper(Po);

    function Po() {
      var _this55;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Rt();
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Rt();
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new Rt();
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : new Rt();

      _classCallCheck(this, Po);

      _this55 = _super66.call(this), _this55.type = "CubicBezierCurve3", _this55.v0 = t, _this55.v1 = e, _this55.v2 = n, _this55.v3 = i;
      return _this55;
    }

    _createClass(Po, [{
      key: "getPoint",
      value: function getPoint(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Rt();
        var n = e,
            i = this.v0,
            r = this.v1,
            s = this.v2,
            a = this.v3;
        return n.set(Ro(t, i.x, r.x, s.x, a.x), Ro(t, i.y, r.y, s.y, a.y), Ro(t, i.z, r.z, s.z, a.z)), n;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Po.prototype), "copy", this).call(this, t), this.v0.copy(t.v0), this.v1.copy(t.v1), this.v2.copy(t.v2), this.v3.copy(t.v3), this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(Po.prototype), "toJSON", this).call(this);

        return t.v0 = this.v0.toArray(), t.v1 = this.v1.toArray(), t.v2 = this.v2.toArray(), t.v3 = this.v3.toArray(), t;
      }
    }, {
      key: "fromJSON",
      value: function fromJSON(t) {
        return _get(_getPrototypeOf(Po.prototype), "fromJSON", this).call(this, t), this.v0.fromArray(t.v0), this.v1.fromArray(t.v1), this.v2.fromArray(t.v2), this.v3.fromArray(t.v3), this;
      }
    }]);

    return Po;
  }(yo);

  Po.prototype.isCubicBezierCurve3 = !0;

  var Io = /*#__PURE__*/function (_yo5) {
    _inherits(Io, _yo5);

    var _super67 = _createSuper(Io);

    function Io() {
      var _this56;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new vt();
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new vt();

      _classCallCheck(this, Io);

      _this56 = _super67.call(this), _this56.type = "LineCurve", _this56.v1 = t, _this56.v2 = e;
      return _this56;
    }

    _createClass(Io, [{
      key: "getPoint",
      value: function getPoint(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new vt();
        var n = e;
        return 1 === t ? n.copy(this.v2) : (n.copy(this.v2).sub(this.v1), n.multiplyScalar(t).add(this.v1)), n;
      }
    }, {
      key: "getPointAt",
      value: function getPointAt(t, e) {
        return this.getPoint(t, e);
      }
    }, {
      key: "getTangent",
      value: function getTangent(t, e) {
        var n = e || new vt();
        return n.copy(this.v2).sub(this.v1).normalize(), n;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Io.prototype), "copy", this).call(this, t), this.v1.copy(t.v1), this.v2.copy(t.v2), this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(Io.prototype), "toJSON", this).call(this);

        return t.v1 = this.v1.toArray(), t.v2 = this.v2.toArray(), t;
      }
    }, {
      key: "fromJSON",
      value: function fromJSON(t) {
        return _get(_getPrototypeOf(Io.prototype), "fromJSON", this).call(this, t), this.v1.fromArray(t.v1), this.v2.fromArray(t.v2), this;
      }
    }]);

    return Io;
  }(yo);

  Io.prototype.isLineCurve = !0;

  var Do = /*#__PURE__*/function (_yo6) {
    _inherits(Do, _yo6);

    var _super68 = _createSuper(Do);

    function Do() {
      var _this57;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Rt();
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Rt();

      _classCallCheck(this, Do);

      _this57 = _super68.call(this), _this57.type = "LineCurve3", _this57.isLineCurve3 = !0, _this57.v1 = t, _this57.v2 = e;
      return _this57;
    }

    _createClass(Do, [{
      key: "getPoint",
      value: function getPoint(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Rt();
        var n = e;
        return 1 === t ? n.copy(this.v2) : (n.copy(this.v2).sub(this.v1), n.multiplyScalar(t).add(this.v1)), n;
      }
    }, {
      key: "getPointAt",
      value: function getPointAt(t, e) {
        return this.getPoint(t, e);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Do.prototype), "copy", this).call(this, t), this.v1.copy(t.v1), this.v2.copy(t.v2), this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(Do.prototype), "toJSON", this).call(this);

        return t.v1 = this.v1.toArray(), t.v2 = this.v2.toArray(), t;
      }
    }, {
      key: "fromJSON",
      value: function fromJSON(t) {
        return _get(_getPrototypeOf(Do.prototype), "fromJSON", this).call(this, t), this.v1.fromArray(t.v1), this.v2.fromArray(t.v2), this;
      }
    }]);

    return Do;
  }(yo);

  var No = /*#__PURE__*/function (_yo7) {
    _inherits(No, _yo7);

    var _super69 = _createSuper(No);

    function No() {
      var _this58;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new vt();
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new vt();
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new vt();

      _classCallCheck(this, No);

      _this58 = _super69.call(this), _this58.type = "QuadraticBezierCurve", _this58.v0 = t, _this58.v1 = e, _this58.v2 = n;
      return _this58;
    }

    _createClass(No, [{
      key: "getPoint",
      value: function getPoint(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new vt();
        var n = e,
            i = this.v0,
            r = this.v1,
            s = this.v2;
        return n.set(Lo(t, i.x, r.x, s.x), Lo(t, i.y, r.y, s.y)), n;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(No.prototype), "copy", this).call(this, t), this.v0.copy(t.v0), this.v1.copy(t.v1), this.v2.copy(t.v2), this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(No.prototype), "toJSON", this).call(this);

        return t.v0 = this.v0.toArray(), t.v1 = this.v1.toArray(), t.v2 = this.v2.toArray(), t;
      }
    }, {
      key: "fromJSON",
      value: function fromJSON(t) {
        return _get(_getPrototypeOf(No.prototype), "fromJSON", this).call(this, t), this.v0.fromArray(t.v0), this.v1.fromArray(t.v1), this.v2.fromArray(t.v2), this;
      }
    }]);

    return No;
  }(yo);

  No.prototype.isQuadraticBezierCurve = !0;

  var Bo = /*#__PURE__*/function (_yo8) {
    _inherits(Bo, _yo8);

    var _super70 = _createSuper(Bo);

    function Bo() {
      var _this59;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Rt();
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Rt();
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new Rt();

      _classCallCheck(this, Bo);

      _this59 = _super70.call(this), _this59.type = "QuadraticBezierCurve3", _this59.v0 = t, _this59.v1 = e, _this59.v2 = n;
      return _this59;
    }

    _createClass(Bo, [{
      key: "getPoint",
      value: function getPoint(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Rt();
        var n = e,
            i = this.v0,
            r = this.v1,
            s = this.v2;
        return n.set(Lo(t, i.x, r.x, s.x), Lo(t, i.y, r.y, s.y), Lo(t, i.z, r.z, s.z)), n;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Bo.prototype), "copy", this).call(this, t), this.v0.copy(t.v0), this.v1.copy(t.v1), this.v2.copy(t.v2), this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(Bo.prototype), "toJSON", this).call(this);

        return t.v0 = this.v0.toArray(), t.v1 = this.v1.toArray(), t.v2 = this.v2.toArray(), t;
      }
    }, {
      key: "fromJSON",
      value: function fromJSON(t) {
        return _get(_getPrototypeOf(Bo.prototype), "fromJSON", this).call(this, t), this.v0.fromArray(t.v0), this.v1.fromArray(t.v1), this.v2.fromArray(t.v2), this;
      }
    }]);

    return Bo;
  }(yo);

  Bo.prototype.isQuadraticBezierCurve3 = !0;

  var zo = /*#__PURE__*/function (_yo9) {
    _inherits(zo, _yo9);

    var _super71 = _createSuper(zo);

    function zo() {
      var _this60;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];

      _classCallCheck(this, zo);

      _this60 = _super71.call(this), _this60.type = "SplineCurve", _this60.points = t;
      return _this60;
    }

    _createClass(zo, [{
      key: "getPoint",
      value: function getPoint(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new vt();
        var n = e,
            i = this.points,
            r = (i.length - 1) * t,
            s = Math.floor(r),
            a = r - s,
            o = i[0 === s ? s : s - 1],
            l = i[s],
            c = i[s > i.length - 2 ? i.length - 1 : s + 1],
            h = i[s > i.length - 3 ? i.length - 1 : s + 2];
        return n.set(Ao(a, o.x, l.x, c.x, h.x), Ao(a, o.y, l.y, c.y, h.y)), n;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        _get(_getPrototypeOf(zo.prototype), "copy", this).call(this, t), this.points = [];

        for (var _e156 = 0, _n155 = t.points.length; _e156 < _n155; _e156++) {
          var _n156 = t.points[_e156];
          this.points.push(_n156.clone());
        }

        return this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(zo.prototype), "toJSON", this).call(this);

        t.points = [];

        for (var _e157 = 0, _n157 = this.points.length; _e157 < _n157; _e157++) {
          var _n158 = this.points[_e157];
          t.points.push(_n158.toArray());
        }

        return t;
      }
    }, {
      key: "fromJSON",
      value: function fromJSON(t) {
        _get(_getPrototypeOf(zo.prototype), "fromJSON", this).call(this, t), this.points = [];

        for (var _e158 = 0, _n159 = t.points.length; _e158 < _n159; _e158++) {
          var _n160 = t.points[_e158];
          this.points.push(new vt().fromArray(_n160));
        }

        return this;
      }
    }]);

    return zo;
  }(yo);

  zo.prototype.isSplineCurve = !0;
  var Fo = Object.freeze({
    __proto__: null,
    ArcCurve: _o,
    CatmullRomCurve3: Eo,
    CubicBezierCurve: Co,
    CubicBezierCurve3: Po,
    EllipseCurve: xo,
    LineCurve: Io,
    LineCurve3: Do,
    QuadraticBezierCurve: No,
    QuadraticBezierCurve3: Bo,
    SplineCurve: zo
  });

  var Oo = function Oo(t, e) {
    var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 2;
    var i = e && e.length,
        r = i ? e[0] * n : t.length;
    var s = Uo(t, 0, r, n, !0);
    var a = [];
    if (!s || s.next === s.prev) return a;
    var o, l, c, h, u, d, p;

    if (i && (s = function (t, e, n, i) {
      var r = [];
      var s, a, o, l, c;

      for (s = 0, a = e.length; s < a; s++) {
        o = e[s] * i, l = s < a - 1 ? e[s + 1] * i : t.length, c = Uo(t, o, l, i, !1), c === c.next && (c.steiner = !0), r.push(Zo(c));
      }

      for (r.sort(qo), s = 0; s < r.length; s++) {
        Xo(r[s], n), n = Ho(n, n.next);
      }

      return n;
    }(t, e, s, n)), t.length > 80 * n) {
      o = c = t[0], l = h = t[1];

      for (var _e159 = n; _e159 < r; _e159 += n) {
        u = t[_e159], d = t[_e159 + 1], u < o && (o = u), d < l && (l = d), u > c && (c = u), d > h && (h = d);
      }

      p = Math.max(c - o, h - l), p = 0 !== p ? 1 / p : 0;
    }

    return Go(s, a, n, o, l, p), a;
  };

  function Uo(t, e, n, i, r) {
    var s, a;
    if (r === function (t, e, n, i) {
      var r = 0;

      for (var _s50 = e, _a43 = n - i; _s50 < n; _s50 += i) {
        r += (t[_a43] - t[_s50]) * (t[_s50 + 1] + t[_a43 + 1]), _a43 = _s50;
      }

      return r;
    }(t, e, n, i) > 0) for (s = e; s < n; s += i) {
      a = al(s, t[s], t[s + 1], a);
    } else for (s = n - i; s >= e; s -= i) {
      a = al(s, t[s], t[s + 1], a);
    }
    return a && tl(a, a.next) && (ol(a), a = a.next), a;
  }

  function Ho(t, e) {
    if (!t) return t;
    e || (e = t);
    var n,
        i = t;

    do {
      if (n = !1, i.steiner || !tl(i, i.next) && 0 !== $o(i.prev, i, i.next)) i = i.next;else {
        if (ol(i), i = e = i.prev, i === i.next) break;
        n = !0;
      }
    } while (n || i !== e);

    return e;
  }

  function Go(t, e, n, i, r, s, a) {
    if (!t) return;
    !a && s && function (t, e, n, i) {
      var r = t;

      do {
        null === r.z && (r.z = Jo(r.x, r.y, e, n, i)), r.prevZ = r.prev, r.nextZ = r.next, r = r.next;
      } while (r !== t);

      r.prevZ.nextZ = null, r.prevZ = null, function (t) {
        var e,
            n,
            i,
            r,
            s,
            a,
            o,
            l,
            c = 1;

        do {
          for (n = t, t = null, s = null, a = 0; n;) {
            for (a++, i = n, o = 0, e = 0; e < c && (o++, i = i.nextZ, i); e++) {
              ;
            }

            for (l = c; o > 0 || l > 0 && i;) {
              0 !== o && (0 === l || !i || n.z <= i.z) ? (r = n, n = n.nextZ, o--) : (r = i, i = i.nextZ, l--), s ? s.nextZ = r : t = r, r.prevZ = s, s = r;
            }

            n = i;
          }

          s.nextZ = null, c *= 2;
        } while (a > 1);
      }(r);
    }(t, i, r, s);
    var o,
        l,
        c = t;

    for (; t.prev !== t.next;) {
      if (o = t.prev, l = t.next, s ? Vo(t, i, r, s) : ko(t)) e.push(o.i / n), e.push(t.i / n), e.push(l.i / n), ol(t), t = l.next, c = l.next;else if ((t = l) === c) {
        a ? 1 === a ? Go(t = Wo(Ho(t), e, n), e, n, i, r, s, 2) : 2 === a && jo(t, e, n, i, r, s) : Go(Ho(t), e, n, i, r, s, 1);
        break;
      }
    }
  }

  function ko(t) {
    var e = t.prev,
        n = t,
        i = t.next;
    if ($o(e, n, i) >= 0) return !1;
    var r = t.next.next;

    for (; r !== t.prev;) {
      if (Qo(e.x, e.y, n.x, n.y, i.x, i.y, r.x, r.y) && $o(r.prev, r, r.next) >= 0) return !1;
      r = r.next;
    }

    return !0;
  }

  function Vo(t, e, n, i) {
    var r = t.prev,
        s = t,
        a = t.next;
    if ($o(r, s, a) >= 0) return !1;
    var o = r.x < s.x ? r.x < a.x ? r.x : a.x : s.x < a.x ? s.x : a.x,
        l = r.y < s.y ? r.y < a.y ? r.y : a.y : s.y < a.y ? s.y : a.y,
        c = r.x > s.x ? r.x > a.x ? r.x : a.x : s.x > a.x ? s.x : a.x,
        h = r.y > s.y ? r.y > a.y ? r.y : a.y : s.y > a.y ? s.y : a.y,
        u = Jo(o, l, e, n, i),
        d = Jo(c, h, e, n, i);
    var p = t.prevZ,
        m = t.nextZ;

    for (; p && p.z >= u && m && m.z <= d;) {
      if (p !== t.prev && p !== t.next && Qo(r.x, r.y, s.x, s.y, a.x, a.y, p.x, p.y) && $o(p.prev, p, p.next) >= 0) return !1;
      if (p = p.prevZ, m !== t.prev && m !== t.next && Qo(r.x, r.y, s.x, s.y, a.x, a.y, m.x, m.y) && $o(m.prev, m, m.next) >= 0) return !1;
      m = m.nextZ;
    }

    for (; p && p.z >= u;) {
      if (p !== t.prev && p !== t.next && Qo(r.x, r.y, s.x, s.y, a.x, a.y, p.x, p.y) && $o(p.prev, p, p.next) >= 0) return !1;
      p = p.prevZ;
    }

    for (; m && m.z <= d;) {
      if (m !== t.prev && m !== t.next && Qo(r.x, r.y, s.x, s.y, a.x, a.y, m.x, m.y) && $o(m.prev, m, m.next) >= 0) return !1;
      m = m.nextZ;
    }

    return !0;
  }

  function Wo(t, e, n) {
    var i = t;

    do {
      var _r105 = i.prev,
          _s51 = i.next.next;
      !tl(_r105, _s51) && el(_r105, i, i.next, _s51) && rl(_r105, _s51) && rl(_s51, _r105) && (e.push(_r105.i / n), e.push(i.i / n), e.push(_s51.i / n), ol(i), ol(i.next), i = t = _s51), i = i.next;
    } while (i !== t);

    return Ho(i);
  }

  function jo(t, e, n, i, r, s) {
    var a = t;

    do {
      var _t182 = a.next.next;

      for (; _t182 !== a.prev;) {
        if (a.i !== _t182.i && Ko(a, _t182)) {
          var _o24 = sl(a, _t182);

          return a = Ho(a, a.next), _o24 = Ho(_o24, _o24.next), Go(a, e, n, i, r, s), void Go(_o24, e, n, i, r, s);
        }

        _t182 = _t182.next;
      }

      a = a.next;
    } while (a !== t);
  }

  function qo(t, e) {
    return t.x - e.x;
  }

  function Xo(t, e) {
    if (e = function (t, e) {
      var n = e;
      var i = t.x,
          r = t.y;
      var s,
          a = -1 / 0;

      do {
        if (r <= n.y && r >= n.next.y && n.next.y !== n.y) {
          var _t183 = n.x + (r - n.y) * (n.next.x - n.x) / (n.next.y - n.y);

          if (_t183 <= i && _t183 > a) {
            if (a = _t183, _t183 === i) {
              if (r === n.y) return n;
              if (r === n.next.y) return n.next;
            }

            s = n.x < n.next.x ? n : n.next;
          }
        }

        n = n.next;
      } while (n !== e);

      if (!s) return null;
      if (i === a) return s;
      var o = s,
          l = s.x,
          c = s.y;
      var h,
          u = 1 / 0;
      n = s;

      do {
        i >= n.x && n.x >= l && i !== n.x && Qo(r < c ? i : a, r, l, c, r < c ? a : i, r, n.x, n.y) && (h = Math.abs(r - n.y) / (i - n.x), rl(n, t) && (h < u || h === u && (n.x > s.x || n.x === s.x && Yo(s, n))) && (s = n, u = h)), n = n.next;
      } while (n !== o);

      return s;
    }(t, e)) {
      var _n161 = sl(e, t);

      Ho(e, e.next), Ho(_n161, _n161.next);
    }
  }

  function Yo(t, e) {
    return $o(t.prev, t, e.prev) < 0 && $o(e.next, t, t.next) < 0;
  }

  function Jo(t, e, n, i, r) {
    return (t = 1431655765 & ((t = 858993459 & ((t = 252645135 & ((t = 16711935 & ((t = 32767 * (t - n) * r) | t << 8)) | t << 4)) | t << 2)) | t << 1)) | (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - i) * r) | e << 8)) | e << 4)) | e << 2)) | e << 1)) << 1;
  }

  function Zo(t) {
    var e = t,
        n = t;

    do {
      (e.x < n.x || e.x === n.x && e.y < n.y) && (n = e), e = e.next;
    } while (e !== t);

    return n;
  }

  function Qo(t, e, n, i, r, s, a, o) {
    return (r - a) * (e - o) - (t - a) * (s - o) >= 0 && (t - a) * (i - o) - (n - a) * (e - o) >= 0 && (n - a) * (s - o) - (r - a) * (i - o) >= 0;
  }

  function Ko(t, e) {
    return t.next.i !== e.i && t.prev.i !== e.i && !function (t, e) {
      var n = t;

      do {
        if (n.i !== t.i && n.next.i !== t.i && n.i !== e.i && n.next.i !== e.i && el(n, n.next, t, e)) return !0;
        n = n.next;
      } while (n !== t);

      return !1;
    }(t, e) && (rl(t, e) && rl(e, t) && function (t, e) {
      var n = t,
          i = !1;
      var r = (t.x + e.x) / 2,
          s = (t.y + e.y) / 2;

      do {
        n.y > s != n.next.y > s && n.next.y !== n.y && r < (n.next.x - n.x) * (s - n.y) / (n.next.y - n.y) + n.x && (i = !i), n = n.next;
      } while (n !== t);

      return i;
    }(t, e) && ($o(t.prev, t, e.prev) || $o(t, e.prev, e)) || tl(t, e) && $o(t.prev, t, t.next) > 0 && $o(e.prev, e, e.next) > 0);
  }

  function $o(t, e, n) {
    return (e.y - t.y) * (n.x - e.x) - (e.x - t.x) * (n.y - e.y);
  }

  function tl(t, e) {
    return t.x === e.x && t.y === e.y;
  }

  function el(t, e, n, i) {
    var r = il($o(t, e, n)),
        s = il($o(t, e, i)),
        a = il($o(n, i, t)),
        o = il($o(n, i, e));
    return r !== s && a !== o || !(0 !== r || !nl(t, n, e)) || !(0 !== s || !nl(t, i, e)) || !(0 !== a || !nl(n, t, i)) || !(0 !== o || !nl(n, e, i));
  }

  function nl(t, e, n) {
    return e.x <= Math.max(t.x, n.x) && e.x >= Math.min(t.x, n.x) && e.y <= Math.max(t.y, n.y) && e.y >= Math.min(t.y, n.y);
  }

  function il(t) {
    return t > 0 ? 1 : t < 0 ? -1 : 0;
  }

  function rl(t, e) {
    return $o(t.prev, t, t.next) < 0 ? $o(t, e, t.next) >= 0 && $o(t, t.prev, e) >= 0 : $o(t, e, t.prev) < 0 || $o(t, t.next, e) < 0;
  }

  function sl(t, e) {
    var n = new ll(t.i, t.x, t.y),
        i = new ll(e.i, e.x, e.y),
        r = t.next,
        s = e.prev;
    return t.next = e, e.prev = t, n.next = r, r.prev = n, i.next = n, n.prev = i, s.next = i, i.prev = s, i;
  }

  function al(t, e, n, i) {
    var r = new ll(t, e, n);
    return i ? (r.next = i.next, r.prev = i, i.next.prev = r, i.next = r) : (r.prev = r, r.next = r), r;
  }

  function ol(t) {
    t.next.prev = t.prev, t.prev.next = t.next, t.prevZ && (t.prevZ.nextZ = t.nextZ), t.nextZ && (t.nextZ.prevZ = t.prevZ);
  }

  function ll(t, e, n) {
    this.i = t, this.x = e, this.y = n, this.prev = null, this.next = null, this.z = null, this.prevZ = null, this.nextZ = null, this.steiner = !1;
  }

  var cl = /*#__PURE__*/function () {
    function cl() {
      _classCallCheck(this, cl);
    }

    _createClass(cl, null, [{
      key: "area",
      value: function area(t) {
        var e = t.length;
        var n = 0;

        for (var _i124 = e - 1, _r106 = 0; _r106 < e; _i124 = _r106++) {
          n += t[_i124].x * t[_r106].y - t[_r106].x * t[_i124].y;
        }

        return .5 * n;
      }
    }, {
      key: "isClockWise",
      value: function isClockWise(t) {
        return cl.area(t) < 0;
      }
    }, {
      key: "triangulateShape",
      value: function triangulateShape(t, e) {
        var n = [],
            i = [],
            r = [];
        hl(t), ul(n, t);
        var s = t.length;
        e.forEach(hl);

        for (var _t184 = 0; _t184 < e.length; _t184++) {
          i.push(s), s += e[_t184].length, ul(n, e[_t184]);
        }

        var a = Oo(n, i);

        for (var _t185 = 0; _t185 < a.length; _t185 += 3) {
          r.push(a.slice(_t185, _t185 + 3));
        }

        return r;
      }
    }]);

    return cl;
  }();

  function hl(t) {
    var e = t.length;
    e > 2 && t[e - 1].equals(t[0]) && t.pop();
  }

  function ul(t, e) {
    for (var _n162 = 0; _n162 < e.length; _n162++) {
      t.push(e[_n162].x), t.push(e[_n162].y);
    }
  }

  var dl = /*#__PURE__*/function (_wn7) {
    _inherits(dl, _wn7);

    var _super72 = _createSuper(dl);

    function dl(t, e) {
      var _this61;

      _classCallCheck(this, dl);

      _this61 = _super72.call(this), _this61.type = "ExtrudeGeometry", _this61.parameters = {
        shapes: t,
        options: e
      }, t = Array.isArray(t) ? t : [t];

      var n = _assertThisInitialized(_this61),
          i = [],
          r = [];

      for (var _e160 = 0, _n163 = t.length; _e160 < _n163; _e160++) {
        s(t[_e160]);
      }

      function s(t) {
        var s = [],
            a = void 0 !== e.curveSegments ? e.curveSegments : 12,
            o = void 0 !== e.steps ? e.steps : 1;
        var l = void 0 !== e.depth ? e.depth : 100,
            c = void 0 === e.bevelEnabled || e.bevelEnabled,
            h = void 0 !== e.bevelThickness ? e.bevelThickness : 6,
            u = void 0 !== e.bevelSize ? e.bevelSize : h - 2,
            d = void 0 !== e.bevelOffset ? e.bevelOffset : 0,
            p = void 0 !== e.bevelSegments ? e.bevelSegments : 3;
        var m = e.extrudePath,
            f = void 0 !== e.UVGenerator ? e.UVGenerator : pl;
        void 0 !== e.amount && (console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."), l = e.amount);

        var g,
            v,
            y,
            x,
            _,
            M = !1;

        m && (g = m.getSpacedPoints(o), M = !0, c = !1, v = m.computeFrenetFrames(o, !1), y = new Rt(), x = new Rt(), _ = new Rt()), c || (p = 0, h = 0, u = 0, d = 0);
        var b = t.extractPoints(a);
        var w = b.shape;
        var S = b.holes;

        if (!cl.isClockWise(w)) {
          w = w.reverse();

          for (var _t186 = 0, _e161 = S.length; _t186 < _e161; _t186++) {
            var _e162 = S[_t186];
            cl.isClockWise(_e162) && (S[_t186] = _e162.reverse());
          }
        }

        var T = cl.triangulateShape(w, S),
            E = w;

        for (var _t187 = 0, _e163 = S.length; _t187 < _e163; _t187++) {
          var _e164 = S[_t187];
          w = w.concat(_e164);
        }

        function A(t, e, n) {
          return e || console.error("THREE.ExtrudeGeometry: vec does not exist"), e.clone().multiplyScalar(n).add(t);
        }

        var L = w.length,
            R = T.length;

        function C(t, e, n) {
          var i, r, s;
          var a = t.x - e.x,
              o = t.y - e.y,
              l = n.x - t.x,
              c = n.y - t.y,
              h = a * a + o * o,
              u = a * c - o * l;

          if (Math.abs(u) > Number.EPSILON) {
            var _u15 = Math.sqrt(h),
                _d12 = Math.sqrt(l * l + c * c),
                _p9 = e.x - o / _u15,
                _m6 = e.y + a / _u15,
                _f3 = ((n.x - c / _d12 - _p9) * c - (n.y + l / _d12 - _m6) * l) / (a * c - o * l);

            i = _p9 + a * _f3 - t.x, r = _m6 + o * _f3 - t.y;

            var _g3 = i * i + r * r;

            if (_g3 <= 2) return new vt(i, r);
            s = Math.sqrt(_g3 / 2);
          } else {
            var _t188 = !1;

            a > Number.EPSILON ? l > Number.EPSILON && (_t188 = !0) : a < -Number.EPSILON ? l < -Number.EPSILON && (_t188 = !0) : Math.sign(o) === Math.sign(c) && (_t188 = !0), _t188 ? (i = -o, r = a, s = Math.sqrt(h)) : (i = a, r = o, s = Math.sqrt(h / 2));
          }

          return new vt(i / s, r / s);
        }

        var P = [];

        for (var _t189 = 0, _e165 = E.length, _n164 = _e165 - 1, _i125 = _t189 + 1; _t189 < _e165; _t189++, _n164++, _i125++) {
          _n164 === _e165 && (_n164 = 0), _i125 === _e165 && (_i125 = 0), P[_t189] = C(E[_t189], E[_n164], E[_i125]);
        }

        var I = [];
        var D,
            N = P.concat();

        for (var _t190 = 0, _e166 = S.length; _t190 < _e166; _t190++) {
          var _e167 = S[_t190];
          D = [];

          for (var _t191 = 0, _n165 = _e167.length, _i126 = _n165 - 1, _r107 = _t191 + 1; _t191 < _n165; _t191++, _i126++, _r107++) {
            _i126 === _n165 && (_i126 = 0), _r107 === _n165 && (_r107 = 0), D[_t191] = C(_e167[_t191], _e167[_i126], _e167[_r107]);
          }

          I.push(D), N = N.concat(D);
        }

        for (var _t192 = 0; _t192 < p; _t192++) {
          var _e168 = _t192 / p,
              _n166 = h * Math.cos(_e168 * Math.PI / 2),
              _i127 = u * Math.sin(_e168 * Math.PI / 2) + d;

          for (var _t193 = 0, _e169 = E.length; _t193 < _e169; _t193++) {
            var _e170 = A(E[_t193], P[_t193], _i127);

            F(_e170.x, _e170.y, -_n166);
          }

          for (var _t194 = 0, _e171 = S.length; _t194 < _e171; _t194++) {
            var _e172 = S[_t194];
            D = I[_t194];

            for (var _t195 = 0, _r108 = _e172.length; _t195 < _r108; _t195++) {
              var _r109 = A(_e172[_t195], D[_t195], _i127);

              F(_r109.x, _r109.y, -_n166);
            }
          }
        }

        var B = u + d;

        for (var _t196 = 0; _t196 < L; _t196++) {
          var _e173 = c ? A(w[_t196], N[_t196], B) : w[_t196];

          M ? (x.copy(v.normals[0]).multiplyScalar(_e173.x), y.copy(v.binormals[0]).multiplyScalar(_e173.y), _.copy(g[0]).add(x).add(y), F(_.x, _.y, _.z)) : F(_e173.x, _e173.y, 0);
        }

        for (var _t197 = 1; _t197 <= o; _t197++) {
          for (var _e174 = 0; _e174 < L; _e174++) {
            var _n167 = c ? A(w[_e174], N[_e174], B) : w[_e174];

            M ? (x.copy(v.normals[_t197]).multiplyScalar(_n167.x), y.copy(v.binormals[_t197]).multiplyScalar(_n167.y), _.copy(g[_t197]).add(x).add(y), F(_.x, _.y, _.z)) : F(_n167.x, _n167.y, l / o * _t197);
          }
        }

        for (var _t198 = p - 1; _t198 >= 0; _t198--) {
          var _e175 = _t198 / p,
              _n168 = h * Math.cos(_e175 * Math.PI / 2),
              _i128 = u * Math.sin(_e175 * Math.PI / 2) + d;

          for (var _t199 = 0, _e176 = E.length; _t199 < _e176; _t199++) {
            var _e177 = A(E[_t199], P[_t199], _i128);

            F(_e177.x, _e177.y, l + _n168);
          }

          for (var _t200 = 0, _e178 = S.length; _t200 < _e178; _t200++) {
            var _e179 = S[_t200];
            D = I[_t200];

            for (var _t201 = 0, _r110 = _e179.length; _t201 < _r110; _t201++) {
              var _r111 = A(_e179[_t201], D[_t201], _i128);

              M ? F(_r111.x, _r111.y + g[o - 1].y, g[o - 1].x + _n168) : F(_r111.x, _r111.y, l + _n168);
            }
          }
        }

        function z(t, e) {
          var n = t.length;

          for (; --n >= 0;) {
            var _i129 = n;

            var _r112 = n - 1;

            _r112 < 0 && (_r112 = t.length - 1);

            for (var _t202 = 0, _n169 = o + 2 * p; _t202 < _n169; _t202++) {
              var _n170 = L * _t202,
                  _s52 = L * (_t202 + 1);

              U(e + _i129 + _n170, e + _r112 + _n170, e + _r112 + _s52, e + _i129 + _s52);
            }
          }
        }

        function F(t, e, n) {
          s.push(t), s.push(e), s.push(n);
        }

        function O(t, e, r) {
          H(t), H(e), H(r);
          var s = i.length / 3,
              a = f.generateTopUV(n, i, s - 3, s - 2, s - 1);
          G(a[0]), G(a[1]), G(a[2]);
        }

        function U(t, e, r, s) {
          H(t), H(e), H(s), H(e), H(r), H(s);
          var a = i.length / 3,
              o = f.generateSideWallUV(n, i, a - 6, a - 3, a - 2, a - 1);
          G(o[0]), G(o[1]), G(o[3]), G(o[1]), G(o[2]), G(o[3]);
        }

        function H(t) {
          i.push(s[3 * t + 0]), i.push(s[3 * t + 1]), i.push(s[3 * t + 2]);
        }

        function G(t) {
          r.push(t.x), r.push(t.y);
        }

        !function () {
          var t = i.length / 3;

          if (c) {
            var _t203 = 0,
                _e180 = L * _t203;

            for (var _t204 = 0; _t204 < R; _t204++) {
              var _n171 = T[_t204];
              O(_n171[2] + _e180, _n171[1] + _e180, _n171[0] + _e180);
            }

            _t203 = o + 2 * p, _e180 = L * _t203;

            for (var _t205 = 0; _t205 < R; _t205++) {
              var _n172 = T[_t205];
              O(_n172[0] + _e180, _n172[1] + _e180, _n172[2] + _e180);
            }
          } else {
            for (var _t206 = 0; _t206 < R; _t206++) {
              var _e181 = T[_t206];
              O(_e181[2], _e181[1], _e181[0]);
            }

            for (var _t207 = 0; _t207 < R; _t207++) {
              var _e182 = T[_t207];
              O(_e182[0] + L * o, _e182[1] + L * o, _e182[2] + L * o);
            }
          }

          n.addGroup(t, i.length / 3 - t, 0);
        }(), function () {
          var t = i.length / 3;
          var e = 0;
          z(E, e), e += E.length;

          for (var _t208 = 0, _n173 = S.length; _t208 < _n173; _t208++) {
            var _n174 = S[_t208];
            z(_n174, e), e += _n174.length;
          }

          n.addGroup(t, i.length / 3 - t, 1);
        }();
      }

      _this61.setAttribute("position", new un(i, 3)), _this61.setAttribute("uv", new un(r, 2)), _this61.computeVertexNormals();
      return _this61;
    }

    _createClass(dl, [{
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(dl.prototype), "toJSON", this).call(this);

        return function (t, e, n) {
          if (n.shapes = [], Array.isArray(t)) for (var _e183 = 0, _i130 = t.length; _e183 < _i130; _e183++) {
            var _i131 = t[_e183];
            n.shapes.push(_i131.uuid);
          } else n.shapes.push(t.uuid);
          void 0 !== e.extrudePath && (n.options.extrudePath = e.extrudePath.toJSON());
          return n;
        }(this.parameters.shapes, this.parameters.options, t);
      }
    }], [{
      key: "fromJSON",
      value: function fromJSON(t, e) {
        var n = [];

        for (var _i132 = 0, _r113 = t.shapes.length; _i132 < _r113; _i132++) {
          var _r114 = e[t.shapes[_i132]];
          n.push(_r114);
        }

        var i = t.options.extrudePath;
        return void 0 !== i && (t.options.extrudePath = new Fo[i.type]().fromJSON(i)), new dl(n, t.options);
      }
    }]);

    return dl;
  }(wn);

  var pl = {
    generateTopUV: function generateTopUV(t, e, n, i, r) {
      var s = e[3 * n],
          a = e[3 * n + 1],
          o = e[3 * i],
          l = e[3 * i + 1],
          c = e[3 * r],
          h = e[3 * r + 1];
      return [new vt(s, a), new vt(o, l), new vt(c, h)];
    },
    generateSideWallUV: function generateSideWallUV(t, e, n, i, r, s) {
      var a = e[3 * n],
          o = e[3 * n + 1],
          l = e[3 * n + 2],
          c = e[3 * i],
          h = e[3 * i + 1],
          u = e[3 * i + 2],
          d = e[3 * r],
          p = e[3 * r + 1],
          m = e[3 * r + 2],
          f = e[3 * s],
          g = e[3 * s + 1],
          v = e[3 * s + 2];
      return Math.abs(o - h) < Math.abs(a - c) ? [new vt(a, 1 - l), new vt(c, 1 - u), new vt(d, 1 - m), new vt(f, 1 - v)] : [new vt(o, 1 - l), new vt(h, 1 - u), new vt(p, 1 - m), new vt(g, 1 - v)];
    }
  };

  var ml = /*#__PURE__*/function (_ho2) {
    _inherits(ml, _ho2);

    var _super73 = _createSuper(ml);

    function ml() {
      var _this62;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;

      _classCallCheck(this, ml);

      var n = (1 + Math.sqrt(5)) / 2;
      _this62 = _super73.call(this, [-1, n, 0, 1, n, 0, -1, -n, 0, 1, -n, 0, 0, -1, n, 0, 1, n, 0, -1, -n, 0, 1, -n, n, 0, -1, n, 0, 1, -n, 0, -1, -n, 0, 1], [0, 11, 5, 0, 5, 1, 0, 1, 7, 0, 7, 10, 0, 10, 11, 1, 5, 9, 5, 11, 4, 11, 10, 2, 10, 7, 6, 7, 1, 8, 3, 9, 4, 3, 4, 2, 3, 2, 6, 3, 6, 8, 3, 8, 9, 4, 9, 5, 2, 4, 11, 6, 2, 10, 8, 6, 7, 9, 8, 1], t, e), _this62.type = "IcosahedronGeometry", _this62.parameters = {
        radius: t,
        detail: e
      };
      return _this62;
    }

    _createClass(ml, null, [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new ml(t.radius, t.detail);
      }
    }]);

    return ml;
  }(ho);

  var fl = /*#__PURE__*/function (_wn8) {
    _inherits(fl, _wn8);

    var _super74 = _createSuper(fl);

    function fl(t) {
      var _this63;

      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 12;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 2 * Math.PI;

      _classCallCheck(this, fl);

      _this63 = _super74.call(this), _this63.type = "LatheGeometry", _this63.parameters = {
        points: t,
        segments: e,
        phiStart: n,
        phiLength: i
      }, e = Math.floor(e), i = ht(i, 0, 2 * Math.PI);
      var r = [],
          s = [],
          a = [],
          o = 1 / e,
          l = new Rt(),
          c = new vt();

      for (var _r115 = 0; _r115 <= e; _r115++) {
        var _h11 = n + _r115 * o * i,
            _u16 = Math.sin(_h11),
            _d13 = Math.cos(_h11);

        for (var _n175 = 0; _n175 <= t.length - 1; _n175++) {
          l.x = t[_n175].x * _u16, l.y = t[_n175].y, l.z = t[_n175].x * _d13, s.push(l.x, l.y, l.z), c.x = _r115 / e, c.y = _n175 / (t.length - 1), a.push(c.x, c.y);
        }
      }

      for (var _n176 = 0; _n176 < e; _n176++) {
        for (var _e184 = 0; _e184 < t.length - 1; _e184++) {
          var _i133 = _e184 + _n176 * t.length,
              _s53 = _i133,
              _a44 = _i133 + t.length,
              _o25 = _i133 + t.length + 1,
              _l24 = _i133 + 1;

          r.push(_s53, _a44, _l24), r.push(_a44, _o25, _l24);
        }
      }

      if (_this63.setIndex(r), _this63.setAttribute("position", new un(s, 3)), _this63.setAttribute("uv", new un(a, 2)), _this63.computeVertexNormals(), i === 2 * Math.PI) {
        var _n177 = _this63.attributes.normal.array,
            _i134 = new Rt(),
            _r116 = new Rt(),
            _s54 = new Rt(),
            _a45 = e * t.length * 3;

        for (var _e185 = 0, _o26 = 0; _e185 < t.length; _e185++, _o26 += 3) {
          _i134.x = _n177[_o26 + 0], _i134.y = _n177[_o26 + 1], _i134.z = _n177[_o26 + 2], _r116.x = _n177[_a45 + _o26 + 0], _r116.y = _n177[_a45 + _o26 + 1], _r116.z = _n177[_a45 + _o26 + 2], _s54.addVectors(_i134, _r116).normalize(), _n177[_o26 + 0] = _n177[_a45 + _o26 + 0] = _s54.x, _n177[_o26 + 1] = _n177[_a45 + _o26 + 1] = _s54.y, _n177[_o26 + 2] = _n177[_a45 + _o26 + 2] = _s54.z;
        }
      }

      return _this63;
    }

    _createClass(fl, null, [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new fl(t.points, t.segments, t.phiStart, t.phiLength);
      }
    }]);

    return fl;
  }(wn);

  var gl = /*#__PURE__*/function (_ho3) {
    _inherits(gl, _ho3);

    var _super75 = _createSuper(gl);

    function gl() {
      var _this64;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;

      _classCallCheck(this, gl);

      _this64 = _super75.call(this, [1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1], [0, 2, 4, 0, 4, 3, 0, 3, 5, 0, 5, 2, 1, 2, 5, 1, 5, 3, 1, 3, 4, 1, 4, 2], t, e), _this64.type = "OctahedronGeometry", _this64.parameters = {
        radius: t,
        detail: e
      };
      return _this64;
    }

    _createClass(gl, null, [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new gl(t.radius, t.detail);
      }
    }]);

    return gl;
  }(ho);

  var vl = /*#__PURE__*/function (_wn9) {
    _inherits(vl, _wn9);

    var _super76 = _createSuper(vl);

    function vl(t, e, n) {
      var _this65;

      _classCallCheck(this, vl);

      _this65 = _super76.call(this), _this65.type = "ParametricGeometry", _this65.parameters = {
        func: t,
        slices: e,
        stacks: n
      };
      var i = [],
          r = [],
          s = [],
          a = [],
          o = 1e-5,
          l = new Rt(),
          c = new Rt(),
          h = new Rt(),
          u = new Rt(),
          d = new Rt();
      t.length < 3 && console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");
      var p = e + 1;

      for (var _i135 = 0; _i135 <= n; _i135++) {
        var _p10 = _i135 / n;

        for (var _n178 = 0; _n178 <= e; _n178++) {
          var _i136 = _n178 / e;

          t(_i136, _p10, c), r.push(c.x, c.y, c.z), _i136 - o >= 0 ? (t(_i136 - o, _p10, h), u.subVectors(c, h)) : (t(_i136 + o, _p10, h), u.subVectors(h, c)), _p10 - o >= 0 ? (t(_i136, _p10 - o, h), d.subVectors(c, h)) : (t(_i136, _p10 + o, h), d.subVectors(h, c)), l.crossVectors(u, d).normalize(), s.push(l.x, l.y, l.z), a.push(_i136, _p10);
        }
      }

      for (var _t209 = 0; _t209 < n; _t209++) {
        for (var _n179 = 0; _n179 < e; _n179++) {
          var _e186 = _t209 * p + _n179,
              _r117 = _t209 * p + _n179 + 1,
              _s55 = (_t209 + 1) * p + _n179 + 1,
              _a46 = (_t209 + 1) * p + _n179;

          i.push(_e186, _r117, _a46), i.push(_r117, _s55, _a46);
        }
      }

      _this65.setIndex(i), _this65.setAttribute("position", new un(r, 3)), _this65.setAttribute("normal", new un(s, 3)), _this65.setAttribute("uv", new un(a, 2));
      return _this65;
    }

    return vl;
  }(wn);

  var yl = /*#__PURE__*/function (_wn10) {
    _inherits(yl, _wn10);

    var _super77 = _createSuper(yl);

    function yl() {
      var _this66;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : .5;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 8;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;
      var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 2 * Math.PI;

      _classCallCheck(this, yl);

      _this66 = _super77.call(this), _this66.type = "RingGeometry", _this66.parameters = {
        innerRadius: t,
        outerRadius: e,
        thetaSegments: n,
        phiSegments: i,
        thetaStart: r,
        thetaLength: s
      }, n = Math.max(3, n);
      var a = [],
          o = [],
          l = [],
          c = [];
      var h = t;
      var u = (e - t) / (i = Math.max(1, i)),
          d = new Rt(),
          p = new vt();

      for (var _t210 = 0; _t210 <= i; _t210++) {
        for (var _t211 = 0; _t211 <= n; _t211++) {
          var _i137 = r + _t211 / n * s;

          d.x = h * Math.cos(_i137), d.y = h * Math.sin(_i137), o.push(d.x, d.y, d.z), l.push(0, 0, 1), p.x = (d.x / e + 1) / 2, p.y = (d.y / e + 1) / 2, c.push(p.x, p.y);
        }

        h += u;
      }

      for (var _t212 = 0; _t212 < i; _t212++) {
        var _e187 = _t212 * (n + 1);

        for (var _t213 = 0; _t213 < n; _t213++) {
          var _i138 = _t213 + _e187,
              _r118 = _i138,
              _s56 = _i138 + n + 1,
              _o27 = _i138 + n + 2,
              _l25 = _i138 + 1;

          a.push(_r118, _s56, _l25), a.push(_s56, _o27, _l25);
        }
      }

      _this66.setIndex(a), _this66.setAttribute("position", new un(o, 3)), _this66.setAttribute("normal", new un(l, 3)), _this66.setAttribute("uv", new un(c, 2));
      return _this66;
    }

    _createClass(yl, null, [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new yl(t.innerRadius, t.outerRadius, t.thetaSegments, t.phiSegments, t.thetaStart, t.thetaLength);
      }
    }]);

    return yl;
  }(wn);

  var xl = /*#__PURE__*/function (_wn11) {
    _inherits(xl, _wn11);

    var _super78 = _createSuper(xl);

    function xl(t) {
      var _this67;

      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 12;

      _classCallCheck(this, xl);

      _this67 = _super78.call(this), _this67.type = "ShapeGeometry", _this67.parameters = {
        shapes: t,
        curveSegments: e
      };
      var n = [],
          i = [],
          r = [],
          s = [];
      var a = 0,
          o = 0;
      if (!1 === Array.isArray(t)) l(t);else for (var _e188 = 0; _e188 < t.length; _e188++) {
        l(t[_e188]), _this67.addGroup(a, o, _e188), a += o, o = 0;
      }

      function l(t) {
        var a = i.length / 3,
            l = t.extractPoints(e);
        var c = l.shape;
        var h = l.holes;
        !1 === cl.isClockWise(c) && (c = c.reverse());

        for (var _t214 = 0, _e189 = h.length; _t214 < _e189; _t214++) {
          var _e190 = h[_t214];
          !0 === cl.isClockWise(_e190) && (h[_t214] = _e190.reverse());
        }

        var u = cl.triangulateShape(c, h);

        for (var _t215 = 0, _e191 = h.length; _t215 < _e191; _t215++) {
          var _e192 = h[_t215];
          c = c.concat(_e192);
        }

        for (var _t216 = 0, _e193 = c.length; _t216 < _e193; _t216++) {
          var _e194 = c[_t216];
          i.push(_e194.x, _e194.y, 0), r.push(0, 0, 1), s.push(_e194.x, _e194.y);
        }

        for (var _t217 = 0, _e195 = u.length; _t217 < _e195; _t217++) {
          var _e196 = u[_t217],
              _i139 = _e196[0] + a,
              _r119 = _e196[1] + a,
              _s57 = _e196[2] + a;

          n.push(_i139, _r119, _s57), o += 3;
        }
      }

      _this67.setIndex(n), _this67.setAttribute("position", new un(i, 3)), _this67.setAttribute("normal", new un(r, 3)), _this67.setAttribute("uv", new un(s, 2));
      return _this67;
    }

    _createClass(xl, [{
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(xl.prototype), "toJSON", this).call(this);

        return function (t, e) {
          if (e.shapes = [], Array.isArray(t)) for (var _n180 = 0, _i140 = t.length; _n180 < _i140; _n180++) {
            var _i141 = t[_n180];
            e.shapes.push(_i141.uuid);
          } else e.shapes.push(t.uuid);
          return e;
        }(this.parameters.shapes, t);
      }
    }], [{
      key: "fromJSON",
      value: function fromJSON(t, e) {
        var n = [];

        for (var _i142 = 0, _r120 = t.shapes.length; _i142 < _r120; _i142++) {
          var _r121 = e[t.shapes[_i142]];
          n.push(_r121);
        }

        return new xl(n, t.curveSegments);
      }
    }]);

    return xl;
  }(wn);

  var _l = /*#__PURE__*/function (_wn12) {
    _inherits(_l, _wn12);

    var _super79 = _createSuper(_l);

    function _l() {
      var _this68;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 32;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 16;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 2 * Math.PI;
      var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 0;
      var a = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : Math.PI;

      _classCallCheck(this, _l);

      _this68 = _super79.call(this), _this68.type = "SphereGeometry", _this68.parameters = {
        radius: t,
        widthSegments: e,
        heightSegments: n,
        phiStart: i,
        phiLength: r,
        thetaStart: s,
        thetaLength: a
      }, e = Math.max(3, Math.floor(e)), n = Math.max(2, Math.floor(n));
      var o = Math.min(s + a, Math.PI);
      var l = 0;
      var c = [],
          h = new Rt(),
          u = new Rt(),
          d = [],
          p = [],
          m = [],
          f = [];

      for (var _d14 = 0; _d14 <= n; _d14++) {
        var _g4 = [],
            _v4 = _d14 / n;

        var _y5 = 0;
        0 == _d14 && 0 == s ? _y5 = .5 / e : _d14 == n && o == Math.PI && (_y5 = -.5 / e);

        for (var _n181 = 0; _n181 <= e; _n181++) {
          var _o28 = _n181 / e;

          h.x = -t * Math.cos(i + _o28 * r) * Math.sin(s + _v4 * a), h.y = t * Math.cos(s + _v4 * a), h.z = t * Math.sin(i + _o28 * r) * Math.sin(s + _v4 * a), p.push(h.x, h.y, h.z), u.copy(h).normalize(), m.push(u.x, u.y, u.z), f.push(_o28 + _y5, 1 - _v4), _g4.push(l++);
        }

        c.push(_g4);
      }

      for (var _t218 = 0; _t218 < n; _t218++) {
        for (var _i143 = 0; _i143 < e; _i143++) {
          var _e197 = c[_t218][_i143 + 1],
              _r122 = c[_t218][_i143],
              _a47 = c[_t218 + 1][_i143],
              _l26 = c[_t218 + 1][_i143 + 1];
          (0 !== _t218 || s > 0) && d.push(_e197, _r122, _l26), (_t218 !== n - 1 || o < Math.PI) && d.push(_r122, _a47, _l26);
        }
      }

      _this68.setIndex(d), _this68.setAttribute("position", new un(p, 3)), _this68.setAttribute("normal", new un(m, 3)), _this68.setAttribute("uv", new un(f, 2));
      return _this68;
    }

    _createClass(_l, null, [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new _l(t.radius, t.widthSegments, t.heightSegments, t.phiStart, t.phiLength, t.thetaStart, t.thetaLength);
      }
    }]);

    return _l;
  }(wn);

  var Ml = /*#__PURE__*/function (_ho4) {
    _inherits(Ml, _ho4);

    var _super80 = _createSuper(Ml);

    function Ml() {
      var _this69;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;

      _classCallCheck(this, Ml);

      _this69 = _super80.call(this, [1, 1, 1, -1, -1, 1, -1, 1, -1, 1, -1, -1], [2, 1, 0, 0, 3, 2, 1, 3, 0, 2, 3, 1], t, e), _this69.type = "TetrahedronGeometry", _this69.parameters = {
        radius: t,
        detail: e
      };
      return _this69;
    }

    _createClass(Ml, null, [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new Ml(t.radius, t.detail);
      }
    }]);

    return Ml;
  }(ho);

  var bl = /*#__PURE__*/function (_dl) {
    _inherits(bl, _dl);

    var _super81 = _createSuper(bl);

    function bl(t) {
      var _this70;

      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

      _classCallCheck(this, bl);

      var n = e.font;
      if (!n || !n.isFont) return _possibleConstructorReturn(_this70, (console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."), new wn()));
      var i = n.generateShapes(t, e.size);
      e.depth = void 0 !== e.height ? e.height : 50, void 0 === e.bevelThickness && (e.bevelThickness = 10), void 0 === e.bevelSize && (e.bevelSize = 8), void 0 === e.bevelEnabled && (e.bevelEnabled = !1), _this70 = _super81.call(this, i, e), _this70.type = "TextGeometry";
      return _this70;
    }

    return bl;
  }(dl);

  var wl = /*#__PURE__*/function (_wn13) {
    _inherits(wl, _wn13);

    var _super82 = _createSuper(wl);

    function wl() {
      var _this71;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : .4;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 8;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 6;
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 2 * Math.PI;

      _classCallCheck(this, wl);

      _this71 = _super82.call(this), _this71.type = "TorusGeometry", _this71.parameters = {
        radius: t,
        tube: e,
        radialSegments: n,
        tubularSegments: i,
        arc: r
      }, n = Math.floor(n), i = Math.floor(i);
      var s = [],
          a = [],
          o = [],
          l = [],
          c = new Rt(),
          h = new Rt(),
          u = new Rt();

      for (var _s58 = 0; _s58 <= n; _s58++) {
        for (var _d15 = 0; _d15 <= i; _d15++) {
          var _p11 = _d15 / i * r,
              _m7 = _s58 / n * Math.PI * 2;

          h.x = (t + e * Math.cos(_m7)) * Math.cos(_p11), h.y = (t + e * Math.cos(_m7)) * Math.sin(_p11), h.z = e * Math.sin(_m7), a.push(h.x, h.y, h.z), c.x = t * Math.cos(_p11), c.y = t * Math.sin(_p11), u.subVectors(h, c).normalize(), o.push(u.x, u.y, u.z), l.push(_d15 / i), l.push(_s58 / n);
        }
      }

      for (var _t219 = 1; _t219 <= n; _t219++) {
        for (var _e198 = 1; _e198 <= i; _e198++) {
          var _n182 = (i + 1) * _t219 + _e198 - 1,
              _r123 = (i + 1) * (_t219 - 1) + _e198 - 1,
              _a48 = (i + 1) * (_t219 - 1) + _e198,
              _o29 = (i + 1) * _t219 + _e198;

          s.push(_n182, _r123, _o29), s.push(_r123, _a48, _o29);
        }
      }

      _this71.setIndex(s), _this71.setAttribute("position", new un(a, 3)), _this71.setAttribute("normal", new un(o, 3)), _this71.setAttribute("uv", new un(l, 2));
      return _this71;
    }

    _createClass(wl, null, [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new wl(t.radius, t.tube, t.radialSegments, t.tubularSegments, t.arc);
      }
    }]);

    return wl;
  }(wn);

  var Sl = /*#__PURE__*/function (_wn14) {
    _inherits(Sl, _wn14);

    var _super83 = _createSuper(Sl);

    function Sl() {
      var _this72;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : .4;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 64;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 8;
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 2;
      var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 3;

      _classCallCheck(this, Sl);

      _this72 = _super83.call(this), _this72.type = "TorusKnotGeometry", _this72.parameters = {
        radius: t,
        tube: e,
        tubularSegments: n,
        radialSegments: i,
        p: r,
        q: s
      }, n = Math.floor(n), i = Math.floor(i);
      var a = [],
          o = [],
          l = [],
          c = [],
          h = new Rt(),
          u = new Rt(),
          d = new Rt(),
          p = new Rt(),
          m = new Rt(),
          f = new Rt(),
          g = new Rt();

      for (var _a49 = 0; _a49 <= n; ++_a49) {
        var _y6 = _a49 / n * r * Math.PI * 2;

        v(_y6, r, s, t, d), v(_y6 + .01, r, s, t, p), f.subVectors(p, d), g.addVectors(p, d), m.crossVectors(f, g), g.crossVectors(m, f), m.normalize(), g.normalize();

        for (var _t220 = 0; _t220 <= i; ++_t220) {
          var _r124 = _t220 / i * Math.PI * 2,
              _s59 = -e * Math.cos(_r124),
              _p12 = e * Math.sin(_r124);

          h.x = d.x + (_s59 * g.x + _p12 * m.x), h.y = d.y + (_s59 * g.y + _p12 * m.y), h.z = d.z + (_s59 * g.z + _p12 * m.z), o.push(h.x, h.y, h.z), u.subVectors(h, d).normalize(), l.push(u.x, u.y, u.z), c.push(_a49 / n), c.push(_t220 / i);
        }
      }

      for (var _t221 = 1; _t221 <= n; _t221++) {
        for (var _e199 = 1; _e199 <= i; _e199++) {
          var _n183 = (i + 1) * (_t221 - 1) + (_e199 - 1),
              _r125 = (i + 1) * _t221 + (_e199 - 1),
              _s60 = (i + 1) * _t221 + _e199,
              _o30 = (i + 1) * (_t221 - 1) + _e199;

          a.push(_n183, _r125, _o30), a.push(_r125, _s60, _o30);
        }
      }

      function v(t, e, n, i, r) {
        var s = Math.cos(t),
            a = Math.sin(t),
            o = n / e * t,
            l = Math.cos(o);
        r.x = i * (2 + l) * .5 * s, r.y = i * (2 + l) * a * .5, r.z = i * Math.sin(o) * .5;
      }

      _this72.setIndex(a), _this72.setAttribute("position", new un(o, 3)), _this72.setAttribute("normal", new un(l, 3)), _this72.setAttribute("uv", new un(c, 2));
      return _this72;
    }

    _createClass(Sl, null, [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new Sl(t.radius, t.tube, t.tubularSegments, t.radialSegments, t.p, t.q);
      }
    }]);

    return Sl;
  }(wn);

  var Tl = /*#__PURE__*/function (_wn15) {
    _inherits(Tl, _wn15);

    var _super84 = _createSuper(Tl);

    function Tl(t) {
      var _this73;

      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 64;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 8;
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : !1;

      _classCallCheck(this, Tl);

      _this73 = _super84.call(this), _this73.type = "TubeGeometry", _this73.parameters = {
        path: t,
        tubularSegments: e,
        radius: n,
        radialSegments: i,
        closed: r
      };
      var s = t.computeFrenetFrames(e, r);
      _this73.tangents = s.tangents, _this73.normals = s.normals, _this73.binormals = s.binormals;
      var a = new Rt(),
          o = new Rt(),
          l = new vt();
      var c = new Rt();
      var h = [],
          u = [],
          d = [],
          p = [];

      function m(r) {
        c = t.getPointAt(r / e, c);
        var l = s.normals[r],
            d = s.binormals[r];

        for (var _t222 = 0; _t222 <= i; _t222++) {
          var _e200 = _t222 / i * Math.PI * 2,
              _r126 = Math.sin(_e200),
              _s61 = -Math.cos(_e200);

          o.x = _s61 * l.x + _r126 * d.x, o.y = _s61 * l.y + _r126 * d.y, o.z = _s61 * l.z + _r126 * d.z, o.normalize(), u.push(o.x, o.y, o.z), a.x = c.x + n * o.x, a.y = c.y + n * o.y, a.z = c.z + n * o.z, h.push(a.x, a.y, a.z);
        }
      }

      !function () {
        for (var _t223 = 0; _t223 < e; _t223++) {
          m(_t223);
        }

        m(!1 === r ? e : 0), function () {
          for (var _t224 = 0; _t224 <= e; _t224++) {
            for (var _n184 = 0; _n184 <= i; _n184++) {
              l.x = _t224 / e, l.y = _n184 / i, d.push(l.x, l.y);
            }
          }
        }(), function () {
          for (var _t225 = 1; _t225 <= e; _t225++) {
            for (var _e201 = 1; _e201 <= i; _e201++) {
              var _n185 = (i + 1) * (_t225 - 1) + (_e201 - 1),
                  _r127 = (i + 1) * _t225 + (_e201 - 1),
                  _s62 = (i + 1) * _t225 + _e201,
                  _a50 = (i + 1) * (_t225 - 1) + _e201;

              p.push(_n185, _r127, _a50), p.push(_r127, _s62, _a50);
            }
          }
        }();
      }(), _this73.setIndex(p), _this73.setAttribute("position", new un(h, 3)), _this73.setAttribute("normal", new un(u, 3)), _this73.setAttribute("uv", new un(d, 2));
      return _this73;
    }

    _createClass(Tl, [{
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(Tl.prototype), "toJSON", this).call(this);

        return t.path = this.parameters.path.toJSON(), t;
      }
    }], [{
      key: "fromJSON",
      value: function fromJSON(t) {
        return new Tl(new Fo[t.path.type]().fromJSON(t.path), t.tubularSegments, t.radius, t.radialSegments, t.closed);
      }
    }]);

    return Tl;
  }(wn);

  var El = /*#__PURE__*/function (_wn16) {
    _inherits(El, _wn16);

    var _super85 = _createSuper(El);

    function El(t) {
      var _this74;

      _classCallCheck(this, El);

      if (_this74 = _super85.call(this), _this74.type = "WireframeGeometry", !0 === t.isGeometry) return _possibleConstructorReturn(_this74, void console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."));
      var e = [],
          n = new Set(),
          i = new Rt(),
          r = new Rt();

      if (null !== t.index) {
        var _s63 = t.attributes.position,
            _a51 = t.index;
        var _o31 = t.groups;
        0 === _o31.length && (_o31 = [{
          start: 0,
          count: _a51.count,
          materialIndex: 0
        }]);

        for (var _t226 = 0, _l27 = _o31.length; _t226 < _l27; ++_t226) {
          var _l28 = _o31[_t226],
              _c20 = _l28.start;

          for (var _t227 = _c20, _o32 = _c20 + _l28.count; _t227 < _o32; _t227 += 3) {
            for (var _o33 = 0; _o33 < 3; _o33++) {
              var _l29 = _a51.getX(_t227 + _o33),
                  _c21 = _a51.getX(_t227 + (_o33 + 1) % 3);

              i.fromBufferAttribute(_s63, _l29), r.fromBufferAttribute(_s63, _c21), !0 === Al(i, r, n) && (e.push(i.x, i.y, i.z), e.push(r.x, r.y, r.z));
            }
          }
        }
      } else {
        var _s64 = t.attributes.position;

        for (var _t228 = 0, _a52 = _s64.count / 3; _t228 < _a52; _t228++) {
          for (var _a53 = 0; _a53 < 3; _a53++) {
            var _o34 = 3 * _t228 + _a53,
                _l30 = 3 * _t228 + (_a53 + 1) % 3;

            i.fromBufferAttribute(_s64, _o34), r.fromBufferAttribute(_s64, _l30), !0 === Al(i, r, n) && (e.push(i.x, i.y, i.z), e.push(r.x, r.y, r.z));
          }
        }
      }

      _this74.setAttribute("position", new un(e, 3));

      return _possibleConstructorReturn(_this74);
    }

    return El;
  }(wn);

  function Al(t, e, n) {
    var i = "".concat(t.x, ",").concat(t.y, ",").concat(t.z, "-").concat(e.x, ",").concat(e.y, ",").concat(e.z),
        r = "".concat(e.x, ",").concat(e.y, ",").concat(e.z, "-").concat(t.x, ",").concat(t.y, ",").concat(t.z);
    return !0 !== n.has(i) && !0 !== n.has(r) && (n.add(i, r), !0);
  }

  var Ll = Object.freeze({
    __proto__: null,
    BoxGeometry: Vn,
    BoxBufferGeometry: Vn,
    CircleGeometry: oo,
    CircleBufferGeometry: oo,
    ConeGeometry: co,
    ConeBufferGeometry: co,
    CylinderGeometry: lo,
    CylinderBufferGeometry: lo,
    DodecahedronGeometry: uo,
    DodecahedronBufferGeometry: uo,
    EdgesGeometry: vo,
    ExtrudeGeometry: dl,
    ExtrudeBufferGeometry: dl,
    IcosahedronGeometry: ml,
    IcosahedronBufferGeometry: ml,
    LatheGeometry: fl,
    LatheBufferGeometry: fl,
    OctahedronGeometry: gl,
    OctahedronBufferGeometry: gl,
    ParametricGeometry: vl,
    ParametricBufferGeometry: vl,
    PlaneGeometry: ci,
    PlaneBufferGeometry: ci,
    PolyhedronGeometry: ho,
    PolyhedronBufferGeometry: ho,
    RingGeometry: yl,
    RingBufferGeometry: yl,
    ShapeGeometry: xl,
    ShapeBufferGeometry: xl,
    SphereGeometry: _l,
    SphereBufferGeometry: _l,
    TetrahedronGeometry: Ml,
    TetrahedronBufferGeometry: Ml,
    TextGeometry: bl,
    TextBufferGeometry: bl,
    TorusGeometry: wl,
    TorusBufferGeometry: wl,
    TorusKnotGeometry: Sl,
    TorusKnotBufferGeometry: Sl,
    TubeGeometry: Tl,
    TubeBufferGeometry: Tl,
    WireframeGeometry: El
  });

  var Rl = /*#__PURE__*/function (_We8) {
    _inherits(Rl, _We8);

    var _super86 = _createSuper(Rl);

    function Rl(t) {
      var _this75;

      _classCallCheck(this, Rl);

      _this75 = _super86.call(this), _this75.type = "ShadowMaterial", _this75.color = new Qe(0), _this75.transparent = !0, _this75.setValues(t);
      return _this75;
    }

    _createClass(Rl, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Rl.prototype), "copy", this).call(this, t), this.color.copy(t.color), this;
      }
    }]);

    return Rl;
  }(We);

  Rl.prototype.isShadowMaterial = !0;

  var Cl = /*#__PURE__*/function (_We9) {
    _inherits(Cl, _We9);

    var _super87 = _createSuper(Cl);

    function Cl(t) {
      var _this76;

      _classCallCheck(this, Cl);

      _this76 = _super87.call(this), _this76.defines = {
        STANDARD: ""
      }, _this76.type = "MeshStandardMaterial", _this76.color = new Qe(16777215), _this76.roughness = 1, _this76.metalness = 0, _this76.map = null, _this76.lightMap = null, _this76.lightMapIntensity = 1, _this76.aoMap = null, _this76.aoMapIntensity = 1, _this76.emissive = new Qe(0), _this76.emissiveIntensity = 1, _this76.emissiveMap = null, _this76.bumpMap = null, _this76.bumpScale = 1, _this76.normalMap = null, _this76.normalMapType = 0, _this76.normalScale = new vt(1, 1), _this76.displacementMap = null, _this76.displacementScale = 1, _this76.displacementBias = 0, _this76.roughnessMap = null, _this76.metalnessMap = null, _this76.alphaMap = null, _this76.envMap = null, _this76.envMapIntensity = 1, _this76.refractionRatio = .98, _this76.wireframe = !1, _this76.wireframeLinewidth = 1, _this76.wireframeLinecap = "round", _this76.wireframeLinejoin = "round", _this76.flatShading = !1, _this76.setValues(t);
      return _this76;
    }

    _createClass(Cl, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Cl.prototype), "copy", this).call(this, t), this.defines = {
          STANDARD: ""
        }, this.color.copy(t.color), this.roughness = t.roughness, this.metalness = t.metalness, this.map = t.map, this.lightMap = t.lightMap, this.lightMapIntensity = t.lightMapIntensity, this.aoMap = t.aoMap, this.aoMapIntensity = t.aoMapIntensity, this.emissive.copy(t.emissive), this.emissiveMap = t.emissiveMap, this.emissiveIntensity = t.emissiveIntensity, this.bumpMap = t.bumpMap, this.bumpScale = t.bumpScale, this.normalMap = t.normalMap, this.normalMapType = t.normalMapType, this.normalScale.copy(t.normalScale), this.displacementMap = t.displacementMap, this.displacementScale = t.displacementScale, this.displacementBias = t.displacementBias, this.roughnessMap = t.roughnessMap, this.metalnessMap = t.metalnessMap, this.alphaMap = t.alphaMap, this.envMap = t.envMap, this.envMapIntensity = t.envMapIntensity, this.refractionRatio = t.refractionRatio, this.wireframe = t.wireframe, this.wireframeLinewidth = t.wireframeLinewidth, this.wireframeLinecap = t.wireframeLinecap, this.wireframeLinejoin = t.wireframeLinejoin, this.flatShading = t.flatShading, this;
      }
    }]);

    return Cl;
  }(We);

  Cl.prototype.isMeshStandardMaterial = !0;

  var Pl = /*#__PURE__*/function (_Cl) {
    _inherits(Pl, _Cl);

    var _super88 = _createSuper(Pl);

    function Pl(t) {
      var _this77;

      _classCallCheck(this, Pl);

      _this77 = _super88.call(this), _this77.defines = {
        STANDARD: "",
        PHYSICAL: ""
      }, _this77.type = "MeshPhysicalMaterial", _this77.clearcoat = 0, _this77.clearcoatMap = null, _this77.clearcoatRoughness = 0, _this77.clearcoatRoughnessMap = null, _this77.clearcoatNormalScale = new vt(1, 1), _this77.clearcoatNormalMap = null, _this77.reflectivity = .5, Object.defineProperty(_assertThisInitialized(_this77), "ior", {
        get: function get() {
          return (1 + .4 * this.reflectivity) / (1 - .4 * this.reflectivity);
        },
        set: function set(t) {
          this.reflectivity = ht(2.5 * (t - 1) / (t + 1), 0, 1);
        }
      }), _this77.sheen = null, _this77.transmission = 0, _this77.transmissionMap = null, _this77.thickness = .01, _this77.thicknessMap = null, _this77.attenuationDistance = 0, _this77.attenuationTint = new Qe(1, 1, 1), _this77.specularIntensity = 1, _this77.specularIntensityMap = null, _this77.specularTint = new Qe(1, 1, 1), _this77.specularTintMap = null, _this77.setValues(t);
      return _this77;
    }

    _createClass(Pl, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Pl.prototype), "copy", this).call(this, t), this.defines = {
          STANDARD: "",
          PHYSICAL: ""
        }, this.clearcoat = t.clearcoat, this.clearcoatMap = t.clearcoatMap, this.clearcoatRoughness = t.clearcoatRoughness, this.clearcoatRoughnessMap = t.clearcoatRoughnessMap, this.clearcoatNormalMap = t.clearcoatNormalMap, this.clearcoatNormalScale.copy(t.clearcoatNormalScale), this.reflectivity = t.reflectivity, t.sheen ? this.sheen = (this.sheen || new Qe()).copy(t.sheen) : this.sheen = null, this.transmission = t.transmission, this.transmissionMap = t.transmissionMap, this.thickness = t.thickness, this.thicknessMap = t.thicknessMap, this.attenuationDistance = t.attenuationDistance, this.attenuationTint.copy(t.attenuationTint), this.specularIntensity = t.specularIntensity, this.specularIntensityMap = t.specularIntensityMap, this.specularTint.copy(t.specularTint), this.specularTintMap = t.specularTintMap, this;
      }
    }]);

    return Pl;
  }(Cl);

  Pl.prototype.isMeshPhysicalMaterial = !0;

  var Il = /*#__PURE__*/function (_We10) {
    _inherits(Il, _We10);

    var _super89 = _createSuper(Il);

    function Il(t) {
      var _this78;

      _classCallCheck(this, Il);

      _this78 = _super89.call(this), _this78.type = "MeshPhongMaterial", _this78.color = new Qe(16777215), _this78.specular = new Qe(1118481), _this78.shininess = 30, _this78.map = null, _this78.lightMap = null, _this78.lightMapIntensity = 1, _this78.aoMap = null, _this78.aoMapIntensity = 1, _this78.emissive = new Qe(0), _this78.emissiveIntensity = 1, _this78.emissiveMap = null, _this78.bumpMap = null, _this78.bumpScale = 1, _this78.normalMap = null, _this78.normalMapType = 0, _this78.normalScale = new vt(1, 1), _this78.displacementMap = null, _this78.displacementScale = 1, _this78.displacementBias = 0, _this78.specularMap = null, _this78.alphaMap = null, _this78.envMap = null, _this78.combine = 0, _this78.reflectivity = 1, _this78.refractionRatio = .98, _this78.wireframe = !1, _this78.wireframeLinewidth = 1, _this78.wireframeLinecap = "round", _this78.wireframeLinejoin = "round", _this78.flatShading = !1, _this78.setValues(t);
      return _this78;
    }

    _createClass(Il, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Il.prototype), "copy", this).call(this, t), this.color.copy(t.color), this.specular.copy(t.specular), this.shininess = t.shininess, this.map = t.map, this.lightMap = t.lightMap, this.lightMapIntensity = t.lightMapIntensity, this.aoMap = t.aoMap, this.aoMapIntensity = t.aoMapIntensity, this.emissive.copy(t.emissive), this.emissiveMap = t.emissiveMap, this.emissiveIntensity = t.emissiveIntensity, this.bumpMap = t.bumpMap, this.bumpScale = t.bumpScale, this.normalMap = t.normalMap, this.normalMapType = t.normalMapType, this.normalScale.copy(t.normalScale), this.displacementMap = t.displacementMap, this.displacementScale = t.displacementScale, this.displacementBias = t.displacementBias, this.specularMap = t.specularMap, this.alphaMap = t.alphaMap, this.envMap = t.envMap, this.combine = t.combine, this.reflectivity = t.reflectivity, this.refractionRatio = t.refractionRatio, this.wireframe = t.wireframe, this.wireframeLinewidth = t.wireframeLinewidth, this.wireframeLinecap = t.wireframeLinecap, this.wireframeLinejoin = t.wireframeLinejoin, this.flatShading = t.flatShading, this;
      }
    }]);

    return Il;
  }(We);

  Il.prototype.isMeshPhongMaterial = !0;

  var Dl = /*#__PURE__*/function (_We11) {
    _inherits(Dl, _We11);

    var _super90 = _createSuper(Dl);

    function Dl(t) {
      var _this79;

      _classCallCheck(this, Dl);

      _this79 = _super90.call(this), _this79.defines = {
        TOON: ""
      }, _this79.type = "MeshToonMaterial", _this79.color = new Qe(16777215), _this79.map = null, _this79.gradientMap = null, _this79.lightMap = null, _this79.lightMapIntensity = 1, _this79.aoMap = null, _this79.aoMapIntensity = 1, _this79.emissive = new Qe(0), _this79.emissiveIntensity = 1, _this79.emissiveMap = null, _this79.bumpMap = null, _this79.bumpScale = 1, _this79.normalMap = null, _this79.normalMapType = 0, _this79.normalScale = new vt(1, 1), _this79.displacementMap = null, _this79.displacementScale = 1, _this79.displacementBias = 0, _this79.alphaMap = null, _this79.wireframe = !1, _this79.wireframeLinewidth = 1, _this79.wireframeLinecap = "round", _this79.wireframeLinejoin = "round", _this79.setValues(t);
      return _this79;
    }

    _createClass(Dl, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Dl.prototype), "copy", this).call(this, t), this.color.copy(t.color), this.map = t.map, this.gradientMap = t.gradientMap, this.lightMap = t.lightMap, this.lightMapIntensity = t.lightMapIntensity, this.aoMap = t.aoMap, this.aoMapIntensity = t.aoMapIntensity, this.emissive.copy(t.emissive), this.emissiveMap = t.emissiveMap, this.emissiveIntensity = t.emissiveIntensity, this.bumpMap = t.bumpMap, this.bumpScale = t.bumpScale, this.normalMap = t.normalMap, this.normalMapType = t.normalMapType, this.normalScale.copy(t.normalScale), this.displacementMap = t.displacementMap, this.displacementScale = t.displacementScale, this.displacementBias = t.displacementBias, this.alphaMap = t.alphaMap, this.wireframe = t.wireframe, this.wireframeLinewidth = t.wireframeLinewidth, this.wireframeLinecap = t.wireframeLinecap, this.wireframeLinejoin = t.wireframeLinejoin, this;
      }
    }]);

    return Dl;
  }(We);

  Dl.prototype.isMeshToonMaterial = !0;

  var Nl = /*#__PURE__*/function (_We12) {
    _inherits(Nl, _We12);

    var _super91 = _createSuper(Nl);

    function Nl(t) {
      var _this80;

      _classCallCheck(this, Nl);

      _this80 = _super91.call(this), _this80.type = "MeshNormalMaterial", _this80.bumpMap = null, _this80.bumpScale = 1, _this80.normalMap = null, _this80.normalMapType = 0, _this80.normalScale = new vt(1, 1), _this80.displacementMap = null, _this80.displacementScale = 1, _this80.displacementBias = 0, _this80.wireframe = !1, _this80.wireframeLinewidth = 1, _this80.fog = !1, _this80.flatShading = !1, _this80.setValues(t);
      return _this80;
    }

    _createClass(Nl, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Nl.prototype), "copy", this).call(this, t), this.bumpMap = t.bumpMap, this.bumpScale = t.bumpScale, this.normalMap = t.normalMap, this.normalMapType = t.normalMapType, this.normalScale.copy(t.normalScale), this.displacementMap = t.displacementMap, this.displacementScale = t.displacementScale, this.displacementBias = t.displacementBias, this.wireframe = t.wireframe, this.wireframeLinewidth = t.wireframeLinewidth, this.flatShading = t.flatShading, this;
      }
    }]);

    return Nl;
  }(We);

  Nl.prototype.isMeshNormalMaterial = !0;

  var Bl = /*#__PURE__*/function (_We13) {
    _inherits(Bl, _We13);

    var _super92 = _createSuper(Bl);

    function Bl(t) {
      var _this81;

      _classCallCheck(this, Bl);

      _this81 = _super92.call(this), _this81.type = "MeshLambertMaterial", _this81.color = new Qe(16777215), _this81.map = null, _this81.lightMap = null, _this81.lightMapIntensity = 1, _this81.aoMap = null, _this81.aoMapIntensity = 1, _this81.emissive = new Qe(0), _this81.emissiveIntensity = 1, _this81.emissiveMap = null, _this81.specularMap = null, _this81.alphaMap = null, _this81.envMap = null, _this81.combine = 0, _this81.reflectivity = 1, _this81.refractionRatio = .98, _this81.wireframe = !1, _this81.wireframeLinewidth = 1, _this81.wireframeLinecap = "round", _this81.wireframeLinejoin = "round", _this81.setValues(t);
      return _this81;
    }

    _createClass(Bl, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Bl.prototype), "copy", this).call(this, t), this.color.copy(t.color), this.map = t.map, this.lightMap = t.lightMap, this.lightMapIntensity = t.lightMapIntensity, this.aoMap = t.aoMap, this.aoMapIntensity = t.aoMapIntensity, this.emissive.copy(t.emissive), this.emissiveMap = t.emissiveMap, this.emissiveIntensity = t.emissiveIntensity, this.specularMap = t.specularMap, this.alphaMap = t.alphaMap, this.envMap = t.envMap, this.combine = t.combine, this.reflectivity = t.reflectivity, this.refractionRatio = t.refractionRatio, this.wireframe = t.wireframe, this.wireframeLinewidth = t.wireframeLinewidth, this.wireframeLinecap = t.wireframeLinecap, this.wireframeLinejoin = t.wireframeLinejoin, this;
      }
    }]);

    return Bl;
  }(We);

  Bl.prototype.isMeshLambertMaterial = !0;

  var zl = /*#__PURE__*/function (_We14) {
    _inherits(zl, _We14);

    var _super93 = _createSuper(zl);

    function zl(t) {
      var _this82;

      _classCallCheck(this, zl);

      _this82 = _super93.call(this), _this82.defines = {
        MATCAP: ""
      }, _this82.type = "MeshMatcapMaterial", _this82.color = new Qe(16777215), _this82.matcap = null, _this82.map = null, _this82.bumpMap = null, _this82.bumpScale = 1, _this82.normalMap = null, _this82.normalMapType = 0, _this82.normalScale = new vt(1, 1), _this82.displacementMap = null, _this82.displacementScale = 1, _this82.displacementBias = 0, _this82.alphaMap = null, _this82.flatShading = !1, _this82.setValues(t);
      return _this82;
    }

    _createClass(zl, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(zl.prototype), "copy", this).call(this, t), this.defines = {
          MATCAP: ""
        }, this.color.copy(t.color), this.matcap = t.matcap, this.map = t.map, this.bumpMap = t.bumpMap, this.bumpScale = t.bumpScale, this.normalMap = t.normalMap, this.normalMapType = t.normalMapType, this.normalScale.copy(t.normalScale), this.displacementMap = t.displacementMap, this.displacementScale = t.displacementScale, this.displacementBias = t.displacementBias, this.alphaMap = t.alphaMap, this.flatShading = t.flatShading, this;
      }
    }]);

    return zl;
  }(We);

  zl.prototype.isMeshMatcapMaterial = !0;

  var Fl = /*#__PURE__*/function (_Ua) {
    _inherits(Fl, _Ua);

    var _super94 = _createSuper(Fl);

    function Fl(t) {
      var _this83;

      _classCallCheck(this, Fl);

      _this83 = _super94.call(this), _this83.type = "LineDashedMaterial", _this83.scale = 1, _this83.dashSize = 3, _this83.gapSize = 1, _this83.setValues(t);
      return _this83;
    }

    _createClass(Fl, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Fl.prototype), "copy", this).call(this, t), this.scale = t.scale, this.dashSize = t.dashSize, this.gapSize = t.gapSize, this;
      }
    }]);

    return Fl;
  }(Ua);

  Fl.prototype.isLineDashedMaterial = !0;
  var Ol = Object.freeze({
    __proto__: null,
    ShadowMaterial: Rl,
    SpriteMaterial: ra,
    RawShaderMaterial: _i,
    ShaderMaterial: Xn,
    PointsMaterial: Za,
    MeshPhysicalMaterial: Pl,
    MeshStandardMaterial: Cl,
    MeshPhongMaterial: Il,
    MeshToonMaterial: Dl,
    MeshNormalMaterial: Nl,
    MeshLambertMaterial: Bl,
    MeshDepthMaterial: Os,
    MeshDistanceMaterial: Us,
    MeshBasicMaterial: Ke,
    MeshMatcapMaterial: zl,
    LineDashedMaterial: Fl,
    LineBasicMaterial: Ua,
    Material: We
  });
  var Ul = {
    arraySlice: function arraySlice(t, e, n) {
      return Ul.isTypedArray(t) ? new t.constructor(t.subarray(e, void 0 !== n ? n : t.length)) : t.slice(e, n);
    },
    convertArray: function convertArray(t, e, n) {
      return !t || !n && t.constructor === e ? t : "number" == typeof e.BYTES_PER_ELEMENT ? new e(t) : Array.prototype.slice.call(t);
    },
    isTypedArray: function isTypedArray(t) {
      return ArrayBuffer.isView(t) && !(t instanceof DataView);
    },
    getKeyframeOrder: function getKeyframeOrder(t) {
      var e = t.length,
          n = new Array(e);

      for (var _t229 = 0; _t229 !== e; ++_t229) {
        n[_t229] = _t229;
      }

      return n.sort(function (e, n) {
        return t[e] - t[n];
      }), n;
    },
    sortedArray: function sortedArray(t, e, n) {
      var i = t.length,
          r = new t.constructor(i);

      for (var _s65 = 0, _a54 = 0; _a54 !== i; ++_s65) {
        var _i144 = n[_s65] * e;

        for (var _n186 = 0; _n186 !== e; ++_n186) {
          r[_a54++] = t[_i144 + _n186];
        }
      }

      return r;
    },
    flattenJSON: function flattenJSON(t, e, n, i) {
      var r = 1,
          s = t[0];

      for (; void 0 !== s && void 0 === s[i];) {
        s = t[r++];
      }

      if (void 0 === s) return;
      var a = s[i];
      if (void 0 !== a) if (Array.isArray(a)) do {
        a = s[i], void 0 !== a && (e.push(s.time), n.push.apply(n, a)), s = t[r++];
      } while (void 0 !== s);else if (void 0 !== a.toArray) do {
        a = s[i], void 0 !== a && (e.push(s.time), a.toArray(n, n.length)), s = t[r++];
      } while (void 0 !== s);else do {
        a = s[i], void 0 !== a && (e.push(s.time), n.push(a)), s = t[r++];
      } while (void 0 !== s);
    },
    subclip: function subclip(t, e, n, i) {
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 30;
      var s = t.clone();
      s.name = e;
      var a = [];

      for (var _t230 = 0; _t230 < s.tracks.length; ++_t230) {
        var _e202 = s.tracks[_t230],
            _o35 = _e202.getValueSize(),
            _l31 = [],
            _c22 = [];

        for (var _t231 = 0; _t231 < _e202.times.length; ++_t231) {
          var _s66 = _e202.times[_t231] * r;

          if (!(_s66 < n || _s66 >= i)) {
            _l31.push(_e202.times[_t231]);

            for (var _n187 = 0; _n187 < _o35; ++_n187) {
              _c22.push(_e202.values[_t231 * _o35 + _n187]);
            }
          }
        }

        0 !== _l31.length && (_e202.times = Ul.convertArray(_l31, _e202.times.constructor), _e202.values = Ul.convertArray(_c22, _e202.values.constructor), a.push(_e202));
      }

      s.tracks = a;
      var o = 1 / 0;

      for (var _t232 = 0; _t232 < s.tracks.length; ++_t232) {
        o > s.tracks[_t232].times[0] && (o = s.tracks[_t232].times[0]);
      }

      for (var _t233 = 0; _t233 < s.tracks.length; ++_t233) {
        s.tracks[_t233].shift(-1 * o);
      }

      return s.resetDuration(), s;
    },
    makeClipAdditive: function makeClipAdditive(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : t;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 30;
      i <= 0 && (i = 30);
      var r = n.tracks.length,
          s = e / i;

      var _loop = function _loop(_e203) {
        var i = n.tracks[_e203],
            r = i.ValueTypeName;
        if ("bool" === r || "string" === r) return "continue";
        var a = t.tracks.find(function (t) {
          return t.name === i.name && t.ValueTypeName === r;
        });
        if (void 0 === a) return "continue";
        var o = 0;
        var l = i.getValueSize();
        i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline && (o = l / 3);
        var c = 0;
        var h = a.getValueSize();
        a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline && (c = h / 3);
        var u = i.times.length - 1;
        var d = void 0;

        if (s <= i.times[0]) {
          var _t234 = o,
              _e204 = l - o;

          d = Ul.arraySlice(i.values, _t234, _e204);
        } else if (s >= i.times[u]) {
          var _t235 = u * l + o,
              _e205 = _t235 + l - o;

          d = Ul.arraySlice(i.values, _t235, _e205);
        } else {
          var _t236 = i.createInterpolant(),
              _e206 = o,
              _n188 = l - o;

          _t236.evaluate(s), d = Ul.arraySlice(_t236.resultBuffer, _e206, _n188);
        }

        if ("quaternion" === r) {
          new Lt().fromArray(d).normalize().conjugate().toArray(d);
        }

        var p = a.times.length;

        for (var _t237 = 0; _t237 < p; ++_t237) {
          var _e207 = _t237 * h + c;

          if ("quaternion" === r) Lt.multiplyQuaternionsFlat(a.values, _e207, d, 0, a.values, _e207);else {
            var _t238 = h - 2 * c;

            for (var _n189 = 0; _n189 < _t238; ++_n189) {
              a.values[_e207 + _n189] -= d[_n189];
            }
          }
        }
      };

      for (var _e203 = 0; _e203 < r; ++_e203) {
        var _ret = _loop(_e203);

        if (_ret === "continue") continue;
      }

      return t.blendMode = q, t;
    }
  };

  var Hl = /*#__PURE__*/function () {
    function Hl(t, e, n, i) {
      _classCallCheck(this, Hl);

      this.parameterPositions = t, this._cachedIndex = 0, this.resultBuffer = void 0 !== i ? i : new e.constructor(n), this.sampleValues = e, this.valueSize = n, this.settings = null, this.DefaultSettings_ = {};
    }

    _createClass(Hl, [{
      key: "evaluate",
      value: function evaluate(t) {
        var e = this.parameterPositions;
        var n = this._cachedIndex,
            i = e[n],
            r = e[n - 1];

        t: {
          e: {
            var _s67;

            n: {
              i: if (!(t < i)) {
                for (var _s68 = n + 2;;) {
                  if (void 0 === i) {
                    if (t < r) break i;
                    return n = e.length, this._cachedIndex = n, this.afterEnd_(n - 1, t, r);
                  }

                  if (n === _s68) break;
                  if (r = i, i = e[++n], t < i) break e;
                }

                _s67 = e.length;
                break n;
              }

              if (t >= r) break t;
              {
                var _a55 = e[1];
                t < _a55 && (n = 2, r = _a55);

                for (var _s69 = n - 2;;) {
                  if (void 0 === r) return this._cachedIndex = 0, this.beforeStart_(0, t, i);
                  if (n === _s69) break;
                  if (i = r, r = e[--n - 1], t >= r) break e;
                }

                _s67 = n, n = 0;
              }
            }

            for (; n < _s67;) {
              var _i145 = n + _s67 >>> 1;

              t < e[_i145] ? _s67 = _i145 : n = _i145 + 1;
            }

            if (i = e[n], r = e[n - 1], void 0 === r) return this._cachedIndex = 0, this.beforeStart_(0, t, i);
            if (void 0 === i) return n = e.length, this._cachedIndex = n, this.afterEnd_(n - 1, r, t);
          }

          this._cachedIndex = n, this.intervalChanged_(n, r, i);
        }

        return this.interpolate_(n, r, t, i);
      }
    }, {
      key: "getSettings_",
      value: function getSettings_() {
        return this.settings || this.DefaultSettings_;
      }
    }, {
      key: "copySampleValue_",
      value: function copySampleValue_(t) {
        var e = this.resultBuffer,
            n = this.sampleValues,
            i = this.valueSize,
            r = t * i;

        for (var _t239 = 0; _t239 !== i; ++_t239) {
          e[_t239] = n[r + _t239];
        }

        return e;
      }
    }, {
      key: "interpolate_",
      value: function interpolate_() {
        throw new Error("call to abstract method");
      }
    }, {
      key: "intervalChanged_",
      value: function intervalChanged_() {}
    }]);

    return Hl;
  }();

  Hl.prototype.beforeStart_ = Hl.prototype.copySampleValue_, Hl.prototype.afterEnd_ = Hl.prototype.copySampleValue_;

  var Gl = /*#__PURE__*/function (_Hl) {
    _inherits(Gl, _Hl);

    var _super95 = _createSuper(Gl);

    function Gl(t, e, n, i) {
      var _this84;

      _classCallCheck(this, Gl);

      _this84 = _super95.call(this, t, e, n, i), _this84._weightPrev = -0, _this84._offsetPrev = -0, _this84._weightNext = -0, _this84._offsetNext = -0, _this84.DefaultSettings_ = {
        endingStart: k,
        endingEnd: k
      };
      return _this84;
    }

    _createClass(Gl, [{
      key: "intervalChanged_",
      value: function intervalChanged_(t, e, n) {
        var i = this.parameterPositions;
        var r = t - 2,
            s = t + 1,
            a = i[r],
            o = i[s];
        if (void 0 === a) switch (this.getSettings_().endingStart) {
          case V:
            r = t, a = 2 * e - n;
            break;

          case W:
            r = i.length - 2, a = e + i[r] - i[r + 1];
            break;

          default:
            r = t, a = n;
        }
        if (void 0 === o) switch (this.getSettings_().endingEnd) {
          case V:
            s = t, o = 2 * n - e;
            break;

          case W:
            s = 1, o = n + i[1] - i[0];
            break;

          default:
            s = t - 1, o = e;
        }
        var l = .5 * (n - e),
            c = this.valueSize;
        this._weightPrev = l / (e - a), this._weightNext = l / (o - n), this._offsetPrev = r * c, this._offsetNext = s * c;
      }
    }, {
      key: "interpolate_",
      value: function interpolate_(t, e, n, i) {
        var r = this.resultBuffer,
            s = this.sampleValues,
            a = this.valueSize,
            o = t * a,
            l = o - a,
            c = this._offsetPrev,
            h = this._offsetNext,
            u = this._weightPrev,
            d = this._weightNext,
            p = (n - e) / (i - e),
            m = p * p,
            f = m * p,
            g = -u * f + 2 * u * m - u * p,
            v = (1 + u) * f + (-1.5 - 2 * u) * m + (-.5 + u) * p + 1,
            y = (-1 - d) * f + (1.5 + d) * m + .5 * p,
            x = d * f - d * m;

        for (var _t240 = 0; _t240 !== a; ++_t240) {
          r[_t240] = g * s[c + _t240] + v * s[l + _t240] + y * s[o + _t240] + x * s[h + _t240];
        }

        return r;
      }
    }]);

    return Gl;
  }(Hl);

  var kl = /*#__PURE__*/function (_Hl2) {
    _inherits(kl, _Hl2);

    var _super96 = _createSuper(kl);

    function kl(t, e, n, i) {
      _classCallCheck(this, kl);

      return _super96.call(this, t, e, n, i);
    }

    _createClass(kl, [{
      key: "interpolate_",
      value: function interpolate_(t, e, n, i) {
        var r = this.resultBuffer,
            s = this.sampleValues,
            a = this.valueSize,
            o = t * a,
            l = o - a,
            c = (n - e) / (i - e),
            h = 1 - c;

        for (var _t241 = 0; _t241 !== a; ++_t241) {
          r[_t241] = s[l + _t241] * h + s[o + _t241] * c;
        }

        return r;
      }
    }]);

    return kl;
  }(Hl);

  var Vl = /*#__PURE__*/function (_Hl3) {
    _inherits(Vl, _Hl3);

    var _super97 = _createSuper(Vl);

    function Vl(t, e, n, i) {
      _classCallCheck(this, Vl);

      return _super97.call(this, t, e, n, i);
    }

    _createClass(Vl, [{
      key: "interpolate_",
      value: function interpolate_(t) {
        return this.copySampleValue_(t - 1);
      }
    }]);

    return Vl;
  }(Hl);

  var Wl = /*#__PURE__*/function () {
    function Wl(t, e, n, i) {
      _classCallCheck(this, Wl);

      if (void 0 === t) throw new Error("THREE.KeyframeTrack: track name is undefined");
      if (void 0 === e || 0 === e.length) throw new Error("THREE.KeyframeTrack: no keyframes in track named " + t);
      this.name = t, this.times = Ul.convertArray(e, this.TimeBufferType), this.values = Ul.convertArray(n, this.ValueBufferType), this.setInterpolation(i || this.DefaultInterpolation);
    }

    _createClass(Wl, [{
      key: "InterpolantFactoryMethodDiscrete",
      value: function InterpolantFactoryMethodDiscrete(t) {
        return new Vl(this.times, this.values, this.getValueSize(), t);
      }
    }, {
      key: "InterpolantFactoryMethodLinear",
      value: function InterpolantFactoryMethodLinear(t) {
        return new kl(this.times, this.values, this.getValueSize(), t);
      }
    }, {
      key: "InterpolantFactoryMethodSmooth",
      value: function InterpolantFactoryMethodSmooth(t) {
        return new Gl(this.times, this.values, this.getValueSize(), t);
      }
    }, {
      key: "setInterpolation",
      value: function setInterpolation(t) {
        var e;

        switch (t) {
          case U:
            e = this.InterpolantFactoryMethodDiscrete;
            break;

          case H:
            e = this.InterpolantFactoryMethodLinear;
            break;

          case G:
            e = this.InterpolantFactoryMethodSmooth;
        }

        if (void 0 === e) {
          var _e208 = "unsupported interpolation for " + this.ValueTypeName + " keyframe track named " + this.name;

          if (void 0 === this.createInterpolant) {
            if (t === this.DefaultInterpolation) throw new Error(_e208);
            this.setInterpolation(this.DefaultInterpolation);
          }

          return console.warn("THREE.KeyframeTrack:", _e208), this;
        }

        return this.createInterpolant = e, this;
      }
    }, {
      key: "getInterpolation",
      value: function getInterpolation() {
        switch (this.createInterpolant) {
          case this.InterpolantFactoryMethodDiscrete:
            return U;

          case this.InterpolantFactoryMethodLinear:
            return H;

          case this.InterpolantFactoryMethodSmooth:
            return G;
        }
      }
    }, {
      key: "getValueSize",
      value: function getValueSize() {
        return this.values.length / this.times.length;
      }
    }, {
      key: "shift",
      value: function shift(t) {
        if (0 !== t) {
          var _e209 = this.times;

          for (var _n190 = 0, _i146 = _e209.length; _n190 !== _i146; ++_n190) {
            _e209[_n190] += t;
          }
        }

        return this;
      }
    }, {
      key: "scale",
      value: function scale(t) {
        if (1 !== t) {
          var _e210 = this.times;

          for (var _n191 = 0, _i147 = _e210.length; _n191 !== _i147; ++_n191) {
            _e210[_n191] *= t;
          }
        }

        return this;
      }
    }, {
      key: "trim",
      value: function trim(t, e) {
        var n = this.times,
            i = n.length;
        var r = 0,
            s = i - 1;

        for (; r !== i && n[r] < t;) {
          ++r;
        }

        for (; -1 !== s && n[s] > e;) {
          --s;
        }

        if (++s, 0 !== r || s !== i) {
          r >= s && (s = Math.max(s, 1), r = s - 1);

          var _t242 = this.getValueSize();

          this.times = Ul.arraySlice(n, r, s), this.values = Ul.arraySlice(this.values, r * _t242, s * _t242);
        }

        return this;
      }
    }, {
      key: "validate",
      value: function validate() {
        var t = !0;
        var e = this.getValueSize();
        e - Math.floor(e) != 0 && (console.error("THREE.KeyframeTrack: Invalid value size in track.", this), t = !1);
        var n = this.times,
            i = this.values,
            r = n.length;
        0 === r && (console.error("THREE.KeyframeTrack: Track is empty.", this), t = !1);
        var s = null;

        for (var _e211 = 0; _e211 !== r; _e211++) {
          var _i148 = n[_e211];

          if ("number" == typeof _i148 && isNaN(_i148)) {
            console.error("THREE.KeyframeTrack: Time is not a valid number.", this, _e211, _i148), t = !1;
            break;
          }

          if (null !== s && s > _i148) {
            console.error("THREE.KeyframeTrack: Out of order keys.", this, _e211, _i148, s), t = !1;
            break;
          }

          s = _i148;
        }

        if (void 0 !== i && Ul.isTypedArray(i)) for (var _e212 = 0, _n192 = i.length; _e212 !== _n192; ++_e212) {
          var _n193 = i[_e212];

          if (isNaN(_n193)) {
            console.error("THREE.KeyframeTrack: Value is not a valid number.", this, _e212, _n193), t = !1;
            break;
          }
        }
        return t;
      }
    }, {
      key: "optimize",
      value: function optimize() {
        var t = Ul.arraySlice(this.times),
            e = Ul.arraySlice(this.values),
            n = this.getValueSize(),
            i = this.getInterpolation() === G,
            r = t.length - 1;
        var s = 1;

        for (var _a56 = 1; _a56 < r; ++_a56) {
          var _r128 = !1;

          var _o36 = t[_a56];
          if (_o36 !== t[_a56 + 1] && (1 !== _a56 || _o36 !== t[0])) if (i) _r128 = !0;else {
            var _t243 = _a56 * n,
                _i149 = _t243 - n,
                _s70 = _t243 + n;

            for (var _a57 = 0; _a57 !== n; ++_a57) {
              var _n194 = e[_t243 + _a57];

              if (_n194 !== e[_i149 + _a57] || _n194 !== e[_s70 + _a57]) {
                _r128 = !0;
                break;
              }
            }
          }

          if (_r128) {
            if (_a56 !== s) {
              t[s] = t[_a56];

              var _i150 = _a56 * n,
                  _r129 = s * n;

              for (var _t244 = 0; _t244 !== n; ++_t244) {
                e[_r129 + _t244] = e[_i150 + _t244];
              }
            }

            ++s;
          }
        }

        if (r > 0) {
          t[s] = t[r];

          for (var _t245 = r * n, _i151 = s * n, _a58 = 0; _a58 !== n; ++_a58) {
            e[_i151 + _a58] = e[_t245 + _a58];
          }

          ++s;
        }

        return s !== t.length ? (this.times = Ul.arraySlice(t, 0, s), this.values = Ul.arraySlice(e, 0, s * n)) : (this.times = t, this.values = e), this;
      }
    }, {
      key: "clone",
      value: function clone() {
        var t = Ul.arraySlice(this.times, 0),
            e = Ul.arraySlice(this.values, 0),
            n = new (0, this.constructor)(this.name, t, e);
        return n.createInterpolant = this.createInterpolant, n;
      }
    }], [{
      key: "toJSON",
      value: function toJSON(t) {
        var e = t.constructor;
        var n;
        if (e.toJSON !== this.toJSON) n = e.toJSON(t);else {
          n = {
            name: t.name,
            times: Ul.convertArray(t.times, Array),
            values: Ul.convertArray(t.values, Array)
          };

          var _e213 = t.getInterpolation();

          _e213 !== t.DefaultInterpolation && (n.interpolation = _e213);
        }
        return n.type = t.ValueTypeName, n;
      }
    }]);

    return Wl;
  }();

  Wl.prototype.TimeBufferType = Float32Array, Wl.prototype.ValueBufferType = Float32Array, Wl.prototype.DefaultInterpolation = H;

  var jl = /*#__PURE__*/function (_Wl) {
    _inherits(jl, _Wl);

    var _super98 = _createSuper(jl);

    function jl() {
      _classCallCheck(this, jl);

      return _super98.apply(this, arguments);
    }

    return jl;
  }(Wl);

  jl.prototype.ValueTypeName = "bool", jl.prototype.ValueBufferType = Array, jl.prototype.DefaultInterpolation = U, jl.prototype.InterpolantFactoryMethodLinear = void 0, jl.prototype.InterpolantFactoryMethodSmooth = void 0;

  var ql = /*#__PURE__*/function (_Wl2) {
    _inherits(ql, _Wl2);

    var _super99 = _createSuper(ql);

    function ql() {
      _classCallCheck(this, ql);

      return _super99.apply(this, arguments);
    }

    return ql;
  }(Wl);

  ql.prototype.ValueTypeName = "color";

  var Xl = /*#__PURE__*/function (_Wl3) {
    _inherits(Xl, _Wl3);

    var _super100 = _createSuper(Xl);

    function Xl() {
      _classCallCheck(this, Xl);

      return _super100.apply(this, arguments);
    }

    return Xl;
  }(Wl);

  Xl.prototype.ValueTypeName = "number";

  var Yl = /*#__PURE__*/function (_Hl4) {
    _inherits(Yl, _Hl4);

    var _super101 = _createSuper(Yl);

    function Yl(t, e, n, i) {
      _classCallCheck(this, Yl);

      return _super101.call(this, t, e, n, i);
    }

    _createClass(Yl, [{
      key: "interpolate_",
      value: function interpolate_(t, e, n, i) {
        var r = this.resultBuffer,
            s = this.sampleValues,
            a = this.valueSize,
            o = (n - e) / (i - e);
        var l = t * a;

        for (var _t246 = l + a; l !== _t246; l += 4) {
          Lt.slerpFlat(r, 0, s, l - a, s, l, o);
        }

        return r;
      }
    }]);

    return Yl;
  }(Hl);

  var Jl = /*#__PURE__*/function (_Wl4) {
    _inherits(Jl, _Wl4);

    var _super102 = _createSuper(Jl);

    function Jl() {
      _classCallCheck(this, Jl);

      return _super102.apply(this, arguments);
    }

    _createClass(Jl, [{
      key: "InterpolantFactoryMethodLinear",
      value: function InterpolantFactoryMethodLinear(t) {
        return new Yl(this.times, this.values, this.getValueSize(), t);
      }
    }]);

    return Jl;
  }(Wl);

  Jl.prototype.ValueTypeName = "quaternion", Jl.prototype.DefaultInterpolation = H, Jl.prototype.InterpolantFactoryMethodSmooth = void 0;

  var Zl = /*#__PURE__*/function (_Wl5) {
    _inherits(Zl, _Wl5);

    var _super103 = _createSuper(Zl);

    function Zl() {
      _classCallCheck(this, Zl);

      return _super103.apply(this, arguments);
    }

    return Zl;
  }(Wl);

  Zl.prototype.ValueTypeName = "string", Zl.prototype.ValueBufferType = Array, Zl.prototype.DefaultInterpolation = U, Zl.prototype.InterpolantFactoryMethodLinear = void 0, Zl.prototype.InterpolantFactoryMethodSmooth = void 0;

  var Ql = /*#__PURE__*/function (_Wl6) {
    _inherits(Ql, _Wl6);

    var _super104 = _createSuper(Ql);

    function Ql() {
      _classCallCheck(this, Ql);

      return _super104.apply(this, arguments);
    }

    return Ql;
  }(Wl);

  Ql.prototype.ValueTypeName = "vector";

  var Kl = /*#__PURE__*/function () {
    function Kl(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : -1;
      var n = arguments.length > 2 ? arguments[2] : undefined;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 2500;

      _classCallCheck(this, Kl);

      this.name = t, this.tracks = n, this.duration = e, this.blendMode = i, this.uuid = ct(), this.duration < 0 && this.resetDuration();
    }

    _createClass(Kl, [{
      key: "resetDuration",
      value: function resetDuration() {
        var t = 0;

        for (var _e214 = 0, _n195 = this.tracks.length; _e214 !== _n195; ++_e214) {
          var _n196 = this.tracks[_e214];
          t = Math.max(t, _n196.times[_n196.times.length - 1]);
        }

        return this.duration = t, this;
      }
    }, {
      key: "trim",
      value: function trim() {
        for (var _t247 = 0; _t247 < this.tracks.length; _t247++) {
          this.tracks[_t247].trim(0, this.duration);
        }

        return this;
      }
    }, {
      key: "validate",
      value: function validate() {
        var t = !0;

        for (var _e215 = 0; _e215 < this.tracks.length; _e215++) {
          t = t && this.tracks[_e215].validate();
        }

        return t;
      }
    }, {
      key: "optimize",
      value: function optimize() {
        for (var _t248 = 0; _t248 < this.tracks.length; _t248++) {
          this.tracks[_t248].optimize();
        }

        return this;
      }
    }, {
      key: "clone",
      value: function clone() {
        var t = [];

        for (var _e216 = 0; _e216 < this.tracks.length; _e216++) {
          t.push(this.tracks[_e216].clone());
        }

        return new this.constructor(this.name, this.duration, t, this.blendMode);
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        return this.constructor.toJSON(this);
      }
    }], [{
      key: "parse",
      value: function parse(t) {
        var e = [],
            n = t.tracks,
            i = 1 / (t.fps || 1);

        for (var _t249 = 0, _r130 = n.length; _t249 !== _r130; ++_t249) {
          e.push($l(n[_t249]).scale(i));
        }

        var r = new this(t.name, t.duration, e, t.blendMode);
        return r.uuid = t.uuid, r;
      }
    }, {
      key: "toJSON",
      value: function toJSON(t) {
        var e = [],
            n = t.tracks,
            i = {
          name: t.name,
          duration: t.duration,
          tracks: e,
          uuid: t.uuid,
          blendMode: t.blendMode
        };

        for (var _t250 = 0, _i152 = n.length; _t250 !== _i152; ++_t250) {
          e.push(Wl.toJSON(n[_t250]));
        }

        return i;
      }
    }, {
      key: "CreateFromMorphTargetSequence",
      value: function CreateFromMorphTargetSequence(t, e, n, i) {
        var r = e.length,
            s = [];

        for (var _t251 = 0; _t251 < r; _t251++) {
          var _a59 = [],
              _o37 = [];
          _a59.push((_t251 + r - 1) % r, _t251, (_t251 + 1) % r), _o37.push(0, 1, 0);

          var _l32 = Ul.getKeyframeOrder(_a59);

          _a59 = Ul.sortedArray(_a59, 1, _l32), _o37 = Ul.sortedArray(_o37, 1, _l32), i || 0 !== _a59[0] || (_a59.push(r), _o37.push(_o37[0])), s.push(new Xl(".morphTargetInfluences[" + e[_t251].name + "]", _a59, _o37).scale(1 / n));
        }

        return new this(t, -1, s);
      }
    }, {
      key: "findByName",
      value: function findByName(t, e) {
        var n = t;

        if (!Array.isArray(t)) {
          var _e217 = t;
          n = _e217.geometry && _e217.geometry.animations || _e217.animations;
        }

        for (var _t252 = 0; _t252 < n.length; _t252++) {
          if (n[_t252].name === e) return n[_t252];
        }

        return null;
      }
    }, {
      key: "CreateClipsFromMorphTargetSequences",
      value: function CreateClipsFromMorphTargetSequences(t, e, n) {
        var i = {},
            r = /^([\w-]*?)([\d]+)$/;

        for (var _e218 = 0, _n197 = t.length; _e218 < _n197; _e218++) {
          var _n198 = t[_e218],
              _s71 = _n198.name.match(r);

          if (_s71 && _s71.length > 1) {
            var _t253 = _s71[1];
            var _e219 = i[_t253];
            _e219 || (i[_t253] = _e219 = []), _e219.push(_n198);
          }
        }

        var s = [];

        for (var _t254 in i) {
          s.push(this.CreateFromMorphTargetSequence(_t254, i[_t254], e, n));
        }

        return s;
      }
    }, {
      key: "parseAnimation",
      value: function parseAnimation(t, e) {
        if (!t) return console.error("THREE.AnimationClip: No animation in JSONLoader data."), null;

        var n = function n(t, e, _n199, i, r) {
          if (0 !== _n199.length) {
            var _s72 = [],
                _a60 = [];
            Ul.flattenJSON(_n199, _s72, _a60, i), 0 !== _s72.length && r.push(new t(e, _s72, _a60));
          }
        },
            i = [],
            r = t.name || "default",
            s = t.fps || 30,
            a = t.blendMode;

        var o = t.length || -1;
        var l = t.hierarchy || [];

        for (var _t255 = 0; _t255 < l.length; _t255++) {
          var _r131 = l[_t255].keys;
          if (_r131 && 0 !== _r131.length) if (_r131[0].morphTargets) {
            var _t256 = {};

            var _e220 = void 0;

            for (_e220 = 0; _e220 < _r131.length; _e220++) {
              if (_r131[_e220].morphTargets) for (var _n200 = 0; _n200 < _r131[_e220].morphTargets.length; _n200++) {
                _t256[_r131[_e220].morphTargets[_n200]] = -1;
              }
            }

            for (var _n201 in _t256) {
              var _t257 = [],
                  _s73 = [];

              for (var _i153 = 0; _i153 !== _r131[_e220].morphTargets.length; ++_i153) {
                var _i154 = _r131[_e220];
                _t257.push(_i154.time), _s73.push(_i154.morphTarget === _n201 ? 1 : 0);
              }

              i.push(new Xl(".morphTargetInfluence[" + _n201 + "]", _t257, _s73));
            }

            o = _t256.length * (s || 1);
          } else {
            var _s74 = ".bones[" + e[_t255].name + "]";

            n(Ql, _s74 + ".position", _r131, "pos", i), n(Jl, _s74 + ".quaternion", _r131, "rot", i), n(Ql, _s74 + ".scale", _r131, "scl", i);
          }
        }

        if (0 === i.length) return null;
        return new this(r, o, i, a);
      }
    }]);

    return Kl;
  }();

  function $l(t) {
    if (void 0 === t.type) throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");

    var e = function (t) {
      switch (t.toLowerCase()) {
        case "scalar":
        case "double":
        case "float":
        case "number":
        case "integer":
          return Xl;

        case "vector":
        case "vector2":
        case "vector3":
        case "vector4":
          return Ql;

        case "color":
          return ql;

        case "quaternion":
          return Jl;

        case "bool":
        case "boolean":
          return jl;

        case "string":
          return Zl;
      }

      throw new Error("THREE.KeyframeTrack: Unsupported typeName: " + t);
    }(t.type);

    if (void 0 === t.times) {
      var _e221 = [],
          _n202 = [];
      Ul.flattenJSON(t.keys, _e221, _n202, "value"), t.times = _e221, t.values = _n202;
    }

    return void 0 !== e.parse ? e.parse(t) : new e(t.name, t.times, t.values, t.interpolation);
  }

  var tc = {
    enabled: !1,
    files: {},
    add: function add(t, e) {
      !1 !== this.enabled && (this.files[t] = e);
    },
    get: function get(t) {
      if (!1 !== this.enabled) return this.files[t];
    },
    remove: function remove(t) {
      delete this.files[t];
    },
    clear: function clear() {
      this.files = {};
    }
  };

  var ec = function ec(t, e, n) {
    _classCallCheck(this, ec);

    var i = this;
    var r,
        s = !1,
        a = 0,
        o = 0;
    var l = [];
    this.onStart = void 0, this.onLoad = t, this.onProgress = e, this.onError = n, this.itemStart = function (t) {
      o++, !1 === s && void 0 !== i.onStart && i.onStart(t, a, o), s = !0;
    }, this.itemEnd = function (t) {
      a++, void 0 !== i.onProgress && i.onProgress(t, a, o), a === o && (s = !1, void 0 !== i.onLoad && i.onLoad());
    }, this.itemError = function (t) {
      void 0 !== i.onError && i.onError(t);
    }, this.resolveURL = function (t) {
      return r ? r(t) : t;
    }, this.setURLModifier = function (t) {
      return r = t, this;
    }, this.addHandler = function (t, e) {
      return l.push(t, e), this;
    }, this.removeHandler = function (t) {
      var e = l.indexOf(t);
      return -1 !== e && l.splice(e, 2), this;
    }, this.getHandler = function (t) {
      for (var _e222 = 0, _n203 = l.length; _e222 < _n203; _e222 += 2) {
        var _n204 = l[_e222],
            _i155 = l[_e222 + 1];
        if (_n204.global && (_n204.lastIndex = 0), _n204.test(t)) return _i155;
      }

      return null;
    };
  };

  var nc = new ec();

  var ic = /*#__PURE__*/function () {
    function ic(t) {
      _classCallCheck(this, ic);

      this.manager = void 0 !== t ? t : nc, this.crossOrigin = "anonymous", this.withCredentials = !1, this.path = "", this.resourcePath = "", this.requestHeader = {};
    }

    _createClass(ic, [{
      key: "load",
      value: function load() {}
    }, {
      key: "loadAsync",
      value: function loadAsync(t, e) {
        var n = this;
        return new Promise(function (i, r) {
          n.load(t, i, e, r);
        });
      }
    }, {
      key: "parse",
      value: function parse() {}
    }, {
      key: "setCrossOrigin",
      value: function setCrossOrigin(t) {
        return this.crossOrigin = t, this;
      }
    }, {
      key: "setWithCredentials",
      value: function setWithCredentials(t) {
        return this.withCredentials = t, this;
      }
    }, {
      key: "setPath",
      value: function setPath(t) {
        return this.path = t, this;
      }
    }, {
      key: "setResourcePath",
      value: function setResourcePath(t) {
        return this.resourcePath = t, this;
      }
    }, {
      key: "setRequestHeader",
      value: function setRequestHeader(t) {
        return this.requestHeader = t, this;
      }
    }]);

    return ic;
  }();

  var rc = {};

  var sc = /*#__PURE__*/function (_ic) {
    _inherits(sc, _ic);

    var _super105 = _createSuper(sc);

    function sc(t) {
      _classCallCheck(this, sc);

      return _super105.call(this, t);
    }

    _createClass(sc, [{
      key: "load",
      value: function load(t, e, n, i) {
        void 0 === t && (t = ""), void 0 !== this.path && (t = this.path + t), t = this.manager.resolveURL(t);
        var r = this,
            s = tc.get(t);
        if (void 0 !== s) return r.manager.itemStart(t), setTimeout(function () {
          e && e(s), r.manager.itemEnd(t);
        }, 0), s;
        if (void 0 !== rc[t]) return void rc[t].push({
          onLoad: e,
          onProgress: n,
          onError: i
        });
        var a = t.match(/^data:(.*?)(;base64)?,(.*)$/);
        var o;

        if (a) {
          var _n205 = a[1],
              _s75 = !!a[2];

          var _o38 = a[3];
          _o38 = decodeURIComponent(_o38), _s75 && (_o38 = atob(_o38));

          try {
            var _i156;

            var _s76 = (this.responseType || "").toLowerCase();

            switch (_s76) {
              case "arraybuffer":
              case "blob":
                var _t258 = new Uint8Array(_o38.length);

                for (var _e224 = 0; _e224 < _o38.length; _e224++) {
                  _t258[_e224] = _o38.charCodeAt(_e224);
                }

                _i156 = "blob" === _s76 ? new Blob([_t258.buffer], {
                  type: _n205
                }) : _t258.buffer;
                break;

              case "document":
                var _e223 = new DOMParser();

                _i156 = _e223.parseFromString(_o38, _n205);
                break;

              case "json":
                _i156 = JSON.parse(_o38);
                break;

              default:
                _i156 = _o38;
            }

            setTimeout(function () {
              e && e(_i156), r.manager.itemEnd(t);
            }, 0);
          } catch (e) {
            setTimeout(function () {
              i && i(e), r.manager.itemError(t), r.manager.itemEnd(t);
            }, 0);
          }
        } else {
          rc[t] = [], rc[t].push({
            onLoad: e,
            onProgress: n,
            onError: i
          }), o = new XMLHttpRequest(), o.open("GET", t, !0), o.addEventListener("load", function (e) {
            var n = this.response,
                i = rc[t];

            if (delete rc[t], 200 === this.status || 0 === this.status) {
              0 === this.status && console.warn("THREE.FileLoader: HTTP Status 0 received."), tc.add(t, n);

              for (var _t259 = 0, _e225 = i.length; _t259 < _e225; _t259++) {
                var _e226 = i[_t259];
                _e226.onLoad && _e226.onLoad(n);
              }

              r.manager.itemEnd(t);
            } else {
              for (var _t260 = 0, _n206 = i.length; _t260 < _n206; _t260++) {
                var _n207 = i[_t260];
                _n207.onError && _n207.onError(e);
              }

              r.manager.itemError(t), r.manager.itemEnd(t);
            }
          }, !1), o.addEventListener("progress", function (e) {
            var n = rc[t];

            for (var _t261 = 0, _i157 = n.length; _t261 < _i157; _t261++) {
              var _i158 = n[_t261];
              _i158.onProgress && _i158.onProgress(e);
            }
          }, !1), o.addEventListener("error", function (e) {
            var n = rc[t];
            delete rc[t];

            for (var _t262 = 0, _i159 = n.length; _t262 < _i159; _t262++) {
              var _i160 = n[_t262];
              _i160.onError && _i160.onError(e);
            }

            r.manager.itemError(t), r.manager.itemEnd(t);
          }, !1), o.addEventListener("abort", function (e) {
            var n = rc[t];
            delete rc[t];

            for (var _t263 = 0, _i161 = n.length; _t263 < _i161; _t263++) {
              var _i162 = n[_t263];
              _i162.onError && _i162.onError(e);
            }

            r.manager.itemError(t), r.manager.itemEnd(t);
          }, !1), void 0 !== this.responseType && (o.responseType = this.responseType), void 0 !== this.withCredentials && (o.withCredentials = this.withCredentials), o.overrideMimeType && o.overrideMimeType(void 0 !== this.mimeType ? this.mimeType : "text/plain");

          for (var _t264 in this.requestHeader) {
            o.setRequestHeader(_t264, this.requestHeader[_t264]);
          }

          o.send(null);
        }

        return r.manager.itemStart(t), o;
      }
    }, {
      key: "setResponseType",
      value: function setResponseType(t) {
        return this.responseType = t, this;
      }
    }, {
      key: "setMimeType",
      value: function setMimeType(t) {
        return this.mimeType = t, this;
      }
    }]);

    return sc;
  }(ic);

  var ac = /*#__PURE__*/function (_ic2) {
    _inherits(ac, _ic2);

    var _super106 = _createSuper(ac);

    function ac(t) {
      _classCallCheck(this, ac);

      return _super106.call(this, t);
    }

    _createClass(ac, [{
      key: "load",
      value: function load(t, e, n, i) {
        void 0 !== this.path && (t = this.path + t), t = this.manager.resolveURL(t);
        var r = this,
            s = tc.get(t);
        if (void 0 !== s) return r.manager.itemStart(t), setTimeout(function () {
          e && e(s), r.manager.itemEnd(t);
        }, 0), s;
        var a = document.createElementNS("http://www.w3.org/1999/xhtml", "img");

        function o() {
          a.removeEventListener("load", o, !1), a.removeEventListener("error", l, !1), tc.add(t, this), e && e(this), r.manager.itemEnd(t);
        }

        function l(e) {
          a.removeEventListener("load", o, !1), a.removeEventListener("error", l, !1), i && i(e), r.manager.itemError(t), r.manager.itemEnd(t);
        }

        return a.addEventListener("load", o, !1), a.addEventListener("error", l, !1), "data:" !== t.substr(0, 5) && void 0 !== this.crossOrigin && (a.crossOrigin = this.crossOrigin), r.manager.itemStart(t), a.src = t, a;
      }
    }]);

    return ac;
  }(ic);

  var oc = /*#__PURE__*/function (_ic3) {
    _inherits(oc, _ic3);

    var _super107 = _createSuper(oc);

    function oc(t) {
      _classCallCheck(this, oc);

      return _super107.call(this, t);
    }

    _createClass(oc, [{
      key: "load",
      value: function load(t, e, n, i) {
        var r = new Kn(),
            s = new ac(this.manager);
        s.setCrossOrigin(this.crossOrigin), s.setPath(this.path);
        var a = 0;

        function o(n) {
          s.load(t[n], function (t) {
            r.images[n] = t, a++, 6 === a && (r.needsUpdate = !0, e && e(r));
          }, void 0, i);
        }

        for (var _e227 = 0; _e227 < t.length; ++_e227) {
          o(_e227);
        }

        return r;
      }
    }]);

    return oc;
  }(ic);

  var lc = /*#__PURE__*/function (_ic4) {
    _inherits(lc, _ic4);

    var _super108 = _createSuper(lc);

    function lc(t) {
      _classCallCheck(this, lc);

      return _super108.call(this, t);
    }

    _createClass(lc, [{
      key: "load",
      value: function load(t, e, n, i) {
        var r = this,
            s = new Ca(),
            a = new sc(this.manager);
        return a.setResponseType("arraybuffer"), a.setRequestHeader(this.requestHeader), a.setPath(this.path), a.setWithCredentials(r.withCredentials), a.load(t, function (t) {
          var n = r.parse(t);
          n && (void 0 !== n.image ? s.image = n.image : void 0 !== n.data && (s.image.width = n.width, s.image.height = n.height, s.image.data = n.data), s.wrapS = void 0 !== n.wrapS ? n.wrapS : u, s.wrapT = void 0 !== n.wrapT ? n.wrapT : u, s.magFilter = void 0 !== n.magFilter ? n.magFilter : g, s.minFilter = void 0 !== n.minFilter ? n.minFilter : g, s.anisotropy = void 0 !== n.anisotropy ? n.anisotropy : 1, void 0 !== n.encoding && (s.encoding = n.encoding), void 0 !== n.flipY && (s.flipY = n.flipY), void 0 !== n.format && (s.format = n.format), void 0 !== n.type && (s.type = n.type), void 0 !== n.mipmaps && (s.mipmaps = n.mipmaps, s.minFilter = y), 1 === n.mipmapCount && (s.minFilter = g), void 0 !== n.generateMipmaps && (s.generateMipmaps = n.generateMipmaps), s.needsUpdate = !0, e && e(s, n));
        }, n, i), s;
      }
    }]);

    return lc;
  }(ic);

  var cc = /*#__PURE__*/function (_ic5) {
    _inherits(cc, _ic5);

    var _super109 = _createSuper(cc);

    function cc(t) {
      _classCallCheck(this, cc);

      return _super109.call(this, t);
    }

    _createClass(cc, [{
      key: "load",
      value: function load(t, e, n, i) {
        var r = new bt(),
            s = new ac(this.manager);
        return s.setCrossOrigin(this.crossOrigin), s.setPath(this.path), s.load(t, function (n) {
          r.image = n;
          var i = t.search(/\.jpe?g($|\?)/i) > 0 || 0 === t.search(/^data\:image\/jpeg/);
          r.format = i ? T : E, r.needsUpdate = !0, void 0 !== e && e(r);
        }, n, i), r;
      }
    }]);

    return cc;
  }(ic);

  var hc = /*#__PURE__*/function (_yo10) {
    _inherits(hc, _yo10);

    var _super110 = _createSuper(hc);

    function hc() {
      var _this85;

      _classCallCheck(this, hc);

      _this85 = _super110.call(this), _this85.type = "CurvePath", _this85.curves = [], _this85.autoClose = !1;
      return _this85;
    }

    _createClass(hc, [{
      key: "add",
      value: function add(t) {
        this.curves.push(t);
      }
    }, {
      key: "closePath",
      value: function closePath() {
        var t = this.curves[0].getPoint(0),
            e = this.curves[this.curves.length - 1].getPoint(1);
        t.equals(e) || this.curves.push(new Io(e, t));
      }
    }, {
      key: "getPoint",
      value: function getPoint(t) {
        var e = t * this.getLength(),
            n = this.getCurveLengths();
        var i = 0;

        for (; i < n.length;) {
          if (n[i] >= e) {
            var _t265 = n[i] - e,
                _r132 = this.curves[i],
                _s77 = _r132.getLength(),
                _a61 = 0 === _s77 ? 0 : 1 - _t265 / _s77;

            return _r132.getPointAt(_a61);
          }

          i++;
        }

        return null;
      }
    }, {
      key: "getLength",
      value: function getLength() {
        var t = this.getCurveLengths();
        return t[t.length - 1];
      }
    }, {
      key: "updateArcLengths",
      value: function updateArcLengths() {
        this.needsUpdate = !0, this.cacheLengths = null, this.getCurveLengths();
      }
    }, {
      key: "getCurveLengths",
      value: function getCurveLengths() {
        if (this.cacheLengths && this.cacheLengths.length === this.curves.length) return this.cacheLengths;
        var t = [];
        var e = 0;

        for (var _n208 = 0, _i163 = this.curves.length; _n208 < _i163; _n208++) {
          e += this.curves[_n208].getLength(), t.push(e);
        }

        return this.cacheLengths = t, t;
      }
    }, {
      key: "getSpacedPoints",
      value: function getSpacedPoints() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 40;
        var e = [];

        for (var _n209 = 0; _n209 <= t; _n209++) {
          e.push(this.getPoint(_n209 / t));
        }

        return this.autoClose && e.push(e[0]), e;
      }
    }, {
      key: "getPoints",
      value: function getPoints() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 12;
        var e = [];
        var n;

        for (var _i164 = 0, _r133 = this.curves; _i164 < _r133.length; _i164++) {
          var _s78 = _r133[_i164],
              _a62 = _s78 && _s78.isEllipseCurve ? 2 * t : _s78 && (_s78.isLineCurve || _s78.isLineCurve3) ? 1 : _s78 && _s78.isSplineCurve ? t * _s78.points.length : t,
              _o39 = _s78.getPoints(_a62);

          for (var _t266 = 0; _t266 < _o39.length; _t266++) {
            var _i165 = _o39[_t266];
            n && n.equals(_i165) || (e.push(_i165), n = _i165);
          }
        }

        return this.autoClose && e.length > 1 && !e[e.length - 1].equals(e[0]) && e.push(e[0]), e;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        _get(_getPrototypeOf(hc.prototype), "copy", this).call(this, t), this.curves = [];

        for (var _e228 = 0, _n210 = t.curves.length; _e228 < _n210; _e228++) {
          var _n211 = t.curves[_e228];
          this.curves.push(_n211.clone());
        }

        return this.autoClose = t.autoClose, this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(hc.prototype), "toJSON", this).call(this);

        t.autoClose = this.autoClose, t.curves = [];

        for (var _e229 = 0, _n212 = this.curves.length; _e229 < _n212; _e229++) {
          var _n213 = this.curves[_e229];
          t.curves.push(_n213.toJSON());
        }

        return t;
      }
    }, {
      key: "fromJSON",
      value: function fromJSON(t) {
        _get(_getPrototypeOf(hc.prototype), "fromJSON", this).call(this, t), this.autoClose = t.autoClose, this.curves = [];

        for (var _e230 = 0, _n214 = t.curves.length; _e230 < _n214; _e230++) {
          var _n215 = t.curves[_e230];
          this.curves.push(new Fo[_n215.type]().fromJSON(_n215));
        }

        return this;
      }
    }]);

    return hc;
  }(yo);

  var uc = /*#__PURE__*/function (_hc) {
    _inherits(uc, _hc);

    var _super111 = _createSuper(uc);

    function uc(t) {
      var _this86;

      _classCallCheck(this, uc);

      _this86 = _super111.call(this), _this86.type = "Path", _this86.currentPoint = new vt(), t && _this86.setFromPoints(t);
      return _this86;
    }

    _createClass(uc, [{
      key: "setFromPoints",
      value: function setFromPoints(t) {
        this.moveTo(t[0].x, t[0].y);

        for (var _e231 = 1, _n216 = t.length; _e231 < _n216; _e231++) {
          this.lineTo(t[_e231].x, t[_e231].y);
        }

        return this;
      }
    }, {
      key: "moveTo",
      value: function moveTo(t, e) {
        return this.currentPoint.set(t, e), this;
      }
    }, {
      key: "lineTo",
      value: function lineTo(t, e) {
        var n = new Io(this.currentPoint.clone(), new vt(t, e));
        return this.curves.push(n), this.currentPoint.set(t, e), this;
      }
    }, {
      key: "quadraticCurveTo",
      value: function quadraticCurveTo(t, e, n, i) {
        var r = new No(this.currentPoint.clone(), new vt(t, e), new vt(n, i));
        return this.curves.push(r), this.currentPoint.set(n, i), this;
      }
    }, {
      key: "bezierCurveTo",
      value: function bezierCurveTo(t, e, n, i, r, s) {
        var a = new Co(this.currentPoint.clone(), new vt(t, e), new vt(n, i), new vt(r, s));
        return this.curves.push(a), this.currentPoint.set(r, s), this;
      }
    }, {
      key: "splineThru",
      value: function splineThru(t) {
        var e = [this.currentPoint.clone()].concat(t),
            n = new zo(e);
        return this.curves.push(n), this.currentPoint.copy(t[t.length - 1]), this;
      }
    }, {
      key: "arc",
      value: function arc(t, e, n, i, r, s) {
        var a = this.currentPoint.x,
            o = this.currentPoint.y;
        return this.absarc(t + a, e + o, n, i, r, s), this;
      }
    }, {
      key: "absarc",
      value: function absarc(t, e, n, i, r, s) {
        return this.absellipse(t, e, n, n, i, r, s), this;
      }
    }, {
      key: "ellipse",
      value: function ellipse(t, e, n, i, r, s, a, o) {
        var l = this.currentPoint.x,
            c = this.currentPoint.y;
        return this.absellipse(t + l, e + c, n, i, r, s, a, o), this;
      }
    }, {
      key: "absellipse",
      value: function absellipse(t, e, n, i, r, s, a, o) {
        var l = new xo(t, e, n, i, r, s, a, o);

        if (this.curves.length > 0) {
          var _t267 = l.getPoint(0);

          _t267.equals(this.currentPoint) || this.lineTo(_t267.x, _t267.y);
        }

        this.curves.push(l);
        var c = l.getPoint(1);
        return this.currentPoint.copy(c), this;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(uc.prototype), "copy", this).call(this, t), this.currentPoint.copy(t.currentPoint), this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(uc.prototype), "toJSON", this).call(this);

        return t.currentPoint = this.currentPoint.toArray(), t;
      }
    }, {
      key: "fromJSON",
      value: function fromJSON(t) {
        return _get(_getPrototypeOf(uc.prototype), "fromJSON", this).call(this, t), this.currentPoint.fromArray(t.currentPoint), this;
      }
    }]);

    return uc;
  }(hc);

  var dc = /*#__PURE__*/function (_uc) {
    _inherits(dc, _uc);

    var _super112 = _createSuper(dc);

    function dc(t) {
      var _this87;

      _classCallCheck(this, dc);

      _this87 = _super112.call(this, t), _this87.uuid = ct(), _this87.type = "Shape", _this87.holes = [];
      return _this87;
    }

    _createClass(dc, [{
      key: "getPointsHoles",
      value: function getPointsHoles(t) {
        var e = [];

        for (var _n217 = 0, _i166 = this.holes.length; _n217 < _i166; _n217++) {
          e[_n217] = this.holes[_n217].getPoints(t);
        }

        return e;
      }
    }, {
      key: "extractPoints",
      value: function extractPoints(t) {
        return {
          shape: this.getPoints(t),
          holes: this.getPointsHoles(t)
        };
      }
    }, {
      key: "copy",
      value: function copy(t) {
        _get(_getPrototypeOf(dc.prototype), "copy", this).call(this, t), this.holes = [];

        for (var _e232 = 0, _n218 = t.holes.length; _e232 < _n218; _e232++) {
          var _n219 = t.holes[_e232];
          this.holes.push(_n219.clone());
        }

        return this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(dc.prototype), "toJSON", this).call(this);

        t.uuid = this.uuid, t.holes = [];

        for (var _e233 = 0, _n220 = this.holes.length; _e233 < _n220; _e233++) {
          var _n221 = this.holes[_e233];
          t.holes.push(_n221.toJSON());
        }

        return t;
      }
    }, {
      key: "fromJSON",
      value: function fromJSON(t) {
        _get(_getPrototypeOf(dc.prototype), "fromJSON", this).call(this, t), this.uuid = t.uuid, this.holes = [];

        for (var _e234 = 0, _n222 = t.holes.length; _e234 < _n222; _e234++) {
          var _n223 = t.holes[_e234];
          this.holes.push(new uc().fromJSON(_n223));
        }

        return this;
      }
    }]);

    return dc;
  }(uc);

  var pc = /*#__PURE__*/function (_Pe11) {
    _inherits(pc, _Pe11);

    var _super113 = _createSuper(pc);

    function pc(t) {
      var _this88;

      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;

      _classCallCheck(this, pc);

      _this88 = _super113.call(this), _this88.type = "Light", _this88.color = new Qe(t), _this88.intensity = e;
      return _this88;
    }

    _createClass(pc, [{
      key: "dispose",
      value: function dispose() {}
    }, {
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(pc.prototype), "copy", this).call(this, t), this.color.copy(t.color), this.intensity = t.intensity, this;
      }
    }, {
      key: "toJSON",
      value: function toJSON(t) {
        var e = _get(_getPrototypeOf(pc.prototype), "toJSON", this).call(this, t);

        return e.object.color = this.color.getHex(), e.object.intensity = this.intensity, void 0 !== this.groundColor && (e.object.groundColor = this.groundColor.getHex()), void 0 !== this.distance && (e.object.distance = this.distance), void 0 !== this.angle && (e.object.angle = this.angle), void 0 !== this.decay && (e.object.decay = this.decay), void 0 !== this.penumbra && (e.object.penumbra = this.penumbra), void 0 !== this.shadow && (e.object.shadow = this.shadow.toJSON()), e;
      }
    }]);

    return pc;
  }(Pe);

  pc.prototype.isLight = !0;

  var mc = /*#__PURE__*/function (_pc) {
    _inherits(mc, _pc);

    var _super114 = _createSuper(mc);

    function mc(t, e, n) {
      var _this89;

      _classCallCheck(this, mc);

      _this89 = _super114.call(this, t, n), _this89.type = "HemisphereLight", _this89.position.copy(Pe.DefaultUp), _this89.updateMatrix(), _this89.groundColor = new Qe(e);
      return _this89;
    }

    _createClass(mc, [{
      key: "copy",
      value: function copy(t) {
        return pc.prototype.copy.call(this, t), this.groundColor.copy(t.groundColor), this;
      }
    }]);

    return mc;
  }(pc);

  mc.prototype.isHemisphereLight = !0;
  var fc = new ae(),
      gc = new Rt(),
      vc = new Rt();

  var yc = /*#__PURE__*/function () {
    function yc(t) {
      _classCallCheck(this, yc);

      this.camera = t, this.bias = 0, this.normalBias = 0, this.radius = 1, this.mapSize = new vt(512, 512), this.map = null, this.mapPass = null, this.matrix = new ae(), this.autoUpdate = !0, this.needsUpdate = !1, this._frustum = new ai(), this._frameExtents = new vt(1, 1), this._viewportCount = 1, this._viewports = [new St(0, 0, 1, 1)];
    }

    _createClass(yc, [{
      key: "getViewportCount",
      value: function getViewportCount() {
        return this._viewportCount;
      }
    }, {
      key: "getFrustum",
      value: function getFrustum() {
        return this._frustum;
      }
    }, {
      key: "updateMatrices",
      value: function updateMatrices(t) {
        var e = this.camera,
            n = this.matrix;
        gc.setFromMatrixPosition(t.matrixWorld), e.position.copy(gc), vc.setFromMatrixPosition(t.target.matrixWorld), e.lookAt(vc), e.updateMatrixWorld(), fc.multiplyMatrices(e.projectionMatrix, e.matrixWorldInverse), this._frustum.setFromProjectionMatrix(fc), n.set(.5, 0, 0, .5, 0, .5, 0, .5, 0, 0, .5, .5, 0, 0, 0, 1), n.multiply(e.projectionMatrix), n.multiply(e.matrixWorldInverse);
      }
    }, {
      key: "getViewport",
      value: function getViewport(t) {
        return this._viewports[t];
      }
    }, {
      key: "getFrameExtents",
      value: function getFrameExtents() {
        return this._frameExtents;
      }
    }, {
      key: "dispose",
      value: function dispose() {
        this.map && this.map.dispose(), this.mapPass && this.mapPass.dispose();
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.camera = t.camera.clone(), this.bias = t.bias, this.radius = t.radius, this.mapSize.copy(t.mapSize), this;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = {};
        return 0 !== this.bias && (t.bias = this.bias), 0 !== this.normalBias && (t.normalBias = this.normalBias), 1 !== this.radius && (t.radius = this.radius), 512 === this.mapSize.x && 512 === this.mapSize.y || (t.mapSize = this.mapSize.toArray()), t.camera = this.camera.toJSON(!1).object, delete t.camera.matrix, t;
      }
    }]);

    return yc;
  }();

  var xc = /*#__PURE__*/function (_yc) {
    _inherits(xc, _yc);

    var _super115 = _createSuper(xc);

    function xc() {
      var _this90;

      _classCallCheck(this, xc);

      _this90 = _super115.call(this, new Jn(50, 1, .5, 500)), _this90.focus = 1;
      return _this90;
    }

    _createClass(xc, [{
      key: "updateMatrices",
      value: function updateMatrices(t) {
        var e = this.camera,
            n = 2 * lt * t.angle * this.focus,
            i = this.mapSize.width / this.mapSize.height,
            r = t.distance || e.far;
        n === e.fov && i === e.aspect && r === e.far || (e.fov = n, e.aspect = i, e.far = r, e.updateProjectionMatrix()), _get(_getPrototypeOf(xc.prototype), "updateMatrices", this).call(this, t);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(xc.prototype), "copy", this).call(this, t), this.focus = t.focus, this;
      }
    }]);

    return xc;
  }(yc);

  xc.prototype.isSpotLightShadow = !0;

  var _c = /*#__PURE__*/function (_pc2) {
    _inherits(_c, _pc2);

    var _super116 = _createSuper(_c);

    function _c(t, e) {
      var _this91;

      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : Math.PI / 3;
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;
      var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 1;

      _classCallCheck(this, _c);

      _this91 = _super116.call(this, t, e), _this91.type = "SpotLight", _this91.position.copy(Pe.DefaultUp), _this91.updateMatrix(), _this91.target = new Pe(), _this91.distance = n, _this91.angle = i, _this91.penumbra = r, _this91.decay = s, _this91.shadow = new xc();
      return _this91;
    }

    _createClass(_c, [{
      key: "power",
      get: function get() {
        return this.intensity * Math.PI;
      },
      set: function set(t) {
        this.intensity = t / Math.PI;
      }
    }, {
      key: "dispose",
      value: function dispose() {
        this.shadow.dispose();
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(_c.prototype), "copy", this).call(this, t), this.distance = t.distance, this.angle = t.angle, this.penumbra = t.penumbra, this.decay = t.decay, this.target = t.target.clone(), this.shadow = t.shadow.clone(), this;
      }
    }]);

    return _c;
  }(pc);

  _c.prototype.isSpotLight = !0;
  var Mc = new ae(),
      bc = new Rt(),
      wc = new Rt();

  var Sc = /*#__PURE__*/function (_yc2) {
    _inherits(Sc, _yc2);

    var _super117 = _createSuper(Sc);

    function Sc() {
      var _this92;

      _classCallCheck(this, Sc);

      _this92 = _super117.call(this, new Jn(90, 1, .5, 500)), _this92._frameExtents = new vt(4, 2), _this92._viewportCount = 6, _this92._viewports = [new St(2, 1, 1, 1), new St(0, 1, 1, 1), new St(3, 1, 1, 1), new St(1, 1, 1, 1), new St(3, 0, 1, 1), new St(1, 0, 1, 1)], _this92._cubeDirections = [new Rt(1, 0, 0), new Rt(-1, 0, 0), new Rt(0, 0, 1), new Rt(0, 0, -1), new Rt(0, 1, 0), new Rt(0, -1, 0)], _this92._cubeUps = [new Rt(0, 1, 0), new Rt(0, 1, 0), new Rt(0, 1, 0), new Rt(0, 1, 0), new Rt(0, 0, 1), new Rt(0, 0, -1)];
      return _this92;
    }

    _createClass(Sc, [{
      key: "updateMatrices",
      value: function updateMatrices(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        var n = this.camera,
            i = this.matrix,
            r = t.distance || n.far;
        r !== n.far && (n.far = r, n.updateProjectionMatrix()), bc.setFromMatrixPosition(t.matrixWorld), n.position.copy(bc), wc.copy(n.position), wc.add(this._cubeDirections[e]), n.up.copy(this._cubeUps[e]), n.lookAt(wc), n.updateMatrixWorld(), i.makeTranslation(-bc.x, -bc.y, -bc.z), Mc.multiplyMatrices(n.projectionMatrix, n.matrixWorldInverse), this._frustum.setFromProjectionMatrix(Mc);
      }
    }]);

    return Sc;
  }(yc);

  Sc.prototype.isPointLightShadow = !0;

  var Tc = /*#__PURE__*/function (_pc3) {
    _inherits(Tc, _pc3);

    var _super118 = _createSuper(Tc);

    function Tc(t, e) {
      var _this93;

      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;

      _classCallCheck(this, Tc);

      _this93 = _super118.call(this, t, e), _this93.type = "PointLight", _this93.distance = n, _this93.decay = i, _this93.shadow = new Sc();
      return _this93;
    }

    _createClass(Tc, [{
      key: "power",
      get: function get() {
        return 4 * this.intensity * Math.PI;
      },
      set: function set(t) {
        this.intensity = t / (4 * Math.PI);
      }
    }, {
      key: "dispose",
      value: function dispose() {
        this.shadow.dispose();
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Tc.prototype), "copy", this).call(this, t), this.distance = t.distance, this.decay = t.decay, this.shadow = t.shadow.clone(), this;
      }
    }]);

    return Tc;
  }(pc);

  Tc.prototype.isPointLight = !0;

  var Ec = /*#__PURE__*/function (_yc3) {
    _inherits(Ec, _yc3);

    var _super119 = _createSuper(Ec);

    function Ec() {
      _classCallCheck(this, Ec);

      return _super119.call(this, new xi(-5, 5, 5, -5, .5, 500));
    }

    return Ec;
  }(yc);

  Ec.prototype.isDirectionalLightShadow = !0;

  var Ac = /*#__PURE__*/function (_pc4) {
    _inherits(Ac, _pc4);

    var _super120 = _createSuper(Ac);

    function Ac(t, e) {
      var _this94;

      _classCallCheck(this, Ac);

      _this94 = _super120.call(this, t, e), _this94.type = "DirectionalLight", _this94.position.copy(Pe.DefaultUp), _this94.updateMatrix(), _this94.target = new Pe(), _this94.shadow = new Ec();
      return _this94;
    }

    _createClass(Ac, [{
      key: "dispose",
      value: function dispose() {
        this.shadow.dispose();
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Ac.prototype), "copy", this).call(this, t), this.target = t.target.clone(), this.shadow = t.shadow.clone(), this;
      }
    }]);

    return Ac;
  }(pc);

  Ac.prototype.isDirectionalLight = !0;

  var Lc = /*#__PURE__*/function (_pc5) {
    _inherits(Lc, _pc5);

    var _super121 = _createSuper(Lc);

    function Lc(t, e) {
      var _this95;

      _classCallCheck(this, Lc);

      _this95 = _super121.call(this, t, e), _this95.type = "AmbientLight";
      return _this95;
    }

    return Lc;
  }(pc);

  Lc.prototype.isAmbientLight = !0;

  var Rc = /*#__PURE__*/function (_pc6) {
    _inherits(Rc, _pc6);

    var _super122 = _createSuper(Rc);

    function Rc(t, e) {
      var _this96;

      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 10;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 10;

      _classCallCheck(this, Rc);

      _this96 = _super122.call(this, t, e), _this96.type = "RectAreaLight", _this96.width = n, _this96.height = i;
      return _this96;
    }

    _createClass(Rc, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Rc.prototype), "copy", this).call(this, t), this.width = t.width, this.height = t.height, this;
      }
    }, {
      key: "toJSON",
      value: function toJSON(t) {
        var e = _get(_getPrototypeOf(Rc.prototype), "toJSON", this).call(this, t);

        return e.object.width = this.width, e.object.height = this.height, e;
      }
    }]);

    return Rc;
  }(pc);

  Rc.prototype.isRectAreaLight = !0;

  var Cc = /*#__PURE__*/function () {
    function Cc() {
      _classCallCheck(this, Cc);

      this.coefficients = [];

      for (var _t268 = 0; _t268 < 9; _t268++) {
        this.coefficients.push(new Rt());
      }
    }

    _createClass(Cc, [{
      key: "set",
      value: function set(t) {
        for (var _e235 = 0; _e235 < 9; _e235++) {
          this.coefficients[_e235].copy(t[_e235]);
        }

        return this;
      }
    }, {
      key: "zero",
      value: function zero() {
        for (var _t269 = 0; _t269 < 9; _t269++) {
          this.coefficients[_t269].set(0, 0, 0);
        }

        return this;
      }
    }, {
      key: "getAt",
      value: function getAt(t, e) {
        var n = t.x,
            i = t.y,
            r = t.z,
            s = this.coefficients;
        return e.copy(s[0]).multiplyScalar(.282095), e.addScaledVector(s[1], .488603 * i), e.addScaledVector(s[2], .488603 * r), e.addScaledVector(s[3], .488603 * n), e.addScaledVector(s[4], n * i * 1.092548), e.addScaledVector(s[5], i * r * 1.092548), e.addScaledVector(s[6], .315392 * (3 * r * r - 1)), e.addScaledVector(s[7], n * r * 1.092548), e.addScaledVector(s[8], .546274 * (n * n - i * i)), e;
      }
    }, {
      key: "getIrradianceAt",
      value: function getIrradianceAt(t, e) {
        var n = t.x,
            i = t.y,
            r = t.z,
            s = this.coefficients;
        return e.copy(s[0]).multiplyScalar(.886227), e.addScaledVector(s[1], 1.023328 * i), e.addScaledVector(s[2], 1.023328 * r), e.addScaledVector(s[3], 1.023328 * n), e.addScaledVector(s[4], .858086 * n * i), e.addScaledVector(s[5], .858086 * i * r), e.addScaledVector(s[6], .743125 * r * r - .247708), e.addScaledVector(s[7], .858086 * n * r), e.addScaledVector(s[8], .429043 * (n * n - i * i)), e;
      }
    }, {
      key: "add",
      value: function add(t) {
        for (var _e236 = 0; _e236 < 9; _e236++) {
          this.coefficients[_e236].add(t.coefficients[_e236]);
        }

        return this;
      }
    }, {
      key: "addScaledSH",
      value: function addScaledSH(t, e) {
        for (var _n224 = 0; _n224 < 9; _n224++) {
          this.coefficients[_n224].addScaledVector(t.coefficients[_n224], e);
        }

        return this;
      }
    }, {
      key: "scale",
      value: function scale(t) {
        for (var _e237 = 0; _e237 < 9; _e237++) {
          this.coefficients[_e237].multiplyScalar(t);
        }

        return this;
      }
    }, {
      key: "lerp",
      value: function lerp(t, e) {
        for (var _n225 = 0; _n225 < 9; _n225++) {
          this.coefficients[_n225].lerp(t.coefficients[_n225], e);
        }

        return this;
      }
    }, {
      key: "equals",
      value: function equals(t) {
        for (var _e238 = 0; _e238 < 9; _e238++) {
          if (!this.coefficients[_e238].equals(t.coefficients[_e238])) return !1;
        }

        return !0;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.set(t.coefficients);
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }, {
      key: "fromArray",
      value: function fromArray(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        var n = this.coefficients;

        for (var _i167 = 0; _i167 < 9; _i167++) {
          n[_i167].fromArray(t, e + 3 * _i167);
        }

        return this;
      }
    }, {
      key: "toArray",
      value: function toArray() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
        var n = this.coefficients;

        for (var _i168 = 0; _i168 < 9; _i168++) {
          n[_i168].toArray(t, e + 3 * _i168);
        }

        return t;
      }
    }], [{
      key: "getBasisAt",
      value: function getBasisAt(t, e) {
        var n = t.x,
            i = t.y,
            r = t.z;
        e[0] = .282095, e[1] = .488603 * i, e[2] = .488603 * r, e[3] = .488603 * n, e[4] = 1.092548 * n * i, e[5] = 1.092548 * i * r, e[6] = .315392 * (3 * r * r - 1), e[7] = 1.092548 * n * r, e[8] = .546274 * (n * n - i * i);
      }
    }]);

    return Cc;
  }();

  Cc.prototype.isSphericalHarmonics3 = !0;

  var Pc = /*#__PURE__*/function (_pc7) {
    _inherits(Pc, _pc7);

    var _super123 = _createSuper(Pc);

    function Pc() {
      var _this97;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Cc();
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;

      _classCallCheck(this, Pc);

      _this97 = _super123.call(this, void 0, e), _this97.sh = t;
      return _this97;
    }

    _createClass(Pc, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Pc.prototype), "copy", this).call(this, t), this.sh.copy(t.sh), this;
      }
    }, {
      key: "fromJSON",
      value: function fromJSON(t) {
        return this.intensity = t.intensity, this.sh.fromArray(t.sh), this;
      }
    }, {
      key: "toJSON",
      value: function toJSON(t) {
        var e = _get(_getPrototypeOf(Pc.prototype), "toJSON", this).call(this, t);

        return e.object.sh = this.sh.toArray(), e;
      }
    }]);

    return Pc;
  }(pc);

  Pc.prototype.isLightProbe = !0;

  var Ic = /*#__PURE__*/function (_ic6) {
    _inherits(Ic, _ic6);

    var _super124 = _createSuper(Ic);

    function Ic(t) {
      var _this98;

      _classCallCheck(this, Ic);

      _this98 = _super124.call(this, t), _this98.textures = {};
      return _this98;
    }

    _createClass(Ic, [{
      key: "load",
      value: function load(t, e, n, i) {
        var r = this,
            s = new sc(r.manager);
        s.setPath(r.path), s.setRequestHeader(r.requestHeader), s.setWithCredentials(r.withCredentials), s.load(t, function (n) {
          try {
            e(r.parse(JSON.parse(n)));
          } catch (e) {
            i ? i(e) : console.error(e), r.manager.itemError(t);
          }
        }, n, i);
      }
    }, {
      key: "parse",
      value: function parse(t) {
        var e = this.textures;

        function n(t) {
          return void 0 === e[t] && console.warn("THREE.MaterialLoader: Undefined texture", t), e[t];
        }

        var i = new Ol[t.type]();
        if (void 0 !== t.uuid && (i.uuid = t.uuid), void 0 !== t.name && (i.name = t.name), void 0 !== t.color && void 0 !== i.color && i.color.setHex(t.color), void 0 !== t.roughness && (i.roughness = t.roughness), void 0 !== t.metalness && (i.metalness = t.metalness), void 0 !== t.sheen && (i.sheen = new Qe().setHex(t.sheen)), void 0 !== t.emissive && void 0 !== i.emissive && i.emissive.setHex(t.emissive), void 0 !== t.specular && void 0 !== i.specular && i.specular.setHex(t.specular), void 0 !== t.specularIntensity && (i.specularIntensity = t.specularIntensity), void 0 !== t.specularTint && void 0 !== i.specularTint && i.specularTint.setHex(t.specularTint), void 0 !== t.shininess && (i.shininess = t.shininess), void 0 !== t.clearcoat && (i.clearcoat = t.clearcoat), void 0 !== t.clearcoatRoughness && (i.clearcoatRoughness = t.clearcoatRoughness), void 0 !== t.transmission && (i.transmission = t.transmission), void 0 !== t.thickness && (i.thickness = t.thickness), void 0 !== t.attenuationDistance && (i.attenuationDistance = t.attenuationDistance), void 0 !== t.attenuationTint && void 0 !== i.attenuationTint && i.attenuationTint.setHex(t.attenuationTint), void 0 !== t.fog && (i.fog = t.fog), void 0 !== t.flatShading && (i.flatShading = t.flatShading), void 0 !== t.blending && (i.blending = t.blending), void 0 !== t.combine && (i.combine = t.combine), void 0 !== t.side && (i.side = t.side), void 0 !== t.shadowSide && (i.shadowSide = t.shadowSide), void 0 !== t.opacity && (i.opacity = t.opacity), void 0 !== t.transparent && (i.transparent = t.transparent), void 0 !== t.alphaTest && (i.alphaTest = t.alphaTest), void 0 !== t.depthTest && (i.depthTest = t.depthTest), void 0 !== t.depthWrite && (i.depthWrite = t.depthWrite), void 0 !== t.colorWrite && (i.colorWrite = t.colorWrite), void 0 !== t.stencilWrite && (i.stencilWrite = t.stencilWrite), void 0 !== t.stencilWriteMask && (i.stencilWriteMask = t.stencilWriteMask), void 0 !== t.stencilFunc && (i.stencilFunc = t.stencilFunc), void 0 !== t.stencilRef && (i.stencilRef = t.stencilRef), void 0 !== t.stencilFuncMask && (i.stencilFuncMask = t.stencilFuncMask), void 0 !== t.stencilFail && (i.stencilFail = t.stencilFail), void 0 !== t.stencilZFail && (i.stencilZFail = t.stencilZFail), void 0 !== t.stencilZPass && (i.stencilZPass = t.stencilZPass), void 0 !== t.wireframe && (i.wireframe = t.wireframe), void 0 !== t.wireframeLinewidth && (i.wireframeLinewidth = t.wireframeLinewidth), void 0 !== t.wireframeLinecap && (i.wireframeLinecap = t.wireframeLinecap), void 0 !== t.wireframeLinejoin && (i.wireframeLinejoin = t.wireframeLinejoin), void 0 !== t.rotation && (i.rotation = t.rotation), 1 !== t.linewidth && (i.linewidth = t.linewidth), void 0 !== t.dashSize && (i.dashSize = t.dashSize), void 0 !== t.gapSize && (i.gapSize = t.gapSize), void 0 !== t.scale && (i.scale = t.scale), void 0 !== t.polygonOffset && (i.polygonOffset = t.polygonOffset), void 0 !== t.polygonOffsetFactor && (i.polygonOffsetFactor = t.polygonOffsetFactor), void 0 !== t.polygonOffsetUnits && (i.polygonOffsetUnits = t.polygonOffsetUnits), void 0 !== t.dithering && (i.dithering = t.dithering), void 0 !== t.alphaToCoverage && (i.alphaToCoverage = t.alphaToCoverage), void 0 !== t.premultipliedAlpha && (i.premultipliedAlpha = t.premultipliedAlpha), void 0 !== t.visible && (i.visible = t.visible), void 0 !== t.toneMapped && (i.toneMapped = t.toneMapped), void 0 !== t.userData && (i.userData = t.userData), void 0 !== t.vertexColors && ("number" == typeof t.vertexColors ? i.vertexColors = t.vertexColors > 0 : i.vertexColors = t.vertexColors), void 0 !== t.uniforms) for (var _e239 in t.uniforms) {
          var _r134 = t.uniforms[_e239];

          switch (i.uniforms[_e239] = {}, _r134.type) {
            case "t":
              i.uniforms[_e239].value = n(_r134.value);
              break;

            case "c":
              i.uniforms[_e239].value = new Qe().setHex(_r134.value);
              break;

            case "v2":
              i.uniforms[_e239].value = new vt().fromArray(_r134.value);
              break;

            case "v3":
              i.uniforms[_e239].value = new Rt().fromArray(_r134.value);
              break;

            case "v4":
              i.uniforms[_e239].value = new St().fromArray(_r134.value);
              break;

            case "m3":
              i.uniforms[_e239].value = new yt().fromArray(_r134.value);
              break;

            case "m4":
              i.uniforms[_e239].value = new ae().fromArray(_r134.value);
              break;

            default:
              i.uniforms[_e239].value = _r134.value;
          }
        }
        if (void 0 !== t.defines && (i.defines = t.defines), void 0 !== t.vertexShader && (i.vertexShader = t.vertexShader), void 0 !== t.fragmentShader && (i.fragmentShader = t.fragmentShader), void 0 !== t.extensions) for (var _e240 in t.extensions) {
          i.extensions[_e240] = t.extensions[_e240];
        }

        if (void 0 !== t.shading && (i.flatShading = 1 === t.shading), void 0 !== t.size && (i.size = t.size), void 0 !== t.sizeAttenuation && (i.sizeAttenuation = t.sizeAttenuation), void 0 !== t.map && (i.map = n(t.map)), void 0 !== t.matcap && (i.matcap = n(t.matcap)), void 0 !== t.alphaMap && (i.alphaMap = n(t.alphaMap)), void 0 !== t.bumpMap && (i.bumpMap = n(t.bumpMap)), void 0 !== t.bumpScale && (i.bumpScale = t.bumpScale), void 0 !== t.normalMap && (i.normalMap = n(t.normalMap)), void 0 !== t.normalMapType && (i.normalMapType = t.normalMapType), void 0 !== t.normalScale) {
          var _e241 = t.normalScale;
          !1 === Array.isArray(_e241) && (_e241 = [_e241, _e241]), i.normalScale = new vt().fromArray(_e241);
        }

        return void 0 !== t.displacementMap && (i.displacementMap = n(t.displacementMap)), void 0 !== t.displacementScale && (i.displacementScale = t.displacementScale), void 0 !== t.displacementBias && (i.displacementBias = t.displacementBias), void 0 !== t.roughnessMap && (i.roughnessMap = n(t.roughnessMap)), void 0 !== t.metalnessMap && (i.metalnessMap = n(t.metalnessMap)), void 0 !== t.emissiveMap && (i.emissiveMap = n(t.emissiveMap)), void 0 !== t.emissiveIntensity && (i.emissiveIntensity = t.emissiveIntensity), void 0 !== t.specularMap && (i.specularMap = n(t.specularMap)), void 0 !== t.specularIntensityMap && (i.specularIntensityMap = n(t.specularIntensityMap)), void 0 !== t.specularTintMap && (i.specularTintMap = n(t.specularTintMap)), void 0 !== t.envMap && (i.envMap = n(t.envMap)), void 0 !== t.envMapIntensity && (i.envMapIntensity = t.envMapIntensity), void 0 !== t.reflectivity && (i.reflectivity = t.reflectivity), void 0 !== t.refractionRatio && (i.refractionRatio = t.refractionRatio), void 0 !== t.lightMap && (i.lightMap = n(t.lightMap)), void 0 !== t.lightMapIntensity && (i.lightMapIntensity = t.lightMapIntensity), void 0 !== t.aoMap && (i.aoMap = n(t.aoMap)), void 0 !== t.aoMapIntensity && (i.aoMapIntensity = t.aoMapIntensity), void 0 !== t.gradientMap && (i.gradientMap = n(t.gradientMap)), void 0 !== t.clearcoatMap && (i.clearcoatMap = n(t.clearcoatMap)), void 0 !== t.clearcoatRoughnessMap && (i.clearcoatRoughnessMap = n(t.clearcoatRoughnessMap)), void 0 !== t.clearcoatNormalMap && (i.clearcoatNormalMap = n(t.clearcoatNormalMap)), void 0 !== t.clearcoatNormalScale && (i.clearcoatNormalScale = new vt().fromArray(t.clearcoatNormalScale)), void 0 !== t.transmissionMap && (i.transmissionMap = n(t.transmissionMap)), void 0 !== t.thicknessMap && (i.thicknessMap = n(t.thicknessMap)), i;
      }
    }, {
      key: "setTextures",
      value: function setTextures(t) {
        return this.textures = t, this;
      }
    }]);

    return Ic;
  }(ic);

  var Dc = /*#__PURE__*/function () {
    function Dc() {
      _classCallCheck(this, Dc);
    }

    _createClass(Dc, null, [{
      key: "decodeText",
      value: function decodeText(t) {
        if ("undefined" != typeof TextDecoder) return new TextDecoder().decode(t);
        var e = "";

        for (var _n226 = 0, _i169 = t.length; _n226 < _i169; _n226++) {
          e += String.fromCharCode(t[_n226]);
        }

        try {
          return decodeURIComponent(escape(e));
        } catch (t) {
          return e;
        }
      }
    }, {
      key: "extractUrlBase",
      value: function extractUrlBase(t) {
        var e = t.lastIndexOf("/");
        return -1 === e ? "./" : t.substr(0, e + 1);
      }
    }]);

    return Dc;
  }();

  var Nc = /*#__PURE__*/function (_wn17) {
    _inherits(Nc, _wn17);

    var _super125 = _createSuper(Nc);

    function Nc() {
      var _this99;

      _classCallCheck(this, Nc);

      _this99 = _super125.call(this), _this99.type = "InstancedBufferGeometry", _this99.instanceCount = 1 / 0;
      return _this99;
    }

    _createClass(Nc, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Nc.prototype), "copy", this).call(this, t), this.instanceCount = t.instanceCount, this;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(Nc.prototype), "toJSON", this).call(this, this);

        return t.instanceCount = this.instanceCount, t.isInstancedBufferGeometry = !0, t;
      }
    }]);

    return Nc;
  }(wn);

  Nc.prototype.isInstancedBufferGeometry = !0;

  var Bc = /*#__PURE__*/function (_en11) {
    _inherits(Bc, _en11);

    var _super126 = _createSuper(Bc);

    function Bc(t, e, n) {
      var _this100;

      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;

      _classCallCheck(this, Bc);

      "number" == typeof n && (i = n, n = !1, console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")), _this100 = _super126.call(this, t, e, n), _this100.meshPerAttribute = i;
      return _this100;
    }

    _createClass(Bc, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Bc.prototype), "copy", this).call(this, t), this.meshPerAttribute = t.meshPerAttribute, this;
      }
    }, {
      key: "toJSON",
      value: function toJSON() {
        var t = _get(_getPrototypeOf(Bc.prototype), "toJSON", this).call(this);

        return t.meshPerAttribute = this.meshPerAttribute, t.isInstancedBufferAttribute = !0, t;
      }
    }]);

    return Bc;
  }(en);

  Bc.prototype.isInstancedBufferAttribute = !0;

  var zc = /*#__PURE__*/function (_ic7) {
    _inherits(zc, _ic7);

    var _super127 = _createSuper(zc);

    function zc(t) {
      _classCallCheck(this, zc);

      return _super127.call(this, t);
    }

    _createClass(zc, [{
      key: "load",
      value: function load(t, e, n, i) {
        var r = this,
            s = new sc(r.manager);
        s.setPath(r.path), s.setRequestHeader(r.requestHeader), s.setWithCredentials(r.withCredentials), s.load(t, function (n) {
          try {
            e(r.parse(JSON.parse(n)));
          } catch (e) {
            i ? i(e) : console.error(e), r.manager.itemError(t);
          }
        }, n, i);
      }
    }, {
      key: "parse",
      value: function parse(t) {
        var e = {},
            n = {};

        function i(t, i) {
          if (void 0 !== e[i]) return e[i];

          var r = t.interleavedBuffers[i],
              s = function (t, e) {
            if (void 0 !== n[e]) return n[e];
            var i = t.arrayBuffers[e],
                r = new Uint32Array(i).buffer;
            return n[e] = r, r;
          }(t, r.buffer),
              a = fn(r.type, s),
              o = new ea(a, r.stride);

          return o.uuid = r.uuid, e[i] = o, o;
        }

        var r = t.isInstancedBufferGeometry ? new Nc() : new wn(),
            s = t.data.index;

        if (void 0 !== s) {
          var _t270 = fn(s.type, s.array);

          r.setIndex(new en(_t270, 1));
        }

        var a = t.data.attributes;

        for (var _e242 in a) {
          var _n227 = a[_e242];

          var _s79 = void 0;

          if (_n227.isInterleavedBufferAttribute) {
            var _e243 = i(t.data, _n227.data);

            _s79 = new ia(_e243, _n227.itemSize, _n227.offset, _n227.normalized);
          } else {
            var _t271 = fn(_n227.type, _n227.array);

            _s79 = new (_n227.isInstancedBufferAttribute ? Bc : en)(_t271, _n227.itemSize, _n227.normalized);
          }

          void 0 !== _n227.name && (_s79.name = _n227.name), void 0 !== _n227.usage && _s79.setUsage(_n227.usage), void 0 !== _n227.updateRange && (_s79.updateRange.offset = _n227.updateRange.offset, _s79.updateRange.count = _n227.updateRange.count), r.setAttribute(_e242, _s79);
        }

        var o = t.data.morphAttributes;
        if (o) for (var _e244 in o) {
          var _n228 = o[_e244],
              _s80 = [];

          for (var _e245 = 0, _r135 = _n228.length; _e245 < _r135; _e245++) {
            var _r136 = _n228[_e245];

            var _a63 = void 0;

            if (_r136.isInterleavedBufferAttribute) {
              var _e246 = i(t.data, _r136.data);

              _a63 = new ia(_e246, _r136.itemSize, _r136.offset, _r136.normalized);
            } else {
              var _t272 = fn(_r136.type, _r136.array);

              _a63 = new en(_t272, _r136.itemSize, _r136.normalized);
            }

            void 0 !== _r136.name && (_a63.name = _r136.name), _s80.push(_a63);
          }

          r.morphAttributes[_e244] = _s80;
        }
        t.data.morphTargetsRelative && (r.morphTargetsRelative = !0);
        var l = t.data.groups || t.data.drawcalls || t.data.offsets;
        if (void 0 !== l) for (var _t273 = 0, _e247 = l.length; _t273 !== _e247; ++_t273) {
          var _e248 = l[_t273];
          r.addGroup(_e248.start, _e248.count, _e248.materialIndex);
        }
        var c = t.data.boundingSphere;

        if (void 0 !== c) {
          var _t274 = new Rt();

          void 0 !== c.center && _t274.fromArray(c.center), r.boundingSphere = new Qt(_t274, c.radius);
        }

        return t.name && (r.name = t.name), t.userData && (r.userData = t.userData), r;
      }
    }]);

    return zc;
  }(ic);

  var Fc = {
    UVMapping: i,
    CubeReflectionMapping: r,
    CubeRefractionMapping: s,
    EquirectangularReflectionMapping: a,
    EquirectangularRefractionMapping: o,
    CubeUVReflectionMapping: l,
    CubeUVRefractionMapping: c
  },
      Oc = {
    RepeatWrapping: h,
    ClampToEdgeWrapping: u,
    MirroredRepeatWrapping: d
  },
      Uc = {
    NearestFilter: p,
    NearestMipmapNearestFilter: m,
    NearestMipmapLinearFilter: f,
    LinearFilter: g,
    LinearMipmapNearestFilter: v,
    LinearMipmapLinearFilter: y
  };

  var Hc = /*#__PURE__*/function (_ic8) {
    _inherits(Hc, _ic8);

    var _super128 = _createSuper(Hc);

    function Hc(t) {
      var _this101;

      _classCallCheck(this, Hc);

      _this101 = _super128.call(this, t), "undefined" == typeof createImageBitmap && console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."), "undefined" == typeof fetch && console.warn("THREE.ImageBitmapLoader: fetch() not supported."), _this101.options = {
        premultiplyAlpha: "none"
      };
      return _this101;
    }

    _createClass(Hc, [{
      key: "setOptions",
      value: function setOptions(t) {
        return this.options = t, this;
      }
    }, {
      key: "load",
      value: function load(t, e, n, i) {
        void 0 === t && (t = ""), void 0 !== this.path && (t = this.path + t), t = this.manager.resolveURL(t);
        var r = this,
            s = tc.get(t);
        if (void 0 !== s) return r.manager.itemStart(t), setTimeout(function () {
          e && e(s), r.manager.itemEnd(t);
        }, 0), s;
        var a = {};
        a.credentials = "anonymous" === this.crossOrigin ? "same-origin" : "include", a.headers = this.requestHeader, fetch(t, a).then(function (t) {
          return t.blob();
        }).then(function (t) {
          return createImageBitmap(t, Object.assign(r.options, {
            colorSpaceConversion: "none"
          }));
        }).then(function (n) {
          tc.add(t, n), e && e(n), r.manager.itemEnd(t);
        }).catch(function (e) {
          i && i(e), r.manager.itemError(t), r.manager.itemEnd(t);
        }), r.manager.itemStart(t);
      }
    }]);

    return Hc;
  }(ic);

  Hc.prototype.isImageBitmapLoader = !0;

  var Gc = /*#__PURE__*/function () {
    function Gc() {
      _classCallCheck(this, Gc);

      this.type = "ShapePath", this.color = new Qe(), this.subPaths = [], this.currentPath = null;
    }

    _createClass(Gc, [{
      key: "moveTo",
      value: function moveTo(t, e) {
        return this.currentPath = new uc(), this.subPaths.push(this.currentPath), this.currentPath.moveTo(t, e), this;
      }
    }, {
      key: "lineTo",
      value: function lineTo(t, e) {
        return this.currentPath.lineTo(t, e), this;
      }
    }, {
      key: "quadraticCurveTo",
      value: function quadraticCurveTo(t, e, n, i) {
        return this.currentPath.quadraticCurveTo(t, e, n, i), this;
      }
    }, {
      key: "bezierCurveTo",
      value: function bezierCurveTo(t, e, n, i, r, s) {
        return this.currentPath.bezierCurveTo(t, e, n, i, r, s), this;
      }
    }, {
      key: "splineThru",
      value: function splineThru(t) {
        return this.currentPath.splineThru(t), this;
      }
    }, {
      key: "toShapes",
      value: function toShapes(t, e) {
        function n(t) {
          var e = [];

          for (var _n229 = 0, _i170 = t.length; _n229 < _i170; _n229++) {
            var _i171 = t[_n229],
                _r137 = new dc();

            _r137.curves = _i171.curves, e.push(_r137);
          }

          return e;
        }

        function i(t, e) {
          var n = e.length;
          var i = !1;

          for (var _r138 = n - 1, _s81 = 0; _s81 < n; _r138 = _s81++) {
            var _n230 = e[_r138],
                _a64 = e[_s81],
                _o40 = _a64.x - _n230.x,
                _l33 = _a64.y - _n230.y;

            if (Math.abs(_l33) > Number.EPSILON) {
              if (_l33 < 0 && (_n230 = e[_s81], _o40 = -_o40, _a64 = e[_r138], _l33 = -_l33), t.y < _n230.y || t.y > _a64.y) continue;

              if (t.y === _n230.y) {
                if (t.x === _n230.x) return !0;
              } else {
                var _e249 = _l33 * (t.x - _n230.x) - _o40 * (t.y - _n230.y);

                if (0 === _e249) return !0;
                if (_e249 < 0) continue;
                i = !i;
              }
            } else {
              if (t.y !== _n230.y) continue;
              if (_a64.x <= t.x && t.x <= _n230.x || _n230.x <= t.x && t.x <= _a64.x) return !0;
            }
          }

          return i;
        }

        var r = cl.isClockWise,
            s = this.subPaths;
        if (0 === s.length) return [];
        if (!0 === e) return n(s);
        var a, o, l;
        var c = [];
        if (1 === s.length) return o = s[0], l = new dc(), l.curves = o.curves, c.push(l), c;
        var h = !r(s[0].getPoints());
        h = t ? !h : h;
        var u = [],
            d = [];
        var p,
            m,
            f = [],
            g = 0;
        d[g] = void 0, f[g] = [];

        for (var _e250 = 0, _n231 = s.length; _e250 < _n231; _e250++) {
          o = s[_e250], p = o.getPoints(), a = r(p), a = t ? !a : a, a ? (!h && d[g] && g++, d[g] = {
            s: new dc(),
            p: p
          }, d[g].s.curves = o.curves, h && g++, f[g] = []) : f[g].push({
            h: o,
            p: p[0]
          });
        }

        if (!d[0]) return n(s);

        if (d.length > 1) {
          var _t275 = !1;

          var _e251 = [];

          for (var _t276 = 0, _e252 = d.length; _t276 < _e252; _t276++) {
            u[_t276] = [];
          }

          for (var _n232 = 0, _r139 = d.length; _n232 < _r139; _n232++) {
            var _r140 = f[_n232];

            for (var _s82 = 0; _s82 < _r140.length; _s82++) {
              var _a65 = _r140[_s82];

              var _o41 = !0;

              for (var _r141 = 0; _r141 < d.length; _r141++) {
                i(_a65.p, d[_r141].p) && (_n232 !== _r141 && _e251.push({
                  froms: _n232,
                  tos: _r141,
                  hole: _s82
                }), _o41 ? (_o41 = !1, u[_r141].push(_a65)) : _t275 = !0);
              }

              _o41 && u[_n232].push(_a65);
            }
          }

          _e251.length > 0 && (_t275 || (f = u));
        }

        for (var _t277 = 0, _e253 = d.length; _t277 < _e253; _t277++) {
          l = d[_t277].s, c.push(l), m = f[_t277];

          for (var _t278 = 0, _e254 = m.length; _t278 < _e254; _t278++) {
            l.holes.push(m[_t278].h);
          }
        }

        return c;
      }
    }]);

    return Gc;
  }();

  var kc = /*#__PURE__*/function () {
    function kc(t) {
      _classCallCheck(this, kc);

      this.type = "Font", this.data = t;
    }

    _createClass(kc, [{
      key: "generateShapes",
      value: function generateShapes(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 100;

        var n = [],
            i = function (t, e, n) {
          var i = Array.from(t),
              r = e / n.resolution,
              s = (n.boundingBox.yMax - n.boundingBox.yMin + n.underlineThickness) * r,
              a = [];
          var o = 0,
              l = 0;

          for (var _t279 = 0; _t279 < i.length; _t279++) {
            var _e255 = i[_t279];
            if ("\n" === _e255) o = 0, l -= s;else {
              var _t280 = Vc(_e255, r, o, l, n);

              o += _t280.offsetX, a.push(_t280.path);
            }
          }

          return a;
        }(t, e, this.data);

        for (var _t281 = 0, _e256 = i.length; _t281 < _e256; _t281++) {
          Array.prototype.push.apply(n, i[_t281].toShapes());
        }

        return n;
      }
    }]);

    return kc;
  }();

  function Vc(t, e, n, i, r) {
    var s = r.glyphs[t] || r.glyphs["?"];
    if (!s) return void console.error('THREE.Font: character "' + t + '" does not exists in font family ' + r.familyName + ".");
    var a = new Gc();
    var o, l, c, h, u, d, p, m;

    if (s.o) {
      var _t282 = s._cachedOutline || (s._cachedOutline = s.o.split(" "));

      for (var _r142 = 0, _s83 = _t282.length; _r142 < _s83;) {
        switch (_t282[_r142++]) {
          case "m":
            o = _t282[_r142++] * e + n, l = _t282[_r142++] * e + i, a.moveTo(o, l);
            break;

          case "l":
            o = _t282[_r142++] * e + n, l = _t282[_r142++] * e + i, a.lineTo(o, l);
            break;

          case "q":
            c = _t282[_r142++] * e + n, h = _t282[_r142++] * e + i, u = _t282[_r142++] * e + n, d = _t282[_r142++] * e + i, a.quadraticCurveTo(u, d, c, h);
            break;

          case "b":
            c = _t282[_r142++] * e + n, h = _t282[_r142++] * e + i, u = _t282[_r142++] * e + n, d = _t282[_r142++] * e + i, p = _t282[_r142++] * e + n, m = _t282[_r142++] * e + i, a.bezierCurveTo(u, d, p, m, c, h);
        }
      }
    }

    return {
      offsetX: s.ha * e,
      path: a
    };
  }

  kc.prototype.isFont = !0;
  var Wc;
  var jc = {
    getContext: function getContext() {
      return void 0 === Wc && (Wc = new (window.AudioContext || window.webkitAudioContext)()), Wc;
    },
    setContext: function setContext(t) {
      Wc = t;
    }
  };

  var qc = /*#__PURE__*/function (_ic9) {
    _inherits(qc, _ic9);

    var _super129 = _createSuper(qc);

    function qc(t) {
      _classCallCheck(this, qc);

      return _super129.call(this, t);
    }

    _createClass(qc, [{
      key: "load",
      value: function load(t, e, n, i) {
        var r = this,
            s = new sc(this.manager);
        s.setResponseType("arraybuffer"), s.setPath(this.path), s.setRequestHeader(this.requestHeader), s.setWithCredentials(this.withCredentials), s.load(t, function (n) {
          try {
            var _t283 = n.slice(0);

            jc.getContext().decodeAudioData(_t283, function (t) {
              e(t);
            });
          } catch (e) {
            i ? i(e) : console.error(e), r.manager.itemError(t);
          }
        }, n, i);
      }
    }]);

    return qc;
  }(ic);

  var Xc = /*#__PURE__*/function (_Pc) {
    _inherits(Xc, _Pc);

    var _super130 = _createSuper(Xc);

    function Xc(t, e) {
      var _this102;

      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;

      _classCallCheck(this, Xc);

      _this102 = _super130.call(this, void 0, n);
      var i = new Qe().set(t),
          r = new Qe().set(e),
          s = new Rt(i.r, i.g, i.b),
          a = new Rt(r.r, r.g, r.b),
          o = Math.sqrt(Math.PI),
          l = o * Math.sqrt(.75);
      _this102.sh.coefficients[0].copy(s).add(a).multiplyScalar(o), _this102.sh.coefficients[1].copy(s).sub(a).multiplyScalar(l);
      return _this102;
    }

    return Xc;
  }(Pc);

  Xc.prototype.isHemisphereLightProbe = !0;

  var Yc = /*#__PURE__*/function (_Pc2) {
    _inherits(Yc, _Pc2);

    var _super131 = _createSuper(Yc);

    function Yc(t) {
      var _this103;

      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;

      _classCallCheck(this, Yc);

      _this103 = _super131.call(this, void 0, e);
      var n = new Qe().set(t);

      _this103.sh.coefficients[0].set(n.r, n.g, n.b).multiplyScalar(2 * Math.sqrt(Math.PI));

      return _this103;
    }

    return Yc;
  }(Pc);

  Yc.prototype.isAmbientLightProbe = !0;
  var Jc = new ae(),
      Zc = new ae();

  var Qc = /*#__PURE__*/function () {
    function Qc() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : !0;

      _classCallCheck(this, Qc);

      this.autoStart = t, this.startTime = 0, this.oldTime = 0, this.elapsedTime = 0, this.running = !1;
    }

    _createClass(Qc, [{
      key: "start",
      value: function start() {
        this.startTime = Kc(), this.oldTime = this.startTime, this.elapsedTime = 0, this.running = !0;
      }
    }, {
      key: "stop",
      value: function stop() {
        this.getElapsedTime(), this.running = !1, this.autoStart = !1;
      }
    }, {
      key: "getElapsedTime",
      value: function getElapsedTime() {
        return this.getDelta(), this.elapsedTime;
      }
    }, {
      key: "getDelta",
      value: function getDelta() {
        var t = 0;
        if (this.autoStart && !this.running) return this.start(), 0;

        if (this.running) {
          var _e257 = Kc();

          t = (_e257 - this.oldTime) / 1e3, this.oldTime = _e257, this.elapsedTime += t;
        }

        return t;
      }
    }]);

    return Qc;
  }();

  function Kc() {
    return ("undefined" == typeof performance ? Date : performance).now();
  }

  var $c = new Rt(),
      th = new Lt(),
      eh = new Rt(),
      nh = new Rt();

  var ih = /*#__PURE__*/function (_Pe12) {
    _inherits(ih, _Pe12);

    var _super132 = _createSuper(ih);

    function ih(t) {
      var _this104;

      _classCallCheck(this, ih);

      _this104 = _super132.call(this), _this104.type = "Audio", _this104.listener = t, _this104.context = t.context, _this104.gain = _this104.context.createGain(), _this104.gain.connect(t.getInput()), _this104.autoplay = !1, _this104.buffer = null, _this104.detune = 0, _this104.loop = !1, _this104.loopStart = 0, _this104.loopEnd = 0, _this104.offset = 0, _this104.duration = void 0, _this104.playbackRate = 1, _this104.isPlaying = !1, _this104.hasPlaybackControl = !0, _this104.source = null, _this104.sourceType = "empty", _this104._startedAt = 0, _this104._progress = 0, _this104._connected = !1, _this104.filters = [];
      return _this104;
    }

    _createClass(ih, [{
      key: "getOutput",
      value: function getOutput() {
        return this.gain;
      }
    }, {
      key: "setNodeSource",
      value: function setNodeSource(t) {
        return this.hasPlaybackControl = !1, this.sourceType = "audioNode", this.source = t, this.connect(), this;
      }
    }, {
      key: "setMediaElementSource",
      value: function setMediaElementSource(t) {
        return this.hasPlaybackControl = !1, this.sourceType = "mediaNode", this.source = this.context.createMediaElementSource(t), this.connect(), this;
      }
    }, {
      key: "setMediaStreamSource",
      value: function setMediaStreamSource(t) {
        return this.hasPlaybackControl = !1, this.sourceType = "mediaStreamNode", this.source = this.context.createMediaStreamSource(t), this.connect(), this;
      }
    }, {
      key: "setBuffer",
      value: function setBuffer(t) {
        return this.buffer = t, this.sourceType = "buffer", this.autoplay && this.play(), this;
      }
    }, {
      key: "play",
      value: function play() {
        var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;
        if (!0 === this.isPlaying) return void console.warn("THREE.Audio: Audio is already playing.");
        if (!1 === this.hasPlaybackControl) return void console.warn("THREE.Audio: this Audio has no playback control.");
        this._startedAt = this.context.currentTime + t;
        var e = this.context.createBufferSource();
        return e.buffer = this.buffer, e.loop = this.loop, e.loopStart = this.loopStart, e.loopEnd = this.loopEnd, e.onended = this.onEnded.bind(this), e.start(this._startedAt, this._progress + this.offset, this.duration), this.isPlaying = !0, this.source = e, this.setDetune(this.detune), this.setPlaybackRate(this.playbackRate), this.connect();
      }
    }, {
      key: "pause",
      value: function pause() {
        if (!1 !== this.hasPlaybackControl) return !0 === this.isPlaying && (this._progress += Math.max(this.context.currentTime - this._startedAt, 0) * this.playbackRate, !0 === this.loop && (this._progress = this._progress % (this.duration || this.buffer.duration)), this.source.stop(), this.source.onended = null, this.isPlaying = !1), this;
        console.warn("THREE.Audio: this Audio has no playback control.");
      }
    }, {
      key: "stop",
      value: function stop() {
        if (!1 !== this.hasPlaybackControl) return this._progress = 0, this.source.stop(), this.source.onended = null, this.isPlaying = !1, this;
        console.warn("THREE.Audio: this Audio has no playback control.");
      }
    }, {
      key: "connect",
      value: function connect() {
        if (this.filters.length > 0) {
          this.source.connect(this.filters[0]);

          for (var _t284 = 1, _e258 = this.filters.length; _t284 < _e258; _t284++) {
            this.filters[_t284 - 1].connect(this.filters[_t284]);
          }

          this.filters[this.filters.length - 1].connect(this.getOutput());
        } else this.source.connect(this.getOutput());

        return this._connected = !0, this;
      }
    }, {
      key: "disconnect",
      value: function disconnect() {
        if (this.filters.length > 0) {
          this.source.disconnect(this.filters[0]);

          for (var _t285 = 1, _e259 = this.filters.length; _t285 < _e259; _t285++) {
            this.filters[_t285 - 1].disconnect(this.filters[_t285]);
          }

          this.filters[this.filters.length - 1].disconnect(this.getOutput());
        } else this.source.disconnect(this.getOutput());

        return this._connected = !1, this;
      }
    }, {
      key: "getFilters",
      value: function getFilters() {
        return this.filters;
      }
    }, {
      key: "setFilters",
      value: function setFilters(t) {
        return t || (t = []), !0 === this._connected ? (this.disconnect(), this.filters = t.slice(), this.connect()) : this.filters = t.slice(), this;
      }
    }, {
      key: "setDetune",
      value: function setDetune(t) {
        if (this.detune = t, void 0 !== this.source.detune) return !0 === this.isPlaying && this.source.detune.setTargetAtTime(this.detune, this.context.currentTime, .01), this;
      }
    }, {
      key: "getDetune",
      value: function getDetune() {
        return this.detune;
      }
    }, {
      key: "getFilter",
      value: function getFilter() {
        return this.getFilters()[0];
      }
    }, {
      key: "setFilter",
      value: function setFilter(t) {
        return this.setFilters(t ? [t] : []);
      }
    }, {
      key: "setPlaybackRate",
      value: function setPlaybackRate(t) {
        if (!1 !== this.hasPlaybackControl) return this.playbackRate = t, !0 === this.isPlaying && this.source.playbackRate.setTargetAtTime(this.playbackRate, this.context.currentTime, .01), this;
        console.warn("THREE.Audio: this Audio has no playback control.");
      }
    }, {
      key: "getPlaybackRate",
      value: function getPlaybackRate() {
        return this.playbackRate;
      }
    }, {
      key: "onEnded",
      value: function onEnded() {
        this.isPlaying = !1;
      }
    }, {
      key: "getLoop",
      value: function getLoop() {
        return !1 === this.hasPlaybackControl ? (console.warn("THREE.Audio: this Audio has no playback control."), !1) : this.loop;
      }
    }, {
      key: "setLoop",
      value: function setLoop(t) {
        if (!1 !== this.hasPlaybackControl) return this.loop = t, !0 === this.isPlaying && (this.source.loop = this.loop), this;
        console.warn("THREE.Audio: this Audio has no playback control.");
      }
    }, {
      key: "setLoopStart",
      value: function setLoopStart(t) {
        return this.loopStart = t, this;
      }
    }, {
      key: "setLoopEnd",
      value: function setLoopEnd(t) {
        return this.loopEnd = t, this;
      }
    }, {
      key: "getVolume",
      value: function getVolume() {
        return this.gain.gain.value;
      }
    }, {
      key: "setVolume",
      value: function setVolume(t) {
        return this.gain.gain.setTargetAtTime(t, this.context.currentTime, .01), this;
      }
    }]);

    return ih;
  }(Pe);

  var rh = new Rt(),
      sh = new Lt(),
      ah = new Rt(),
      oh = new Rt();

  var lh = /*#__PURE__*/function () {
    function lh(t) {
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 2048;

      _classCallCheck(this, lh);

      this.analyser = t.context.createAnalyser(), this.analyser.fftSize = e, this.data = new Uint8Array(this.analyser.frequencyBinCount), t.getOutput().connect(this.analyser);
    }

    _createClass(lh, [{
      key: "getFrequencyData",
      value: function getFrequencyData() {
        return this.analyser.getByteFrequencyData(this.data), this.data;
      }
    }, {
      key: "getAverageFrequency",
      value: function getAverageFrequency() {
        var t = 0;
        var e = this.getFrequencyData();

        for (var _n233 = 0; _n233 < e.length; _n233++) {
          t += e[_n233];
        }

        return t / e.length;
      }
    }]);

    return lh;
  }();

  var ch = /*#__PURE__*/function () {
    function ch(t, e, n) {
      _classCallCheck(this, ch);

      var i, r, s;

      switch (this.binding = t, this.valueSize = n, e) {
        case "quaternion":
          i = this._slerp, r = this._slerpAdditive, s = this._setAdditiveIdentityQuaternion, this.buffer = new Float64Array(6 * n), this._workIndex = 5;
          break;

        case "string":
        case "bool":
          i = this._select, r = this._select, s = this._setAdditiveIdentityOther, this.buffer = new Array(5 * n);
          break;

        default:
          i = this._lerp, r = this._lerpAdditive, s = this._setAdditiveIdentityNumeric, this.buffer = new Float64Array(5 * n);
      }

      this._mixBufferRegion = i, this._mixBufferRegionAdditive = r, this._setIdentity = s, this._origIndex = 3, this._addIndex = 4, this.cumulativeWeight = 0, this.cumulativeWeightAdditive = 0, this.useCount = 0, this.referenceCount = 0;
    }

    _createClass(ch, [{
      key: "accumulate",
      value: function accumulate(t, e) {
        var n = this.buffer,
            i = this.valueSize,
            r = t * i + i;
        var s = this.cumulativeWeight;

        if (0 === s) {
          for (var _t286 = 0; _t286 !== i; ++_t286) {
            n[r + _t286] = n[_t286];
          }

          s = e;
        } else {
          s += e;

          var _t287 = e / s;

          this._mixBufferRegion(n, r, 0, _t287, i);
        }

        this.cumulativeWeight = s;
      }
    }, {
      key: "accumulateAdditive",
      value: function accumulateAdditive(t) {
        var e = this.buffer,
            n = this.valueSize,
            i = n * this._addIndex;
        0 === this.cumulativeWeightAdditive && this._setIdentity(), this._mixBufferRegionAdditive(e, i, 0, t, n), this.cumulativeWeightAdditive += t;
      }
    }, {
      key: "apply",
      value: function apply(t) {
        var e = this.valueSize,
            n = this.buffer,
            i = t * e + e,
            r = this.cumulativeWeight,
            s = this.cumulativeWeightAdditive,
            a = this.binding;

        if (this.cumulativeWeight = 0, this.cumulativeWeightAdditive = 0, r < 1) {
          var _t288 = e * this._origIndex;

          this._mixBufferRegion(n, i, _t288, 1 - r, e);
        }

        s > 0 && this._mixBufferRegionAdditive(n, i, this._addIndex * e, 1, e);

        for (var _t289 = e, _r143 = e + e; _t289 !== _r143; ++_t289) {
          if (n[_t289] !== n[_t289 + e]) {
            a.setValue(n, i);
            break;
          }
        }
      }
    }, {
      key: "saveOriginalState",
      value: function saveOriginalState() {
        var t = this.binding,
            e = this.buffer,
            n = this.valueSize,
            i = n * this._origIndex;
        t.getValue(e, i);

        for (var _t290 = n, _r144 = i; _t290 !== _r144; ++_t290) {
          e[_t290] = e[i + _t290 % n];
        }

        this._setIdentity(), this.cumulativeWeight = 0, this.cumulativeWeightAdditive = 0;
      }
    }, {
      key: "restoreOriginalState",
      value: function restoreOriginalState() {
        var t = 3 * this.valueSize;
        this.binding.setValue(this.buffer, t);
      }
    }, {
      key: "_setAdditiveIdentityNumeric",
      value: function _setAdditiveIdentityNumeric() {
        var t = this._addIndex * this.valueSize,
            e = t + this.valueSize;

        for (var _n234 = t; _n234 < e; _n234++) {
          this.buffer[_n234] = 0;
        }
      }
    }, {
      key: "_setAdditiveIdentityQuaternion",
      value: function _setAdditiveIdentityQuaternion() {
        this._setAdditiveIdentityNumeric(), this.buffer[this._addIndex * this.valueSize + 3] = 1;
      }
    }, {
      key: "_setAdditiveIdentityOther",
      value: function _setAdditiveIdentityOther() {
        var t = this._origIndex * this.valueSize,
            e = this._addIndex * this.valueSize;

        for (var _n235 = 0; _n235 < this.valueSize; _n235++) {
          this.buffer[e + _n235] = this.buffer[t + _n235];
        }
      }
    }, {
      key: "_select",
      value: function _select(t, e, n, i, r) {
        if (i >= .5) for (var _i172 = 0; _i172 !== r; ++_i172) {
          t[e + _i172] = t[n + _i172];
        }
      }
    }, {
      key: "_slerp",
      value: function _slerp(t, e, n, i) {
        Lt.slerpFlat(t, e, t, e, t, n, i);
      }
    }, {
      key: "_slerpAdditive",
      value: function _slerpAdditive(t, e, n, i, r) {
        var s = this._workIndex * r;
        Lt.multiplyQuaternionsFlat(t, s, t, e, t, n), Lt.slerpFlat(t, e, t, e, t, s, i);
      }
    }, {
      key: "_lerp",
      value: function _lerp(t, e, n, i, r) {
        var s = 1 - i;

        for (var _a66 = 0; _a66 !== r; ++_a66) {
          var _r145 = e + _a66;

          t[_r145] = t[_r145] * s + t[n + _a66] * i;
        }
      }
    }, {
      key: "_lerpAdditive",
      value: function _lerpAdditive(t, e, n, i, r) {
        for (var _s84 = 0; _s84 !== r; ++_s84) {
          var _r146 = e + _s84;

          t[_r146] = t[_r146] + t[n + _s84] * i;
        }
      }
    }]);

    return ch;
  }();

  var hh = "\\[\\]\\.:\\/",
      uh = new RegExp("[\\[\\]\\.:\\/]", "g"),
      dh = "[^\\[\\]\\.:\\/]",
      ph = "[^" + hh.replace("\\.", "") + "]",
      mh = /((?:WC+[\/:])*)/.source.replace("WC", dh),
      fh = /(WCOD+)?/.source.replace("WCOD", ph),
      gh = /(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC", dh),
      vh = /\.(WC+)(?:\[(.+)\])?/.source.replace("WC", dh),
      yh = new RegExp("^" + mh + fh + gh + vh + "$"),
      xh = ["material", "materials", "bones"];

  var _h = /*#__PURE__*/function () {
    function _h(t, e, n) {
      _classCallCheck(this, _h);

      this.path = e, this.parsedPath = n || _h.parseTrackName(e), this.node = _h.findNode(t, this.parsedPath.nodeName) || t, this.rootNode = t, this.getValue = this._getValue_unbound, this.setValue = this._setValue_unbound;
    }

    _createClass(_h, [{
      key: "_getValue_unavailable",
      value: function _getValue_unavailable() {}
    }, {
      key: "_setValue_unavailable",
      value: function _setValue_unavailable() {}
    }, {
      key: "_getValue_direct",
      value: function _getValue_direct(t, e) {
        t[e] = this.node[this.propertyName];
      }
    }, {
      key: "_getValue_array",
      value: function _getValue_array(t, e) {
        var n = this.resolvedProperty;

        for (var _i173 = 0, _r147 = n.length; _i173 !== _r147; ++_i173) {
          t[e++] = n[_i173];
        }
      }
    }, {
      key: "_getValue_arrayElement",
      value: function _getValue_arrayElement(t, e) {
        t[e] = this.resolvedProperty[this.propertyIndex];
      }
    }, {
      key: "_getValue_toArray",
      value: function _getValue_toArray(t, e) {
        this.resolvedProperty.toArray(t, e);
      }
    }, {
      key: "_setValue_direct",
      value: function _setValue_direct(t, e) {
        this.targetObject[this.propertyName] = t[e];
      }
    }, {
      key: "_setValue_direct_setNeedsUpdate",
      value: function _setValue_direct_setNeedsUpdate(t, e) {
        this.targetObject[this.propertyName] = t[e], this.targetObject.needsUpdate = !0;
      }
    }, {
      key: "_setValue_direct_setMatrixWorldNeedsUpdate",
      value: function _setValue_direct_setMatrixWorldNeedsUpdate(t, e) {
        this.targetObject[this.propertyName] = t[e], this.targetObject.matrixWorldNeedsUpdate = !0;
      }
    }, {
      key: "_setValue_array",
      value: function _setValue_array(t, e) {
        var n = this.resolvedProperty;

        for (var _i174 = 0, _r148 = n.length; _i174 !== _r148; ++_i174) {
          n[_i174] = t[e++];
        }
      }
    }, {
      key: "_setValue_array_setNeedsUpdate",
      value: function _setValue_array_setNeedsUpdate(t, e) {
        var n = this.resolvedProperty;

        for (var _i175 = 0, _r149 = n.length; _i175 !== _r149; ++_i175) {
          n[_i175] = t[e++];
        }

        this.targetObject.needsUpdate = !0;
      }
    }, {
      key: "_setValue_array_setMatrixWorldNeedsUpdate",
      value: function _setValue_array_setMatrixWorldNeedsUpdate(t, e) {
        var n = this.resolvedProperty;

        for (var _i176 = 0, _r150 = n.length; _i176 !== _r150; ++_i176) {
          n[_i176] = t[e++];
        }

        this.targetObject.matrixWorldNeedsUpdate = !0;
      }
    }, {
      key: "_setValue_arrayElement",
      value: function _setValue_arrayElement(t, e) {
        this.resolvedProperty[this.propertyIndex] = t[e];
      }
    }, {
      key: "_setValue_arrayElement_setNeedsUpdate",
      value: function _setValue_arrayElement_setNeedsUpdate(t, e) {
        this.resolvedProperty[this.propertyIndex] = t[e], this.targetObject.needsUpdate = !0;
      }
    }, {
      key: "_setValue_arrayElement_setMatrixWorldNeedsUpdate",
      value: function _setValue_arrayElement_setMatrixWorldNeedsUpdate(t, e) {
        this.resolvedProperty[this.propertyIndex] = t[e], this.targetObject.matrixWorldNeedsUpdate = !0;
      }
    }, {
      key: "_setValue_fromArray",
      value: function _setValue_fromArray(t, e) {
        this.resolvedProperty.fromArray(t, e);
      }
    }, {
      key: "_setValue_fromArray_setNeedsUpdate",
      value: function _setValue_fromArray_setNeedsUpdate(t, e) {
        this.resolvedProperty.fromArray(t, e), this.targetObject.needsUpdate = !0;
      }
    }, {
      key: "_setValue_fromArray_setMatrixWorldNeedsUpdate",
      value: function _setValue_fromArray_setMatrixWorldNeedsUpdate(t, e) {
        this.resolvedProperty.fromArray(t, e), this.targetObject.matrixWorldNeedsUpdate = !0;
      }
    }, {
      key: "_getValue_unbound",
      value: function _getValue_unbound(t, e) {
        this.bind(), this.getValue(t, e);
      }
    }, {
      key: "_setValue_unbound",
      value: function _setValue_unbound(t, e) {
        this.bind(), this.setValue(t, e);
      }
    }, {
      key: "bind",
      value: function bind() {
        var t = this.node;
        var e = this.parsedPath,
            n = e.objectName,
            i = e.propertyName;
        var r = e.propertyIndex;
        if (t || (t = _h.findNode(this.rootNode, e.nodeName) || this.rootNode, this.node = t), this.getValue = this._getValue_unavailable, this.setValue = this._setValue_unavailable, !t) return void console.error("THREE.PropertyBinding: Trying to update node for track: " + this.path + " but it wasn't found.");

        if (n) {
          var _i177 = e.objectIndex;

          switch (n) {
            case "materials":
              if (!t.material) return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.", this);
              if (!t.material.materials) return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.", this);
              t = t.material.materials;
              break;

            case "bones":
              if (!t.skeleton) return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.", this);
              t = t.skeleton.bones;

              for (var _e260 = 0; _e260 < t.length; _e260++) {
                if (t[_e260].name === _i177) {
                  _i177 = _e260;
                  break;
                }
              }

              break;

            default:
              if (void 0 === t[n]) return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.", this);
              t = t[n];
          }

          if (void 0 !== _i177) {
            if (void 0 === t[_i177]) return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.", this, t);
            t = t[_i177];
          }
        }

        var s = t[i];

        if (void 0 === s) {
          var _n236 = e.nodeName;
          return void console.error("THREE.PropertyBinding: Trying to update property for track: " + _n236 + "." + i + " but it wasn't found.", t);
        }

        var a = this.Versioning.None;
        this.targetObject = t, void 0 !== t.needsUpdate ? a = this.Versioning.NeedsUpdate : void 0 !== t.matrixWorldNeedsUpdate && (a = this.Versioning.MatrixWorldNeedsUpdate);
        var o = this.BindingType.Direct;

        if (void 0 !== r) {
          if ("morphTargetInfluences" === i) {
            if (!t.geometry) return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.", this);
            if (!t.geometry.isBufferGeometry) return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.", this);
            if (!t.geometry.morphAttributes) return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.", this);
            void 0 !== t.morphTargetDictionary[r] && (r = t.morphTargetDictionary[r]);
          }

          o = this.BindingType.ArrayElement, this.resolvedProperty = s, this.propertyIndex = r;
        } else void 0 !== s.fromArray && void 0 !== s.toArray ? (o = this.BindingType.HasFromToArray, this.resolvedProperty = s) : Array.isArray(s) ? (o = this.BindingType.EntireArray, this.resolvedProperty = s) : this.propertyName = i;

        this.getValue = this.GetterByBindingType[o], this.setValue = this.SetterByBindingTypeAndVersioning[o][a];
      }
    }, {
      key: "unbind",
      value: function unbind() {
        this.node = null, this.getValue = this._getValue_unbound, this.setValue = this._setValue_unbound;
      }
    }], [{
      key: "create",
      value: function create(t, e, n) {
        return t && t.isAnimationObjectGroup ? new _h.Composite(t, e, n) : new _h(t, e, n);
      }
    }, {
      key: "sanitizeNodeName",
      value: function sanitizeNodeName(t) {
        return t.replace(/\s/g, "_").replace(uh, "");
      }
    }, {
      key: "parseTrackName",
      value: function parseTrackName(t) {
        var e = yh.exec(t);
        if (!e) throw new Error("PropertyBinding: Cannot parse trackName: " + t);
        var n = {
          nodeName: e[2],
          objectName: e[3],
          objectIndex: e[4],
          propertyName: e[5],
          propertyIndex: e[6]
        },
            i = n.nodeName && n.nodeName.lastIndexOf(".");

        if (void 0 !== i && -1 !== i) {
          var _t291 = n.nodeName.substring(i + 1);

          -1 !== xh.indexOf(_t291) && (n.nodeName = n.nodeName.substring(0, i), n.objectName = _t291);
        }

        if (null === n.propertyName || 0 === n.propertyName.length) throw new Error("PropertyBinding: can not parse propertyName from trackName: " + t);
        return n;
      }
    }, {
      key: "findNode",
      value: function findNode(t, e) {
        if (!e || "" === e || "." === e || -1 === e || e === t.name || e === t.uuid) return t;

        if (t.skeleton) {
          var _n237 = t.skeleton.getBoneByName(e);

          if (void 0 !== _n237) return _n237;
        }

        if (t.children) {
          var _n238 = function _n238(t) {
            for (var _i179 = 0; _i179 < t.length; _i179++) {
              var _r151 = t[_i179];
              if (_r151.name === e || _r151.uuid === e) return _r151;

              var _s85 = _n238(_r151.children);

              if (_s85) return _s85;
            }

            return null;
          },
              _i178 = _n238(t.children);

          if (_i178) return _i178;
        }

        return null;
      }
    }]);

    return _h;
  }();

  _h.Composite = /*#__PURE__*/function () {
    function _class(t, e, n) {
      _classCallCheck(this, _class);

      var i = n || _h.parseTrackName(e);

      this._targetGroup = t, this._bindings = t.subscribe_(e, i);
    }

    _createClass(_class, [{
      key: "getValue",
      value: function getValue(t, e) {
        this.bind();
        var n = this._targetGroup.nCachedObjects_,
            i = this._bindings[n];
        void 0 !== i && i.getValue(t, e);
      }
    }, {
      key: "setValue",
      value: function setValue(t, e) {
        var n = this._bindings;

        for (var _i180 = this._targetGroup.nCachedObjects_, _r152 = n.length; _i180 !== _r152; ++_i180) {
          n[_i180].setValue(t, e);
        }
      }
    }, {
      key: "bind",
      value: function bind() {
        var t = this._bindings;

        for (var _e261 = this._targetGroup.nCachedObjects_, _n239 = t.length; _e261 !== _n239; ++_e261) {
          t[_e261].bind();
        }
      }
    }, {
      key: "unbind",
      value: function unbind() {
        var t = this._bindings;

        for (var _e262 = this._targetGroup.nCachedObjects_, _n240 = t.length; _e262 !== _n240; ++_e262) {
          t[_e262].unbind();
        }
      }
    }]);

    return _class;
  }(), _h.prototype.BindingType = {
    Direct: 0,
    EntireArray: 1,
    ArrayElement: 2,
    HasFromToArray: 3
  }, _h.prototype.Versioning = {
    None: 0,
    NeedsUpdate: 1,
    MatrixWorldNeedsUpdate: 2
  }, _h.prototype.GetterByBindingType = [_h.prototype._getValue_direct, _h.prototype._getValue_array, _h.prototype._getValue_arrayElement, _h.prototype._getValue_toArray], _h.prototype.SetterByBindingTypeAndVersioning = [[_h.prototype._setValue_direct, _h.prototype._setValue_direct_setNeedsUpdate, _h.prototype._setValue_direct_setMatrixWorldNeedsUpdate], [_h.prototype._setValue_array, _h.prototype._setValue_array_setNeedsUpdate, _h.prototype._setValue_array_setMatrixWorldNeedsUpdate], [_h.prototype._setValue_arrayElement, _h.prototype._setValue_arrayElement_setNeedsUpdate, _h.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate], [_h.prototype._setValue_fromArray, _h.prototype._setValue_fromArray_setNeedsUpdate, _h.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];

  var Mh = /*#__PURE__*/function () {
    function Mh() {
      _classCallCheck(this, Mh);

      this.uuid = ct(), this._objects = Array.prototype.slice.call(arguments), this.nCachedObjects_ = 0;
      var t = {};
      this._indicesByUUID = t;

      for (var _e263 = 0, _n241 = arguments.length; _e263 !== _n241; ++_e263) {
        t[arguments[_e263].uuid] = _e263;
      }

      this._paths = [], this._parsedPaths = [], this._bindings = [], this._bindingsIndicesByPath = {};
      var e = this;
      this.stats = {
        objects: {
          get total() {
            return e._objects.length;
          },

          get inUse() {
            return this.total - e.nCachedObjects_;
          }

        },

        get bindingsPerObject() {
          return e._bindings.length;
        }

      };
    }

    _createClass(Mh, [{
      key: "add",
      value: function add() {
        var t = this._objects,
            e = this._indicesByUUID,
            n = this._paths,
            i = this._parsedPaths,
            r = this._bindings,
            s = r.length;
        var a,
            o = t.length,
            l = this.nCachedObjects_;

        for (var _c23 = 0, _h12 = arguments.length; _c23 !== _h12; ++_c23) {
          var _h13 = arguments[_c23],
              _u17 = _h13.uuid;
          var _d16 = e[_u17];

          if (void 0 === _d16) {
            _d16 = o++, e[_u17] = _d16, t.push(_h13);

            for (var _t292 = 0, _e264 = s; _t292 !== _e264; ++_t292) {
              r[_t292].push(new _h(_h13, n[_t292], i[_t292]));
            }
          } else if (_d16 < l) {
            a = t[_d16];

            var _o42 = --l,
                _c24 = t[_o42];

            e[_c24.uuid] = _d16, t[_d16] = _c24, e[_u17] = _o42, t[_o42] = _h13;

            for (var _t293 = 0, _e265 = s; _t293 !== _e265; ++_t293) {
              var _e266 = r[_t293],
                  _s86 = _e266[_o42];
              var _a67 = _e266[_d16];
              _e266[_d16] = _s86, void 0 === _a67 && (_a67 = new _h(_h13, n[_t293], i[_t293])), _e266[_o42] = _a67;
            }
          } else t[_d16] !== a && console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.");
        }

        this.nCachedObjects_ = l;
      }
    }, {
      key: "remove",
      value: function remove() {
        var t = this._objects,
            e = this._indicesByUUID,
            n = this._bindings,
            i = n.length;
        var r = this.nCachedObjects_;

        for (var _s87 = 0, _a68 = arguments.length; _s87 !== _a68; ++_s87) {
          var _a69 = arguments[_s87],
              _o43 = _a69.uuid,
              _l34 = e[_o43];

          if (void 0 !== _l34 && _l34 >= r) {
            var _s88 = r++,
                _c25 = t[_s88];

            e[_c25.uuid] = _l34, t[_l34] = _c25, e[_o43] = _s88, t[_s88] = _a69;

            for (var _t294 = 0, _e267 = i; _t294 !== _e267; ++_t294) {
              var _e268 = n[_t294],
                  _i181 = _e268[_s88],
                  _r153 = _e268[_l34];
              _e268[_l34] = _i181, _e268[_s88] = _r153;
            }
          }
        }

        this.nCachedObjects_ = r;
      }
    }, {
      key: "uncache",
      value: function uncache() {
        var t = this._objects,
            e = this._indicesByUUID,
            n = this._bindings,
            i = n.length;
        var r = this.nCachedObjects_,
            s = t.length;

        for (var _a70 = 0, _o44 = arguments.length; _a70 !== _o44; ++_a70) {
          var _o45 = arguments[_a70].uuid,
              _l35 = e[_o45];
          if (void 0 !== _l35) if (delete e[_o45], _l35 < r) {
            var _a71 = --r,
                _o46 = t[_a71],
                _c26 = --s,
                _h14 = t[_c26];

            e[_o46.uuid] = _l35, t[_l35] = _o46, e[_h14.uuid] = _a71, t[_a71] = _h14, t.pop();

            for (var _t295 = 0, _e269 = i; _t295 !== _e269; ++_t295) {
              var _e270 = n[_t295],
                  _i182 = _e270[_a71],
                  _r154 = _e270[_c26];
              _e270[_l35] = _i182, _e270[_a71] = _r154, _e270.pop();
            }
          } else {
            var _r155 = --s,
                _a72 = t[_r155];

            _r155 > 0 && (e[_a72.uuid] = _l35), t[_l35] = _a72, t.pop();

            for (var _t296 = 0, _e271 = i; _t296 !== _e271; ++_t296) {
              var _e272 = n[_t296];
              _e272[_l35] = _e272[_r155], _e272.pop();
            }
          }
        }

        this.nCachedObjects_ = r;
      }
    }, {
      key: "subscribe_",
      value: function subscribe_(t, e) {
        var n = this._bindingsIndicesByPath;
        var i = n[t];
        var r = this._bindings;
        if (void 0 !== i) return r[i];
        var s = this._paths,
            a = this._parsedPaths,
            o = this._objects,
            l = o.length,
            c = this.nCachedObjects_,
            h = new Array(l);
        i = r.length, n[t] = i, s.push(t), a.push(e), r.push(h);

        for (var _n242 = c, _i183 = o.length; _n242 !== _i183; ++_n242) {
          var _i184 = o[_n242];
          h[_n242] = new _h(_i184, t, e);
        }

        return h;
      }
    }, {
      key: "unsubscribe_",
      value: function unsubscribe_(t) {
        var e = this._bindingsIndicesByPath,
            n = e[t];

        if (void 0 !== n) {
          var _i185 = this._paths,
              _r156 = this._parsedPaths,
              _s89 = this._bindings,
              _a73 = _s89.length - 1,
              _o47 = _s89[_a73];

          e[t[_a73]] = n, _s89[n] = _o47, _s89.pop(), _r156[n] = _r156[_a73], _r156.pop(), _i185[n] = _i185[_a73], _i185.pop();
        }
      }
    }]);

    return Mh;
  }();

  Mh.prototype.isAnimationObjectGroup = !0;

  var bh = /*#__PURE__*/function () {
    function bh(t, e) {
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : e.blendMode;

      _classCallCheck(this, bh);

      this._mixer = t, this._clip = e, this._localRoot = n, this.blendMode = i;
      var r = e.tracks,
          s = r.length,
          a = new Array(s),
          o = {
        endingStart: k,
        endingEnd: k
      };

      for (var _t297 = 0; _t297 !== s; ++_t297) {
        var _e273 = r[_t297].createInterpolant(null);

        a[_t297] = _e273, _e273.settings = o;
      }

      this._interpolantSettings = o, this._interpolants = a, this._propertyBindings = new Array(s), this._cacheIndex = null, this._byClipCacheIndex = null, this._timeScaleInterpolant = null, this._weightInterpolant = null, this.loop = 2201, this._loopCount = -1, this._startTime = null, this.time = 0, this.timeScale = 1, this._effectiveTimeScale = 1, this.weight = 1, this._effectiveWeight = 1, this.repetitions = 1 / 0, this.paused = !1, this.enabled = !0, this.clampWhenFinished = !1, this.zeroSlopeAtStart = !0, this.zeroSlopeAtEnd = !0;
    }

    _createClass(bh, [{
      key: "play",
      value: function play() {
        return this._mixer._activateAction(this), this;
      }
    }, {
      key: "stop",
      value: function stop() {
        return this._mixer._deactivateAction(this), this.reset();
      }
    }, {
      key: "reset",
      value: function reset() {
        return this.paused = !1, this.enabled = !0, this.time = 0, this._loopCount = -1, this._startTime = null, this.stopFading().stopWarping();
      }
    }, {
      key: "isRunning",
      value: function isRunning() {
        return this.enabled && !this.paused && 0 !== this.timeScale && null === this._startTime && this._mixer._isActiveAction(this);
      }
    }, {
      key: "isScheduled",
      value: function isScheduled() {
        return this._mixer._isActiveAction(this);
      }
    }, {
      key: "startAt",
      value: function startAt(t) {
        return this._startTime = t, this;
      }
    }, {
      key: "setLoop",
      value: function setLoop(t, e) {
        return this.loop = t, this.repetitions = e, this;
      }
    }, {
      key: "setEffectiveWeight",
      value: function setEffectiveWeight(t) {
        return this.weight = t, this._effectiveWeight = this.enabled ? t : 0, this.stopFading();
      }
    }, {
      key: "getEffectiveWeight",
      value: function getEffectiveWeight() {
        return this._effectiveWeight;
      }
    }, {
      key: "fadeIn",
      value: function fadeIn(t) {
        return this._scheduleFading(t, 0, 1);
      }
    }, {
      key: "fadeOut",
      value: function fadeOut(t) {
        return this._scheduleFading(t, 1, 0);
      }
    }, {
      key: "crossFadeFrom",
      value: function crossFadeFrom(t, e, n) {
        if (t.fadeOut(e), this.fadeIn(e), n) {
          var _n243 = this._clip.duration,
              _i186 = t._clip.duration,
              _r157 = _i186 / _n243,
              _s90 = _n243 / _i186;

          t.warp(1, _r157, e), this.warp(_s90, 1, e);
        }

        return this;
      }
    }, {
      key: "crossFadeTo",
      value: function crossFadeTo(t, e, n) {
        return t.crossFadeFrom(this, e, n);
      }
    }, {
      key: "stopFading",
      value: function stopFading() {
        var t = this._weightInterpolant;
        return null !== t && (this._weightInterpolant = null, this._mixer._takeBackControlInterpolant(t)), this;
      }
    }, {
      key: "setEffectiveTimeScale",
      value: function setEffectiveTimeScale(t) {
        return this.timeScale = t, this._effectiveTimeScale = this.paused ? 0 : t, this.stopWarping();
      }
    }, {
      key: "getEffectiveTimeScale",
      value: function getEffectiveTimeScale() {
        return this._effectiveTimeScale;
      }
    }, {
      key: "setDuration",
      value: function setDuration(t) {
        return this.timeScale = this._clip.duration / t, this.stopWarping();
      }
    }, {
      key: "syncWith",
      value: function syncWith(t) {
        return this.time = t.time, this.timeScale = t.timeScale, this.stopWarping();
      }
    }, {
      key: "halt",
      value: function halt(t) {
        return this.warp(this._effectiveTimeScale, 0, t);
      }
    }, {
      key: "warp",
      value: function warp(t, e, n) {
        var i = this._mixer,
            r = i.time,
            s = this.timeScale;
        var a = this._timeScaleInterpolant;
        null === a && (a = i._lendControlInterpolant(), this._timeScaleInterpolant = a);
        var o = a.parameterPositions,
            l = a.sampleValues;
        return o[0] = r, o[1] = r + n, l[0] = t / s, l[1] = e / s, this;
      }
    }, {
      key: "stopWarping",
      value: function stopWarping() {
        var t = this._timeScaleInterpolant;
        return null !== t && (this._timeScaleInterpolant = null, this._mixer._takeBackControlInterpolant(t)), this;
      }
    }, {
      key: "getMixer",
      value: function getMixer() {
        return this._mixer;
      }
    }, {
      key: "getClip",
      value: function getClip() {
        return this._clip;
      }
    }, {
      key: "getRoot",
      value: function getRoot() {
        return this._localRoot || this._mixer._root;
      }
    }, {
      key: "_update",
      value: function _update(t, e, n, i) {
        if (!this.enabled) return void this._updateWeight(t);
        var r = this._startTime;

        if (null !== r) {
          var _i187 = (t - r) * n;

          if (_i187 < 0 || 0 === n) return;
          this._startTime = null, e = n * _i187;
        }

        e *= this._updateTimeScale(t);

        var s = this._updateTime(e),
            a = this._updateWeight(t);

        if (a > 0) {
          var _t298 = this._interpolants,
              _e274 = this._propertyBindings;

          switch (this.blendMode) {
            case q:
              for (var _n244 = 0, _i188 = _t298.length; _n244 !== _i188; ++_n244) {
                _t298[_n244].evaluate(s), _e274[_n244].accumulateAdditive(a);
              }

              break;

            case j:
            default:
              for (var _n245 = 0, _r158 = _t298.length; _n245 !== _r158; ++_n245) {
                _t298[_n245].evaluate(s), _e274[_n245].accumulate(i, a);
              }

          }
        }
      }
    }, {
      key: "_updateWeight",
      value: function _updateWeight(t) {
        var e = 0;

        if (this.enabled) {
          e = this.weight;
          var _n246 = this._weightInterpolant;

          if (null !== _n246) {
            var _i189 = _n246.evaluate(t)[0];

            e *= _i189, t > _n246.parameterPositions[1] && (this.stopFading(), 0 === _i189 && (this.enabled = !1));
          }
        }

        return this._effectiveWeight = e, e;
      }
    }, {
      key: "_updateTimeScale",
      value: function _updateTimeScale(t) {
        var e = 0;

        if (!this.paused) {
          e = this.timeScale;
          var _n247 = this._timeScaleInterpolant;

          if (null !== _n247) {
            e *= _n247.evaluate(t)[0], t > _n247.parameterPositions[1] && (this.stopWarping(), 0 === e ? this.paused = !0 : this.timeScale = e);
          }
        }

        return this._effectiveTimeScale = e, e;
      }
    }, {
      key: "_updateTime",
      value: function _updateTime(t) {
        var e = this._clip.duration,
            n = this.loop;
        var i = this.time + t,
            r = this._loopCount;
        var s = 2202 === n;
        if (0 === t) return -1 === r ? i : s && 1 == (1 & r) ? e - i : i;

        if (2200 === n) {
          -1 === r && (this._loopCount = 0, this._setEndings(!0, !0, !1));

          t: {
            if (i >= e) i = e;else {
              if (!(i < 0)) {
                this.time = i;
                break t;
              }

              i = 0;
            }
            this.clampWhenFinished ? this.paused = !0 : this.enabled = !1, this.time = i, this._mixer.dispatchEvent({
              type: "finished",
              action: this,
              direction: t < 0 ? -1 : 1
            });
          }
        } else {
          if (-1 === r && (t >= 0 ? (r = 0, this._setEndings(!0, 0 === this.repetitions, s)) : this._setEndings(0 === this.repetitions, !0, s)), i >= e || i < 0) {
            var _n248 = Math.floor(i / e);

            i -= e * _n248, r += Math.abs(_n248);

            var _a74 = this.repetitions - r;

            if (_a74 <= 0) this.clampWhenFinished ? this.paused = !0 : this.enabled = !1, i = t > 0 ? e : 0, this.time = i, this._mixer.dispatchEvent({
              type: "finished",
              action: this,
              direction: t > 0 ? 1 : -1
            });else {
              if (1 === _a74) {
                var _e275 = t < 0;

                this._setEndings(_e275, !_e275, s);
              } else this._setEndings(!1, !1, s);

              this._loopCount = r, this.time = i, this._mixer.dispatchEvent({
                type: "loop",
                action: this,
                loopDelta: _n248
              });
            }
          } else this.time = i;

          if (s && 1 == (1 & r)) return e - i;
        }

        return i;
      }
    }, {
      key: "_setEndings",
      value: function _setEndings(t, e, n) {
        var i = this._interpolantSettings;
        n ? (i.endingStart = V, i.endingEnd = V) : (i.endingStart = t ? this.zeroSlopeAtStart ? V : k : W, i.endingEnd = e ? this.zeroSlopeAtEnd ? V : k : W);
      }
    }, {
      key: "_scheduleFading",
      value: function _scheduleFading(t, e, n) {
        var i = this._mixer,
            r = i.time;
        var s = this._weightInterpolant;
        null === s && (s = i._lendControlInterpolant(), this._weightInterpolant = s);
        var a = s.parameterPositions,
            o = s.sampleValues;
        return a[0] = r, o[0] = e, a[1] = r + t, o[1] = n, this;
      }
    }]);

    return bh;
  }();

  var wh = /*#__PURE__*/function (_rt7) {
    _inherits(wh, _rt7);

    var _super133 = _createSuper(wh);

    function wh(t) {
      var _this105;

      _classCallCheck(this, wh);

      _this105 = _super133.call(this), _this105._root = t, _this105._initMemoryManager(), _this105._accuIndex = 0, _this105.time = 0, _this105.timeScale = 1;
      return _this105;
    }

    _createClass(wh, [{
      key: "_bindAction",
      value: function _bindAction(t, e) {
        var n = t._localRoot || this._root,
            i = t._clip.tracks,
            r = i.length,
            s = t._propertyBindings,
            a = t._interpolants,
            o = n.uuid,
            l = this._bindingsByRootAndName;
        var c = l[o];
        void 0 === c && (c = {}, l[o] = c);

        for (var _t299 = 0; _t299 !== r; ++_t299) {
          var _r159 = i[_t299],
              _l36 = _r159.name;
          var _h15 = c[_l36];
          if (void 0 !== _h15) s[_t299] = _h15;else {
            if (_h15 = s[_t299], void 0 !== _h15) {
              null === _h15._cacheIndex && (++_h15.referenceCount, this._addInactiveBinding(_h15, o, _l36));
              continue;
            }

            var _i190 = e && e._propertyBindings[_t299].binding.parsedPath;

            _h15 = new ch(_h.create(n, _l36, _i190), _r159.ValueTypeName, _r159.getValueSize()), ++_h15.referenceCount, this._addInactiveBinding(_h15, o, _l36), s[_t299] = _h15;
          }
          a[_t299].resultBuffer = _h15.buffer;
        }
      }
    }, {
      key: "_activateAction",
      value: function _activateAction(t) {
        if (!this._isActiveAction(t)) {
          if (null === t._cacheIndex) {
            var _e277 = (t._localRoot || this._root).uuid,
                _n249 = t._clip.uuid,
                _i191 = this._actionsByClip[_n249];
            this._bindAction(t, _i191 && _i191.knownActions[0]), this._addInactiveAction(t, _n249, _e277);
          }

          var _e276 = t._propertyBindings;

          for (var _t300 = 0, _n250 = _e276.length; _t300 !== _n250; ++_t300) {
            var _n251 = _e276[_t300];
            0 == _n251.useCount++ && (this._lendBinding(_n251), _n251.saveOriginalState());
          }

          this._lendAction(t);
        }
      }
    }, {
      key: "_deactivateAction",
      value: function _deactivateAction(t) {
        if (this._isActiveAction(t)) {
          var _e278 = t._propertyBindings;

          for (var _t301 = 0, _n252 = _e278.length; _t301 !== _n252; ++_t301) {
            var _n253 = _e278[_t301];
            0 == --_n253.useCount && (_n253.restoreOriginalState(), this._takeBackBinding(_n253));
          }

          this._takeBackAction(t);
        }
      }
    }, {
      key: "_initMemoryManager",
      value: function _initMemoryManager() {
        this._actions = [], this._nActiveActions = 0, this._actionsByClip = {}, this._bindings = [], this._nActiveBindings = 0, this._bindingsByRootAndName = {}, this._controlInterpolants = [], this._nActiveControlInterpolants = 0;
        var t = this;
        this.stats = {
          actions: {
            get total() {
              return t._actions.length;
            },

            get inUse() {
              return t._nActiveActions;
            }

          },
          bindings: {
            get total() {
              return t._bindings.length;
            },

            get inUse() {
              return t._nActiveBindings;
            }

          },
          controlInterpolants: {
            get total() {
              return t._controlInterpolants.length;
            },

            get inUse() {
              return t._nActiveControlInterpolants;
            }

          }
        };
      }
    }, {
      key: "_isActiveAction",
      value: function _isActiveAction(t) {
        var e = t._cacheIndex;
        return null !== e && e < this._nActiveActions;
      }
    }, {
      key: "_addInactiveAction",
      value: function _addInactiveAction(t, e, n) {
        var i = this._actions,
            r = this._actionsByClip;
        var s = r[e];
        if (void 0 === s) s = {
          knownActions: [t],
          actionByRoot: {}
        }, t._byClipCacheIndex = 0, r[e] = s;else {
          var _e279 = s.knownActions;
          t._byClipCacheIndex = _e279.length, _e279.push(t);
        }
        t._cacheIndex = i.length, i.push(t), s.actionByRoot[n] = t;
      }
    }, {
      key: "_removeInactiveAction",
      value: function _removeInactiveAction(t) {
        var e = this._actions,
            n = e[e.length - 1],
            i = t._cacheIndex;
        n._cacheIndex = i, e[i] = n, e.pop(), t._cacheIndex = null;
        var r = t._clip.uuid,
            s = this._actionsByClip,
            a = s[r],
            o = a.knownActions,
            l = o[o.length - 1],
            c = t._byClipCacheIndex;
        l._byClipCacheIndex = c, o[c] = l, o.pop(), t._byClipCacheIndex = null;
        delete a.actionByRoot[(t._localRoot || this._root).uuid], 0 === o.length && delete s[r], this._removeInactiveBindingsForAction(t);
      }
    }, {
      key: "_removeInactiveBindingsForAction",
      value: function _removeInactiveBindingsForAction(t) {
        var e = t._propertyBindings;

        for (var _t302 = 0, _n254 = e.length; _t302 !== _n254; ++_t302) {
          var _n255 = e[_t302];
          0 == --_n255.referenceCount && this._removeInactiveBinding(_n255);
        }
      }
    }, {
      key: "_lendAction",
      value: function _lendAction(t) {
        var e = this._actions,
            n = t._cacheIndex,
            i = this._nActiveActions++,
            r = e[i];
        t._cacheIndex = i, e[i] = t, r._cacheIndex = n, e[n] = r;
      }
    }, {
      key: "_takeBackAction",
      value: function _takeBackAction(t) {
        var e = this._actions,
            n = t._cacheIndex,
            i = --this._nActiveActions,
            r = e[i];
        t._cacheIndex = i, e[i] = t, r._cacheIndex = n, e[n] = r;
      }
    }, {
      key: "_addInactiveBinding",
      value: function _addInactiveBinding(t, e, n) {
        var i = this._bindingsByRootAndName,
            r = this._bindings;
        var s = i[e];
        void 0 === s && (s = {}, i[e] = s), s[n] = t, t._cacheIndex = r.length, r.push(t);
      }
    }, {
      key: "_removeInactiveBinding",
      value: function _removeInactiveBinding(t) {
        var e = this._bindings,
            n = t.binding,
            i = n.rootNode.uuid,
            r = n.path,
            s = this._bindingsByRootAndName,
            a = s[i],
            o = e[e.length - 1],
            l = t._cacheIndex;
        o._cacheIndex = l, e[l] = o, e.pop(), delete a[r], 0 === Object.keys(a).length && delete s[i];
      }
    }, {
      key: "_lendBinding",
      value: function _lendBinding(t) {
        var e = this._bindings,
            n = t._cacheIndex,
            i = this._nActiveBindings++,
            r = e[i];
        t._cacheIndex = i, e[i] = t, r._cacheIndex = n, e[n] = r;
      }
    }, {
      key: "_takeBackBinding",
      value: function _takeBackBinding(t) {
        var e = this._bindings,
            n = t._cacheIndex,
            i = --this._nActiveBindings,
            r = e[i];
        t._cacheIndex = i, e[i] = t, r._cacheIndex = n, e[n] = r;
      }
    }, {
      key: "_lendControlInterpolant",
      value: function _lendControlInterpolant() {
        var t = this._controlInterpolants,
            e = this._nActiveControlInterpolants++;
        var n = t[e];
        return void 0 === n && (n = new kl(new Float32Array(2), new Float32Array(2), 1, this._controlInterpolantsResultBuffer), n.__cacheIndex = e, t[e] = n), n;
      }
    }, {
      key: "_takeBackControlInterpolant",
      value: function _takeBackControlInterpolant(t) {
        var e = this._controlInterpolants,
            n = t.__cacheIndex,
            i = --this._nActiveControlInterpolants,
            r = e[i];
        t.__cacheIndex = i, e[i] = t, r.__cacheIndex = n, e[n] = r;
      }
    }, {
      key: "clipAction",
      value: function clipAction(t, e, n) {
        var i = e || this._root,
            r = i.uuid;
        var s = "string" == typeof t ? Kl.findByName(i, t) : t;
        var a = null !== s ? s.uuid : t,
            o = this._actionsByClip[a];
        var l = null;

        if (void 0 === n && (n = null !== s ? s.blendMode : j), void 0 !== o) {
          var _t303 = o.actionByRoot[r];
          if (void 0 !== _t303 && _t303.blendMode === n) return _t303;
          l = o.knownActions[0], null === s && (s = l._clip);
        }

        if (null === s) return null;
        var c = new bh(this, s, e, n);
        return this._bindAction(c, l), this._addInactiveAction(c, a, r), c;
      }
    }, {
      key: "existingAction",
      value: function existingAction(t, e) {
        var n = e || this._root,
            i = n.uuid,
            r = "string" == typeof t ? Kl.findByName(n, t) : t,
            s = r ? r.uuid : t,
            a = this._actionsByClip[s];
        return void 0 !== a && a.actionByRoot[i] || null;
      }
    }, {
      key: "stopAllAction",
      value: function stopAllAction() {
        var t = this._actions;

        for (var _e280 = this._nActiveActions - 1; _e280 >= 0; --_e280) {
          t[_e280].stop();
        }

        return this;
      }
    }, {
      key: "update",
      value: function update(t) {
        t *= this.timeScale;
        var e = this._actions,
            n = this._nActiveActions,
            i = this.time += t,
            r = Math.sign(t),
            s = this._accuIndex ^= 1;

        for (var _a75 = 0; _a75 !== n; ++_a75) {
          e[_a75]._update(i, t, r, s);
        }

        var a = this._bindings,
            o = this._nActiveBindings;

        for (var _t304 = 0; _t304 !== o; ++_t304) {
          a[_t304].apply(s);
        }

        return this;
      }
    }, {
      key: "setTime",
      value: function setTime(t) {
        this.time = 0;

        for (var _t305 = 0; _t305 < this._actions.length; _t305++) {
          this._actions[_t305].time = 0;
        }

        return this.update(t);
      }
    }, {
      key: "getRoot",
      value: function getRoot() {
        return this._root;
      }
    }, {
      key: "uncacheClip",
      value: function uncacheClip(t) {
        var e = this._actions,
            n = t.uuid,
            i = this._actionsByClip,
            r = i[n];

        if (void 0 !== r) {
          var _t306 = r.knownActions;

          for (var _n256 = 0, _i192 = _t306.length; _n256 !== _i192; ++_n256) {
            var _i193 = _t306[_n256];

            this._deactivateAction(_i193);

            var _r160 = _i193._cacheIndex,
                _s91 = e[e.length - 1];
            _i193._cacheIndex = null, _i193._byClipCacheIndex = null, _s91._cacheIndex = _r160, e[_r160] = _s91, e.pop(), this._removeInactiveBindingsForAction(_i193);
          }

          delete i[n];
        }
      }
    }, {
      key: "uncacheRoot",
      value: function uncacheRoot(t) {
        var e = t.uuid,
            n = this._actionsByClip;

        for (var _t307 in n) {
          var _i194 = n[_t307].actionByRoot[e];
          void 0 !== _i194 && (this._deactivateAction(_i194), this._removeInactiveAction(_i194));
        }

        var i = this._bindingsByRootAndName[e];
        if (void 0 !== i) for (var _t308 in i) {
          var _e281 = i[_t308];
          _e281.restoreOriginalState(), this._removeInactiveBinding(_e281);
        }
      }
    }, {
      key: "uncacheAction",
      value: function uncacheAction(t, e) {
        var n = this.existingAction(t, e);
        null !== n && (this._deactivateAction(n), this._removeInactiveAction(n));
      }
    }]);

    return wh;
  }(rt);

  wh.prototype._controlInterpolantsResultBuffer = new Float32Array(1);

  var Sh = /*#__PURE__*/function () {
    function Sh(t) {
      _classCallCheck(this, Sh);

      "string" == typeof t && (console.warn("THREE.Uniform: Type parameter is no longer needed."), t = arguments[1]), this.value = t;
    }

    _createClass(Sh, [{
      key: "clone",
      value: function clone() {
        return new Sh(void 0 === this.value.clone ? this.value : this.value.clone());
      }
    }]);

    return Sh;
  }();

  var Th = /*#__PURE__*/function (_ea) {
    _inherits(Th, _ea);

    var _super134 = _createSuper(Th);

    function Th(t, e) {
      var _this106;

      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;

      _classCallCheck(this, Th);

      _this106 = _super134.call(this, t, e), _this106.meshPerAttribute = n;
      return _this106;
    }

    _createClass(Th, [{
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(Th.prototype), "copy", this).call(this, t), this.meshPerAttribute = t.meshPerAttribute, this;
      }
    }, {
      key: "clone",
      value: function clone(t) {
        var e = _get(_getPrototypeOf(Th.prototype), "clone", this).call(this, t);

        return e.meshPerAttribute = this.meshPerAttribute, e;
      }
    }, {
      key: "toJSON",
      value: function toJSON(t) {
        var e = _get(_getPrototypeOf(Th.prototype), "toJSON", this).call(this, t);

        return e.isInstancedInterleavedBuffer = !0, e.meshPerAttribute = this.meshPerAttribute, e;
      }
    }]);

    return Th;
  }(ea);

  Th.prototype.isInstancedInterleavedBuffer = !0;

  var Eh = /*#__PURE__*/function () {
    function Eh(t, e, n, i, r) {
      _classCallCheck(this, Eh);

      this.buffer = t, this.type = e, this.itemSize = n, this.elementSize = i, this.count = r, this.version = 0;
    }

    _createClass(Eh, [{
      key: "needsUpdate",
      set: function set(t) {
        !0 === t && this.version++;
      }
    }, {
      key: "setBuffer",
      value: function setBuffer(t) {
        return this.buffer = t, this;
      }
    }, {
      key: "setType",
      value: function setType(t, e) {
        return this.type = t, this.elementSize = e, this;
      }
    }, {
      key: "setItemSize",
      value: function setItemSize(t) {
        return this.itemSize = t, this;
      }
    }, {
      key: "setCount",
      value: function setCount(t) {
        return this.count = t, this;
      }
    }]);

    return Eh;
  }();

  Eh.prototype.isGLBufferAttribute = !0;

  function Ah(t, e) {
    return t.distance - e.distance;
  }

  function Lh(t, e, n, i) {
    if (t.layers.test(e.layers) && t.raycast(e, n), !0 === i) {
      var _i195 = t.children;

      for (var _t309 = 0, _r161 = _i195.length; _t309 < _r161; _t309++) {
        Lh(_i195[_t309], e, n, !0);
      }
    }
  }

  var Rh = new vt();

  var Ch = /*#__PURE__*/function () {
    function Ch() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new vt(1 / 0, 1 / 0);
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new vt(-1 / 0, -1 / 0);

      _classCallCheck(this, Ch);

      this.min = t, this.max = e;
    }

    _createClass(Ch, [{
      key: "set",
      value: function set(t, e) {
        return this.min.copy(t), this.max.copy(e), this;
      }
    }, {
      key: "setFromPoints",
      value: function setFromPoints(t) {
        this.makeEmpty();

        for (var _e282 = 0, _n257 = t.length; _e282 < _n257; _e282++) {
          this.expandByPoint(t[_e282]);
        }

        return this;
      }
    }, {
      key: "setFromCenterAndSize",
      value: function setFromCenterAndSize(t, e) {
        var n = Rh.copy(e).multiplyScalar(.5);
        return this.min.copy(t).sub(n), this.max.copy(t).add(n), this;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.min.copy(t.min), this.max.copy(t.max), this;
      }
    }, {
      key: "makeEmpty",
      value: function makeEmpty() {
        return this.min.x = this.min.y = 1 / 0, this.max.x = this.max.y = -1 / 0, this;
      }
    }, {
      key: "isEmpty",
      value: function isEmpty() {
        return this.max.x < this.min.x || this.max.y < this.min.y;
      }
    }, {
      key: "getCenter",
      value: function getCenter(t) {
        return this.isEmpty() ? t.set(0, 0) : t.addVectors(this.min, this.max).multiplyScalar(.5);
      }
    }, {
      key: "getSize",
      value: function getSize(t) {
        return this.isEmpty() ? t.set(0, 0) : t.subVectors(this.max, this.min);
      }
    }, {
      key: "expandByPoint",
      value: function expandByPoint(t) {
        return this.min.min(t), this.max.max(t), this;
      }
    }, {
      key: "expandByVector",
      value: function expandByVector(t) {
        return this.min.sub(t), this.max.add(t), this;
      }
    }, {
      key: "expandByScalar",
      value: function expandByScalar(t) {
        return this.min.addScalar(-t), this.max.addScalar(t), this;
      }
    }, {
      key: "containsPoint",
      value: function containsPoint(t) {
        return !(t.x < this.min.x || t.x > this.max.x || t.y < this.min.y || t.y > this.max.y);
      }
    }, {
      key: "containsBox",
      value: function containsBox(t) {
        return this.min.x <= t.min.x && t.max.x <= this.max.x && this.min.y <= t.min.y && t.max.y <= this.max.y;
      }
    }, {
      key: "getParameter",
      value: function getParameter(t, e) {
        return e.set((t.x - this.min.x) / (this.max.x - this.min.x), (t.y - this.min.y) / (this.max.y - this.min.y));
      }
    }, {
      key: "intersectsBox",
      value: function intersectsBox(t) {
        return !(t.max.x < this.min.x || t.min.x > this.max.x || t.max.y < this.min.y || t.min.y > this.max.y);
      }
    }, {
      key: "clampPoint",
      value: function clampPoint(t, e) {
        return e.copy(t).clamp(this.min, this.max);
      }
    }, {
      key: "distanceToPoint",
      value: function distanceToPoint(t) {
        return Rh.copy(t).clamp(this.min, this.max).sub(t).length();
      }
    }, {
      key: "intersect",
      value: function intersect(t) {
        return this.min.max(t.min), this.max.min(t.max), this;
      }
    }, {
      key: "union",
      value: function union(t) {
        return this.min.min(t.min), this.max.max(t.max), this;
      }
    }, {
      key: "translate",
      value: function translate(t) {
        return this.min.add(t), this.max.add(t), this;
      }
    }, {
      key: "equals",
      value: function equals(t) {
        return t.min.equals(this.min) && t.max.equals(this.max);
      }
    }]);

    return Ch;
  }();

  Ch.prototype.isBox2 = !0;
  var Ph = new Rt(),
      Ih = new Rt();

  var Dh = /*#__PURE__*/function () {
    function Dh() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Rt();
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Rt();

      _classCallCheck(this, Dh);

      this.start = t, this.end = e;
    }

    _createClass(Dh, [{
      key: "set",
      value: function set(t, e) {
        return this.start.copy(t), this.end.copy(e), this;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.start.copy(t.start), this.end.copy(t.end), this;
      }
    }, {
      key: "getCenter",
      value: function getCenter(t) {
        return t.addVectors(this.start, this.end).multiplyScalar(.5);
      }
    }, {
      key: "delta",
      value: function delta(t) {
        return t.subVectors(this.end, this.start);
      }
    }, {
      key: "distanceSq",
      value: function distanceSq() {
        return this.start.distanceToSquared(this.end);
      }
    }, {
      key: "distance",
      value: function distance() {
        return this.start.distanceTo(this.end);
      }
    }, {
      key: "at",
      value: function at(t, e) {
        return this.delta(e).multiplyScalar(t).add(this.start);
      }
    }, {
      key: "closestPointToPointParameter",
      value: function closestPointToPointParameter(t, e) {
        Ph.subVectors(t, this.start), Ih.subVectors(this.end, this.start);
        var n = Ih.dot(Ih);
        var i = Ih.dot(Ph) / n;
        return e && (i = ht(i, 0, 1)), i;
      }
    }, {
      key: "closestPointToPoint",
      value: function closestPointToPoint(t, e, n) {
        var i = this.closestPointToPointParameter(t, e);
        return this.delta(n).multiplyScalar(i).add(this.start);
      }
    }, {
      key: "applyMatrix4",
      value: function applyMatrix4(t) {
        return this.start.applyMatrix4(t), this.end.applyMatrix4(t), this;
      }
    }, {
      key: "equals",
      value: function equals(t) {
        return t.start.equals(this.start) && t.end.equals(this.end);
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }]);

    return Dh;
  }();

  var Nh = /*#__PURE__*/function (_Pe13) {
    _inherits(Nh, _Pe13);

    var _super135 = _createSuper(Nh);

    function Nh(t) {
      var _this107;

      _classCallCheck(this, Nh);

      _this107 = _super135.call(this), _this107.material = t, _this107.render = function () {}, _this107.hasPositions = !1, _this107.hasNormals = !1, _this107.hasColors = !1, _this107.hasUvs = !1, _this107.positionArray = null, _this107.normalArray = null, _this107.colorArray = null, _this107.uvArray = null, _this107.count = 0;
      return _this107;
    }

    return Nh;
  }(Pe);

  Nh.prototype.isImmediateRenderObject = !0;
  var Bh = new Rt();
  var zh = new Rt(),
      Fh = new ae(),
      Oh = new ae();

  var Uh = /*#__PURE__*/function (_Ya) {
    _inherits(Uh, _Ya);

    var _super136 = _createSuper(Uh);

    function Uh(t) {
      var _this108;

      _classCallCheck(this, Uh);

      var e = Hh(t),
          n = new wn(),
          i = [],
          r = [],
          s = new Qe(0, 0, 1),
          a = new Qe(0, 1, 0);

      for (var _t310 = 0; _t310 < e.length; _t310++) {
        var _n258 = e[_t310];
        _n258.parent && _n258.parent.isBone && (i.push(0, 0, 0), i.push(0, 0, 0), r.push(s.r, s.g, s.b), r.push(a.r, a.g, a.b));
      }

      n.setAttribute("position", new un(i, 3)), n.setAttribute("color", new un(r, 3));
      _this108 = _super136.call(this, n, new Ua({
        vertexColors: !0,
        depthTest: !1,
        depthWrite: !1,
        toneMapped: !1,
        transparent: !0
      })), _this108.type = "SkeletonHelper", _this108.isSkeletonHelper = !0, _this108.root = t, _this108.bones = e, _this108.matrix = t.matrixWorld, _this108.matrixAutoUpdate = !1;
      return _this108;
    }

    _createClass(Uh, [{
      key: "updateMatrixWorld",
      value: function updateMatrixWorld(t) {
        var e = this.bones,
            n = this.geometry,
            i = n.getAttribute("position");
        Oh.copy(this.root.matrixWorld).invert();

        for (var _t311 = 0, _n259 = 0; _t311 < e.length; _t311++) {
          var _r162 = e[_t311];
          _r162.parent && _r162.parent.isBone && (Fh.multiplyMatrices(Oh, _r162.matrixWorld), zh.setFromMatrixPosition(Fh), i.setXYZ(_n259, zh.x, zh.y, zh.z), Fh.multiplyMatrices(Oh, _r162.parent.matrixWorld), zh.setFromMatrixPosition(Fh), i.setXYZ(_n259 + 1, zh.x, zh.y, zh.z), _n259 += 2);
        }

        n.getAttribute("position").needsUpdate = !0, _get(_getPrototypeOf(Uh.prototype), "updateMatrixWorld", this).call(this, t);
      }
    }]);

    return Uh;
  }(Ya);

  function Hh(t) {
    var e = [];
    t && t.isBone && e.push(t);

    for (var _n260 = 0; _n260 < t.children.length; _n260++) {
      e.push.apply(e, Hh(t.children[_n260]));
    }

    return e;
  }

  var Gh = new Rt(),
      kh = new Qe(),
      Vh = new Qe();

  var Wh = /*#__PURE__*/function (_Ya2) {
    _inherits(Wh, _Ya2);

    var _super137 = _createSuper(Wh);

    function Wh() {
      var _this109;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 10;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 10;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 4473924;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 8947848;

      _classCallCheck(this, Wh);

      n = new Qe(n), i = new Qe(i);
      var r = e / 2,
          s = t / e,
          a = t / 2,
          o = [],
          l = [];

      for (var _t312 = 0, _c27 = 0, _h16 = -a; _t312 <= e; _t312++, _h16 += s) {
        o.push(-a, 0, _h16, a, 0, _h16), o.push(_h16, 0, -a, _h16, 0, a);

        var _e283 = _t312 === r ? n : i;

        _e283.toArray(l, _c27), _c27 += 3, _e283.toArray(l, _c27), _c27 += 3, _e283.toArray(l, _c27), _c27 += 3, _e283.toArray(l, _c27), _c27 += 3;
      }

      var c = new wn();
      c.setAttribute("position", new un(o, 3)), c.setAttribute("color", new un(l, 3));
      _this109 = _super137.call(this, c, new Ua({
        vertexColors: !0,
        toneMapped: !1
      })), _this109.type = "GridHelper";
      return _this109;
    }

    return Wh;
  }(Ya);

  var jh = new Rt(),
      qh = new Rt(),
      Xh = new Rt();
  var Yh = new Rt(),
      Jh = new Yn();

  function Zh(t, e, n, i, r, s, a) {
    Yh.set(r, s, a).unproject(i);
    var o = e[t];

    if (void 0 !== o) {
      var _t313 = n.getAttribute("position");

      for (var _e284 = 0, _n261 = o.length; _e284 < _n261; _e284++) {
        _t313.setXYZ(o[_e284], Yh.x, Yh.y, Yh.z);
      }
    }
  }

  var Qh = new It();

  var Kh = /*#__PURE__*/function (_Ya3) {
    _inherits(Kh, _Ya3);

    var _super138 = _createSuper(Kh);

    function Kh(t) {
      var _this110;

      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 16776960;

      _classCallCheck(this, Kh);

      var n = new Uint16Array([0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7]),
          i = new Float32Array(24),
          r = new wn();
      r.setIndex(new en(n, 1)), r.setAttribute("position", new en(i, 3)), _this110 = _super138.call(this, r, new Ua({
        color: e,
        toneMapped: !1
      })), _this110.object = t, _this110.type = "BoxHelper", _this110.matrixAutoUpdate = !1, _this110.update();
      return _this110;
    }

    _createClass(Kh, [{
      key: "update",
      value: function update(t) {
        if (void 0 !== t && console.warn("THREE.BoxHelper: .update() has no longer arguments."), void 0 !== this.object && Qh.setFromObject(this.object), Qh.isEmpty()) return;
        var e = Qh.min,
            n = Qh.max,
            i = this.geometry.attributes.position,
            r = i.array;
        r[0] = n.x, r[1] = n.y, r[2] = n.z, r[3] = e.x, r[4] = n.y, r[5] = n.z, r[6] = e.x, r[7] = e.y, r[8] = n.z, r[9] = n.x, r[10] = e.y, r[11] = n.z, r[12] = n.x, r[13] = n.y, r[14] = e.z, r[15] = e.x, r[16] = n.y, r[17] = e.z, r[18] = e.x, r[19] = e.y, r[20] = e.z, r[21] = n.x, r[22] = e.y, r[23] = e.z, i.needsUpdate = !0, this.geometry.computeBoundingSphere();
      }
    }, {
      key: "setFromObject",
      value: function setFromObject(t) {
        return this.object = t, this.update(), this;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return Ya.prototype.copy.call(this, t), this.object = t.object, this;
      }
    }]);

    return Kh;
  }(Ya);

  var $h = new Rt();
  var tu, eu;

  var nu = /*#__PURE__*/function (_Ya4) {
    _inherits(nu, _Ya4);

    var _super139 = _createSuper(nu);

    function nu() {
      var _this111;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;

      _classCallCheck(this, nu);

      var e = [0, 0, 0, t, 0, 0, 0, 0, 0, 0, t, 0, 0, 0, 0, 0, 0, t],
          n = new wn();
      n.setAttribute("position", new un(e, 3)), n.setAttribute("color", new un([1, 0, 0, 1, .6, 0, 0, 1, 0, .6, 1, 0, 0, 0, 1, 0, .6, 1], 3));
      _this111 = _super139.call(this, n, new Ua({
        vertexColors: !0,
        toneMapped: !1
      })), _this111.type = "AxesHelper";
      return _this111;
    }

    _createClass(nu, [{
      key: "setColors",
      value: function setColors(t, e, n) {
        var i = new Qe(),
            r = this.geometry.attributes.color.array;
        return i.set(t), i.toArray(r, 0), i.toArray(r, 3), i.set(e), i.toArray(r, 6), i.toArray(r, 9), i.set(n), i.toArray(r, 12), i.toArray(r, 15), this.geometry.attributes.color.needsUpdate = !0, this;
      }
    }, {
      key: "dispose",
      value: function dispose() {
        this.geometry.dispose(), this.material.dispose();
      }
    }]);

    return nu;
  }(Ya);

  var iu = new Float32Array(1),
      ru = new Int32Array(iu.buffer);
  yo.create = function (t, e) {
    return console.log("THREE.Curve.create() has been deprecated"), t.prototype = Object.create(yo.prototype), t.prototype.constructor = t, t.prototype.getPoint = e, t;
  }, uc.prototype.fromPoints = function (t) {
    return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."), this.setFromPoints(t);
  }, Wh.prototype.setColors = function () {
    console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.");
  }, Uh.prototype.update = function () {
    console.error("THREE.SkeletonHelper: update() no longer needs to be called.");
  }, ic.prototype.extractUrlBase = function (t) {
    return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."), Dc.extractUrlBase(t);
  }, ic.Handlers = {
    add: function add() {
      console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.");
    },
    get: function get() {
      console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.");
    }
  }, Ch.prototype.center = function (t) {
    return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."), this.getCenter(t);
  }, Ch.prototype.empty = function () {
    return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."), this.isEmpty();
  }, Ch.prototype.isIntersectionBox = function (t) {
    return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."), this.intersectsBox(t);
  }, Ch.prototype.size = function (t) {
    return console.warn("THREE.Box2: .size() has been renamed to .getSize()."), this.getSize(t);
  }, It.prototype.center = function (t) {
    return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."), this.getCenter(t);
  }, It.prototype.empty = function () {
    return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."), this.isEmpty();
  }, It.prototype.isIntersectionBox = function (t) {
    return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."), this.intersectsBox(t);
  }, It.prototype.isIntersectionSphere = function (t) {
    return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."), this.intersectsSphere(t);
  }, It.prototype.size = function (t) {
    return console.warn("THREE.Box3: .size() has been renamed to .getSize()."), this.getSize(t);
  }, Qt.prototype.empty = function () {
    return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."), this.isEmpty();
  }, ai.prototype.setFromMatrix = function (t) {
    return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."), this.setFromProjectionMatrix(t);
  }, Dh.prototype.center = function (t) {
    return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."), this.getCenter(t);
  }, yt.prototype.flattenToArrayOffset = function (t, e) {
    return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."), this.toArray(t, e);
  }, yt.prototype.multiplyVector3 = function (t) {
    return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."), t.applyMatrix3(this);
  }, yt.prototype.multiplyVector3Array = function () {
    console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.");
  }, yt.prototype.applyToBufferAttribute = function (t) {
    return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."), t.applyMatrix3(this);
  }, yt.prototype.applyToVector3Array = function () {
    console.error("THREE.Matrix3: .applyToVector3Array() has been removed.");
  }, yt.prototype.getInverse = function (t) {
    return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."), this.copy(t).invert();
  }, ae.prototype.extractPosition = function (t) {
    return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."), this.copyPosition(t);
  }, ae.prototype.flattenToArrayOffset = function (t, e) {
    return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."), this.toArray(t, e);
  }, ae.prototype.getPosition = function () {
    return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."), new Rt().setFromMatrixColumn(this, 3);
  }, ae.prototype.setRotationFromQuaternion = function (t) {
    return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."), this.makeRotationFromQuaternion(t);
  }, ae.prototype.multiplyToArray = function () {
    console.warn("THREE.Matrix4: .multiplyToArray() has been removed.");
  }, ae.prototype.multiplyVector3 = function (t) {
    return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."), t.applyMatrix4(this);
  }, ae.prototype.multiplyVector4 = function (t) {
    return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."), t.applyMatrix4(this);
  }, ae.prototype.multiplyVector3Array = function () {
    console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.");
  }, ae.prototype.rotateAxis = function (t) {
    console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."), t.transformDirection(this);
  }, ae.prototype.crossVector = function (t) {
    return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."), t.applyMatrix4(this);
  }, ae.prototype.translate = function () {
    console.error("THREE.Matrix4: .translate() has been removed.");
  }, ae.prototype.rotateX = function () {
    console.error("THREE.Matrix4: .rotateX() has been removed.");
  }, ae.prototype.rotateY = function () {
    console.error("THREE.Matrix4: .rotateY() has been removed.");
  }, ae.prototype.rotateZ = function () {
    console.error("THREE.Matrix4: .rotateZ() has been removed.");
  }, ae.prototype.rotateByAxis = function () {
    console.error("THREE.Matrix4: .rotateByAxis() has been removed.");
  }, ae.prototype.applyToBufferAttribute = function (t) {
    return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."), t.applyMatrix4(this);
  }, ae.prototype.applyToVector3Array = function () {
    console.error("THREE.Matrix4: .applyToVector3Array() has been removed.");
  }, ae.prototype.makeFrustum = function (t, e, n, i, r, s) {
    return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."), this.makePerspective(t, e, i, n, r, s);
  }, ae.prototype.getInverse = function (t) {
    return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."), this.copy(t).invert();
  }, ii.prototype.isIntersectionLine = function (t) {
    return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."), this.intersectsLine(t);
  }, Lt.prototype.multiplyVector3 = function (t) {
    return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."), t.applyQuaternion(this);
  }, Lt.prototype.inverse = function () {
    return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."), this.invert();
  }, se.prototype.isIntersectionBox = function (t) {
    return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."), this.intersectsBox(t);
  }, se.prototype.isIntersectionPlane = function (t) {
    return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."), this.intersectsPlane(t);
  }, se.prototype.isIntersectionSphere = function (t) {
    return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."), this.intersectsSphere(t);
  }, ke.prototype.area = function () {
    return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."), this.getArea();
  }, ke.prototype.barycoordFromPoint = function (t, e) {
    return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."), this.getBarycoord(t, e);
  }, ke.prototype.midpoint = function (t) {
    return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."), this.getMidpoint(t);
  }, ke.prototypenormal = function (t) {
    return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."), this.getNormal(t);
  }, ke.prototype.plane = function (t) {
    return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."), this.getPlane(t);
  }, ke.barycoordFromPoint = function (t, e, n, i, r) {
    return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."), ke.getBarycoord(t, e, n, i, r);
  }, ke.normal = function (t, e, n, i) {
    return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."), ke.getNormal(t, e, n, i);
  }, dc.prototype.extractAllPoints = function (t) {
    return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."), this.extractPoints(t);
  }, dc.prototype.extrude = function (t) {
    return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."), new dl(this, t);
  }, dc.prototype.makeGeometry = function (t) {
    return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."), new xl(this, t);
  }, vt.prototype.fromAttribute = function (t, e, n) {
    return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."), this.fromBufferAttribute(t, e, n);
  }, vt.prototype.distanceToManhattan = function (t) {
    return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."), this.manhattanDistanceTo(t);
  }, vt.prototype.lengthManhattan = function () {
    return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."), this.manhattanLength();
  }, Rt.prototype.setEulerFromRotationMatrix = function () {
    console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.");
  }, Rt.prototype.setEulerFromQuaternion = function () {
    console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.");
  }, Rt.prototype.getPositionFromMatrix = function (t) {
    return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."), this.setFromMatrixPosition(t);
  }, Rt.prototype.getScaleFromMatrix = function (t) {
    return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."), this.setFromMatrixScale(t);
  }, Rt.prototype.getColumnFromMatrix = function (t, e) {
    return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."), this.setFromMatrixColumn(e, t);
  }, Rt.prototype.applyProjection = function (t) {
    return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."), this.applyMatrix4(t);
  }, Rt.prototype.fromAttribute = function (t, e, n) {
    return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."), this.fromBufferAttribute(t, e, n);
  }, Rt.prototype.distanceToManhattan = function (t) {
    return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."), this.manhattanDistanceTo(t);
  }, Rt.prototype.lengthManhattan = function () {
    return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."), this.manhattanLength();
  }, St.prototype.fromAttribute = function (t, e, n) {
    return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."), this.fromBufferAttribute(t, e, n);
  }, St.prototype.lengthManhattan = function () {
    return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."), this.manhattanLength();
  }, Pe.prototype.getChildByName = function (t) {
    return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."), this.getObjectByName(t);
  }, Pe.prototype.renderDepth = function () {
    console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.");
  }, Pe.prototype.translate = function (t, e) {
    return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."), this.translateOnAxis(e, t);
  }, Pe.prototype.getWorldRotation = function () {
    console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.");
  }, Pe.prototype.applyMatrix = function (t) {
    return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."), this.applyMatrix4(t);
  }, Object.defineProperties(Pe.prototype, {
    eulerOrder: {
      get: function get() {
        return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."), this.rotation.order;
      },
      set: function set(t) {
        console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."), this.rotation.order = t;
      }
    },
    useQuaternion: {
      get: function get() {
        console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.");
      },
      set: function set() {
        console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.");
      }
    }
  }), Gn.prototype.setDrawMode = function () {
    console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.");
  }, Object.defineProperties(Gn.prototype, {
    drawMode: {
      get: function get() {
        return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."), 0;
      },
      set: function set() {
        console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.");
      }
    }
  }), La.prototype.initBones = function () {
    console.error("THREE.SkinnedMesh: initBones() has been removed.");
  }, Jn.prototype.setLens = function (t, e) {
    console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."), void 0 !== e && (this.filmGauge = e), this.setFocalLength(t);
  }, Object.defineProperties(pc.prototype, {
    onlyShadow: {
      set: function set() {
        console.warn("THREE.Light: .onlyShadow has been removed.");
      }
    },
    shadowCameraFov: {
      set: function set(t) {
        console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."), this.shadow.camera.fov = t;
      }
    },
    shadowCameraLeft: {
      set: function set(t) {
        console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."), this.shadow.camera.left = t;
      }
    },
    shadowCameraRight: {
      set: function set(t) {
        console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."), this.shadow.camera.right = t;
      }
    },
    shadowCameraTop: {
      set: function set(t) {
        console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."), this.shadow.camera.top = t;
      }
    },
    shadowCameraBottom: {
      set: function set(t) {
        console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."), this.shadow.camera.bottom = t;
      }
    },
    shadowCameraNear: {
      set: function set(t) {
        console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."), this.shadow.camera.near = t;
      }
    },
    shadowCameraFar: {
      set: function set(t) {
        console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."), this.shadow.camera.far = t;
      }
    },
    shadowCameraVisible: {
      set: function set() {
        console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.");
      }
    },
    shadowBias: {
      set: function set(t) {
        console.warn("THREE.Light: .shadowBias is now .shadow.bias."), this.shadow.bias = t;
      }
    },
    shadowDarkness: {
      set: function set() {
        console.warn("THREE.Light: .shadowDarkness has been removed.");
      }
    },
    shadowMapWidth: {
      set: function set(t) {
        console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."), this.shadow.mapSize.width = t;
      }
    },
    shadowMapHeight: {
      set: function set(t) {
        console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."), this.shadow.mapSize.height = t;
      }
    }
  }), Object.defineProperties(en.prototype, {
    length: {
      get: function get() {
        return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."), this.array.length;
      }
    },
    dynamic: {
      get: function get() {
        return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."), this.usage === nt;
      },
      set: function set() {
        console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."), this.setUsage(nt);
      }
    }
  }), en.prototype.setDynamic = function (t) {
    return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."), this.setUsage(!0 === t ? nt : et), this;
  }, en.prototype.copyIndicesArray = function () {
    console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.");
  }, en.prototype.setArray = function () {
    console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers");
  }, wn.prototype.addIndex = function (t) {
    console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."), this.setIndex(t);
  }, wn.prototype.addAttribute = function (t, e) {
    return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."), e && e.isBufferAttribute || e && e.isInterleavedBufferAttribute ? "index" === t ? (console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."), this.setIndex(e), this) : this.setAttribute(t, e) : (console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."), this.setAttribute(t, new en(arguments[1], arguments[2])));
  }, wn.prototype.addDrawCall = function (t, e, n) {
    void 0 !== n && console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."), console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."), this.addGroup(t, e);
  }, wn.prototype.clearDrawCalls = function () {
    console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."), this.clearGroups();
  }, wn.prototype.computeOffsets = function () {
    console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.");
  }, wn.prototype.removeAttribute = function (t) {
    return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."), this.deleteAttribute(t);
  }, wn.prototype.applyMatrix = function (t) {
    return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."), this.applyMatrix4(t);
  }, Object.defineProperties(wn.prototype, {
    drawcalls: {
      get: function get() {
        return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."), this.groups;
      }
    },
    offsets: {
      get: function get() {
        return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."), this.groups;
      }
    }
  }), ea.prototype.setDynamic = function (t) {
    return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."), this.setUsage(!0 === t ? nt : et), this;
  }, ea.prototype.setArray = function () {
    console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers");
  }, dl.prototype.getArrays = function () {
    console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.");
  }, dl.prototype.addShapeList = function () {
    console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.");
  }, dl.prototype.addShape = function () {
    console.error("THREE.ExtrudeGeometry: .addShape() has been removed.");
  }, ta.prototype.dispose = function () {
    console.error("THREE.Scene: .dispose() has been removed.");
  }, Sh.prototype.onUpdate = function () {
    return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."), this;
  }, Object.defineProperties(We.prototype, {
    wrapAround: {
      get: function get() {
        console.warn("THREE.Material: .wrapAround has been removed.");
      },
      set: function set() {
        console.warn("THREE.Material: .wrapAround has been removed.");
      }
    },
    overdraw: {
      get: function get() {
        console.warn("THREE.Material: .overdraw has been removed.");
      },
      set: function set() {
        console.warn("THREE.Material: .overdraw has been removed.");
      }
    },
    wrapRGB: {
      get: function get() {
        return console.warn("THREE.Material: .wrapRGB has been removed."), new Qe();
      }
    },
    shading: {
      get: function get() {
        console.error("THREE." + this.type + ": .shading has been removed. Use the boolean .flatShading instead.");
      },
      set: function set(t) {
        console.warn("THREE." + this.type + ": .shading has been removed. Use the boolean .flatShading instead."), this.flatShading = 1 === t;
      }
    },
    stencilMask: {
      get: function get() {
        return console.warn("THREE." + this.type + ": .stencilMask has been removed. Use .stencilFuncMask instead."), this.stencilFuncMask;
      },
      set: function set(t) {
        console.warn("THREE." + this.type + ": .stencilMask has been removed. Use .stencilFuncMask instead."), this.stencilFuncMask = t;
      }
    },
    vertexTangents: {
      get: function get() {
        console.warn("THREE." + this.type + ": .vertexTangents has been removed.");
      },
      set: function set() {
        console.warn("THREE." + this.type + ": .vertexTangents has been removed.");
      }
    }
  }), Object.defineProperties(Xn.prototype, {
    derivatives: {
      get: function get() {
        return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."), this.extensions.derivatives;
      },
      set: function set(t) {
        console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."), this.extensions.derivatives = t;
      }
    }
  }), Zs.prototype.clearTarget = function (t, e, n, i) {
    console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."), this.setRenderTarget(t), this.clear(e, n, i);
  }, Zs.prototype.animate = function (t) {
    console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."), this.setAnimationLoop(t);
  }, Zs.prototype.getCurrentRenderTarget = function () {
    return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."), this.getRenderTarget();
  }, Zs.prototype.getMaxAnisotropy = function () {
    return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."), this.capabilities.getMaxAnisotropy();
  }, Zs.prototype.getPrecision = function () {
    return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."), this.capabilities.precision;
  }, Zs.prototype.resetGLState = function () {
    return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."), this.state.reset();
  }, Zs.prototype.supportsFloatTextures = function () {
    return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."), this.extensions.get("OES_texture_float");
  }, Zs.prototype.supportsHalfFloatTextures = function () {
    return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."), this.extensions.get("OES_texture_half_float");
  }, Zs.prototype.supportsStandardDerivatives = function () {
    return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."), this.extensions.get("OES_standard_derivatives");
  }, Zs.prototype.supportsCompressedTextureS3TC = function () {
    return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."), this.extensions.get("WEBGL_compressed_texture_s3tc");
  }, Zs.prototype.supportsCompressedTexturePVRTC = function () {
    return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."), this.extensions.get("WEBGL_compressed_texture_pvrtc");
  }, Zs.prototype.supportsBlendMinMax = function () {
    return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."), this.extensions.get("EXT_blend_minmax");
  }, Zs.prototype.supportsVertexTextures = function () {
    return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."), this.capabilities.vertexTextures;
  }, Zs.prototype.supportsInstancedArrays = function () {
    return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."), this.extensions.get("ANGLE_instanced_arrays");
  }, Zs.prototype.enableScissorTest = function (t) {
    console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."), this.setScissorTest(t);
  }, Zs.prototype.initMaterial = function () {
    console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.");
  }, Zs.prototype.addPrePlugin = function () {
    console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.");
  }, Zs.prototype.addPostPlugin = function () {
    console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.");
  }, Zs.prototype.updateShadowMap = function () {
    console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.");
  }, Zs.prototype.setFaceCulling = function () {
    console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.");
  }, Zs.prototype.allocTextureUnit = function () {
    console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.");
  }, Zs.prototype.setTexture = function () {
    console.warn("THREE.WebGLRenderer: .setTexture() has been removed.");
  }, Zs.prototype.setTexture2D = function () {
    console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.");
  }, Zs.prototype.setTextureCube = function () {
    console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.");
  }, Zs.prototype.getActiveMipMapLevel = function () {
    return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."), this.getActiveMipmapLevel();
  }, Object.defineProperties(Zs.prototype, {
    shadowMapEnabled: {
      get: function get() {
        return this.shadowMap.enabled;
      },
      set: function set(t) {
        console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."), this.shadowMap.enabled = t;
      }
    },
    shadowMapType: {
      get: function get() {
        return this.shadowMap.type;
      },
      set: function set(t) {
        console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."), this.shadowMap.type = t;
      }
    },
    shadowMapCullFace: {
      get: function get() {
        console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.");
      },
      set: function set() {
        console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.");
      }
    },
    context: {
      get: function get() {
        return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."), this.getContext();
      }
    },
    vr: {
      get: function get() {
        return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"), this.xr;
      }
    },
    gammaInput: {
      get: function get() {
        return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."), !1;
      },
      set: function set() {
        console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.");
      }
    },
    gammaOutput: {
      get: function get() {
        return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."), !1;
      },
      set: function set(t) {
        console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."), this.outputEncoding = !0 === t ? Y : X;
      }
    },
    toneMappingWhitePoint: {
      get: function get() {
        return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."), 1;
      },
      set: function set() {
        console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.");
      }
    }
  }), Object.defineProperties(Hs.prototype, {
    cullFace: {
      get: function get() {
        console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.");
      },
      set: function set() {
        console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.");
      }
    },
    renderReverseSided: {
      get: function get() {
        console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.");
      },
      set: function set() {
        console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.");
      }
    },
    renderSingleSided: {
      get: function get() {
        console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.");
      },
      set: function set() {
        console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.");
      }
    }
  }), Object.defineProperties(Tt.prototype, {
    wrapS: {
      get: function get() {
        return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."), this.texture.wrapS;
      },
      set: function set(t) {
        console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."), this.texture.wrapS = t;
      }
    },
    wrapT: {
      get: function get() {
        return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."), this.texture.wrapT;
      },
      set: function set(t) {
        console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."), this.texture.wrapT = t;
      }
    },
    magFilter: {
      get: function get() {
        return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."), this.texture.magFilter;
      },
      set: function set(t) {
        console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."), this.texture.magFilter = t;
      }
    },
    minFilter: {
      get: function get() {
        return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."), this.texture.minFilter;
      },
      set: function set(t) {
        console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."), this.texture.minFilter = t;
      }
    },
    anisotropy: {
      get: function get() {
        return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."), this.texture.anisotropy;
      },
      set: function set(t) {
        console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."), this.texture.anisotropy = t;
      }
    },
    offset: {
      get: function get() {
        return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."), this.texture.offset;
      },
      set: function set(t) {
        console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."), this.texture.offset = t;
      }
    },
    repeat: {
      get: function get() {
        return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."), this.texture.repeat;
      },
      set: function set(t) {
        console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."), this.texture.repeat = t;
      }
    },
    format: {
      get: function get() {
        return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."), this.texture.format;
      },
      set: function set(t) {
        console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."), this.texture.format = t;
      }
    },
    type: {
      get: function get() {
        return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."), this.texture.type;
      },
      set: function set(t) {
        console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."), this.texture.type = t;
      }
    },
    generateMipmaps: {
      get: function get() {
        return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."), this.texture.generateMipmaps;
      },
      set: function set(t) {
        console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."), this.texture.generateMipmaps = t;
      }
    }
  }), ih.prototype.load = function (t) {
    console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");
    var e = this;
    return new qc().load(t, function (t) {
      e.setBuffer(t);
    }), this;
  }, lh.prototype.getData = function () {
    return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."), this.getFrequencyData();
  }, Qn.prototype.updateCubeMap = function (t, e) {
    return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."), this.update(t, e);
  }, Qn.prototype.clear = function (t, e, n, i) {
    return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."), this.renderTarget.clear(t, e, n, i);
  }, _t.crossOrigin = void 0, _t.loadTexture = function (t, e, n, i) {
    console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");
    var r = new cc();
    r.setCrossOrigin(this.crossOrigin);
    var s = r.load(t, n, void 0, i);
    return e && (s.mapping = e), s;
  }, _t.loadTextureCube = function (t, e, n, i) {
    console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");
    var r = new oc();
    r.setCrossOrigin(this.crossOrigin);
    var s = r.load(t, n, void 0, i);
    return e && (s.mapping = e), s;
  }, _t.loadCompressedTexture = function () {
    console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.");
  }, _t.loadCompressedTextureCube = function () {
    console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.");
  };
  var su = {
    createMultiMaterialObject: function createMultiMaterialObject() {
      console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js");
    },
    detach: function detach() {
      console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js");
    },
    attach: function attach() {
      console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js");
    }
  };
  "undefined" != typeof __THREE_DEVTOOLS__ && __THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register", {
    detail: {
      revision: e
    }
  })), "undefined" != typeof window && (window.__THREE__ ? console.warn("WARNING: Multiple instances of Three.js being imported.") : window.__THREE__ = e), t.ACESFilmicToneMapping = 4, t.AddEquation = n, t.AddOperation = 2, t.AdditiveAnimationBlendMode = q, t.AdditiveBlending = 2, t.AlphaFormat = 1021, t.AlwaysDepth = 1, t.AlwaysStencilFunc = 519, t.AmbientLight = Lc, t.AmbientLightProbe = Yc, t.AnimationClip = Kl, t.AnimationLoader = /*#__PURE__*/function (_ic10) {
    _inherits(_class2, _ic10);

    var _super140 = _createSuper(_class2);

    function _class2(t) {
      _classCallCheck(this, _class2);

      return _super140.call(this, t);
    }

    _createClass(_class2, [{
      key: "load",
      value: function load(t, e, n, i) {
        var r = this,
            s = new sc(this.manager);
        s.setPath(this.path), s.setRequestHeader(this.requestHeader), s.setWithCredentials(this.withCredentials), s.load(t, function (n) {
          try {
            e(r.parse(JSON.parse(n)));
          } catch (e) {
            i ? i(e) : console.error(e), r.manager.itemError(t);
          }
        }, n, i);
      }
    }, {
      key: "parse",
      value: function parse(t) {
        var e = [];

        for (var _n262 = 0; _n262 < t.length; _n262++) {
          var _i196 = Kl.parse(t[_n262]);

          e.push(_i196);
        }

        return e;
      }
    }]);

    return _class2;
  }(ic), t.AnimationMixer = wh, t.AnimationObjectGroup = Mh, t.AnimationUtils = Ul, t.ArcCurve = _o, t.ArrayCamera = Ws, t.ArrowHelper = /*#__PURE__*/function (_Pe14) {
    _inherits(_class3, _Pe14);

    var _super141 = _createSuper(_class3);

    function _class3() {
      var _this112;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new Rt(0, 0, 1);
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : new Rt(0, 0, 0);
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 16776960;
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : .2 * n;
      var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : .2 * r;

      _classCallCheck(this, _class3);

      _this112 = _super141.call(this), _this112.type = "ArrowHelper", void 0 === tu && (tu = new wn(), tu.setAttribute("position", new un([0, 0, 0, 0, 1, 0], 3)), eu = new lo(0, .5, 1, 5, 1), eu.translate(0, -.5, 0)), _this112.position.copy(e), _this112.line = new ja(tu, new Ua({
        color: i,
        toneMapped: !1
      })), _this112.line.matrixAutoUpdate = !1, _this112.add(_this112.line), _this112.cone = new Gn(eu, new Ke({
        color: i,
        toneMapped: !1
      })), _this112.cone.matrixAutoUpdate = !1, _this112.add(_this112.cone), _this112.setDirection(t), _this112.setLength(n, r, s);
      return _this112;
    }

    _createClass(_class3, [{
      key: "setDirection",
      value: function setDirection(t) {
        if (t.y > .99999) this.quaternion.set(0, 0, 0, 1);else if (t.y < -.99999) this.quaternion.set(1, 0, 0, 0);else {
          $h.set(t.z, 0, -t.x).normalize();

          var _e285 = Math.acos(t.y);

          this.quaternion.setFromAxisAngle($h, _e285);
        }
      }
    }, {
      key: "setLength",
      value: function setLength(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : .2 * t;
        var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : .2 * e;
        this.line.scale.set(1, Math.max(1e-4, t - e), 1), this.line.updateMatrix(), this.cone.scale.set(n, e, n), this.cone.position.y = t, this.cone.updateMatrix();
      }
    }, {
      key: "setColor",
      value: function setColor(t) {
        this.line.material.color.set(t), this.cone.material.color.set(t);
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return _get(_getPrototypeOf(_class3.prototype), "copy", this).call(this, t, !1), this.line.copy(t.line), this.cone.copy(t.cone), this;
      }
    }]);

    return _class3;
  }(Pe), t.Audio = ih, t.AudioAnalyser = lh, t.AudioContext = jc, t.AudioListener = /*#__PURE__*/function (_Pe15) {
    _inherits(_class4, _Pe15);

    var _super142 = _createSuper(_class4);

    function _class4() {
      var _this113;

      _classCallCheck(this, _class4);

      _this113 = _super142.call(this), _this113.type = "AudioListener", _this113.context = jc.getContext(), _this113.gain = _this113.context.createGain(), _this113.gain.connect(_this113.context.destination), _this113.filter = null, _this113.timeDelta = 0, _this113._clock = new Qc();
      return _this113;
    }

    _createClass(_class4, [{
      key: "getInput",
      value: function getInput() {
        return this.gain;
      }
    }, {
      key: "removeFilter",
      value: function removeFilter() {
        return null !== this.filter && (this.gain.disconnect(this.filter), this.filter.disconnect(this.context.destination), this.gain.connect(this.context.destination), this.filter = null), this;
      }
    }, {
      key: "getFilter",
      value: function getFilter() {
        return this.filter;
      }
    }, {
      key: "setFilter",
      value: function setFilter(t) {
        return null !== this.filter ? (this.gain.disconnect(this.filter), this.filter.disconnect(this.context.destination)) : this.gain.disconnect(this.context.destination), this.filter = t, this.gain.connect(this.filter), this.filter.connect(this.context.destination), this;
      }
    }, {
      key: "getMasterVolume",
      value: function getMasterVolume() {
        return this.gain.gain.value;
      }
    }, {
      key: "setMasterVolume",
      value: function setMasterVolume(t) {
        return this.gain.gain.setTargetAtTime(t, this.context.currentTime, .01), this;
      }
    }, {
      key: "updateMatrixWorld",
      value: function updateMatrixWorld(t) {
        _get(_getPrototypeOf(_class4.prototype), "updateMatrixWorld", this).call(this, t);

        var e = this.context.listener,
            n = this.up;

        if (this.timeDelta = this._clock.getDelta(), this.matrixWorld.decompose($c, th, eh), nh.set(0, 0, -1).applyQuaternion(th), e.positionX) {
          var _t314 = this.context.currentTime + this.timeDelta;

          e.positionX.linearRampToValueAtTime($c.x, _t314), e.positionY.linearRampToValueAtTime($c.y, _t314), e.positionZ.linearRampToValueAtTime($c.z, _t314), e.forwardX.linearRampToValueAtTime(nh.x, _t314), e.forwardY.linearRampToValueAtTime(nh.y, _t314), e.forwardZ.linearRampToValueAtTime(nh.z, _t314), e.upX.linearRampToValueAtTime(n.x, _t314), e.upY.linearRampToValueAtTime(n.y, _t314), e.upZ.linearRampToValueAtTime(n.z, _t314);
        } else e.setPosition($c.x, $c.y, $c.z), e.setOrientation(nh.x, nh.y, nh.z, n.x, n.y, n.z);
      }
    }]);

    return _class4;
  }(Pe), t.AudioLoader = qc, t.AxesHelper = nu, t.AxisHelper = function (t) {
    return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."), new nu(t);
  }, t.BackSide = 1, t.BasicDepthPacking = 3200, t.BasicShadowMap = 0, t.BinaryTextureLoader = function (t) {
    return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."), new lc(t);
  }, t.Bone = Ra, t.BooleanKeyframeTrack = jl, t.BoundingBoxHelper = function (t, e) {
    return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."), new Kh(t, e);
  }, t.Box2 = Ch, t.Box3 = It, t.Box3Helper = /*#__PURE__*/function (_Ya5) {
    _inherits(_class5, _Ya5);

    var _super143 = _createSuper(_class5);

    function _class5(t) {
      var _this114;

      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 16776960;

      _classCallCheck(this, _class5);

      var n = new Uint16Array([0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7]),
          i = new wn();
      i.setIndex(new en(n, 1)), i.setAttribute("position", new un([1, 1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1, 1, 1, -1, -1, 1, -1, -1, -1, -1, 1, -1, -1], 3)), _this114 = _super143.call(this, i, new Ua({
        color: e,
        toneMapped: !1
      })), _this114.box = t, _this114.type = "Box3Helper", _this114.geometry.computeBoundingSphere();
      return _this114;
    }

    _createClass(_class5, [{
      key: "updateMatrixWorld",
      value: function updateMatrixWorld(t) {
        var e = this.box;
        e.isEmpty() || (e.getCenter(this.position), e.getSize(this.scale), this.scale.multiplyScalar(.5), _get(_getPrototypeOf(_class5.prototype), "updateMatrixWorld", this).call(this, t));
      }
    }]);

    return _class5;
  }(Ya), t.BoxBufferGeometry = Vn, t.BoxGeometry = Vn, t.BoxHelper = Kh, t.BufferAttribute = en, t.BufferGeometry = wn, t.BufferGeometryLoader = zc, t.ByteType = 1010, t.Cache = tc, t.Camera = Yn, t.CameraHelper = /*#__PURE__*/function (_Ya6) {
    _inherits(_class6, _Ya6);

    var _super144 = _createSuper(_class6);

    function _class6(t) {
      var _this115;

      _classCallCheck(this, _class6);

      var e = new wn(),
          n = new Ua({
        color: 16777215,
        vertexColors: !0,
        toneMapped: !1
      }),
          i = [],
          r = [],
          s = {},
          a = new Qe(16755200),
          o = new Qe(16711680),
          l = new Qe(43775),
          c = new Qe(16777215),
          h = new Qe(3355443);

      function u(t, e, n) {
        d(t, n), d(e, n);
      }

      function d(t, e) {
        i.push(0, 0, 0), r.push(e.r, e.g, e.b), void 0 === s[t] && (s[t] = []), s[t].push(i.length / 3 - 1);
      }

      u("n1", "n2", a), u("n2", "n4", a), u("n4", "n3", a), u("n3", "n1", a), u("f1", "f2", a), u("f2", "f4", a), u("f4", "f3", a), u("f3", "f1", a), u("n1", "f1", a), u("n2", "f2", a), u("n3", "f3", a), u("n4", "f4", a), u("p", "n1", o), u("p", "n2", o), u("p", "n3", o), u("p", "n4", o), u("u1", "u2", l), u("u2", "u3", l), u("u3", "u1", l), u("c", "t", c), u("p", "c", h), u("cn1", "cn2", h), u("cn3", "cn4", h), u("cf1", "cf2", h), u("cf3", "cf4", h), e.setAttribute("position", new un(i, 3)), e.setAttribute("color", new un(r, 3)), _this115 = _super144.call(this, e, n), _this115.type = "CameraHelper", _this115.camera = t, _this115.camera.updateProjectionMatrix && _this115.camera.updateProjectionMatrix(), _this115.matrix = t.matrixWorld, _this115.matrixAutoUpdate = !1, _this115.pointMap = s, _this115.update();
      return _this115;
    }

    _createClass(_class6, [{
      key: "update",
      value: function update() {
        var t = this.geometry,
            e = this.pointMap;
        Jh.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse), Zh("c", e, t, Jh, 0, 0, -1), Zh("t", e, t, Jh, 0, 0, 1), Zh("n1", e, t, Jh, -1, -1, -1), Zh("n2", e, t, Jh, 1, -1, -1), Zh("n3", e, t, Jh, -1, 1, -1), Zh("n4", e, t, Jh, 1, 1, -1), Zh("f1", e, t, Jh, -1, -1, 1), Zh("f2", e, t, Jh, 1, -1, 1), Zh("f3", e, t, Jh, -1, 1, 1), Zh("f4", e, t, Jh, 1, 1, 1), Zh("u1", e, t, Jh, .7, 1.1, -1), Zh("u2", e, t, Jh, -.7, 1.1, -1), Zh("u3", e, t, Jh, 0, 2, -1), Zh("cf1", e, t, Jh, -1, 0, 1), Zh("cf2", e, t, Jh, 1, 0, 1), Zh("cf3", e, t, Jh, 0, -1, 1), Zh("cf4", e, t, Jh, 0, 1, 1), Zh("cn1", e, t, Jh, -1, 0, -1), Zh("cn2", e, t, Jh, 1, 0, -1), Zh("cn3", e, t, Jh, 0, -1, -1), Zh("cn4", e, t, Jh, 0, 1, -1), t.getAttribute("position").needsUpdate = !0;
      }
    }, {
      key: "dispose",
      value: function dispose() {
        this.geometry.dispose(), this.material.dispose();
      }
    }]);

    return _class6;
  }(Ya), t.CanvasRenderer = function () {
    console.error("THREE.CanvasRenderer has been removed");
  }, t.CanvasTexture = so, t.CatmullRomCurve3 = Eo, t.CineonToneMapping = 3, t.CircleBufferGeometry = oo, t.CircleGeometry = oo, t.ClampToEdgeWrapping = u, t.Clock = Qc, t.Color = Qe, t.ColorKeyframeTrack = ql, t.CompressedTexture = ro, t.CompressedTextureLoader = /*#__PURE__*/function (_ic11) {
    _inherits(_class7, _ic11);

    var _super145 = _createSuper(_class7);

    function _class7(t) {
      _classCallCheck(this, _class7);

      return _super145.call(this, t);
    }

    _createClass(_class7, [{
      key: "load",
      value: function load(t, e, n, i) {
        var r = this,
            s = [],
            a = new ro(),
            o = new sc(this.manager);
        o.setPath(this.path), o.setResponseType("arraybuffer"), o.setRequestHeader(this.requestHeader), o.setWithCredentials(r.withCredentials);
        var l = 0;

        function c(c) {
          o.load(t[c], function (t) {
            var n = r.parse(t, !0);
            s[c] = {
              width: n.width,
              height: n.height,
              format: n.format,
              mipmaps: n.mipmaps
            }, l += 1, 6 === l && (1 === n.mipmapCount && (a.minFilter = g), a.image = s, a.format = n.format, a.needsUpdate = !0, e && e(a));
          }, n, i);
        }

        if (Array.isArray(t)) for (var _e286 = 0, _n263 = t.length; _e286 < _n263; ++_e286) {
          c(_e286);
        } else o.load(t, function (t) {
          var n = r.parse(t, !0);

          if (n.isCubemap) {
            var _t315 = n.mipmaps.length / n.mipmapCount;

            for (var _e287 = 0; _e287 < _t315; _e287++) {
              s[_e287] = {
                mipmaps: []
              };

              for (var _t316 = 0; _t316 < n.mipmapCount; _t316++) {
                s[_e287].mipmaps.push(n.mipmaps[_e287 * n.mipmapCount + _t316]), s[_e287].format = n.format, s[_e287].width = n.width, s[_e287].height = n.height;
              }
            }

            a.image = s;
          } else a.image.width = n.width, a.image.height = n.height, a.mipmaps = n.mipmaps;

          1 === n.mipmapCount && (a.minFilter = g), a.format = n.format, a.needsUpdate = !0, e && e(a);
        }, n, i);
        return a;
      }
    }]);

    return _class7;
  }(ic), t.ConeBufferGeometry = co, t.ConeGeometry = co, t.CubeCamera = Qn, t.CubeReflectionMapping = r, t.CubeRefractionMapping = s, t.CubeTexture = Kn, t.CubeTextureLoader = oc, t.CubeUVReflectionMapping = l, t.CubeUVRefractionMapping = c, t.CubicBezierCurve = Co, t.CubicBezierCurve3 = Po, t.CubicInterpolant = Gl, t.CullFaceBack = 1, t.CullFaceFront = 2, t.CullFaceFrontBack = 3, t.CullFaceNone = 0, t.Curve = yo, t.CurvePath = hc, t.CustomBlending = 5, t.CustomToneMapping = 5, t.CylinderBufferGeometry = lo, t.CylinderGeometry = lo, t.Cylindrical = /*#__PURE__*/function () {
    function _class8() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;

      _classCallCheck(this, _class8);

      return this.radius = t, this.theta = e, this.y = n, this;
    }

    _createClass(_class8, [{
      key: "set",
      value: function set(t, e, n) {
        return this.radius = t, this.theta = e, this.y = n, this;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.radius = t.radius, this.theta = t.theta, this.y = t.y, this;
      }
    }, {
      key: "setFromVector3",
      value: function setFromVector3(t) {
        return this.setFromCartesianCoords(t.x, t.y, t.z);
      }
    }, {
      key: "setFromCartesianCoords",
      value: function setFromCartesianCoords(t, e, n) {
        return this.radius = Math.sqrt(t * t + n * n), this.theta = Math.atan2(t, n), this.y = e, this;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }]);

    return _class8;
  }(), t.DataTexture = Ca, t.DataTexture2DArray = nr, t.DataTexture3D = ir, t.DataTextureLoader = lc, t.DataUtils = /*#__PURE__*/function () {
    function _class9() {
      _classCallCheck(this, _class9);
    }

    _createClass(_class9, null, [{
      key: "toHalfFloat",
      value: function toHalfFloat(t) {
        iu[0] = t;
        var e = ru[0];
        var n = e >> 16 & 32768,
            i = e >> 12 & 2047;
        var r = e >> 23 & 255;
        return r < 103 ? n : r > 142 ? (n |= 31744, n |= (255 == r ? 0 : 1) && 8388607 & e, n) : r < 113 ? (i |= 2048, n |= (i >> 114 - r) + (i >> 113 - r & 1), n) : (n |= r - 112 << 10 | i >> 1, n += 1 & i, n);
      }
    }]);

    return _class9;
  }(), t.DecrementStencilOp = 7683, t.DecrementWrapStencilOp = 34056, t.DefaultLoadingManager = nc, t.DepthFormat = A, t.DepthStencilFormat = L, t.DepthTexture = ao, t.DirectionalLight = Ac, t.DirectionalLightHelper = /*#__PURE__*/function (_Pe16) {
    _inherits(_class10, _Pe16);

    var _super146 = _createSuper(_class10);

    function _class10(t, e, n) {
      var _this116;

      _classCallCheck(this, _class10);

      _this116 = _super146.call(this), _this116.light = t, _this116.light.updateMatrixWorld(), _this116.matrix = t.matrixWorld, _this116.matrixAutoUpdate = !1, _this116.color = n, void 0 === e && (e = 1);
      var i = new wn();
      i.setAttribute("position", new un([-e, e, 0, e, e, 0, e, -e, 0, -e, -e, 0, -e, e, 0], 3));
      var r = new Ua({
        fog: !1,
        toneMapped: !1
      });
      _this116.lightPlane = new ja(i, r), _this116.add(_this116.lightPlane), i = new wn(), i.setAttribute("position", new un([0, 0, 0, 0, 0, 1], 3)), _this116.targetLine = new ja(i, r), _this116.add(_this116.targetLine), _this116.update();
      return _this116;
    }

    _createClass(_class10, [{
      key: "dispose",
      value: function dispose() {
        this.lightPlane.geometry.dispose(), this.lightPlane.material.dispose(), this.targetLine.geometry.dispose(), this.targetLine.material.dispose();
      }
    }, {
      key: "update",
      value: function update() {
        jh.setFromMatrixPosition(this.light.matrixWorld), qh.setFromMatrixPosition(this.light.target.matrixWorld), Xh.subVectors(qh, jh), this.lightPlane.lookAt(qh), void 0 !== this.color ? (this.lightPlane.material.color.set(this.color), this.targetLine.material.color.set(this.color)) : (this.lightPlane.material.color.copy(this.light.color), this.targetLine.material.color.copy(this.light.color)), this.targetLine.lookAt(qh), this.targetLine.scale.z = Xh.length();
      }
    }]);

    return _class10;
  }(Pe), t.DiscreteInterpolant = Vl, t.DodecahedronBufferGeometry = uo, t.DodecahedronGeometry = uo, t.DoubleSide = 2, t.DstAlphaFactor = 206, t.DstColorFactor = 208, t.DynamicBufferAttribute = function (t, e) {
    return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."), new en(t, e).setUsage(nt);
  }, t.DynamicCopyUsage = 35050, t.DynamicDrawUsage = nt, t.DynamicReadUsage = 35049, t.EdgesGeometry = vo, t.EdgesHelper = function (t, e) {
    return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."), new Ya(new vo(t.geometry), new Ua({
      color: void 0 !== e ? e : 16777215
    }));
  }, t.EllipseCurve = xo, t.EqualDepth = 4, t.EqualStencilFunc = 514, t.EquirectangularReflectionMapping = a, t.EquirectangularRefractionMapping = o, t.Euler = ge, t.EventDispatcher = rt, t.ExtrudeBufferGeometry = dl, t.ExtrudeGeometry = dl, t.FaceColors = 1, t.FileLoader = sc, t.FlatShading = 1, t.Float16BufferAttribute = hn, t.Float32Attribute = function (t, e) {
    return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."), new un(t, e);
  }, t.Float32BufferAttribute = un, t.Float64Attribute = function (t, e) {
    return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."), new dn(t, e);
  }, t.Float64BufferAttribute = dn, t.FloatType = b, t.Fog = $s, t.FogExp2 = Ks, t.Font = kc, t.FontLoader = /*#__PURE__*/function (_ic12) {
    _inherits(_class11, _ic12);

    var _super147 = _createSuper(_class11);

    function _class11(t) {
      _classCallCheck(this, _class11);

      return _super147.call(this, t);
    }

    _createClass(_class11, [{
      key: "load",
      value: function load(t, e, n, i) {
        var r = this,
            s = new sc(this.manager);
        s.setPath(this.path), s.setRequestHeader(this.requestHeader), s.setWithCredentials(r.withCredentials), s.load(t, function (t) {
          var n;

          try {
            n = JSON.parse(t);
          } catch (e) {
            console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."), n = JSON.parse(t.substring(65, t.length - 2));
          }

          var i = r.parse(n);
          e && e(i);
        }, n, i);
      }
    }, {
      key: "parse",
      value: function parse(t) {
        return new kc(t);
      }
    }]);

    return _class11;
  }(ic), t.FrontSide = 0, t.Frustum = ai, t.GLBufferAttribute = Eh, t.GLSL1 = "100", t.GLSL3 = it, t.GammaEncoding = J, t.GreaterDepth = 6, t.GreaterEqualDepth = 5, t.GreaterEqualStencilFunc = 518, t.GreaterStencilFunc = 516, t.GridHelper = Wh, t.Group = js, t.HalfFloatType = w, t.HemisphereLight = mc, t.HemisphereLightHelper = /*#__PURE__*/function (_Pe17) {
    _inherits(_class12, _Pe17);

    var _super148 = _createSuper(_class12);

    function _class12(t, e, n) {
      var _this117;

      _classCallCheck(this, _class12);

      _this117 = _super148.call(this), _this117.light = t, _this117.light.updateMatrixWorld(), _this117.matrix = t.matrixWorld, _this117.matrixAutoUpdate = !1, _this117.color = n;
      var i = new gl(e);
      i.rotateY(.5 * Math.PI), _this117.material = new Ke({
        wireframe: !0,
        fog: !1,
        toneMapped: !1
      }), void 0 === _this117.color && (_this117.material.vertexColors = !0);
      var r = i.getAttribute("position"),
          s = new Float32Array(3 * r.count);
      i.setAttribute("color", new en(s, 3)), _this117.add(new Gn(i, _this117.material)), _this117.update();
      return _this117;
    }

    _createClass(_class12, [{
      key: "dispose",
      value: function dispose() {
        this.children[0].geometry.dispose(), this.children[0].material.dispose();
      }
    }, {
      key: "update",
      value: function update() {
        var t = this.children[0];
        if (void 0 !== this.color) this.material.color.set(this.color);else {
          var _e288 = t.geometry.getAttribute("color");

          kh.copy(this.light.color), Vh.copy(this.light.groundColor);

          for (var _t317 = 0, _n264 = _e288.count; _t317 < _n264; _t317++) {
            var _i197 = _t317 < _n264 / 2 ? kh : Vh;

            _e288.setXYZ(_t317, _i197.r, _i197.g, _i197.b);
          }

          _e288.needsUpdate = !0;
        }
        t.lookAt(Gh.setFromMatrixPosition(this.light.matrixWorld).negate());
      }
    }]);

    return _class12;
  }(Pe), t.HemisphereLightProbe = Xc, t.IcosahedronBufferGeometry = ml, t.IcosahedronGeometry = ml, t.ImageBitmapLoader = Hc, t.ImageLoader = ac, t.ImageUtils = _t, t.ImmediateRenderObject = Nh, t.IncrementStencilOp = 7682, t.IncrementWrapStencilOp = 34055, t.InstancedBufferAttribute = Bc, t.InstancedBufferGeometry = Nc, t.InstancedInterleavedBuffer = Th, t.InstancedMesh = Oa, t.Int16Attribute = function (t, e) {
    return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."), new an(t, e);
  }, t.Int16BufferAttribute = an, t.Int32Attribute = function (t, e) {
    return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."), new ln(t, e);
  }, t.Int32BufferAttribute = ln, t.Int8Attribute = function (t, e) {
    return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."), new nn(t, e);
  }, t.Int8BufferAttribute = nn, t.IntType = 1013, t.InterleavedBuffer = ea, t.InterleavedBufferAttribute = ia, t.Interpolant = Hl, t.InterpolateDiscrete = U, t.InterpolateLinear = H, t.InterpolateSmooth = G, t.InvertStencilOp = 5386, t.JSONLoader = function () {
    console.error("THREE.JSONLoader has been removed.");
  }, t.KeepStencilOp = tt, t.KeyframeTrack = Wl, t.LOD = ba, t.LatheBufferGeometry = fl, t.LatheGeometry = fl, t.Layers = ve, t.LensFlare = function () {
    console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js");
  }, t.LessDepth = 2, t.LessEqualDepth = 3, t.LessEqualStencilFunc = 515, t.LessStencilFunc = 513, t.Light = pc, t.LightProbe = Pc, t.Line = ja, t.Line3 = Dh, t.LineBasicMaterial = Ua, t.LineCurve = Io, t.LineCurve3 = Do, t.LineDashedMaterial = Fl, t.LineLoop = Ja, t.LinePieces = 1, t.LineSegments = Ya, t.LineStrip = 0, t.LinearEncoding = X, t.LinearFilter = g, t.LinearInterpolant = kl, t.LinearMipMapLinearFilter = 1008, t.LinearMipMapNearestFilter = 1007, t.LinearMipmapLinearFilter = y, t.LinearMipmapNearestFilter = v, t.LinearToneMapping = 1, t.Loader = ic, t.LoaderUtils = Dc, t.LoadingManager = ec, t.LogLuvEncoding = 3003, t.LoopOnce = 2200, t.LoopPingPong = 2202, t.LoopRepeat = 2201, t.LuminanceAlphaFormat = 1025, t.LuminanceFormat = 1024, t.MOUSE = {
    LEFT: 0,
    MIDDLE: 1,
    RIGHT: 2,
    ROTATE: 0,
    DOLLY: 1,
    PAN: 2
  }, t.Material = We, t.MaterialLoader = Ic, t.Math = gt, t.MathUtils = gt, t.Matrix3 = yt, t.Matrix4 = ae, t.MaxEquation = 104, t.Mesh = Gn, t.MeshBasicMaterial = Ke, t.MeshDepthMaterial = Os, t.MeshDistanceMaterial = Us, t.MeshFaceMaterial = function (t) {
    return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."), t;
  }, t.MeshLambertMaterial = Bl, t.MeshMatcapMaterial = zl, t.MeshNormalMaterial = Nl, t.MeshPhongMaterial = Il, t.MeshPhysicalMaterial = Pl, t.MeshStandardMaterial = Cl, t.MeshToonMaterial = Dl, t.MinEquation = 103, t.MirroredRepeatWrapping = d, t.MixOperation = 1, t.MultiMaterial = function () {
    var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
    return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."), t.isMultiMaterial = !0, t.materials = t, t.clone = function () {
      return t.slice();
    }, t;
  }, t.MultiplyBlending = 4, t.MultiplyOperation = 0, t.NearestFilter = p, t.NearestMipMapLinearFilter = 1005, t.NearestMipMapNearestFilter = 1004, t.NearestMipmapLinearFilter = f, t.NearestMipmapNearestFilter = m, t.NeverDepth = 0, t.NeverStencilFunc = 512, t.NoBlending = 0, t.NoColors = 0, t.NoToneMapping = 0, t.NormalAnimationBlendMode = j, t.NormalBlending = 1, t.NotEqualDepth = 7, t.NotEqualStencilFunc = 517, t.NumberKeyframeTrack = Xl, t.Object3D = Pe, t.ObjectLoader = /*#__PURE__*/function (_ic13) {
    _inherits(_class13, _ic13);

    var _super149 = _createSuper(_class13);

    function _class13(t) {
      _classCallCheck(this, _class13);

      return _super149.call(this, t);
    }

    _createClass(_class13, [{
      key: "load",
      value: function load(t, e, n, i) {
        var r = this,
            s = "" === this.path ? Dc.extractUrlBase(t) : this.path;
        this.resourcePath = this.resourcePath || s;
        var a = new sc(this.manager);
        a.setPath(this.path), a.setRequestHeader(this.requestHeader), a.setWithCredentials(this.withCredentials), a.load(t, function (n) {
          var s = null;

          try {
            s = JSON.parse(n);
          } catch (e) {
            return void 0 !== i && i(e), void console.error("THREE:ObjectLoader: Can't parse " + t + ".", e.message);
          }

          var a = s.metadata;
          void 0 !== a && void 0 !== a.type && "geometry" !== a.type.toLowerCase() ? r.parse(s, e) : console.error("THREE.ObjectLoader: Can't load " + t);
        }, n, i);
      }
    }, {
      key: "loadAsync",
      value: function () {
        var _loadAsync = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(t, e) {
          var n, i, r, s, a;
          return regeneratorRuntime.wrap(function _callee2$(_context2) {
            while (1) {
              switch (_context2.prev = _context2.next) {
                case 0:
                  n = "" === this.path ? Dc.extractUrlBase(t) : this.path;
                  this.resourcePath = this.resourcePath || n;
                  i = new sc(this.manager);
                  i.setPath(this.path), i.setRequestHeader(this.requestHeader), i.setWithCredentials(this.withCredentials);
                  _context2.next = 6;
                  return i.loadAsync(t, e);

                case 6:
                  r = _context2.sent;
                  s = JSON.parse(r);
                  a = s.metadata;

                  if (!(void 0 === a || void 0 === a.type || "geometry" === a.type.toLowerCase())) {
                    _context2.next = 11;
                    break;
                  }

                  throw new Error("THREE.ObjectLoader: Can't load " + t);

                case 11:
                  _context2.next = 13;
                  return this.parseAsync(s);

                case 13:
                  return _context2.abrupt("return", _context2.sent);

                case 14:
                case "end":
                  return _context2.stop();
              }
            }
          }, _callee2, this);
        }));

        function loadAsync(_x5, _x6) {
          return _loadAsync.apply(this, arguments);
        }

        return loadAsync;
      }()
    }, {
      key: "parse",
      value: function parse(t, e) {
        var n = this.parseAnimations(t.animations),
            i = this.parseShapes(t.shapes),
            r = this.parseGeometries(t.geometries, i),
            s = this.parseImages(t.images, function () {
          void 0 !== e && e(l);
        }),
            a = this.parseTextures(t.textures, s),
            o = this.parseMaterials(t.materials, a),
            l = this.parseObject(t.object, r, o, a, n),
            c = this.parseSkeletons(t.skeletons, l);

        if (this.bindSkeletons(l, c), void 0 !== e) {
          var _t318 = !1;

          for (var _e289 in s) {
            if (s[_e289] instanceof HTMLImageElement) {
              _t318 = !0;
              break;
            }
          }

          !1 === _t318 && e(l);
        }

        return l;
      }
    }, {
      key: "parseAsync",
      value: function () {
        var _parseAsync = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(t) {
          var e, n, i, r, s, a, o, l;
          return regeneratorRuntime.wrap(function _callee3$(_context3) {
            while (1) {
              switch (_context3.prev = _context3.next) {
                case 0:
                  e = this.parseAnimations(t.animations);
                  n = this.parseShapes(t.shapes);
                  i = this.parseGeometries(t.geometries, n);
                  _context3.next = 5;
                  return this.parseImagesAsync(t.images);

                case 5:
                  r = _context3.sent;
                  s = this.parseTextures(t.textures, r);
                  a = this.parseMaterials(t.materials, s);
                  o = this.parseObject(t.object, i, a, s, e);
                  l = this.parseSkeletons(t.skeletons, o);
                  return _context3.abrupt("return", (this.bindSkeletons(o, l), o));

                case 11:
                case "end":
                  return _context3.stop();
              }
            }
          }, _callee3, this);
        }));

        function parseAsync(_x7) {
          return _parseAsync.apply(this, arguments);
        }

        return parseAsync;
      }()
    }, {
      key: "parseShapes",
      value: function parseShapes(t) {
        var e = {};
        if (void 0 !== t) for (var _n265 = 0, _i198 = t.length; _n265 < _i198; _n265++) {
          var _i199 = new dc().fromJSON(t[_n265]);

          e[_i199.uuid] = _i199;
        }
        return e;
      }
    }, {
      key: "parseSkeletons",
      value: function parseSkeletons(t, e) {
        var n = {},
            i = {};
        if (e.traverse(function (t) {
          t.isBone && (i[t.uuid] = t);
        }), void 0 !== t) for (var _e290 = 0, _r163 = t.length; _e290 < _r163; _e290++) {
          var _r164 = new Da().fromJSON(t[_e290], i);

          n[_r164.uuid] = _r164;
        }
        return n;
      }
    }, {
      key: "parseGeometries",
      value: function parseGeometries(t, e) {
        var n = {};

        if (void 0 !== t) {
          var _i200 = new zc();

          for (var _r165 = 0, _s92 = t.length; _r165 < _s92; _r165++) {
            var _s93 = void 0;

            var _a76 = t[_r165];

            switch (_a76.type) {
              case "BufferGeometry":
              case "InstancedBufferGeometry":
                _s93 = _i200.parse(_a76);
                break;

              case "Geometry":
                console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");
                break;

              default:
                _a76.type in Ll ? _s93 = Ll[_a76.type].fromJSON(_a76, e) : console.warn("THREE.ObjectLoader: Unsupported geometry type \"".concat(_a76.type, "\""));
            }

            _s93.uuid = _a76.uuid, void 0 !== _a76.name && (_s93.name = _a76.name), !0 === _s93.isBufferGeometry && void 0 !== _a76.userData && (_s93.userData = _a76.userData), n[_a76.uuid] = _s93;
          }
        }

        return n;
      }
    }, {
      key: "parseMaterials",
      value: function parseMaterials(t, e) {
        var n = {},
            i = {};

        if (void 0 !== t) {
          var _r166 = new Ic();

          _r166.setTextures(e);

          for (var _e291 = 0, _s94 = t.length; _e291 < _s94; _e291++) {
            var _s95 = t[_e291];

            if ("MultiMaterial" === _s95.type) {
              var _t319 = [];

              for (var _e292 = 0; _e292 < _s95.materials.length; _e292++) {
                var _i201 = _s95.materials[_e292];
                void 0 === n[_i201.uuid] && (n[_i201.uuid] = _r166.parse(_i201)), _t319.push(n[_i201.uuid]);
              }

              i[_s95.uuid] = _t319;
            } else void 0 === n[_s95.uuid] && (n[_s95.uuid] = _r166.parse(_s95)), i[_s95.uuid] = n[_s95.uuid];
          }
        }

        return i;
      }
    }, {
      key: "parseAnimations",
      value: function parseAnimations(t) {
        var e = {};
        if (void 0 !== t) for (var _n266 = 0; _n266 < t.length; _n266++) {
          var _i202 = t[_n266],
              _r167 = Kl.parse(_i202);

          e[_r167.uuid] = _r167;
        }
        return e;
      }
    }, {
      key: "parseImages",
      value: function parseImages(t, e) {
        var n = this,
            i = {};
        var r;

        function s(t) {
          if ("string" == typeof t) {
            var _e293 = t;
            return function (t) {
              return n.manager.itemStart(t), r.load(t, function () {
                n.manager.itemEnd(t);
              }, void 0, function () {
                n.manager.itemError(t), n.manager.itemEnd(t);
              });
            }(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(_e293) ? _e293 : n.resourcePath + _e293);
          }

          return t.data ? {
            data: fn(t.type, t.data),
            width: t.width,
            height: t.height
          } : null;
        }

        if (void 0 !== t && t.length > 0) {
          var _n267 = new ec(e);

          r = new ac(_n267), r.setCrossOrigin(this.crossOrigin);

          for (var _e294 = 0, _n268 = t.length; _e294 < _n268; _e294++) {
            var _n269 = t[_e294],
                _r168 = _n269.url;

            if (Array.isArray(_r168)) {
              i[_n269.uuid] = [];

              for (var _t320 = 0, _e295 = _r168.length; _t320 < _e295; _t320++) {
                var _e296 = s(_r168[_t320]);

                null !== _e296 && (_e296 instanceof HTMLImageElement ? i[_n269.uuid].push(_e296) : i[_n269.uuid].push(new Ca(_e296.data, _e296.width, _e296.height)));
              }
            } else {
              var _t321 = s(_n269.url);

              null !== _t321 && (i[_n269.uuid] = _t321);
            }
          }
        }

        return i;
      }
    }, {
      key: "parseImagesAsync",
      value: function () {
        var _parseImagesAsync = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(t) {
          var e, n, i, r, _r169, _e297, _i203, _i204, _s96, _t322, _e298, _e299, _a77, _t323;

          return regeneratorRuntime.wrap(function _callee5$(_context5) {
            while (1) {
              switch (_context5.prev = _context5.next) {
                case 0:
                  _r169 = function _r172() {
                    _r169 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(t) {
                      var _n270, _r170;

                      return regeneratorRuntime.wrap(function _callee4$(_context4) {
                        while (1) {
                          switch (_context4.prev = _context4.next) {
                            case 0:
                              if (!("string" == typeof t)) {
                                _context4.next = 5;
                                break;
                              }

                              _n270 = t, _r170 = /^(\/\/)|([a-z]+:(\/\/)?)/i.test(_n270) ? _n270 : e.resourcePath + _n270;
                              _context4.next = 4;
                              return i.loadAsync(_r170);

                            case 4:
                              return _context4.abrupt("return", _context4.sent);

                            case 5:
                              return _context4.abrupt("return", t.data ? {
                                data: fn(t.type, t.data),
                                width: t.width,
                                height: t.height
                              } : null);

                            case 6:
                            case "end":
                              return _context4.stop();
                          }
                        }
                      }, _callee4);
                    }));
                    return _r169.apply(this, arguments);
                  };

                  r = function _r171(_x9) {
                    return _r169.apply(this, arguments);
                  };

                  e = this, n = {};

                  if (!(void 0 !== t && t.length > 0)) {
                    _context5.next = 29;
                    break;
                  }

                  i = new ac(this.manager), i.setCrossOrigin(this.crossOrigin);
                  _e297 = 0, _i203 = t.length;

                case 6:
                  if (!(_e297 < _i203)) {
                    _context5.next = 29;
                    break;
                  }

                  _i204 = t[_e297], _s96 = _i204.url;

                  if (!Array.isArray(_s96)) {
                    _context5.next = 22;
                    break;
                  }

                  n[_i204.uuid] = [];
                  _t322 = 0, _e298 = _s96.length;

                case 11:
                  if (!(_t322 < _e298)) {
                    _context5.next = 20;
                    break;
                  }

                  _e299 = _s96[_t322];
                  _context5.next = 15;
                  return r(_e299);

                case 15:
                  _a77 = _context5.sent;
                  null !== _a77 && (_a77 instanceof HTMLImageElement ? n[_i204.uuid].push(_a77) : n[_i204.uuid].push(new Ca(_a77.data, _a77.width, _a77.height)));

                case 17:
                  _t322++;
                  _context5.next = 11;
                  break;

                case 20:
                  _context5.next = 26;
                  break;

                case 22:
                  _context5.next = 24;
                  return r(_i204.url);

                case 24:
                  _t323 = _context5.sent;
                  null !== _t323 && (n[_i204.uuid] = _t323);

                case 26:
                  _e297++;
                  _context5.next = 6;
                  break;

                case 29:
                  return _context5.abrupt("return", n);

                case 30:
                case "end":
                  return _context5.stop();
              }
            }
          }, _callee5, this);
        }));

        function parseImagesAsync(_x8) {
          return _parseImagesAsync.apply(this, arguments);
        }

        return parseImagesAsync;
      }()
    }, {
      key: "parseTextures",
      value: function parseTextures(t, e) {
        function n(t, e) {
          return "number" == typeof t ? t : (console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.", t), e[t]);
        }

        var i = {};
        if (void 0 !== t) for (var r = 0, _s97 = t.length; r < _s97; r++) {
          var _s98 = t[r];

          var _a78 = void 0;

          void 0 === _s98.image && console.warn('THREE.ObjectLoader: No "image" specified for', _s98.uuid), void 0 === e[_s98.image] && console.warn("THREE.ObjectLoader: Undefined image", _s98.image);
          var _o48 = e[_s98.image];
          Array.isArray(_o48) ? (_a78 = new Kn(_o48), 6 === _o48.length && (_a78.needsUpdate = !0)) : (_a78 = _o48 && _o48.data ? new Ca(_o48.data, _o48.width, _o48.height) : new bt(_o48), _o48 && (_a78.needsUpdate = !0)), _a78.uuid = _s98.uuid, void 0 !== _s98.name && (_a78.name = _s98.name), void 0 !== _s98.mapping && (_a78.mapping = n(_s98.mapping, Fc)), void 0 !== _s98.offset && _a78.offset.fromArray(_s98.offset), void 0 !== _s98.repeat && _a78.repeat.fromArray(_s98.repeat), void 0 !== _s98.center && _a78.center.fromArray(_s98.center), void 0 !== _s98.rotation && (_a78.rotation = _s98.rotation), void 0 !== _s98.wrap && (_a78.wrapS = n(_s98.wrap[0], Oc), _a78.wrapT = n(_s98.wrap[1], Oc)), void 0 !== _s98.format && (_a78.format = _s98.format), void 0 !== _s98.type && (_a78.type = _s98.type), void 0 !== _s98.encoding && (_a78.encoding = _s98.encoding), void 0 !== _s98.minFilter && (_a78.minFilter = n(_s98.minFilter, Uc)), void 0 !== _s98.magFilter && (_a78.magFilter = n(_s98.magFilter, Uc)), void 0 !== _s98.anisotropy && (_a78.anisotropy = _s98.anisotropy), void 0 !== _s98.flipY && (_a78.flipY = _s98.flipY), void 0 !== _s98.premultiplyAlpha && (_a78.premultiplyAlpha = _s98.premultiplyAlpha), void 0 !== _s98.unpackAlignment && (_a78.unpackAlignment = _s98.unpackAlignment), i[_s98.uuid] = _a78;
        }
        return i;
      }
    }, {
      key: "parseObject",
      value: function parseObject(t, e, n, i, r) {
        var s, a, o;

        function l(t) {
          return void 0 === e[t] && console.warn("THREE.ObjectLoader: Undefined geometry", t), e[t];
        }

        function c(t) {
          if (void 0 !== t) {
            if (Array.isArray(t)) {
              var _e300 = [];

              for (var _i205 = 0, _r173 = t.length; _i205 < _r173; _i205++) {
                var _r174 = t[_i205];
                void 0 === n[_r174] && console.warn("THREE.ObjectLoader: Undefined material", _r174), _e300.push(n[_r174]);
              }

              return _e300;
            }

            return void 0 === n[t] && console.warn("THREE.ObjectLoader: Undefined material", t), n[t];
          }
        }

        function h(t) {
          return void 0 === i[t] && console.warn("THREE.ObjectLoader: Undefined texture", t), i[t];
        }

        switch (t.type) {
          case "Scene":
            s = new ta(), void 0 !== t.background && (Number.isInteger(t.background) ? s.background = new Qe(t.background) : s.background = h(t.background)), void 0 !== t.environment && (s.environment = h(t.environment)), void 0 !== t.fog && ("Fog" === t.fog.type ? s.fog = new $s(t.fog.color, t.fog.near, t.fog.far) : "FogExp2" === t.fog.type && (s.fog = new Ks(t.fog.color, t.fog.density)));
            break;

          case "PerspectiveCamera":
            s = new Jn(t.fov, t.aspect, t.near, t.far), void 0 !== t.focus && (s.focus = t.focus), void 0 !== t.zoom && (s.zoom = t.zoom), void 0 !== t.filmGauge && (s.filmGauge = t.filmGauge), void 0 !== t.filmOffset && (s.filmOffset = t.filmOffset), void 0 !== t.view && (s.view = Object.assign({}, t.view));
            break;

          case "OrthographicCamera":
            s = new xi(t.left, t.right, t.top, t.bottom, t.near, t.far), void 0 !== t.zoom && (s.zoom = t.zoom), void 0 !== t.view && (s.view = Object.assign({}, t.view));
            break;

          case "AmbientLight":
            s = new Lc(t.color, t.intensity);
            break;

          case "DirectionalLight":
            s = new Ac(t.color, t.intensity);
            break;

          case "PointLight":
            s = new Tc(t.color, t.intensity, t.distance, t.decay);
            break;

          case "RectAreaLight":
            s = new Rc(t.color, t.intensity, t.width, t.height);
            break;

          case "SpotLight":
            s = new _c(t.color, t.intensity, t.distance, t.angle, t.penumbra, t.decay);
            break;

          case "HemisphereLight":
            s = new mc(t.color, t.groundColor, t.intensity);
            break;

          case "LightProbe":
            s = new Pc().fromJSON(t);
            break;

          case "SkinnedMesh":
            a = l(t.geometry), o = c(t.material), s = new La(a, o), void 0 !== t.bindMode && (s.bindMode = t.bindMode), void 0 !== t.bindMatrix && s.bindMatrix.fromArray(t.bindMatrix), void 0 !== t.skeleton && (s.skeleton = t.skeleton);
            break;

          case "Mesh":
            a = l(t.geometry), o = c(t.material), s = new Gn(a, o);
            break;

          case "InstancedMesh":
            a = l(t.geometry), o = c(t.material);
            var _e301 = t.count,
                _n271 = t.instanceMatrix,
                _i206 = t.instanceColor;
            s = new Oa(a, o, _e301), s.instanceMatrix = new en(new Float32Array(_n271.array), 16), void 0 !== _i206 && (s.instanceColor = new en(new Float32Array(_i206.array), _i206.itemSize));
            break;

          case "LOD":
            s = new ba();
            break;

          case "Line":
            s = new ja(l(t.geometry), c(t.material));
            break;

          case "LineLoop":
            s = new Ja(l(t.geometry), c(t.material));
            break;

          case "LineSegments":
            s = new Ya(l(t.geometry), c(t.material));
            break;

          case "PointCloud":
          case "Points":
            s = new eo(l(t.geometry), c(t.material));
            break;

          case "Sprite":
            s = new ya(c(t.material));
            break;

          case "Group":
            s = new js();
            break;

          case "Bone":
            s = new Ra();
            break;

          default:
            s = new Pe();
        }

        if (s.uuid = t.uuid, void 0 !== t.name && (s.name = t.name), void 0 !== t.matrix ? (s.matrix.fromArray(t.matrix), void 0 !== t.matrixAutoUpdate && (s.matrixAutoUpdate = t.matrixAutoUpdate), s.matrixAutoUpdate && s.matrix.decompose(s.position, s.quaternion, s.scale)) : (void 0 !== t.position && s.position.fromArray(t.position), void 0 !== t.rotation && s.rotation.fromArray(t.rotation), void 0 !== t.quaternion && s.quaternion.fromArray(t.quaternion), void 0 !== t.scale && s.scale.fromArray(t.scale)), void 0 !== t.castShadow && (s.castShadow = t.castShadow), void 0 !== t.receiveShadow && (s.receiveShadow = t.receiveShadow), t.shadow && (void 0 !== t.shadow.bias && (s.shadow.bias = t.shadow.bias), void 0 !== t.shadow.normalBias && (s.shadow.normalBias = t.shadow.normalBias), void 0 !== t.shadow.radius && (s.shadow.radius = t.shadow.radius), void 0 !== t.shadow.mapSize && s.shadow.mapSize.fromArray(t.shadow.mapSize), void 0 !== t.shadow.camera && (s.shadow.camera = this.parseObject(t.shadow.camera))), void 0 !== t.visible && (s.visible = t.visible), void 0 !== t.frustumCulled && (s.frustumCulled = t.frustumCulled), void 0 !== t.renderOrder && (s.renderOrder = t.renderOrder), void 0 !== t.userData && (s.userData = t.userData), void 0 !== t.layers && (s.layers.mask = t.layers), void 0 !== t.children) {
          var _a79 = t.children;

          for (var _t324 = 0; _t324 < _a79.length; _t324++) {
            s.add(this.parseObject(_a79[_t324], e, n, i, r));
          }
        }

        if (void 0 !== t.animations) {
          var _e302 = t.animations;

          for (var _t325 = 0; _t325 < _e302.length; _t325++) {
            var _n272 = _e302[_t325];
            s.animations.push(r[_n272]);
          }
        }

        if ("LOD" === t.type) {
          void 0 !== t.autoUpdate && (s.autoUpdate = t.autoUpdate);
          var _e303 = t.levels;

          for (var _t326 = 0; _t326 < _e303.length; _t326++) {
            var _n273 = _e303[_t326],
                _i207 = s.getObjectByProperty("uuid", _n273.object);

            void 0 !== _i207 && s.addLevel(_i207, _n273.distance);
          }
        }

        return s;
      }
    }, {
      key: "bindSkeletons",
      value: function bindSkeletons(t, e) {
        0 !== Object.keys(e).length && t.traverse(function (t) {
          if (!0 === t.isSkinnedMesh && void 0 !== t.skeleton) {
            var _n274 = e[t.skeleton];
            void 0 === _n274 ? console.warn("THREE.ObjectLoader: No skeleton found with UUID:", t.skeleton) : t.bind(_n274, t.bindMatrix);
          }
        });
      }
    }, {
      key: "setTexturePath",
      value: function setTexturePath(t) {
        return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."), this.setResourcePath(t);
      }
    }]);

    return _class13;
  }(ic), t.ObjectSpaceNormalMap = 1, t.OctahedronBufferGeometry = gl, t.OctahedronGeometry = gl, t.OneFactor = 201, t.OneMinusDstAlphaFactor = 207, t.OneMinusDstColorFactor = 209, t.OneMinusSrcAlphaFactor = 205, t.OneMinusSrcColorFactor = 203, t.OrthographicCamera = xi, t.PCFShadowMap = 1, t.PCFSoftShadowMap = 2, t.PMREMGenerator = Oi, t.ParametricBufferGeometry = vl, t.ParametricGeometry = vl, t.Particle = function (t) {
    return console.warn("THREE.Particle has been renamed to THREE.Sprite."), new ya(t);
  }, t.ParticleBasicMaterial = function (t) {
    return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."), new Za(t);
  }, t.ParticleSystem = function (t, e) {
    return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."), new eo(t, e);
  }, t.ParticleSystemMaterial = function (t) {
    return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."), new Za(t);
  }, t.Path = uc, t.PerspectiveCamera = Jn, t.Plane = ii, t.PlaneBufferGeometry = ci, t.PlaneGeometry = ci, t.PlaneHelper = /*#__PURE__*/function (_ja3) {
    _inherits(_class14, _ja3);

    var _super150 = _createSuper(_class14);

    function _class14(t) {
      var _this118;

      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 16776960;

      _classCallCheck(this, _class14);

      var i = n,
          r = new wn();
      r.setAttribute("position", new un([1, -1, 1, -1, 1, 1, -1, -1, 1, 1, 1, 1, -1, 1, 1, -1, -1, 1, 1, -1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0], 3)), r.computeBoundingSphere(), _this118 = _super150.call(this, r, new Ua({
        color: i,
        toneMapped: !1
      })), _this118.type = "PlaneHelper", _this118.plane = t, _this118.size = e;
      var s = new wn();
      s.setAttribute("position", new un([1, 1, 1, -1, 1, 1, -1, -1, 1, 1, 1, 1, -1, -1, 1, 1, -1, 1], 3)), s.computeBoundingSphere(), _this118.add(new Gn(s, new Ke({
        color: i,
        opacity: .2,
        transparent: !0,
        depthWrite: !1,
        toneMapped: !1
      })));
      return _this118;
    }

    _createClass(_class14, [{
      key: "updateMatrixWorld",
      value: function updateMatrixWorld(t) {
        var e = -this.plane.constant;
        Math.abs(e) < 1e-8 && (e = 1e-8), this.scale.set(.5 * this.size, .5 * this.size, e), this.children[0].material.side = e < 0 ? 1 : 0, this.lookAt(this.plane.normal), _get(_getPrototypeOf(_class14.prototype), "updateMatrixWorld", this).call(this, t);
      }
    }]);

    return _class14;
  }(ja), t.PointCloud = function (t, e) {
    return console.warn("THREE.PointCloud has been renamed to THREE.Points."), new eo(t, e);
  }, t.PointCloudMaterial = function (t) {
    return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."), new Za(t);
  }, t.PointLight = Tc, t.PointLightHelper = /*#__PURE__*/function (_Gn3) {
    _inherits(_class15, _Gn3);

    var _super151 = _createSuper(_class15);

    function _class15(t, e, n) {
      var _this119;

      _classCallCheck(this, _class15);

      _this119 = _super151.call(this, new _l(e, 4, 2), new Ke({
        wireframe: !0,
        fog: !1,
        toneMapped: !1
      })), _this119.light = t, _this119.light.updateMatrixWorld(), _this119.color = n, _this119.type = "PointLightHelper", _this119.matrix = _this119.light.matrixWorld, _this119.matrixAutoUpdate = !1, _this119.update();
      return _this119;
    }

    _createClass(_class15, [{
      key: "dispose",
      value: function dispose() {
        this.geometry.dispose(), this.material.dispose();
      }
    }, {
      key: "update",
      value: function update() {
        void 0 !== this.color ? this.material.color.set(this.color) : this.material.color.copy(this.light.color);
      }
    }]);

    return _class15;
  }(Gn), t.Points = eo, t.PointsMaterial = Za, t.PolarGridHelper = /*#__PURE__*/function (_Ya7) {
    _inherits(_class16, _Ya7);

    var _super152 = _createSuper(_class16);

    function _class16() {
      var _this120;

      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 10;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 16;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 8;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 64;
      var r = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 4473924;
      var s = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : 8947848;

      _classCallCheck(this, _class16);

      r = new Qe(r), s = new Qe(s);
      var a = [],
          o = [];

      for (var _n275 = 0; _n275 <= e; _n275++) {
        var _i208 = _n275 / e * (2 * Math.PI),
            _l37 = Math.sin(_i208) * t,
            _c28 = Math.cos(_i208) * t;

        a.push(0, 0, 0), a.push(_l37, 0, _c28);

        var _h17 = 1 & _n275 ? r : s;

        o.push(_h17.r, _h17.g, _h17.b), o.push(_h17.r, _h17.g, _h17.b);
      }

      for (var _e304 = 0; _e304 <= n; _e304++) {
        var _l38 = 1 & _e304 ? r : s,
            _c29 = t - t / n * _e304;

        for (var _t327 = 0; _t327 < i; _t327++) {
          var _e305 = _t327 / i * (2 * Math.PI),
              _n276 = Math.sin(_e305) * _c29,
              _r175 = Math.cos(_e305) * _c29;

          a.push(_n276, 0, _r175), o.push(_l38.r, _l38.g, _l38.b), _e305 = (_t327 + 1) / i * (2 * Math.PI), _n276 = Math.sin(_e305) * _c29, _r175 = Math.cos(_e305) * _c29, a.push(_n276, 0, _r175), o.push(_l38.r, _l38.g, _l38.b);
        }
      }

      var l = new wn();
      l.setAttribute("position", new un(a, 3)), l.setAttribute("color", new un(o, 3));
      _this120 = _super152.call(this, l, new Ua({
        vertexColors: !0,
        toneMapped: !1
      })), _this120.type = "PolarGridHelper";
      return _this120;
    }

    return _class16;
  }(Ya), t.PolyhedronBufferGeometry = ho, t.PolyhedronGeometry = ho, t.PositionalAudio = /*#__PURE__*/function (_ih) {
    _inherits(_class17, _ih);

    var _super153 = _createSuper(_class17);

    function _class17(t) {
      var _this121;

      _classCallCheck(this, _class17);

      _this121 = _super153.call(this, t), _this121.panner = _this121.context.createPanner(), _this121.panner.panningModel = "HRTF", _this121.panner.connect(_this121.gain);
      return _this121;
    }

    _createClass(_class17, [{
      key: "getOutput",
      value: function getOutput() {
        return this.panner;
      }
    }, {
      key: "getRefDistance",
      value: function getRefDistance() {
        return this.panner.refDistance;
      }
    }, {
      key: "setRefDistance",
      value: function setRefDistance(t) {
        return this.panner.refDistance = t, this;
      }
    }, {
      key: "getRolloffFactor",
      value: function getRolloffFactor() {
        return this.panner.rolloffFactor;
      }
    }, {
      key: "setRolloffFactor",
      value: function setRolloffFactor(t) {
        return this.panner.rolloffFactor = t, this;
      }
    }, {
      key: "getDistanceModel",
      value: function getDistanceModel() {
        return this.panner.distanceModel;
      }
    }, {
      key: "setDistanceModel",
      value: function setDistanceModel(t) {
        return this.panner.distanceModel = t, this;
      }
    }, {
      key: "getMaxDistance",
      value: function getMaxDistance() {
        return this.panner.maxDistance;
      }
    }, {
      key: "setMaxDistance",
      value: function setMaxDistance(t) {
        return this.panner.maxDistance = t, this;
      }
    }, {
      key: "setDirectionalCone",
      value: function setDirectionalCone(t, e, n) {
        return this.panner.coneInnerAngle = t, this.panner.coneOuterAngle = e, this.panner.coneOuterGain = n, this;
      }
    }, {
      key: "updateMatrixWorld",
      value: function updateMatrixWorld(t) {
        if (_get(_getPrototypeOf(_class17.prototype), "updateMatrixWorld", this).call(this, t), !0 === this.hasPlaybackControl && !1 === this.isPlaying) return;
        this.matrixWorld.decompose(rh, sh, ah), oh.set(0, 0, 1).applyQuaternion(sh);
        var e = this.panner;

        if (e.positionX) {
          var _t328 = this.context.currentTime + this.listener.timeDelta;

          e.positionX.linearRampToValueAtTime(rh.x, _t328), e.positionY.linearRampToValueAtTime(rh.y, _t328), e.positionZ.linearRampToValueAtTime(rh.z, _t328), e.orientationX.linearRampToValueAtTime(oh.x, _t328), e.orientationY.linearRampToValueAtTime(oh.y, _t328), e.orientationZ.linearRampToValueAtTime(oh.z, _t328);
        } else e.setPosition(rh.x, rh.y, rh.z), e.setOrientation(oh.x, oh.y, oh.z);
      }
    }]);

    return _class17;
  }(ih), t.PropertyBinding = _h, t.PropertyMixer = ch, t.QuadraticBezierCurve = No, t.QuadraticBezierCurve3 = Bo, t.Quaternion = Lt, t.QuaternionKeyframeTrack = Jl, t.QuaternionLinearInterpolant = Yl, t.REVISION = e, t.RGBADepthPacking = 3201, t.RGBAFormat = E, t.RGBAIntegerFormat = 1033, t.RGBA_ASTC_10x10_Format = 37819, t.RGBA_ASTC_10x5_Format = 37816, t.RGBA_ASTC_10x6_Format = 37817, t.RGBA_ASTC_10x8_Format = 37818, t.RGBA_ASTC_12x10_Format = 37820, t.RGBA_ASTC_12x12_Format = 37821, t.RGBA_ASTC_4x4_Format = 37808, t.RGBA_ASTC_5x4_Format = 37809, t.RGBA_ASTC_5x5_Format = 37810, t.RGBA_ASTC_6x5_Format = 37811, t.RGBA_ASTC_6x6_Format = 37812, t.RGBA_ASTC_8x5_Format = 37813, t.RGBA_ASTC_8x6_Format = 37814, t.RGBA_ASTC_8x8_Format = 37815, t.RGBA_BPTC_Format = 36492, t.RGBA_ETC2_EAC_Format = O, t.RGBA_PVRTC_2BPPV1_Format = z, t.RGBA_PVRTC_4BPPV1_Format = B, t.RGBA_S3TC_DXT1_Format = C, t.RGBA_S3TC_DXT3_Format = P, t.RGBA_S3TC_DXT5_Format = I, t.RGBDEncoding = $, t.RGBEEncoding = Z, t.RGBEFormat = 1023, t.RGBFormat = T, t.RGBIntegerFormat = 1032, t.RGBM16Encoding = K, t.RGBM7Encoding = Q, t.RGB_ETC1_Format = 36196, t.RGB_ETC2_Format = F, t.RGB_PVRTC_2BPPV1_Format = N, t.RGB_PVRTC_4BPPV1_Format = D, t.RGB_S3TC_DXT1_Format = R, t.RGFormat = 1030, t.RGIntegerFormat = 1031, t.RawShaderMaterial = _i, t.Ray = se, t.Raycaster = /*#__PURE__*/function () {
    function _class18(t, e) {
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;
      var i = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1 / 0;

      _classCallCheck(this, _class18);

      this.ray = new se(t, e), this.near = n, this.far = i, this.camera = null, this.layers = new ve(), this.params = {
        Mesh: {},
        Line: {
          threshold: 1
        },
        LOD: {},
        Points: {
          threshold: 1
        },
        Sprite: {}
      };
    }

    _createClass(_class18, [{
      key: "set",
      value: function set(t, e) {
        this.ray.set(t, e);
      }
    }, {
      key: "setFromCamera",
      value: function setFromCamera(t, e) {
        e && e.isPerspectiveCamera ? (this.ray.origin.setFromMatrixPosition(e.matrixWorld), this.ray.direction.set(t.x, t.y, .5).unproject(e).sub(this.ray.origin).normalize(), this.camera = e) : e && e.isOrthographicCamera ? (this.ray.origin.set(t.x, t.y, (e.near + e.far) / (e.near - e.far)).unproject(e), this.ray.direction.set(0, 0, -1).transformDirection(e.matrixWorld), this.camera = e) : console.error("THREE.Raycaster: Unsupported camera type: " + e.type);
      }
    }, {
      key: "intersectObject",
      value: function intersectObject(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;
        var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];
        return Lh(t, this, n, e), n.sort(Ah), n;
      }
    }, {
      key: "intersectObjects",
      value: function intersectObjects(t) {
        var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : !1;
        var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];

        for (var _i209 = 0, r = t.length; _i209 < r; _i209++) {
          Lh(t[_i209], this, n, e);
        }

        return n.sort(Ah), n;
      }
    }]);

    return _class18;
  }(), t.RectAreaLight = Rc, t.RedFormat = 1028, t.RedIntegerFormat = 1029, t.ReinhardToneMapping = 2, t.RepeatWrapping = h, t.ReplaceStencilOp = 7681, t.ReverseSubtractEquation = 102, t.RingBufferGeometry = yl, t.RingGeometry = yl, t.SRGB8_ALPHA8_ASTC_10x10_Format = 37851, t.SRGB8_ALPHA8_ASTC_10x5_Format = 37848, t.SRGB8_ALPHA8_ASTC_10x6_Format = 37849, t.SRGB8_ALPHA8_ASTC_10x8_Format = 37850, t.SRGB8_ALPHA8_ASTC_12x10_Format = 37852, t.SRGB8_ALPHA8_ASTC_12x12_Format = 37853, t.SRGB8_ALPHA8_ASTC_4x4_Format = 37840, t.SRGB8_ALPHA8_ASTC_5x4_Format = 37841, t.SRGB8_ALPHA8_ASTC_5x5_Format = 37842, t.SRGB8_ALPHA8_ASTC_6x5_Format = 37843, t.SRGB8_ALPHA8_ASTC_6x6_Format = 37844, t.SRGB8_ALPHA8_ASTC_8x5_Format = 37845, t.SRGB8_ALPHA8_ASTC_8x6_Format = 37846, t.SRGB8_ALPHA8_ASTC_8x8_Format = 37847, t.Scene = ta, t.SceneUtils = su, t.ShaderChunk = hi, t.ShaderLib = di, t.ShaderMaterial = Xn, t.ShadowMaterial = Rl, t.Shape = dc, t.ShapeBufferGeometry = xl, t.ShapeGeometry = xl, t.ShapePath = Gc, t.ShapeUtils = cl, t.ShortType = 1011, t.Skeleton = Da, t.SkeletonHelper = Uh, t.SkinnedMesh = La, t.SmoothShading = 2, t.Sphere = Qt, t.SphereBufferGeometry = _l, t.SphereGeometry = _l, t.Spherical = /*#__PURE__*/function () {
    function _class19() {
      var t = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;
      var e = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;
      var n = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;

      _classCallCheck(this, _class19);

      return this.radius = t, this.phi = e, this.theta = n, this;
    }

    _createClass(_class19, [{
      key: "set",
      value: function set(t, e, n) {
        return this.radius = t, this.phi = e, this.theta = n, this;
      }
    }, {
      key: "copy",
      value: function copy(t) {
        return this.radius = t.radius, this.phi = t.phi, this.theta = t.theta, this;
      }
    }, {
      key: "makeSafe",
      value: function makeSafe() {
        var t = 1e-6;
        return this.phi = Math.max(t, Math.min(Math.PI - t, this.phi)), this;
      }
    }, {
      key: "setFromVector3",
      value: function setFromVector3(t) {
        return this.setFromCartesianCoords(t.x, t.y, t.z);
      }
    }, {
      key: "setFromCartesianCoords",
      value: function setFromCartesianCoords(t, e, n) {
        return this.radius = Math.sqrt(t * t + e * e + n * n), 0 === this.radius ? (this.theta = 0, this.phi = 0) : (this.theta = Math.atan2(t, n), this.phi = Math.acos(ht(e / this.radius, -1, 1))), this;
      }
    }, {
      key: "clone",
      value: function clone() {
        return new this.constructor().copy(this);
      }
    }]);

    return _class19;
  }(), t.SphericalHarmonics3 = Cc, t.SplineCurve = zo, t.SpotLight = _c, t.SpotLightHelper = /*#__PURE__*/function (_Pe18) {
    _inherits(_class20, _Pe18);

    var _super154 = _createSuper(_class20);

    function _class20(t, e) {
      var _this122;

      _classCallCheck(this, _class20);

      _this122 = _super154.call(this), _this122.light = t, _this122.light.updateMatrixWorld(), _this122.matrix = t.matrixWorld, _this122.matrixAutoUpdate = !1, _this122.color = e;
      var n = new wn(),
          i = [0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, -1, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, -1, 1];

      for (var _t329 = 0, _e306 = 1, _n277 = 32; _t329 < _n277; _t329++, _e306++) {
        var _r176 = _t329 / _n277 * Math.PI * 2,
            _s99 = _e306 / _n277 * Math.PI * 2;

        i.push(Math.cos(_r176), Math.sin(_r176), 1, Math.cos(_s99), Math.sin(_s99), 1);
      }

      n.setAttribute("position", new un(i, 3));
      var r = new Ua({
        fog: !1,
        toneMapped: !1
      });
      _this122.cone = new Ya(n, r), _this122.add(_this122.cone), _this122.update();
      return _this122;
    }

    _createClass(_class20, [{
      key: "dispose",
      value: function dispose() {
        this.cone.geometry.dispose(), this.cone.material.dispose();
      }
    }, {
      key: "update",
      value: function update() {
        this.light.updateMatrixWorld();
        var t = this.light.distance ? this.light.distance : 1e3,
            e = t * Math.tan(this.light.angle);
        this.cone.scale.set(e, e, t), Bh.setFromMatrixPosition(this.light.target.matrixWorld), this.cone.lookAt(Bh), void 0 !== this.color ? this.cone.material.color.set(this.color) : this.cone.material.color.copy(this.light.color);
      }
    }]);

    return _class20;
  }(Pe), t.Sprite = ya, t.SpriteMaterial = ra, t.SrcAlphaFactor = 204, t.SrcAlphaSaturateFactor = 210, t.SrcColorFactor = 202, t.StaticCopyUsage = 35046, t.StaticDrawUsage = et, t.StaticReadUsage = 35045, t.StereoCamera = /*#__PURE__*/function () {
    function _class21() {
      _classCallCheck(this, _class21);

      this.type = "StereoCamera", this.aspect = 1, this.eyeSep = .064, this.cameraL = new Jn(), this.cameraL.layers.enable(1), this.cameraL.matrixAutoUpdate = !1, this.cameraR = new Jn(), this.cameraR.layers.enable(2), this.cameraR.matrixAutoUpdate = !1, this._cache = {
        focus: null,
        fov: null,
        aspect: null,
        near: null,
        far: null,
        zoom: null,
        eyeSep: null
      };
    }

    _createClass(_class21, [{
      key: "update",
      value: function update(t) {
        var e = this._cache;

        if (e.focus !== t.focus || e.fov !== t.fov || e.aspect !== t.aspect * this.aspect || e.near !== t.near || e.far !== t.far || e.zoom !== t.zoom || e.eyeSep !== this.eyeSep) {
          e.focus = t.focus, e.fov = t.fov, e.aspect = t.aspect * this.aspect, e.near = t.near, e.far = t.far, e.zoom = t.zoom, e.eyeSep = this.eyeSep;

          var _n278 = t.projectionMatrix.clone(),
              _i210 = e.eyeSep / 2,
              r = _i210 * e.near / e.focus,
              _s100 = e.near * Math.tan(ot * e.fov * .5) / e.zoom;

          var _a80, _o49;

          Zc.elements[12] = -_i210, Jc.elements[12] = _i210, _a80 = -_s100 * e.aspect + r, _o49 = _s100 * e.aspect + r, _n278.elements[0] = 2 * e.near / (_o49 - _a80), _n278.elements[8] = (_o49 + _a80) / (_o49 - _a80), this.cameraL.projectionMatrix.copy(_n278), _a80 = -_s100 * e.aspect - r, _o49 = _s100 * e.aspect - r, _n278.elements[0] = 2 * e.near / (_o49 - _a80), _n278.elements[8] = (_o49 + _a80) / (_o49 - _a80), this.cameraR.projectionMatrix.copy(_n278);
        }

        this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(Zc), this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(Jc);
      }
    }]);

    return _class21;
  }(), t.StreamCopyUsage = 35042, t.StreamDrawUsage = 35040, t.StreamReadUsage = 35041, t.StringKeyframeTrack = Zl, t.SubtractEquation = 101, t.SubtractiveBlending = 3, t.TOUCH = {
    ROTATE: 0,
    PAN: 1,
    DOLLY_PAN: 2,
    DOLLY_ROTATE: 3
  }, t.TangentSpaceNormalMap = 0, t.TetrahedronBufferGeometry = Ml, t.TetrahedronGeometry = Ml, t.TextBufferGeometry = bl, t.TextGeometry = bl, t.Texture = bt, t.TextureLoader = cc, t.TorusBufferGeometry = wl, t.TorusGeometry = wl, t.TorusKnotBufferGeometry = Sl, t.TorusKnotGeometry = Sl, t.Triangle = ke, t.TriangleFanDrawMode = 2, t.TriangleStripDrawMode = 1, t.TrianglesDrawMode = 0, t.TubeBufferGeometry = Tl, t.TubeGeometry = Tl, t.UVMapping = i, t.Uint16Attribute = function (t, e) {
    return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."), new on(t, e);
  }, t.Uint16BufferAttribute = on, t.Uint32Attribute = function (t, e) {
    return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."), new cn(t, e);
  }, t.Uint32BufferAttribute = cn, t.Uint8Attribute = function (t, e) {
    return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."), new rn(t, e);
  }, t.Uint8BufferAttribute = rn, t.Uint8ClampedAttribute = function (t, e) {
    return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."), new sn(t, e);
  }, t.Uint8ClampedBufferAttribute = sn, t.Uniform = Sh, t.UniformsLib = ui, t.UniformsUtils = qn, t.UnsignedByteType = x, t.UnsignedInt248Type = S, t.UnsignedIntType = M, t.UnsignedShort4444Type = 1017, t.UnsignedShort5551Type = 1018, t.UnsignedShort565Type = 1019, t.UnsignedShortType = _, t.VSMShadowMap = 3, t.Vector2 = vt, t.Vector3 = Rt, t.Vector4 = St, t.VectorKeyframeTrack = Ql, t.Vertex = function (t, e, n) {
    return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."), new Rt(t, e, n);
  }, t.VertexColors = 2, t.VideoTexture = io, t.WebGL1Renderer = Qs, t.WebGLCubeRenderTarget = $n, t.WebGLMultipleRenderTargets = Et, t.WebGLMultisampleRenderTarget = At, t.WebGLRenderTarget = Tt, t.WebGLRenderTargetCube = function (t, e, n) {
    return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."), new $n(t, n);
  }, t.WebGLRenderer = Zs, t.WebGLUtils = Vs, t.WireframeGeometry = El, t.WireframeHelper = function (t, e) {
    return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."), new Ya(new El(t.geometry), new Ua({
      color: void 0 !== e ? e : 16777215
    }));
  }, t.WrapAroundEnding = W, t.XHRLoader = function (t) {
    return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."), new sc(t);
  }, t.ZeroCurvatureEnding = k, t.ZeroFactor = 200, t.ZeroSlopeEnding = V, t.ZeroStencilOp = 0, t.sRGBEncoding = Y, Object.defineProperty(t, "__esModule", {
    value: !0
  });
});
},{}],"C:/Users/aleks/AppData/Roaming/npm/node_modules/parcel-bundler/src/builtins/hmr-runtime.js":[function(require,module,exports) {
var global = arguments[3];
var OVERLAY_ID = '__parcel__error__overlay__';
var OldModule = module.bundle.Module;

function Module(moduleName) {
  OldModule.call(this, moduleName);
  this.hot = {
    data: module.bundle.hotData,
    _acceptCallbacks: [],
    _disposeCallbacks: [],
    accept: function (fn) {
      this._acceptCallbacks.push(fn || function () {});
    },
    dispose: function (fn) {
      this._disposeCallbacks.push(fn);
    }
  };
  module.bundle.hotData = null;
}

module.bundle.Module = Module;
var checkedAssets, assetsToAccept;
var parent = module.bundle.parent;

if ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {
  var hostname = "" || location.hostname;
  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';
  var ws = new WebSocket(protocol + '://' + hostname + ':' + "55549" + '/');

  ws.onmessage = function (event) {
    checkedAssets = {};
    assetsToAccept = [];
    var data = JSON.parse(event.data);

    if (data.type === 'update') {
      var handled = false;
      data.assets.forEach(function (asset) {
        if (!asset.isNew) {
          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);

          if (didAccept) {
            handled = true;
          }
        }
      }); // Enable HMR for CSS by default.

      handled = handled || data.assets.every(function (asset) {
        return asset.type === 'css' && asset.generated.js;
      });

      if (handled) {
        console.clear();
        data.assets.forEach(function (asset) {
          hmrApply(global.parcelRequire, asset);
        });
        assetsToAccept.forEach(function (v) {
          hmrAcceptRun(v[0], v[1]);
        });
      } else if (location.reload) {
        // `location` global exists in a web worker context but lacks `.reload()` function.
        location.reload();
      }
    }

    if (data.type === 'reload') {
      ws.close();

      ws.onclose = function () {
        location.reload();
      };
    }

    if (data.type === 'error-resolved') {
      console.log('[parcel] ✨ Error resolved');
      removeErrorOverlay();
    }

    if (data.type === 'error') {
      console.error('[parcel] 🚨  ' + data.error.message + '\n' + data.error.stack);
      removeErrorOverlay();
      var overlay = createErrorOverlay(data);
      document.body.appendChild(overlay);
    }
  };
}

function removeErrorOverlay() {
  var overlay = document.getElementById(OVERLAY_ID);

  if (overlay) {
    overlay.remove();
  }
}

function createErrorOverlay(data) {
  var overlay = document.createElement('div');
  overlay.id = OVERLAY_ID; // html encode message and stack trace

  var message = document.createElement('div');
  var stackTrace = document.createElement('pre');
  message.innerText = data.error.message;
  stackTrace.innerText = data.error.stack;
  overlay.innerHTML = '<div style="background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;">' + '<span style="background: red; padding: 2px 4px; border-radius: 2px;">ERROR</span>' + '<span style="top: 2px; margin-left: 5px; position: relative;">🚨</span>' + '<div style="font-size: 18px; font-weight: bold; margin-top: 20px;">' + message.innerHTML + '</div>' + '<pre>' + stackTrace.innerHTML + '</pre>' + '</div>';
  return overlay;
}

function getParents(bundle, id) {
  var modules = bundle.modules;

  if (!modules) {
    return [];
  }

  var parents = [];
  var k, d, dep;

  for (k in modules) {
    for (d in modules[k][1]) {
      dep = modules[k][1][d];

      if (dep === id || Array.isArray(dep) && dep[dep.length - 1] === id) {
        parents.push(k);
      }
    }
  }

  if (bundle.parent) {
    parents = parents.concat(getParents(bundle.parent, id));
  }

  return parents;
}

function hmrApply(bundle, asset) {
  var modules = bundle.modules;

  if (!modules) {
    return;
  }

  if (modules[asset.id] || !bundle.parent) {
    var fn = new Function('require', 'module', 'exports', asset.generated.js);
    asset.isNew = !modules[asset.id];
    modules[asset.id] = [fn, asset.deps];
  } else if (bundle.parent) {
    hmrApply(bundle.parent, asset);
  }
}

function hmrAcceptCheck(bundle, id) {
  var modules = bundle.modules;

  if (!modules) {
    return;
  }

  if (!modules[id] && bundle.parent) {
    return hmrAcceptCheck(bundle.parent, id);
  }

  if (checkedAssets[id]) {
    return;
  }

  checkedAssets[id] = true;
  var cached = bundle.cache[id];
  assetsToAccept.push([bundle, id]);

  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {
    return true;
  }

  return getParents(global.parcelRequire, id).some(function (id) {
    return hmrAcceptCheck(global.parcelRequire, id);
  });
}

function hmrAcceptRun(bundle, id) {
  var cached = bundle.cache[id];
  bundle.hotData = {};

  if (cached) {
    cached.hot.data = bundle.hotData;
  }

  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {
    cached.hot._disposeCallbacks.forEach(function (cb) {
      cb(bundle.hotData);
    });
  }

  delete bundle.cache[id];
  bundle(id);
  cached = bundle.cache[id];

  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {
    cached.hot._acceptCallbacks.forEach(function (cb) {
      cb();
    });

    return true;
  }
}
},{}]},{},["C:/Users/aleks/AppData/Roaming/npm/node_modules/parcel-bundler/src/builtins/hmr-runtime.js","three.js-master/build/three.min.js"], null)
//# sourceMappingURL=/three.min.eb4742ec.js.map